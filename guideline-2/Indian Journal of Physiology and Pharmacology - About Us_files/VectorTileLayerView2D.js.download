// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/engine/vectorTiles/TileHandler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../request ../../../../core/has ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/workers/workers ./GlyphMosaic ./GlyphSource ./SpriteMosaic ./decluttering/debugging ../../tiling/TileKey".split(" "),function(B,F,w,l,r,v,h,f,g,a,b,m){let p=function(){function q(c,d,x){this._layer=c;this._styleRepository=d;this.devicePixelRatio=x;this._connection=
this._glyphMosaic=this._spriteMosaic=null}var k=q.prototype;k.destroy=function(){this._connection&&(this._connection.close(),this._connection=null);this._layer=this._styleRepository=null;this._spriteMosaic&&(this._spriteMosaic=null);this._glyphMosaic&&(this._glyphMosaic=null)};k.start=function(){var c=F._asyncToGenerator(function*(d){this._spriteSourcePromise=this._layer.loadSpriteSource(this.devicePixelRatio,d);this._spriteSourcePromise.then(D=>{this._spriteMosaic=new a(1024,1024,250);this._spriteMosaic.setSpriteSource(D)});
const x=new g(this._layer.currentStyleInfo.glyphsUrl?v.addQueryParameters(this._layer.currentStyleInfo.glyphsUrl,{...this._layer.customParameters,token:this._layer.apiKey}):null);this._glyphMosaic=new f(1024,1024,x);this._broadcastPromise=h.open("WorkerTileHandler",{client:this,schedule:d.schedule,signal:d.signal}).then(D=>{this._connection=D;return Promise.all(this._connection.broadcast("setStyle",{style:this._layer.currentStyleInfo.style,vectorTileLayerMaxBuffers:l("vectortilelayer-max-buffers")},
d))})});return function(d){return c.apply(this,arguments)}}();k.updateStyle=function(){var c=F._asyncToGenerator(function*(d){yield this._broadcastPromise;return this._broadcastPromise=Promise.all(this._connection.broadcast("updateStyle",d))});return function(d){return c.apply(this,arguments)}}();k.setStyle=function(){var c=F._asyncToGenerator(function*(d,x){yield this._broadcastPromise;this._styleRepository=d;this._spriteSourcePromise=this._layer.loadSpriteSource(this.devicePixelRatio,null);this._spriteSourcePromise.then(D=>
{this._spriteMosaic=new a(1024,1024,250);this._spriteMosaic.setSpriteSource(D)});d=new g(this._layer.currentStyleInfo.glyphsUrl?v.addQueryParameters(this._layer.currentStyleInfo.glyphsUrl,{...this._layer.customParameters,token:this._layer.apiKey}):null);this._glyphMosaic=new f(1024,1024,d);return this._broadcastPromise=Promise.all(this._connection.broadcast("setStyle",{style:x,vectorTileLayerMaxBuffers:l("vectortilelayer-max-buffers")}))});return function(d,x){return c.apply(this,arguments)}}();k.fetchTileData=
function(c,d){return this._getRefKeys(c,d).then(x=>{const D=this._layer.sourceNameToSource,C=[];for(const A in D)C.push(A);return this._getSourcesData(C,x,d)})};k.parseTileData=function(c,d){const x=c&&c.data;if(!x)return Promise.resolve(null);const {sourceName2DataAndRefKey:D,transferList:C}=x;return 0===Object.keys(D).length?Promise.resolve(null):this._broadcastPromise.then(()=>this._connection.getAvailableClient().then(A=>A.invoke("createTileAndParse",{key:c.key.id,sourceName2DataAndRefKey:D,styleLayerUIDs:c.styleLayerUIDs},
{...d,transferList:C})))};k.getSprites=function(){var c=F._asyncToGenerator(function*(d){yield this._spriteSourcePromise;return this._spriteMosaic.getSpriteItems(d)});return function(d){return c.apply(this,arguments)}}();k.getGlyphs=function(c){return this._glyphMosaic.getGlyphItems(c.font,c.codePoints)};k.perfReport=function({key:c,milliseconds:d}){b.perfAdd(c,d,"ms")};k._getTilePayload=function(){var c=F._asyncToGenerator(function*(d,x,D){d=m.pool.acquire(d.id);const C=this._layer.sourceNameToSource[x].getSourceTileUrl(d.level,
d.row,d.col);m.pool.release(d);try{return{protobuff:yield this.request(C,D),sourceName:x}}catch(A){if(r.isAbortError(A))throw A;return{protobuff:null,sourceName:x}}});return function(d,x,D){return c.apply(this,arguments)}}();k.request=function(c,d){return w(c,{responseType:"array-buffer",...d}).then(({data:x})=>x)};k._getRefKeys=function(c,d){const x=this._layer.sourceNameToSource,D=[];for(const C in x){const A=x[C].getRefKey(c,d);D.push(A)}return r.eachAlways(D)};k._getSourcesData=function(c,d,x){const D=
[];for(let C=0;C<d.length;C++)if(null==d[C].value||null==c[C])D.push(null);else{const A=this._getTilePayload(d[C].value,c[C],x);D.push(A)}return r.eachAlways(D).then(C=>{const A={},u=[];for(let z=0;z<C.length;z++)C[z].value&&C[z].value&&C[z].value.protobuff&&0<C[z].value.protobuff.byteLength&&(A[C[z].value.sourceName]={refKey:d[z].value.id,protobuff:C[z].value.protobuff},u.push(C[z].value.protobuff));return{sourceName2DataAndRefKey:A,transferList:u}})};F._createClass(q,[{key:"spriteMosaic",get:function(){return this._spriteSourcePromise.then(()=>
this._spriteMosaic)}},{key:"glyphMosaic",get:function(){return this._glyphMosaic}}]);return q}();B.TileHandler=p;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/GlyphMosaic":function(){define("../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/Texture ../../../webgl/VertexArrayObject ./RectangleBinPack ../webgl/Rect".split(" "),
function(B,F,w,l,r,v,h,f,g,a,b){return function(){function m(q,k,c){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphIndex={};this._textures=[];this._rangePromises=new Map;this.width=q;this.height=k;this._glyphSource=c;this._binPack=new a(q-4,k-4);this._glyphData.push(new Uint8Array(q*k));this._dirties.push(!0);this._textures.push(void 0)}var p=m.prototype;p.getGlyphItems=function(q,k){const c=[],d=this._glyphSource,x=new Set,D=1/256;for(const A of k)x.add(Math.floor(A*
D));const C=[];x.forEach(A=>{if(256>=A){const u=q+A;this._rangePromises.has(u)?C.push(this._rangePromises.get(u)):(A=d.getRange(q,A).then(()=>{this._rangePromises["delete"](u)},()=>{this._rangePromises["delete"](u)}),this._rangePromises.set(u,A),C.push(A))}});return Promise.all(C).then(()=>{let A=this._glyphIndex[q];A||(A={},this._glyphIndex[q]=A);for(const M of k){var u=A[M];if(u){c[M]={sdf:!0,rect:u.rect,metrics:u.metrics,page:u.page,code:M};continue}var z=d.getGlyph(q,M);if(!z||!z.metrics)continue;
u=z.metrics;let O;if(0===u.width)O=new b(0,0,0,0);else{const N=u.width+6,Q=u.height+6;var J=N%4?4-N%4:4,L=Q%4?4-Q%4:4;1===J&&(J=5);1===L&&(L=5);O=this._binPack.allocate(N+J,Q+L);O.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(void 0),this._binPack=new a(this.width-4,this.height-4),O=this._binPack.allocate(N+J,Q+L));
J=this._glyphData[this._currentPage];z=z.bitmap;let R;if(z)for(let G=0;G<Q;G++){L=N*G;R=this.width*(O.y+G+1)+O.x;for(let K=0;K<N;K++)J[R+K+1]=z[L+K]}}A[M]={rect:O,metrics:u,tileIDs:null,page:this._currentPage};c[M]={sdf:!0,rect:O,metrics:u,page:this._currentPage,code:M};this._dirties[this._currentPage]=!0}return c})};p.removeGlyphs=function(q){for(const k in this._glyphIndex){const c=this._glyphIndex[k];if(!c)continue;let d;for(const x in c)if(d=c[x],d.tileIDs["delete"](q),0===d.tileIDs.size){const D=
this._glyphData[d.page],C=d.rect;let A,u;for(let z=0;z<C.height;z++)for(A=this.width*(C.y+z)+C.x,u=0;u<C.width;u++)D[A+u]=0;delete c[x];this._dirties[d.page]=!0}}};p.bind=function(q,k,c,d=0){this._textures[c]||(this._textures[c]=new f(q,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));const x=this._textures[c];x.setSamplingMode(k);this._dirties[c]&&x.setData(this._glyphData[c]);q.bindTexture(x,d);this._dirties[c]=!1};p.dispose=function(){this._binPack=
null;for(const q of this._textures)q&&q.dispose();this._textures.length=0};return m}()})},"esri/views/2d/engine/vectorTiles/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../webgl/Rect"],function(B,F){return function(){function w(r,v){this._height=this._width=0;this._free=[];this._width=r;this._height=v;this._free.push(new F(0,0,r,v))}var l=w.prototype;l.allocate=function(r,v){if(r>this._width||v>this._height)return new F;let h=null,f=-1;for(let g=0;g<this._free.length;++g){const a=
this._free[g];r<=a.width&&v<=a.height&&(null===h||a.y<=h.y&&a.x<=h.x)&&(h=a,f=g)}if(null===h)return new F;this._free.splice(f,1);h.width<h.height?(h.width>r&&this._free.push(new F(h.x+r,h.y,h.width-r,v)),h.height>v&&this._free.push(new F(h.x,h.y+v,h.width,h.height-v))):(h.width>r&&this._free.push(new F(h.x+r,h.y,h.width-r,h.height)),h.height>v&&this._free.push(new F(h.x,h.y+v,r,h.height-v)));return new F(h.x,h.y,r,v)};l.release=function(r){for(let v=0;v<this._free.length;++v){const h=this._free[v];
if(h.y===r.y&&h.height===r.height&&h.x+h.width===r.x)h.width+=r.width;else if(h.x===r.x&&h.width===r.width&&h.y+h.height===r.y)h.height+=r.height;else if(r.y===h.y&&r.height===h.height&&r.x+r.width===h.x)h.x=r.x,h.width+=r.width;else if(r.x===h.x&&r.width===h.width&&r.y+r.height===h.y)h.y=r.y,h.height+=r.height;else continue;this._free.splice(v,1);this.release(r)}this._free.push(r)};B._createClass(w,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);
return w}()})},"esri/views/2d/engine/vectorTiles/GlyphSource":function(){define(["../../../../request","../../../../core/pbf"],function(B,F){let w=function(){function r(h){this._metrics=[];this._bitmaps=[];if(h)for(;h.next();)switch(h.tag()){case 1:{const f=h.getMessage();for(;f.next();)switch(f.tag()){case 3:{const g=f.getMessage();let a,b,m,p,q,k,c;for(;g.next();)switch(g.tag()){case 1:a=g.getUInt32();break;case 2:b=g.getBytes();break;case 3:m=g.getUInt32();break;case 4:p=g.getUInt32();break;case 5:q=
g.getSInt32();break;case 6:k=g.getSInt32();break;case 7:c=g.getUInt32();break;default:g.skip()}g.release();a&&(this._metrics[a]={width:m,height:p,left:q,top:k,advance:c},this._bitmaps[a]=b);break}default:f.skip()}f.release();break}default:h.skip()}}var v=r.prototype;v.getMetrics=function(h){return this._metrics[h]};v.getBitmap=function(h){return this._bitmaps[h]};return r}(),l=function(){function r(){this._ranges=[]}var v=r.prototype;v.getRange=function(h){return this._ranges[h]};v.addRange=function(h,
f){this._ranges[h]=f};return r}();return function(){function r(h){this._glyphInfo={};this._baseURL=h}var v=r.prototype;v.getRange=function(h,f){const g=this._getFontStack(h);if(g.getRange(f))return Promise.resolve();const a=256*f,b=a+255;h=this._baseURL.replace("{fontstack}",h).replace("{range}",a+"-"+b);return B(h,{responseType:"array-buffer"}).then(m=>{g.addRange(f,new w(new F(new Uint8Array(m.data),new DataView(m.data))))}).catch(()=>{g.addRange(f,new w)})};v.getGlyph=function(h,f){if(h=this._getFontStack(h)){var g=
Math.floor(f/256);if(!(256<g)&&(h=h.getRange(g)))return{metrics:h.getMetrics(f),bitmap:h.getBitmap(f)}}};v._getFontStack=function(h){let f=this._glyphInfo[h];f||(f=this._glyphInfo[h]=new l);return f};return r}()})},"esri/views/2d/engine/vectorTiles/SpriteMosaic":function(){define("../../../../symbols/cim/CIMSymbolHelper ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/Texture ../../../webgl/VertexArrayObject ./RectangleBinPack ../webgl/Rect".split(" "),
function(B,F,w,l,r,v,h,f,g,a,b,m){return function(){function p(k,c,d=0){this._size=[];this._mosaicsData=[];this._textures=[];this._dirties=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects={};this.pixelRatio=1;(0>=k||0>=c)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=k;this._pageHeight=c;0<d&&(this._maxItemSize=d);this._binPack=new b(k-4,c-4)}var q=p.prototype;q.dispose=function(){this._binPack=
null;this._mosaicRects={};for(const k of this._textures)k&&k.dispose();this._textures.length=0};q.getWidth=function(k){return k>=this._size.length?-1:this._size[k][0]};q.getHeight=function(k){return k>=this._size.length?-1:this._size[k][1]};q.getPageSize=function(k){return k>=this._size.length?null:this._size[k]};q.setSpriteSource=function(k){this.dispose();this.pixelRatio=k.devicePixelRatio;if(0===this._mosaicsData.length){this._binPack=new b(this._pageWidth-4,this._pageHeight-4);const c=new Uint32Array(Math.floor(this._pageWidth)*
Math.floor(this._pageHeight));this._mosaicsData[0]=c;this._dirties.push(!0);this._size.push([this._pageWidth,this._pageHeight]);this._textures.push(void 0)}this._sprites=k};q.getSpriteItem=function(k,c=!1){var d=this._mosaicRects[k];if(d)return d;if(!this._sprites||"loaded"!==this._sprites.loadStatus)return null;let x;k&&k.startsWith("dasharray-")?([d,x]=this._rasterizeDash(k),c=!0):d=this._sprites.getSpriteInfo(k);if(!d||!d.width||!d.height||0>d.width||0>d.height)return null;const D=d.width,C=d.height,
[A,u,z]=this._allocateImage(D,C);if(0>=A.width)return null;this._copy(A,d,u,z,c,x);d={rect:A,width:D,height:C,sdf:d.sdf,simplePattern:!1,pixelRatio:d.pixelRatio,page:u};return this._mosaicRects[k]=d};q.getSpriteItems=function(k){const c={};for(const d of k)c[d.name]=this.getSpriteItem(d.name,d.repeat);return c};q.getMosaicItemPosition=function(k,c){c=(k=this.getSpriteItem(k,c))&&k.rect;if(!c)return null;c.width=k.width;c.height=k.height;return{tl:[c.x+2,c.y+2],br:[c.x+2+k.width,c.y+2+k.height],page:k.page}};
q.bind=function(k,c,d=0,x=0){this._textures[d]||(this._textures[d]=new g(k,{pixelFormat:6408,dataType:5121,wrapMode:33071,width:this._size[d][0],height:this._size[d][1]},new Uint8Array(this._mosaicsData[d].buffer)));const D=this._textures[d];D.setSamplingMode(c);this._dirties[d]&&D.setData(new Uint8Array(this._mosaicsData[d].buffer));k.bindTexture(D,x);this._dirties[d]=!1};p._copyBits=function(k,c,d,x,D,C,A,u,z,J,L){let M=x*c+d;A=u*C+A;if(L)for(A-=C,L=-1;L<=J;L++,M=((L+J)%J+x)*c+d,A+=C)for(u=-1;u<=
z;u++)D[A+u]=k[M+(u+z)%z];else for(d=0;d<J;d++){for(x=0;x<z;x++)D[A+x]=k[M+x];M+=c;A+=C}};q._copy=function(k,c,d,x,D,C){if(this._sprites&&"loaded"===this._sprites.loadStatus&&!(d>=this._mosaicsData.length)){var A=new Uint32Array(C?C.buffer:this._sprites.image.buffer),u=this._mosaicsData[d];u&&A||console.error("Source or target images are uninitialized!");p._copyBits(A,C?c.width:this._sprites.width,c.x,c.y,u,x[0],k.x+2,k.y+2,c.width,c.height,D);this._dirties[d]=!0}};q._allocateImage=function(k,c){k+=
2;c+=2;var d=Math.max(k,c);if(this._maxItemSize&&this._maxItemSize<d)return d=new m(0,0,k,c),this._mosaicsData.push(new Uint32Array(k*c)),this._dirties.push(!0),this._size.push([k,c]),this._textures.push(void 0),[d,this._mosaicsData.length-1,[k,c]];d=k%4?4-k%4:4;let x=c%4?4-c%4:4;1===d&&(d=5);1===x&&(x=5);d=this._binPack.allocate(k+d,c+x);return 0>=d.width?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*
this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new b(this._pageWidth-4,this._pageHeight-4),this._allocateImage(k,c)):[d,this._currentPage,[this._pageWidth,this._pageHeight]]};q._rasterizeDash=function(k){var c=k.match(/\[(.*?)\]/);if(!c)return null;c=c[1].split(",").map(Number);k=k.slice(k.lastIndexOf("-")+1);const [d,x,D]=B.SymbolHelper.rasterizeDash(c,k);k=new Uint8Array(d.buffer);return[{x:0,y:0,width:x,height:D,
sdf:!0,pixelRatio:1},k]};return p}()})},"esri/views/2d/engine/vectorTiles/decluttering/debugging":function(){define(["exports"],function(B){function F(w,l){return`${Math.round(10*w)/10}${l}`}B.drawColliders=function(w,l){const r=window.COLLISION_XRAY;for(let p=0;p<l.length;++p){const q=!l[p].unique.show;if(r||!q)for(const k of l[p].colliders){if(!k.enabled)continue;var v=!l[p].unique.parts[k.partIndex].show;if(!r&&v)continue;var h=k.xScreen,f=k.yScreen;const c=k.dxScreen,d=k.dyScreen;w.globalAlpha=
q||v?.2:1;v=w;var g=h-1,a=f-1;v.fillStyle="green";v.fillRect(g,a,3,3);v=w;g=h+c;a=f+d;var b=k.width,m=k.height;v.strokeStyle="red";v.strokeRect(g,a,b,m);v=w;h=h+c-1;f=f+d-1;v.fillStyle="blue";v.fillRect(h,f,3,3);w.globalAlpha=1}}};B.drawGridIndex=function(w,l){w.strokeStyle="black";const r=l.cellSize,v=l.rows,h=l.columns;for(let f=0;f<v;f++){const g=l.cells[f],a=f*r,b=(f+1)*r;for(let m=0;m<h;m++){const p=g[m],q=m*r;w.strokeRect(q,a,(m+1)*r-q,b-a);w.fillText(`cells:${p.length}`,q+4,a+12)}}};B.perfAdd=
function(w,l,r){if(window.PERFORMANCE_RECORDING_STORAGE){var v=window.PERFORMANCE_RECORDING_STORAGE;v.perf=v.perf||{};v=v.perf;v[w]=v[w]||{start:null,time:0,min:void 0,max:void 0,samples:[],unit:r};v[w].time+=l;v[w].samples.push(l);if(null==v[w].min||l<v[w].min)v[w].min=l;if(null==v[w].max||l>v[w].max)v[w].max=l}};B.perfClear=function(){window.PERFORMANCE_RECORDING_STORAGE&&(window.PERFORMANCE_RECORDING_STORAGE.perf={})};B.perfElement=function(w){if(!window.PERFORMANCE_RECORDING_STORAGE){var l=document.createElement("div");
l.innerHTML="No recorded data is present because performance recording is disabled.";return l}l=document.createElement("div");var r=window.PERFORMANCE_RECORDING_STORAGE.perf;var v='\x3ctable style\x3d"border-collapse: collapse;"\x3e'+`<tr style="text-weight: bold; border-bottom: 1px solid "${w}";"><td>Name</td><td>Total</td><td>Runs</td><td>Average</td><td>Min</td><td>Distribution</td><td>Max</td><td>Histogram (${50} bins)</td></tr>`;const h=[];for(var f in r)h.push({name:f,value:r[f].time/r[f].samples.length,
sortkey:r[f].max});h.sort((q,k)=>-(q.sortkey-k.sortkey));f=h.map(q=>q.name);for(var g of f)v+="\x3ctr\x3e",v+=`<td>${g}</td>`,v+=`<td>${F(r[g].time,r[g].unit)}</td>`,v+=`<td>${r[g].samples.length}</td>`,v+=`<td>${F(r[g].time/r[g].samples.length,r[g].unit)}</td>`,v+=`<td style="text-align: right;">${F(r[g].min,r[g].unit)}</td>`,v+="\x3ctd data-distribution\x3d'1'\x3e\x3c/td\x3e",v+=`<td>${F(r[g].max,r[g].unit)}</td>`,v+="\x3ctd data-histogram\x3d'1'\x3e\x3c/td\x3e",v+="\x3c/tr\x3e";l.innerHTML=v+"\x3ctable\x3e";
v=l.querySelectorAll("td[data-distribution\x3d'1']");g=l.querySelectorAll("td[data-histogram\x3d'1']");for(let q=0;q<v.length;q++){let k=v[q];var a=document.createElement("canvas");a.height=10;a.width=100;var b=a.getContext("2d");b.strokeStyle=w;b.beginPath();b.moveTo(0,5);b.lineTo(100,5);if(r[f[q]].max>r[f[q]].min+.001)for(const c of r[f[q]].samples){var m=(c-r[f[q]].min)/(r[f[q]].max-r[f[q]].min);b.moveTo(100*m,3);b.lineTo(100*m,7)}b.stroke();b.strokeRect((h[q].value-r[f[q]].min)/(r[f[q]].max-r[f[q]].min)*
100-2,0,4,9);k.appendChild(a);k=g[q];{a=Array(50);for(b=0;b<a.length;b++)a[b]=0;for(const d of r[f[q]].samples)b=(d-r[f[q]].min)/(r[f[q]].max-r[f[q]].min),a[1===b?a.length-1:Math.floor(b*a.length)]++;b=document.createElement("canvas");b.height=30;b.width=120;m=b.getContext("2d");m.strokeStyle=w;m.fillStyle=w;let c=0;for(var p=0;p<a.length;p++)c=Math.max(c,a[p]);for(p=0;p<a.length;p++){const d=a[p];m.fillRect(p*b.width/a.length,b.height*(1-d/c),b.width/a.length,d/c*b.height)}m.beginPath();m.moveTo(0,
b.height);m.lineTo(b.width,b.height);m.stroke();k.appendChild(b)}}w=l.querySelectorAll("td");for(r=0;r<w.length;r++)w[r].style.padding="5px";return l};Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/TileManager":function(){define(["exports","../../../../core/LRUCache","../../../../core/maybe","../../tiling/TileCoverage","../../tiling/TileKey"],function(B,F,w,l,r){const v=(f,g)=>f+1/(1<<2*g);let h=function(){function f(a,b){this._tiles=new Map;this._tileCache=
new F(40,m=>m.dispose());this._viewSize=[0,0];this._visibleTiles=new Map;this.acquireTile=a.acquireTile;this.releaseTile=a.releaseTile;this.tileInfoView=a.tileInfoView;this._container=b}var g=f.prototype;g.destroy=function(){for(const [,a]of this._tiles)a.dispose();this._tiles=null;this._tileCache.clear();this._tileCache=null};g.update=function(a){this._updateCacheSize(a);const b=this.tileInfoView;a=b.getTileCoverage(a.state,0,"smallest");const {spans:m,lodInfo:p}=a,{level:q}=p,k=this._tiles,c=new Set,
d=new Set;for(const {row:D,colFrom:C,colTo:A}of m)for(let u=C;u<=A;u++){const z=r.getId(q,D,p.normalizeCol(u),p.getWorldForColumn(u)),J=this._getOrAcquireTile(z);c.add(z);J.processed()?this._addToContainer(J):d.add(new r(z))}for(const [D,C]of k)C.isCoverage=c.has(D);for(var x of d)this._findPlaceholdersForMissingTiles(x,c);x=!1;for(const [D,C]of k)C.neededForCoverage=c.has(D),C.neededForCoverage||C.isHoldingForFade&&b.intersects(a,C.key)&&c.add(D),C.isFading&&(x=!0);for(const [D]of this._tiles)c.has(D)||
this._releaseTile(D);l.pool.release(a);return!x};g.clear=function(){this._tiles.clear();this._tileCache.clear();this._visibleTiles.clear()};g.clearCache=function(){this._tileCache.clear()};g._findPlaceholdersForMissingTiles=function(a,b){var m=[];for(const [,p]of this._tiles)this._addPlaceholderChild(m,p,a,b);m=m.reduce(v,0);1E-6>Math.abs(1-m)||this._addPlaceholderParent(a.id,b)};g._addPlaceholderChild=function(a,b,m,p){if(!(b.key.level<=m.level)&&b.hasData()){{var q=b.key;const k=q.level-m.level;
q=m.row===q.row>>k&&m.col===q.col>>k&&m.world===q.world}q&&(this._addToContainer(b),p.add(b.id),a.push(b.key.level-m.level))}};g._addPlaceholderParent=function(a,b){const m=this._tiles;for(;;){{const [q,k,c,d]=a.split("/");a=parseInt(q,10);a=0===a?null:`${a-1}/${parseInt(k,10)>>1}/${parseInt(c,10)>>1}/${parseInt(d,10)}`}if(!a||b.has(a))break;const p=m.get(a);if(p&&p.hasData()){this._addToContainer(p);b.add(p.id);break}}};g._getOrAcquireTile=function(a){let b=this._tiles.get(a);if(b)return b;(b=this._tileCache.pop(a))||
(b=this.acquireTile(new r(a)));this._tiles.set(a,b);return b};g._releaseTile=function(a){const b=this._tiles.get(a);this.releaseTile(b);this._removeFromContainer(b);this._tiles.delete(a);b.hasData()?this._tileCache.put(a,b,1):b.dispose()};g._addToContainer=function(a){let b;const m=[],p=this._container;if(!p.contains(a)){var q=this._visibleTiles;for(const [,k]of q)this._canConnectDirectly(a,k)&&m.push(k),w.isNone(b)&&this._canConnectDirectly(k,a)&&(b=k);if(w.isSome(b)){for(const k of m)b.childrenTiles.delete(k),
a.childrenTiles.add(k),k.parentTile=a;b.childrenTiles.add(a);a.parentTile=b}else for(const k of m)a.childrenTiles.add(k),k.parentTile=a;q.set(a.id,a);p.addChild(a)}};g._removeFromContainer=function(a){this._visibleTiles.delete(a.id);this._container.removeChild(a);if(w.isSome(a.parentTile)){a.parentTile.childrenTiles.delete(a);for(const b of a.childrenTiles)w.isSome(a.parentTile)&&a.parentTile.childrenTiles.add(b)}for(const b of a.childrenTiles)b.parentTile=a.parentTile;a.parentTile=null;a.childrenTiles.clear()};
g._canConnectDirectly=function(a,b){a=a.key;let {level:m,row:p,col:q,world:k}=b.key;for(b=this._visibleTiles;0<m;){m--;p>>=1;q>>=1;if(a.level===m&&a.row===p&&a.col===q&&a.world===k)return!0;if(b.has(`${m}/${p}/${q}/${k}`))break}return!1};g._updateCacheSize=function(a){a=a.state.size;if(a[0]!==this._viewSize[0]||a[1]!==this._viewSize[1]){var b=Math.ceil(a[0]/512)+1,m=Math.ceil(a[1]/512)+1;this._viewSize[0]=a[0];this._viewSize[1]=a[1];this._tileCache.maxSize=5*b*m}};return f}();B.TileManager=h;Object.defineProperty(B,
"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/VectorTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ./RenderBucket ./decluttering/config ../webgl/TiledDisplayObject".split(" "),function(B,F,w,l,r,v,h,f){f=function(a){function b(p,q,k,c,d,x,D=null){q=a.call(this,p,q,k,c,d,4096,4096)||this;q._memCache=D;q.type="vector-tile";q._referenced=0;q._hasSymbolBuckets=!1;q._memoryUsedByLayerData=
0;q.layerData=new Map;q.layerCount=0;q.status="loading";q.allSymbolsFadingOut=!1;q.lastOpacityUpdate=0;q.symbols=new Map;q.isCoverage=!1;q.neededForCoverage=!1;q.decluttered=!1;q.invalidating=!1;q.parentTile=null;q.childrenTiles=new Set;q._processed=!1;q._referenced=1;q.styleRepository=x;q.id=p.id;return q}F._inheritsLoose(b,a);var m=b.prototype;m.setData=function(p){this.changeDataImpl(p);this.requestRender();this.ready();this.invalidating=!1;this._processed=!0};m.deleteLayerData=function(p){let q=
!1;for(const k of p)this.layerData.has(k)&&(p=this.layerData.get(k),this._memoryUsedByLayerData-=p.memoryUsed,3===p.type&&this.symbols.has(k)&&(this.symbols.delete(k),q=!0),p.destroy(),this.layerData.delete(k),this.layerCount--);w.isSome(this._memCache)&&this._memCache.updateSize(this.key.id,this,this._memoryUsedByLayerData);q&&this.emit("symbols-changed");this.requestRender()};m.processed=function(){return this._processed};m.hasData=function(){return 0<this.layerCount};m.dispose=function(){"unloaded"!==
this.status&&(g.delete(this),b._destroyRenderBuckets(this.layerData),this.layerData=null,this._memoryUsedByLayerData=this.layerCount=0,this.destroy(),this.status="unloaded")};m.release=function(){return 0===--this._referenced?(this.dispose(),this.stage=null,!0):!1};m.retain=function(){++this._referenced};m.changeDataImpl=function(p){let q=!1;if(p){p=this._createRenderBuckets(p);for(const [k,c]of p)this.layerData.has(k)&&(p=this.layerData.get(k),this._memoryUsedByLayerData-=c.memoryUsed,p.destroy(),
this.layerData.delete(k),this.layerCount--),3===c.type&&(this.symbols.set(k,c.symbols),q=!0),this._memoryUsedByLayerData+=c.memoryUsed,this.layerData.set(k,c),this.layerCount++;w.isSome(this._memCache)&&this._memCache.updateSize(this.key.id,this,this._memoryUsedByLayerData)}this._hasSymbolBuckets=!1;for(const [,k]of this.layerData)3===k.type&&(this._hasSymbolBuckets=!0);q&&this.emit("symbols-changed")};m.attachWithContext=function(p){this.stage={context:p,trashDisplayObject(q){q.processDetach()},
untrashDisplayObject(){return!1}}};m.setTransform=function(p,q){a.prototype.setTransform.call(this,p,q);var k=q/(p.resolution*p.pixelRatio);q=this.width/this.rangeX*k;k*=this.height/this.rangeY;const c=[0,0];p.toScreen(c,[this.x,this.y]);const d=this.transforms.tileUnitsToPixels;l.identity(d);l.translate(d,d,c);l.rotate(d,d,Math.PI*p.rotation/180);l.scale(d,d,[q,k,1])};m._createTransforms=function(){return{dvs:r.create(),tileMat3:r.create(),tileUnitsToPixels:r.create()}};b._destroyRenderBuckets=function(p){if(p){var q=
new Set;p.forEach(k=>{q.has(k)||(k.destroy(),q.add(k))});p.clear()}};m._createRenderBuckets=function(p){const q=new Map,k=new Map;for(const c of p){p=this._deserializeBucket(c,k);for(const d of p.layerUIDs)q.set(d,p)}return q};m._deserializeBucket=function(p,q){let k=q.get(p);if(k)return k;switch((new Uint32Array(p))[0]){case 1:k=new v.FillRenderBucket(p,this.styleRepository);break;case 2:k=new v.LineRenderBucket(p,this.styleRepository);break;case 3:k=new v.SymbolRenderBucket(p,this.styleRepository,
this);break;case 4:k=new v.CircleRenderBucket(p,this.styleRepository)}q.set(p,k);return k};F._createClass(b,[{key:"hasSymbolBuckets",get:function(){return this._hasSymbolBuckets}},{key:"isFading",get:function(){return this._hasSymbolBuckets&&performance.now()-this.lastOpacityUpdate<h.FADE_DURATION}},{key:"isHoldingForFade",get:function(){return this._hasSymbolBuckets&&(!this.allSymbolsFadingOut||performance.now()-this.lastOpacityUpdate<h.FADE_DURATION)}},{key:"wasRequested",get:function(){return"errored"===
this.status||"loaded"===this.status||"reloading"===this.status}},{key:"referenced",get:function(){return this._referenced}},{key:"memoryUsage",get:function(){return(this._memoryUsedByLayerData+256)/(this._referenced||1)}}]);return b}(f.TiledDisplayObject);const g=new Map;B.VectorTile=f;B.printAllocations=function(){g.forEach((a,b)=>{console.log(`\n${b.key}:`);a[0].forEach(m=>console.log(m));console.log("\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d");a[1].forEach(m=>console.log(m))})};Object.defineProperty(B,
"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/RenderBucket":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/Texture ../../../webgl/VertexArrayObject ./decluttering/util".split(" "),function(B,F,w,l,r,v,h,f,g,a,b,m){r=function(){function p(k,c){this.layerUIDs=[];
this.isDestroyed=!1;this.data=k;this.memoryUsed=k.byteLength;let d=1;k=new Uint32Array(k);this.layerUIDs=[];const x=k[d++];for(let D=0;D<x;D++)this.layerUIDs[D]=k[d++];this.bufferDataOffset=d;c&&(this.layer=c.getStyleLayerByUID(this.layerUIDs[0]))}var q=p.prototype;q.destroy=function(){this.isDestroyed||(this.doDestroy(),this.isDestroyed=!0)};q.prepareForRendering=function(k){w.isNone(this.data)||(this.doPrepareForRendering(k,this.data,this.bufferDataOffset),this.data=null)};F._createClass(p,[{key:"isPreparedForRendering",
get:function(){return w.isNone(this.data)}},{key:"offset",get:function(){return this.bufferDataOffset}}]);return p}();v=function(p){function q(c,d){d=p.call(this,c,d)||this;d.type=2;d.lineIndexStart=0;d.lineIndexCount=0;c=new Uint32Array(c);let x=d.bufferDataOffset;d.lineIndexStart=c[x++];d.lineIndexCount=c[x++];const D=c[x++];if(0<D){const C=new Map;for(let A=0;A<D;A++){const u=c[x++],z=c[x++],J=c[x++];C.set(u,[z,J])}d.patternMap=C}d.bufferDataOffset=x;return d}F._inheritsLoose(q,p);var k=q.prototype;
k.hasData=function(){return 0<this.lineIndexCount};k.triangleCount=function(){return this.lineIndexCount/3};k.doDestroy=function(){w.isSome(this.lineVertexArrayObject)&&this.lineVertexArrayObject.dispose();w.isSome(this.lineVertexBuffer)&&this.lineVertexBuffer.dispose();w.isSome(this.lineIndexBuffer)&&this.lineIndexBuffer.dispose();this.lineIndexBuffer=this.lineVertexBuffer=this.lineVertexArrayObject=null;this.memoryUsed=0};k.doPrepareForRendering=function(c,d,x){d=new Uint32Array(d);var D=new Int32Array(d.buffer);
const C=d[x++];this.lineVertexBuffer=l.createVertex(c,35044,new Int32Array(D.buffer,4*x,C));x+=C;D=d[x++];this.lineIndexBuffer=l.createIndex(c,35044,new Uint32Array(d.buffer,4*x,D));x+=D;x=this.layer.lineMaterial;this.lineVertexArrayObject=new b(c,x.getAttributeLocations(),x.getLayoutInfo(),{geometry:this.lineVertexBuffer},this.lineIndexBuffer)};return q}(r);h=function(p){function q(c,d){d=p.call(this,c,d)||this;d.type=1;d.fillIndexStart=0;d.fillIndexCount=0;d.outlineIndexStart=0;d.outlineIndexCount=
0;c=new Uint32Array(c);let x=d.bufferDataOffset;d.fillIndexStart=c[x++];d.fillIndexCount=c[x++];d.outlineIndexStart=c[x++];d.outlineIndexCount=c[x++];const D=c[x++];if(0<D){const C=new Map;for(let A=0;A<D;A++){const u=c[x++],z=c[x++],J=c[x++];C.set(u,[z,J])}d.patternMap=C}d.bufferDataOffset=x;return d}F._inheritsLoose(q,p);var k=q.prototype;k.hasData=function(){return 0<this.fillIndexCount||0<this.outlineIndexCount};k.triangleCount=function(){return(this.fillIndexCount+this.outlineIndexCount)/3};
k.doDestroy=function(){w.isSome(this.fillVertexArrayObject)&&this.fillVertexArrayObject.dispose();w.isSome(this.fillVertexBuffer)&&this.fillVertexBuffer.dispose();w.isSome(this.fillIndexBuffer)&&this.fillIndexBuffer.dispose();this.fillIndexBuffer=this.fillVertexBuffer=this.fillVertexArrayObject=null;w.isSome(this.outlineVertexArrayObject)&&this.outlineVertexArrayObject.dispose();w.isSome(this.outlineVertexBuffer)&&this.outlineVertexBuffer.dispose();w.isSome(this.outlineIndexBuffer)&&this.outlineIndexBuffer.dispose();
this.outlineIndexBuffer=this.outlineVertexBuffer=this.outlineVertexArrayObject=null;this.memoryUsed=0};k.doPrepareForRendering=function(c,d,x){d=new Uint32Array(d);var D=new Int32Array(d.buffer),C=d[x++];this.fillVertexBuffer=l.createVertex(c,35044,new Int32Array(D.buffer,4*x,C));x+=C;C=d[x++];this.fillIndexBuffer=l.createIndex(c,35044,new Uint32Array(d.buffer,4*x,C));x+=C;C=d[x++];this.outlineVertexBuffer=l.createVertex(c,35044,new Int32Array(D.buffer,4*x,C));x+=C;D=d[x++];this.outlineIndexBuffer=
l.createIndex(c,35044,new Uint32Array(d.buffer,4*x,D));x+=D;d=this.layer;x=d.fillMaterial;d=d.outlineMaterial;this.fillVertexArrayObject=new b(c,x.getAttributeLocations(),x.getLayoutInfo(),{geometry:this.fillVertexBuffer},this.fillIndexBuffer);this.outlineVertexArrayObject=new b(c,d.getAttributeLocations(),d.getLayoutInfo(),{geometry:this.outlineVertexBuffer},this.outlineIndexBuffer)};return q}(r);f=function(p){function q(c,d,x){d=p.call(this,c,d)||this;d.type=3;d.iconPerPageElementsMap=new Map;d.glyphPerPageElementsMap=
new Map;d.symbolInstances=[];d.isIconSDF=!1;d.opacityChanged=!1;d.lastOpacityUpdate=0;d.symbols=[];const D=new Uint32Array(c),C=new Int32Array(c);c=new Float32Array(c);let A=d.bufferDataOffset;d.isIconSDF=!!D[A++];var u=D[A++];for(var z=0;z<u;z++){var J=D[A++],L=D[A++],M=D[A++];d.iconPerPageElementsMap.set(J,[L,M])}u=D[A++];for(z=0;z<u;z++)J=D[A++],L=D[A++],M=D[A++],d.glyphPerPageElementsMap.set(J,[L,M]);u=D[A++];z=D[A++];d.iconOpacity=new Int32Array(u);d.textOpacity=new Int32Array(z);A=m.deserializeSymbols(D,
C,c,A,d.symbols,x);d.bufferDataOffset=A;return d}F._inheritsLoose(q,p);var k=q.prototype;k.hasData=function(){return 0<this.iconPerPageElementsMap.size||0<this.glyphPerPageElementsMap.size};k.triangleCount=function(){let c=0;for(const [,d]of this.iconPerPageElementsMap)c+=d[1];for(const [,d]of this.glyphPerPageElementsMap)c+=d[1];return c/3};k.doDestroy=function(){w.isSome(this.iconVertexArrayObject)&&this.iconVertexArrayObject.dispose();w.isSome(this.iconVertexBuffer)&&this.iconVertexBuffer.dispose();
w.isSome(this.iconOpacityBuffer)&&this.iconOpacityBuffer.dispose();w.isSome(this.iconIndexBuffer)&&this.iconIndexBuffer.dispose();this.iconIndexBuffer=this.iconOpacityBuffer=this.iconVertexBuffer=this.iconVertexArrayObject=null;w.isSome(this.textVertexArrayObject)&&this.textVertexArrayObject.dispose();w.isSome(this.textVertexBuffer)&&this.textVertexBuffer.dispose();w.isSome(this.textOpacityBuffer)&&this.textOpacityBuffer.dispose();w.isSome(this.textIndexBuffer)&&this.textIndexBuffer.dispose();this.textIndexBuffer=
this.textOpacityBuffer=this.textVertexBuffer=this.textVertexArrayObject=null;this.memoryUsed=0};k.updateOpacityInfo=function(){if(this.opacityChanged){this.opacityChanged=!1;var c=w.unwrap(this.iconOpacity),d=w.unwrap(this.iconOpacityBuffer);0<c.length&&c.byteLength===d.size&&d.setSubData(c);c=w.unwrap(this.textOpacity);d=w.unwrap(this.textOpacityBuffer);0<c.length&&c.byteLength===d.size&&d.setSubData(c)}};k.doPrepareForRendering=function(c,d,x){d=new Uint32Array(d);var D=new Int32Array(d.buffer),
C=d[x++];this.iconVertexBuffer=l.createVertex(c,35044,new Int32Array(D.buffer,4*x,C));x+=C;C=d[x++];this.iconIndexBuffer=l.createIndex(c,35044,new Uint32Array(d.buffer,4*x,C));x+=C;C=d[x++];this.textVertexBuffer=l.createVertex(c,35044,new Int32Array(D.buffer,4*x,C));x+=C;D=d[x++];this.textIndexBuffer=l.createIndex(c,35044,new Uint32Array(d.buffer,4*x,D));x+=D;this.iconOpacityBuffer=l.createVertex(c,35044,w.unwrap(this.iconOpacity).buffer);this.textOpacityBuffer=l.createVertex(c,35044,w.unwrap(this.textOpacity).buffer);
d=this.layer;x=d.iconMaterial;d=d.textMaterial;this.iconVertexArrayObject=new b(c,x.getAttributeLocations(),x.getLayoutInfo(),{geometry:this.iconVertexBuffer,opacity:this.iconOpacityBuffer},this.iconIndexBuffer);this.textVertexArrayObject=new b(c,d.getAttributeLocations(),d.getLayoutInfo(),{geometry:this.textVertexBuffer,opacity:this.textOpacityBuffer},this.textIndexBuffer)};return q}(r);g=function(p){function q(c,d){d=p.call(this,c,d)||this;d.type=4;d.circleIndexStart=0;d.circleIndexCount=0;c=new Uint32Array(c);
let x=d.bufferDataOffset;d.circleIndexStart=c[x++];d.circleIndexCount=c[x++];d.bufferDataOffset=x;return d}F._inheritsLoose(q,p);var k=q.prototype;k.hasData=function(){return 0<this.circleIndexCount};k.triangleCount=function(){return this.circleIndexCount/3};k.doDestroy=function(){w.isSome(this.circleVertexArrayObject)&&this.circleVertexArrayObject.dispose();w.isSome(this.circleVertexBuffer)&&this.circleVertexBuffer.dispose();w.isSome(this.circleIndexBuffer)&&this.circleIndexBuffer.dispose();this.circleIndexBuffer=
this.circleVertexBuffer=this.circleVertexArrayObject=null;this.memoryUsed=0};k.doPrepareForRendering=function(c,d,x){d=new Uint32Array(d);var D=new Int32Array(d.buffer);const C=d[x++];this.circleVertexBuffer=l.createVertex(c,35044,new Int32Array(D.buffer,4*x,C));x+=C;D=d[x++];this.circleIndexBuffer=l.createIndex(c,35044,new Uint32Array(d.buffer,4*x,D));x+=D;x=this.layer.circleMaterial;this.circleVertexArrayObject=new b(c,x.getAttributeLocations(),x.getLayoutInfo(),{geometry:this.circleVertexBuffer},
this.circleIndexBuffer)};return q}(r);B.CircleRenderBucket=g;B.FillRenderBucket=h;B.LineRenderBucket=v;B.RenderBucketBase=r;B.SymbolRenderBucket=f;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/util":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","./core"],function(B,F,w,l){let r=function(g){this.tile=g;this.parent=null;this.children=new Set},v=function(){function g(){this.nodes=new Map;
this.roots=new Set}var a=g.prototype;a.create=function(b){const m=new r(b);let p;const q=[];this.nodes.forEach(k=>{this._canConnectDirectly(m,k)&&q.push(k);!p&&this._canConnectDirectly(k,m)&&(p=k)});if(p){for(const k of q)p.children.delete(k),m.children.add(k),k.parent=m;p.children.add(m);m.parent=p}else{this.roots.add(m);for(const k of q)m.children.add(k),k.parent=m,this.roots.delete(k)}this.nodes.set(b.key.id,m);return m};a.destroy=function(b){w.isSome(b.parent)?(b.parent.children.delete(b),b.children.forEach(m=>
{w.isSome(b.parent)&&b.parent.children.add(m)})):this.roots.delete(b);b.children.forEach(m=>{(m.parent=b.parent)||this.roots.add(m)});this.nodes.delete(b.tile.key.id)};a.clear=function(){this.roots.clear();this.nodes.clear()};a._canConnectDirectly=function(b,m){let {level:p,row:q,col:k}=m.tile.key;for({world:m}=m.tile.key;0<p;){p--;q>>=1;k>>=1;if(b.tile.key.level===p&&b.tile.key.row===q&&b.tile.key.col===k&&b.tile.key.world===m)return!0;if(this.nodes.has(`${p}/${q}/${k}/${m}`))break}return!1};return g}(),
h=function(){function g(){this._tileGraph=new v;this._tileArray=null}var a=g.prototype;a.has=function(b){return"string"===typeof b?this._tileGraph.nodes.has(b):this._tileGraph.nodes.has(b.key.id)};a.getAll=function(){this._tileArray||(this._tileArray=[],this._tileGraph.nodes.forEach(b=>{this._tileArray.push(b.tile)}));return this._tileArray};a.getRoots=function(){const b=[];this._tileGraph.roots.forEach(m=>{b.push(m.tile)});return b};a.getParent=function(b){b=this._tileGraph.nodes.get("string"===
typeof b?b:b.key.id);return w.isSome(b.parent)&&b.parent.tile};a.getChildren=function(b){const m=[];this._tileGraph.nodes.get("string"===typeof b?b:b.key.id).children.forEach(p=>{m.push(p.tile)});return m};a.get=function(b){return this._tileGraph.nodes.get(b).tile};a.removeKey=function(b){b=this._tileGraph.nodes.get(b);this._tileGraph.destroy(b);this._tileArray=null};a.forEach=function(b){this._tileGraph.nodes.forEach((m,p)=>b(m.tile,p))};a.add=function(b){this._tileGraph.create(b);this._tileArray=
null};a.remove=function(b){b=this._tileGraph.nodes.get(b.key.id);this._tileGraph.destroy(b);this._tileArray=null};a.clear=function(){this._tileGraph.clear();this._tileArray=[]};return g}(),f=function(){function g(b,m,p){this._rows=Math.ceil(m/p);this._columns=Math.ceil(b/p);this._cellSize=p;this.cells=Array(this._rows);for(b=0;b<this._rows;b++)for(this.cells[b]=Array(this._columns),m=0;m<this._columns;m++)this.cells[b][m]=[]}var a=g.prototype;a.getCell=function(b,m){m=Math.min(Math.max(Math.floor(m/
this._cellSize),0),this._rows-1);b=Math.min(Math.max(Math.floor(b/this._cellSize),0),this._columns-1);return this.cells[m]&&this.cells[m][b]||null};a.getCellSpan=function(b,m,p,q){return[Math.min(Math.max(Math.floor(b/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(m/this._cellSize),0),this.rows-1),Math.min(Math.max(Math.floor(p/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(q/this._cellSize),0),this.rows-1)]};F._createClass(g,[{key:"cellSize",get:function(){return this._cellSize}},
{key:"columns",get:function(){return this._columns}},{key:"rows",get:function(){return this._rows}}]);return g}();B.GridIndex=f;B.TileForest=h;B.TileGraph=v;B.TileNode=r;B.deserializeSymbols=function(g,a,b,m,p,q){const k=a[m++];for(let x=0;x<k;x++){const D=new l.VTLSymbol(q);D.xTile=a[m++];D.yTile=a[m++];D.hash=a[m++];D.priority=a[m++];var c=a[m++];for(var d=0;d<c;d++){const C=a[m++],A=a[m++],u=a[m++],z=a[m++],J=!!a[m++],L=a[m++],M=b[m++],O=b[m++],N=a[m++],Q=a[m++];D.colliders.push({xTile:C,yTile:A,
dxPixels:u,dyPixels:z,hard:J,partIndex:L,width:N,height:Q,minLod:M,maxLod:O})}c=g[m++];for(d=0;d<c;d++)D.textVertexRanges.push([g[m++],g[m++]]);c=g[m++];for(d=0;d<c;d++)D.iconVertexRanges.push([g[m++],g[m++]]);p.push(D)}return m};B.tileCoordChange=function(g,a,b,m,p,q){b-=p;if(0<=b)return(a>>b)+(m-(q<<b))*(g>>b);b=-b;return a-(q-(m<<b))*(g>>b)<<b};B.writeOpacityToBuffers=function(g,a,b){for(const [x,D]of g.symbols){{var m=g,p=a,q=b,k=D;const C=m.layerData.get(x);if(3===C.type){for(const A of k){k=
A.unique;var c=void 0;if(A.selectedForRendering){var d=k.parts[0];c=d.startOpacity;d=d.targetOpacity;m.allSymbolsFadingOut=m.allSymbolsFadingOut&&0===d;c=q?Math.floor(127*c)|d<<7:d?255:0;c|=c<<24|c<<16|c<<8}else c=0;for(const [u,z]of A.iconVertexRanges)for(d=u;d<u+z;d+=4)C.iconOpacity[d/4]=c;A.selectedForRendering?(c=k.parts[1],k=c.startOpacity,c=c.targetOpacity,m.allSymbolsFadingOut=m.allSymbolsFadingOut&&0===c,k=q?Math.floor(127*k)|c<<7:c?255:0,c=k<<24|k<<16|k<<8|k):c=0;for(const [u,z]of A.textVertexRanges)for(k=
u;k<u+z;k+=4)C.textOpacity[k/4]=c}C.lastOpacityUpdate=p;C.opacityChanged=!0}}}};Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/core":function(){define(["exports"],function(B){B.VTLSymbol=function(F){this.hash=this.yTile=this.xTile=0;this.priority=1;this.colliders=[];this.textVertexRanges=[];this.iconVertexRanges=[];this.tile=F};B.VTLUniqueSymbol=function(){this.tileSymbols=[];this.parts=[{startTime:0,startOpacity:0,targetOpacity:0,show:!1},{startTime:0,
startOpacity:0,targetOpacity:0,show:!1}];this.show=!1};Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/VectorTileContainer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/promiseUtils ../../../../geometry/support/aaBoundingRect ./decluttering/SymbolFader ../webgl/enums ../webgl/RenderableTile ../webgl/TileContainer ../../tiling/TileCoverage ../../tiling/TileKey".split(" "),function(B,F,w,l,r,v,h,
f,g,a,b){function m(p,q){if(p){const k=p.getLayoutProperty("visibility");if(!k||1!==k.getValue()&&(void 0===p.minzoom||p.minzoom<q+1E-6)&&(void 0===p.maxzoom||p.maxzoom>=q-1E-6))return!0}return!1}g=function(p){function q(c){c=p.call(this,c)||this;c._backgroundTiles=[];c._pointToCallbacks=new Map;return c}F._inheritsLoose(q,p);var k=q.prototype;k.destroy=function(){this.removeAllChildren();this._spriteMosaic&&(this._spriteMosaic.dispose(),this._spriteMosaic=null);this._glyphMosaic&&(this._glyphMosaic.dispose(),
this._glyphMosaic=null);w.isSome(this._symbolFader)&&(this._symbolFader.clear(),this._symbolFader=null);this._styleRepository=null;this._backgroundTiles=[];this._pointToCallbacks.clear()};k.setStyleResources=function(c,d,x){this._spriteMosaic=c;this._glyphMosaic=d;this._styleRepository=x;w.isNone(this._symbolFader)&&(c=new v.SymbolFader(this._styleRepository,this.children),c.on("fade-start",()=>{this.emit("fade-start");this.requestRender()}),c.on("fade-complete",()=>{this.emit("fade-complete");this.requestRender()}),
this._symbolFader=c);w.unwrap(this._symbolFader).styleRepository=x};k.deleteStyleLayers=function(c){w.isSome(this._symbolFader)&&this._symbolFader.deleteStyleLayers(c)};k.hitTest=function(){var c=F._asyncToGenerator(function*(d){const x=l.createResolver();this._pointToCallbacks.set(d,x);this.requestRender();return x.promise});return function(d){return c.apply(this,arguments)}}();k.enterTileInvalidation=function(){for(const c of this.children)c.invalidating=!0};k.createRenderParams=function(c){return{...p.prototype.createRenderParams.call(this,
c),renderPass:null,styleLayer:null,styleLayerUID:-1,glyphMosaic:this._glyphMosaic,spriteMosaic:this._spriteMosaic,hasClipping:!!this._clippingInfos}};k.doRender=function(c){!this.visible||c.drawPhase!==h.WGLDrawPhase.MAP&&c.drawPhase!==h.WGLDrawPhase.DEBUG||void 0===this._spriteMosaic||p.prototype.doRender.call(this,c)};k.addChild=function(c){p.prototype.addChild.call(this,c);w.isSome(this._symbolFader)?this._symbolFader.addTile(c):c.decluttered=!0;this.requestRender();return c};k.removeChild=function(c){w.isSome(this._symbolFader)&&
this._symbolFader.removeTile(c);this.requestRender();return p.prototype.removeChild.call(this,c)};k.renderChildren=function(c){const {drawPhase:d}=c;if(d===h.WGLDrawPhase.DEBUG)p.prototype.renderChildren.call(this,c);else if(this._doRender(c),0<this._pointToCallbacks.size){c.drawPhase=h.WGLDrawPhase.HITTEST;const x=c.painter.effects.hittest;x.bind(c);this._doRender(c);x.draw(c,this._pointToCallbacks);x.unbind(c);c.drawPhase=d}};k.removeAllChildren=function(){for(let c=0;c<this.children.length;c++){const d=
this.children[c];w.isSome(this._symbolFader)&&this._symbolFader.removeTile(d);d.dispose()}p.prototype.removeAllChildren.call(this)};k.getStencilTarget=function(){return this.children.filter(c=>c.neededForCoverage&&c.hasData())};k.restartDeclutter=function(){w.isSome(this._symbolFader)&&this._symbolFader.restartDeclutter()};k._doRender=function(c){const {context:d}=c;var x=this._styleRepository;if(x){var D=x.layers,C=!0;c.drawPhase===h.WGLDrawPhase.HITTEST&&(C=!1);0<x.backgroundBucketIds.length&&(c.renderPass=
"background",this._renderBackgroundLayers(c,x.backgroundBucketIds));p.prototype.renderChildren.call(this,c);c.drawPhase===h.WGLDrawPhase.MAP&&this._fade(c.displayLevel,c.state);if((x=this.children.filter(u=>u.visible&&u.hasData()))&&0!==x.length){for(var A of x)A.triangleCount=0;d.setStencilWriteMask(0);d.setColorMask(!0,!0,!0,!0);d.setStencilOp(7680,7680,7681);d.setStencilTestEnabled(!0);d.setBlendingEnabled(!1);d.setDepthTestEnabled(!0);d.setDepthWriteEnabled(!0);d.setDepthFunction(515);d.setClearDepth(1);
d.clear(d.gl.DEPTH_BUFFER_BIT);c.renderPass="opaque";for(A=D.length-1;0<=A;A--)this._renderStyleLayer(D[A],c,x);d.setDepthWriteEnabled(!1);d.setBlendingEnabled(C);d.setBlendFunctionSeparate(1,771,1,771);c.renderPass="translucent";for(C=0;C<D.length;C++)this._renderStyleLayer(D[C],c,x);d.setDepthTestEnabled(!1);c.renderPass="symbol";for(C=0;C<D.length;C++)this._renderStyleLayer(D[C],c,x)}d.bindVAO();d.setStencilTestEnabled(!0);d.setBlendingEnabled(!0)}};k._fade=function(c,d){w.isSome(this._symbolFader)&&
(this._symbolFader.update(c,d)||this.requestRender())};k._renderStyleLayer=function(c,d,x){const {painter:D,renderPass:C}=d;if(void 0!==c){var A=c.getLayoutProperty("visibility");if(!A||1!==A.getValue()){switch(c.type){case 0:return;case 1:if("opaque"!==C&&"translucent"!==d.renderPass)return;var u="vtlFill";break;case 2:if("translucent"!==C)return;u="vtlLine";break;case 4:if("symbol"!==C)return;u="vtlCircle";break;case 3:if("symbol"!==C)return;u="vtlSymbol"}x=3===c.type?x.filter(z=>z.decluttered):
x.filter(z=>z.neededForCoverage);if("vtlSymbol"!==u&&(A=d.displayLevel,0===x.length||void 0!==c.minzoom&&c.minzoom>=A+1E-6||void 0!==c.maxzoom&&c.maxzoom<A-1E-6))return;A=c.uid;d.styleLayerUID=A;d.styleLayer=c;for(const z of x)if(z.layerData.has(A)){D.renderObjects(d,x,u);break}}}};k._renderBackgroundLayers=function(c,d){const {context:x,displayLevel:D,painter:C,state:A}=c,u=this._styleRepository;var z=!1;for(var J of d)if(0===u.getLayerById(J).type&&m(u.getLayerById(J),D)){z=!0;break}if(z){z=this._tileInfoView.getTileCoverage(c.state,
0,"smallest");var {spans:L,lodInfo:M}=z,{level:O}=M,N=r.create();J=[];if(this._renderPasses){var Q=this._renderPasses[0];w.isSome(this._clippingInfos)&&(Q.brushes[0].prepareState(c,this._clippingInfos[0]),Q.brushes[0].drawMany(c,this._clippingInfos))}Q=this._backgroundTiles;var R=0;for(const {row:K,colFrom:I,colTo:S}of L)for(let V=I;V<=S;V++){if(R<Q.length){var G=Q[R];G.key.set(O,K,M.normalizeCol(V),M.getWorldForColumn(V));this._tileInfoView.getTileBounds(N,G.key,!1);G.x=N[0];G.y=N[3]}else{G=new b(O,
K,M.normalizeCol(V),M.getWorldForColumn(V));const aa=this._tileInfoView.getTileBounds(r.create(),G);G=new f.RenderableTile(G,aa[0],aa[3],512,512,4096,4096);Q.push(G)}G.setTransform(A,this._tileInfoView.getTileResolution(G.key));J.push(G);R++}x.setStencilWriteMask(0);x.setColorMask(!0,!0,!0,!0);x.setStencilOp(7680,7680,7681);x.setStencilFunction(514,0,255);O=!0;c.drawPhase===h.WGLDrawPhase.HITTEST&&(O=!1);x.setStencilTestEnabled(O);for(const K of d)d=u.getLayerById(K),0===d.type&&m(d,D)&&(c.styleLayerUID=
d.uid,c.styleLayer=d,C.renderObjects(c,J,"vtlBackground"));a.pool.release(z)}};return q}(g.default);B.VectorTileContainer=g;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/SymbolFader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Evented ../../../../../core/maybe ./config ./core ./jobs ./SymbolDeclutterer ./SymbolRepository ./util".split(" "),function(B,F,w,l,r,v,h,f,g,a){w=function(b){function m(q,
k){var c=b.call(this)||this;c.styleRepository=q;c._tileToHandle=new Map;c._viewState={scale:0,rotation:0,center:[0,0],size:[0,0]};c._declutterViewState={scale:0,rotation:0,center:[0,0],size:[0,0]};c._completed=!1;c._symbolRepository=new g.SymbolRepository(4096,k,()=>new v.VTLUniqueSymbol);c._symbolDeclutterer=new f.SymbolDeclutterer(k,c._symbolRepository,(d,x,D)=>new h.CollisionJob(d,x,D,c.styleRepository,c._zoom,c._viewState.rotation),(d,x)=>{d.allSymbolsFadingOut=!0;d.lastOpacityUpdate=x;a.writeOpacityToBuffers(d,
x,!0);d.decluttered=!0;d.requestRender()},(d,x)=>c.styleRepository.getStyleLayerByUID(d.styleLayerUID).z-c.styleRepository.getStyleLayerByUID(x.styleLayerUID).z,d=>{d=c.styleRepository.getStyleLayerByUID(d);return c._zoom+1E-6<d.minzoom||c._zoom-1E-6>=d.maxzoom?!1:(d=d.getLayoutProperty("visibility"))&&1===d.getValue()?!1:!0});return c}F._inheritsLoose(m,b);var p=m.prototype;p.addTile=function(q){q.decluttered=!1;this._tileToHandle.set(q,q.on("symbols-changed",()=>{this._symbolRepository.add(q);this.restartDeclutter()}));
this._symbolRepository.add(q);this.restartDeclutter()};p.removeTile=function(q){const k=this._tileToHandle.get(q);k&&(this._symbolRepository.removeTile(q),this.restartDeclutter(),k.remove(),this._tileToHandle.delete(q))};p.update=function(q,k){this._zoom=q;this._viewState={scale:k.scale,rotation:k.rotation,center:[k.center[0],k.center[1]],size:[k.size[0],k.size[1]]};this._continueDeclutter();return this._completed};p.restartDeclutter=function(){this._completed=!1;this._symbolDeclutterer.restart();
this._notifyUnstable()};p.clear=function(){this._completed=!1;this._symbolRepository=null;this._symbolDeclutterer.restart();this._tileToHandle.forEach(q=>q.remove());this._tileToHandle.clear()};p.deleteStyleLayers=function(q){this._symbolRepository.deleteStyleLayers(q)};p._continueDeclutter=function(){if(!this._completed||this.stale)this._symbolDeclutterer.running||(this._declutterZoom=this._zoom,this._declutterViewState.center[0]=this._viewState.center[0],this._declutterViewState.center[1]=this._viewState.center[1],
this._declutterViewState.rotation=this._viewState.rotation,this._declutterViewState.scale=this._viewState.scale,this._declutterViewState.size[0]=this._viewState.size[0],this._declutterViewState.size[1]=this._viewState.size[1],this._symbolDeclutterer.restart()),this._symbolDeclutterer.setScreenSize(this._viewState.size[0],this._viewState.size[1]),(this._completed=this._symbolDeclutterer.continue(r.DECLUTTER_BUDGET))&&this._scheduleNotifyStable()};p._scheduleNotifyStable=function(){l.isSome(this._stableNotificationHandle)&&
clearTimeout(this._stableNotificationHandle);this._stableNotificationHandle=setTimeout(()=>{this._stableNotificationHandle=null;this.emit("fade-complete")},1.5*r.FADE_DURATION)};p._notifyUnstable=function(){l.isSome(this._stableNotificationHandle)&&(clearTimeout(this._stableNotificationHandle),this._stableNotificationHandle=null);this.emit("fade-start")};F._createClass(m,[{key:"stale",get:function(){return this._zoom!==this._declutterZoom||this._viewState.size[0]!==this._declutterViewState.size[0]||
this._viewState.size[1]!==this._declutterViewState.size[1]||this._viewState.scale!==this._declutterViewState.scale||this._viewState.rotation!==this._declutterViewState.rotation}}]);return m}(w);B.SymbolFader=w;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/jobs":function(){define(["exports","../../../../../chunks/mat3f32","./config","./util"],function(B,F,w,l){let r=function(){function v(f,g,a,b,m,p){this._symbols=f;this._styleRepository=b;this._zoom=
m;this._currentSymbolCursor=this._currentLayerCursor=0;this._styleProps=new Map;this._allNeededMatrices=new Map;this._gridIndex=new l.GridIndex(g,a,w.COLLISION_GRID_CELL_SIZE);this._si=Math.sin(Math.PI*p/180);this._co=Math.cos(Math.PI*p/180);for(const q of f)for(const k of q.symbols)this._allNeededMatrices.has(k.tile)||this._allNeededMatrices.set(k.tile,F.clone(k.tile.transforms.tileUnitsToPixels))}var h=v.prototype;h.work=function(f){const g=this._gridIndex,a=performance.now();for(;this._currentLayerCursor<
this._symbols.length;this._currentLayerCursor++,this._currentSymbolCursor=0){const A=this._symbols[this._currentLayerCursor],u=this._getProperties(A.styleLayerUID);for(;this._currentSymbolCursor<A.symbols.length;this._currentSymbolCursor++){if(99===this._currentSymbolCursor%100&&performance.now()-a>f)return!1;var b=A.symbols[this._currentSymbolCursor];if(!b.unique.show)continue;{var m=b,p=this._si,q=this._co,k=this._allNeededMatrices.get(b.tile),c=this._zoom;const {iconRotationAlignment:O,textRotationAlignment:N,
iconTranslate:Q,iconTranslateAnchor:R,textTranslate:G,textTranslateAnchor:K}=u;var d=0;for(const I of m.colliders){const [S,V]=0===I.partIndex?Q:G;var x=0===I.partIndex?R:K,D=I.minLod<=c&&c<=I.maxLod;d+=D?0:1;I.enabled=D;I.xScreen=I.xTile*k[0]+I.yTile*k[3]+k[6];I.yScreen=I.xTile*k[1]+I.yTile*k[4]+k[7];0===x?(I.xScreen+=q*S-p*V,I.yScreen+=p*S+q*V):(I.xScreen+=S,I.yScreen+=V);1===(0===I.partIndex?O:N)?(I.dxScreen=I.dxPixels,I.dyScreen=I.dyPixels):(I.dxScreen=q*(I.dxPixels+I.width/2)-p*(I.dyPixels+I.height/
2)-I.width/2,I.dyScreen=p*(I.dxPixels+I.width/2)+q*(I.dyPixels+I.height/2)-I.height/2)}0<m.colliders.length&&d===m.colliders.length&&(m.unique.show=!1)}m=b.unique;if(!m.show)continue;const {iconAllowOverlap:z,iconIgnorePlacement:J,textAllowOverlap:L,textIgnorePlacement:M}=u;for(const O of b.colliders)if(O.enabled&&(p=m.parts[O.partIndex],p.show)){if(q=!(O.partIndex?L:z))a:{q=O.xScreen+O.dxScreen;k=O.yScreen+O.dyScreen;c=q+O.width;d=k+O.height;const [N,Q,R,G]=g.getCellSpan(q,k,c,d);for(x=Q;x<=G;x++)for(D=
N;D<=R;D++){var C=g.cells[x][D];for(const K of C){C=K.xScreen+K.dxScreen;const I=K.yScreen+K.dyScreen,S=C+K.width,V=I+K.height;if(!(c<C||q>S||d<I||k>V)){q=!0;break a}}}q=!1}q&&(O.hard?m.show=!1:p.show=!1)}if(m.show)for(const O of b.colliders){if(!O.enabled)continue;if(O.partIndex?M:J)continue;if(!m.parts[O.partIndex].show)continue;b=O.xScreen+O.dxScreen;p=O.yScreen+O.dyScreen;const [N,Q,R,G]=this._gridIndex.getCellSpan(b,p,b+O.width,p+O.height);for(b=Q;b<=G;b++)for(p=N;p<=R;p++)this._gridIndex.cells[b][p].push(O)}}}return!0};
h._getProperties=function(f){var g=this._styleProps.get(f);if(g)return g;g=this._zoom;const a=this._styleRepository.getStyleLayerByUID(f);var b=0!==a.getLayoutValue("symbol-placement",g);let m=a.getLayoutValue("icon-rotation-alignment",g);2===m&&(m=b?0:1);let p=a.getLayoutValue("text-rotation-alignment",g);2===p&&(p=b?0:1);b=a.getPaintValue("icon-translate",g);const q=a.getPaintValue("icon-translate-anchor",g),k=a.getPaintValue("text-translate",g),c=a.getPaintValue("text-translate-anchor",g);g={iconAllowOverlap:a.getLayoutValue("icon-allow-overlap",
g),iconIgnorePlacement:a.getLayoutValue("icon-ignore-placement",g),textAllowOverlap:a.getLayoutValue("text-allow-overlap",g),textIgnorePlacement:a.getLayoutValue("text-ignore-placement",g),iconRotationAlignment:m,textRotationAlignment:p,iconTranslateAnchor:q,iconTranslate:b,textTranslateAnchor:c,textTranslate:k};this._styleProps.set(f,g);return g};return v}();B.CollisionJob=r;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/SymbolDeclutterer":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","./config"],function(B,F,w,l){function r(h,f){if(h.priority-f.priority)return h.priority-f.priority;const g=h.tile.key,a=f.tile.key;return g.world-a.world?g.world-a.world:g.level-a.level?g.level-a.level:g.row-a.row?g.row-a.row:g.col-a.col?g.col-a.col:h.xTile-f.xTile?h.xTile-f.xTile:h.yTile-f.yTile}let v=function(){function h(g,a,b,m,p,q){this._visibleTiles=g;this._symbolRepository=a;this._createCollisionJob=b;this._assignTileSymbolsOpacity=
m;this._symbolLayerSorter=p;this._isLayerVisible=q;this._selectionJob=null;this._selectionJobCompleted=!1;this._collisionJob=null;this._collisionJobCompleted=!1;this._opacityJob=null;this._opacityJobCompleted=!1;this._running=!0}var f=h.prototype;f.setScreenSize=function(g,a){this._screenWidth===g&&this._screenHeight===a||this.restart();this._screenWidth=g;this._screenHeight=a};f.restart=function(){this._selectionJob=null;this._selectionJobCompleted=!1;this._collisionJob=null;this._collisionJobCompleted=
!1;this._opacityJob=null;this._opacityJobCompleted=!1;this._running=!0};f.continue=function(g){this._selectionJob||(this._selectionJob=this._createSelectionJob());if(!this._selectionJobCompleted){var a=performance.now();if(!this._selectionJob.work(g))return!1;this._selectionJobCompleted=!0;g=Math.max(0,g-(performance.now()-a));if(0===g)return!1}this._collisionJob||(this._collisionJob=this._createCollisionJob(this._selectionJob.sortedSymbols,this._screenWidth,this._screenHeight));if(!this._collisionJobCompleted){a=
performance.now();if(!this._collisionJob.work(g))return!1;this._collisionJobCompleted=!0;g=Math.max(0,g-(performance.now()-a));if(0===g)return!1}this._opacityJob||(this._opacityJob=this._createOpacityJob());if(!this._opacityJobCompleted){a=performance.now();if(!this._opacityJob.work(g))return!1;this._opacityJobCompleted=!0;g=Math.max(0,g-(performance.now()-a));if(0===g)return!1}this._running=!1;return!0};f._createSelectionJob=function(){const g=this._symbolRepository.uniqueSymbols;for(let k=0;k<g.length;k++){const c=
g[k];for(let d=0;d<c.uniqueSymbols.length;d++){const x=c.uniqueSymbols[d];for(const D of x.tileSymbols)D.selectedForRendering=!1}}const a=[];let b=0,m=0;const p=this._isLayerVisible,q=this._symbolLayerSorter;return{work:function(k){const c=performance.now();for(;m<g.length;m++,b=0){const x=g[m];var d=x.styleLayerUID;if(!p(d)){a[m]||(a[m]={styleLayerUID:d,symbols:[]});continue}a[m]=a[m]||{styleLayerUID:d,symbols:[]};const D=a[m];for(;b<x.uniqueSymbols.length;b++){d=x.uniqueSymbols[b];if(99===b%100&&
performance.now()-c>k)return!1;let C=null,A=!1,u=!1;for(const z of d.tileSymbols)if(!u||!A){const J=z.tile;if(!C||J.isCoverage||J.neededForCoverage&&!A){C=z;if(J.neededForCoverage||J.isCoverage)u=!0;J.isCoverage&&(A=!0)}}C.selectedForRendering=!0;if(u){D.symbols.push(C);d.show=!0;for(const z of d.parts)z.show=!0}else d.show=!1}}for(const x of a)x.symbols.sort(r);return!0},get sortedSymbols(){return a.sort(q)}}};f._createOpacityJob=function(){function g(p,q){var k=p.symbols;for(const [,d]of k){var c=
d;k=q;for(const x of c){c=x.unique;for(const D of c.parts)D.startOpacity+=(k-D.startTime)/l.FADE_DURATION*(.5<D.targetOpacity?1:-1),D.startOpacity=Math.min(Math.max(D.startOpacity,0),1),D.startTime=k,D.targetOpacity=c.show&&D.show?1:0}}a(p,q);for(const d of p.childrenTiles)g(d,q)}const a=this._assignTileSymbolsOpacity,b=this._visibleTiles;let m=0;return{work(p){const q=performance.now();for(;m<b.length;m++){if(performance.now()-q>p)return!1;const k=b[m];if(w.isSome(k.parentTile))continue;const c=
performance.now();g(k,c)}return!0}}};F._createClass(h,[{key:"running",get:function(){return this._running}}]);return h}();B.SymbolDeclutterer=v;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/SymbolRepository":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","./util"],function(B,F,w,l){let r=function(){function v(f,g,a){this.tileCoordRange=f;this._visibleTiles=g;this._createUnique=a;this._tiles=
new Map;this._uniqueSymbolsReferences=new Map}var h=v.prototype;h.add=function(f,g){this._uniqueSymbolLayerArray=null;let a=this._tiles.get(f.id);a||(a={symbols:new Map},this._tiles.set(f.id,a));var b=new Map;if(g)for(var m of g)a.symbols.has(m)&&(b.set(m,a.symbols.get(m)),a.symbols.delete(m));else for(var [p]of f.layerData)a.symbols.has(p)&&(b.set(p,a.symbols.get(p)),a.symbols.delete(p));this._removeSymbols(b);g=f.symbols;b=new Map;for(const [q,k]of g)if(m=k.length,32<=m){p=this.tileCoordRange;do p/=
2,m/=4;while(8<m&&64<p);m=new l.GridIndex(this.tileCoordRange,this.tileCoordRange,p);b.set(q,{flat:k,index:m});a.symbols.set(q,{flat:k,index:m});for(const c of k)m.getCell(c.xTile,c.yTile).push(c)}else b.set(q,{flat:k}),a.symbols.set(q,{flat:k});this._addSymbols(f.key,g)};h.deleteStyleLayers=function(f){this._uniqueSymbolLayerArray=null;for(const [g,a]of this._tiles){const b=new Map;for(const m of f)a.symbols.has(m)&&(b.set(m,a.symbols.get(m)),a.symbols.delete(m));this._removeSymbols(b);0===a.symbols.size&&
this._tiles.delete(g)}};h.removeTile=function(f){this._uniqueSymbolLayerArray=null;const g=this._tiles.get(f.id);if(g){var a=new Map;for(const [b]of f.symbols)g.symbols.has(b)&&(a.set(b,g.symbols.get(b)),g.symbols.delete(b));this._removeSymbols(a);0===g.symbols.size&&this._tiles.delete(f.id)}};h._removeSymbols=function(f){for(const [a,{flat:b}]of f)for(const m of b){f=m.unique;var g=f.tileSymbols;const p=g.length-1;for(let q=0;q<p;q++)if(g[q]===m){g[q]=g[p];break}g.length=p;0===p&&(g=this._uniqueSymbolsReferences.get(a),
g.delete(f),0===g.size&&this._uniqueSymbolsReferences.delete(a));m.unique=null}};h._addSymbols=function(f,g){if(0!==g.size){var a=this._visibleTiles;for(const b of a)b.parentTile||b.key.world!==f.world||b.key.level===f.level&&!b.key.equals(f)||this._matchSymbols(b,f,g);for(const [b,m]of g)for(const p of m)w.isNone(p.unique)&&(f=this._createUnique(),p.unique=f,f.tileSymbols.push(p),g=this._uniqueSymbolsReferences.get(b),g||(g=new Set,this._uniqueSymbolsReferences.set(b,g)),g.add(f))}};h._matchSymbols=
function(f,g,a){if(f.key.level>g.level){var b=f.key.level-g.level;if(f.key.row>>b!==g.row||f.key.col>>b!==g.col)return}if(g.level>f.key.level&&(b=g.level-f.key.level,g.row>>b!==f.key.row||g.col>>b!==f.key.col))return;if(g.equals(f.key))for(var m of f.childrenTiles)this._matchSymbols(m,g,a);else{m=new Map;for(const [k,c]of a){var p=[];for(const x of c)a=l.tileCoordChange(this.tileCoordRange,x.xTile,g.level,g.col,f.key.level,f.key.col),b=l.tileCoordChange(this.tileCoordRange,x.yTile,g.level,g.row,f.key.level,
f.key.row),0<=a&&a<this.tileCoordRange&&0<=b&&b<this.tileCoordRange&&p.push({symbol:x,xTransformed:a,yTransformed:b});a=[];b=f.key.level<g.level?1:1<<f.key.level-g.level;const d=this._tiles.get(f.id).symbols.get(k);if(d){const x=d.flat;for(const D of p){var q=!1;let C;const A=D.xTransformed,u=D.yTransformed;C=w.isSome(d.index)?d.index.getCell(A,u):x;p=D.symbol;const z=p.hash;for(const J of C)if(z===J.hash&&Math.abs(A-J.xTile)<=b&&Math.abs(u-J.yTile)<=b){q=J.unique;p.unique=q;q.tileSymbols.push(p);
q=!0;break}q||a.push(p)}}0<a.length&&m.set(k,a)}for(const k of f.childrenTiles)this._matchSymbols(k,g,m)}};h._createUniqueSymbolLayerArray=function(){var f=this._uniqueSymbolsReferences;const g=Array(f.size);let a=0;for(const [b,m]of f){const p=Array(m.size);f=0;for(const q of m)p[f++]=q;g[a]={styleLayerUID:b,uniqueSymbols:p};a++}return g};F._createClass(v,[{key:"uniqueSymbols",get:function(){w.isNone(this._uniqueSymbolLayerArray)&&(this._uniqueSymbolLayerArray=this._createUniqueSymbolLayerArray());
return this._uniqueSymbolLayerArray}}]);return v}();B.SymbolRepository=r;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/RenderableTile":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3f32","./TiledDisplayObject"],function(B,F,w,l){l=function(r){function v(){return r.apply(this,arguments)||this}F._inheritsLoose(v,r);v.prototype._createTransforms=function(){return{dvs:w.create(),tileMat3:w.create()}};return v}(l.TiledDisplayObject);
B.RenderableTile=l;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleRepository":function(){define(["./StyleLayer"],function(B){return function(){function F(l){this._style=l;this.backgroundBucketIds=[];this._uidToLayer=new Map;this._layerByName={};this._runningId=0;l.layers||(l.layers=[]);this.version=parseFloat(l.version);if(this.layers=l.layers.map((r,v,h)=>this._create(r,v,h)))for(let r=0;r<this.layers.length;r++)l=this.layers[r],this._layerByName[l.id]=
l,this._uidToLayer.set(l.uid,l),0===l.type&&this.backgroundBucketIds.push(l.id);this._identifyRefLayers()}var w=F.prototype;w.isPainterDataDriven=function(l){return(l=this._layerByName[l])?l.isPainterDataDriven():!1};w.getStyleLayerId=function(l){return l>=this.layers.length?null:this.layers[l].id};w.getStyleLayerByUID=function(l){l=this._uidToLayer.get(l);return null!=l?l:null};w.getStyleLayerIndex=function(l){return(l=this._layerByName[l])?this.layers.indexOf(l):-1};w.setStyleLayer=function(l,r){if(l&&
l.id){var v=this._style;null!=r&&r>=this.layers.length&&(r=this.layers.length-1);var h=!0,f;if(f=this._layerByName[l.id]){const g=this.layers.indexOf(f);r||(r=g);r===g?(h=!1,f=F._recreateLayer(l,f),this.layers[r]=f,v.layers[r]=l):(this.layers.splice(g,1),v.layers.splice(g,1),f=this._create(l,r,this.layers),this.layers.splice(r,0,f),v.layers.splice(r,0,l))}else f=this._create(l,r,this.layers),!r||r>=this.layers.length?(this.layers.push(f),v.layers.push(l)):(this.layers.splice(r,0,f),v.layers.splice(r,
0,l));this._layerByName[l.id]=f;this._uidToLayer.set(f.uid,f);h&&this._recomputeZValues();this._identifyRefLayers()}};w.getStyleLayer=function(l){return(l=this._layerByName[l])?{type:l.typeName,id:l.id,source:l.source,"source-layer":l.sourceLayer,minzoom:l.minzoom,maxzoom:l.maxzoom,filter:l.filter,layout:l.layout,paint:l.paint}:null};w.deleteStyleLayer=function(l){const r=this._layerByName[l];r&&(delete this._layerByName[l],this._uidToLayer.delete(r.uid),l=this.layers.indexOf(r),this.layers.splice(l,
1),this._style.layers.splice(l,1),this._recomputeZValues(),this._identifyRefLayers())};w.getLayerById=function(l){return this._layerByName[l]};w.getLayoutProperties=function(l){return(l=this._layerByName[l])?l.layout:null};w.getPaintProperties=function(l){return(l=this._layerByName[l])?l.paint:null};w.setPaintProperties=function(l,r){if(l=this._layerByName[l]){var v=F._recreateLayer({type:l.typeName,id:l.id,source:l.source,"source-layer":l.sourceLayer,minzoom:l.minzoom,maxzoom:l.maxzoom,filter:l.filter,
layout:l.layout,paint:r},l),h=this.layers.indexOf(l);this.layers[h]=v;this._style.layers[h].paint=r;this._layerByName[l.id]=v;this._uidToLayer.set(l.uid,v)}};w.setLayoutProperties=function(l,r){if(l=this._layerByName[l]){var v=F._recreateLayer({type:l.typeName,id:l.id,source:l.source,"source-layer":l.sourceLayer,minzoom:l.minzoom,maxzoom:l.maxzoom,filter:l.filter,layout:r,paint:l.paint},l),h=this.layers.indexOf(l);this.layers[h]=v;this._style.layers[h].layout=r;this._layerByName[l.id]=v;this._uidToLayer.set(l.uid,
v)}};w.setStyleLayerVisibility=function(l,r){if(l=this._layerByName[l]){var v=l.layout||{};v.visibility=r;r=F._recreateLayer({type:l.typeName,id:l.id,source:l.source,"source-layer":l.sourceLayer,minzoom:l.minzoom,maxzoom:l.maxzoom,filter:l.filter,layout:v,paint:l.paint},l);var h=this.layers.indexOf(l);this.layers[h]=r;this._style.layers[h].layout=v;this._layerByName[l.id]=r;this._uidToLayer.set(l.uid,r)}};w.getStyleLayerVisibility=function(l){var r;l=this._layerByName[l];if(!l)return"none";l=l.layout;
return null!=(r=null==l?void 0:l.visibility)?r:"visible"};w._recomputeZValues=function(){const l=this.layers,r=1/(l.length+1);for(let v=0;v<l.length;v++)l[v].z=1-(1+v)*r};w._identifyRefLayers=function(){const l=[],r=[];let v=0;for(const b of this.layers){const m=b.layout;if(1===b.type){var h,f=b,g=b.source+"|"+b.sourceLayer;g+=null!=(h="|"+(null==m?void 0:m.visibility))?h:"";g+="|"+b.minzoom;g+="|"+b.maxzoom;g+="|"+JSON.stringify(b.filter);if(f.hasDataDrivenFill||f.hasDataDrivenOutline)g+="|"+v;l.push({key:g,
layer:b})}else if(2===b.type){var a;f=b;g=b.source+"|"+b.sourceLayer;g+=null!=(a="|"+(null==m?void 0:m.visibility))?a:"";g+="|"+b.minzoom;g+="|"+b.maxzoom;g+="|"+JSON.stringify(b.filter);g+="|"+(void 0!==m?m["line-cap"]:"");g+="|"+(void 0!==m?m["line-join"]:"");f.hasDataDrivenLine&&(g+="|"+v);r.push({key:g,layer:b})}++v}this._assignRefLayers(l);this._assignRefLayers(r)};w._assignRefLayers=function(l){l.sort((a,b)=>a.key<b.key?-1:a.key>b.key?1:0);let r,v;const h=l.length;for(let a=0;a<h;a++){const b=
l[a];if(b.key===r)b.layer.refLayerId=v;else if(r=b.key,v=b.layer.id,1===b.layer.type){if(!b.layer.getPaintProperty("fill-outline-color"))for(var f=a+1;f<h;f++){var g=l[f];if(g.key===r){if(g.layer.getPaintProperty("fill-outline-color")){l[a]=g;l[f]=b;v=g.layer.id;break}}else break}}else if(2===b.layer.type)for(f=b.layer,g=a+1;g<h;g++){const m=l[g];if(m.key!==r)break;const p=m.layer;if(f.canUseThinTessellation&&!p.canUseThinTessellation||!f.canUseThinTessellation&&(p.getPaintProperty("line-pattern")||
p.getPaintProperty("line-dasharray")))f=p,l[a]=m,l[g]=b,v=m.layer.id}}};w._create=function(l,r,v){r=1-1/(v.length+1)*(1+r);v=this._runningId++;switch(l.type){case "background":return new B.BackgroundStyleLayer(0,l,r,v);case "fill":return new B.FillStyleLayer(1,l,r,v);case "line":return new B.LineStyleLayer(2,l,r,v);case "symbol":return new B.SymbolStyleLayer(3,l,r,v);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new B.CircleStyleLayer(4,l,r,v)}throw Error("Unknown vector tile layer");
};F._recreateLayer=function(l,r){switch(l.type){case "background":return new B.BackgroundStyleLayer(0,l,r.z,r.uid);case "fill":return new B.FillStyleLayer(1,l,r.z,r.uid);case "line":return new B.LineStyleLayer(2,l,r.z,r.uid);case "symbol":return new B.SymbolStyleLayer(3,l,r.z,r.uid);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new B.CircleStyleLayer(4,l,r.z,r.uid)}};return F}()})},"esri/views/2d/engine/vectorTiles/style/StyleLayer":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../shaders/VTLBackgroundMaterial ../shaders/VTLCircleMaterial ../shaders/VTLFillMaterial ../shaders/VTLLineMaterial ../shaders/VTLSymbolMaterial ./Filter ./StyleDefinition ./StyleProperty ../../webgl/definitions".split(" "),
function(B,F,w,l,r,v,h,f,g,a,b){let m=function(){function C(u,z,J,L){this.type=u;this.typeName=z.type;this.id=z.id;this.source=z.source;this.sourceLayer=z["source-layer"];this.minzoom=z.minzoom;this.maxzoom=z.maxzoom;this.filter=z.filter;this.layout=z.layout;this.paint=z.paint;this.z=J;this.uid=L;switch(u){case 0:this._layoutDefinition=g.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=g.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=g.StyleDefinition.fillLayoutDefinition;
this._paintDefinition=g.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=g.StyleDefinition.lineLayoutDefinition;this._paintDefinition=g.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=g.StyleDefinition.symbolLayoutDefinition;this._paintDefinition=g.StyleDefinition.symbolPaintDefinition;break;case 4:this._layoutDefinition=g.StyleDefinition.circleLayoutDefinition,this._paintDefinition=g.StyleDefinition.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout);
this._paintProperties=this._parsePaint(this.paint)}var A=C.prototype;A.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=f.createFilter(this.filter)};A.getLayoutProperty=function(u){return this._layoutProperties[u]};A.getPaintProperty=function(u){return this._paintProperties[u]};A.getLayoutValue=function(u,z,J){let L;const M=this._layoutProperties[u];M&&(L=M.getValue(z,J));void 0===L&&(L=this._layoutDefinition[u]["default"]);return L};A.getPaintValue=
function(u,z,J){let L;const M=this._paintProperties[u];M&&(L=M.getValue(z,J));void 0===L&&(L=this._paintDefinition[u]["default"]);return L};A.isPainterDataDriven=function(){const u=this._paintProperties;if(u)for(const z in u)if(u[z].isDataDriven)return!0;return!1};A._parseLayout=function(u){const z={};for(const J in u){const L=this._layoutDefinition[J];L&&(z[J]=new a(L,u[J]))}return z};A._parsePaint=function(u){const z={};for(const J in u){const L=this._paintDefinition[J];L&&(z[J]=new a(L,u[J]))}return z};
A.computeAttributesKey=function(u,z,J,L){let M=0,O=0;for(const N of z){z=3;if(!N||N!==L){const {isLayout:Q,isOptional:R}=J[N];z=Q?this.getLayoutProperty(N):this.getPaintProperty(N);z=null!=z&&z.interpolator?2:null!=z&&z.isDataDriven?1:R&&!z?3:0}O|=z<<M;M+=2}return O<<3|u};return C}(),p=function(C){function A(u,z,J,L){u=C.call(this,u,z,J,L)||this;u.backgroundMaterial=new w.VTLBackgroundMaterial(u.computeAttributesKey(0,w.VTLBackgroundMaterial.ATTRIBUTES,w.VTLBackgroundMaterial.ATTRIBUTES_INFO));return u}
F._inheritsLoose(A,C);return A}(m),q=function(C){function A(u,z,J,L){u=C.call(this,u,z,J,L)||this;z=u.getPaintProperty("fill-color");J=u.getPaintProperty("fill-opacity");L=u.getPaintProperty("fill-pattern");u.hasDataDrivenColor=null==z?void 0:z.isDataDriven;u.hasDataDrivenOpacity=null==J?void 0:J.isDataDriven;u.hasDataDrivenFill=u.hasDataDrivenColor||u.hasDataDrivenOpacity||(null==L?void 0:L.isDataDriven);J=u.getPaintProperty("fill-outline-color");u.outlineUsesFillColor=!J;u.hasDataDrivenOutlineColor=
null==J?void 0:J.isDataDriven;u.hasDataDrivenOutline=J?J.isDataDriven:z?z.isDataDriven:!1;u.hasDataDrivenOutline=(J?u.hasDataDrivenOutlineColor:u.hasDataDrivenColor)||u.hasDataDrivenOpacity;u.fillMaterial=new r.VTLFillMaterial(u.computeAttributesKey(1,r.VTLFillMaterial.ATTRIBUTES,r.VTLFillMaterial.ATTRIBUTES_INFO));u.outlineMaterial=new r.VTLOutlineMaterial(u.computeAttributesKey(2,u.outlineUsesFillColor?r.VTLOutlineMaterial.ATTRIBUTES_FILL:r.VTLOutlineMaterial.ATTRIBUTES_OUTLINE,u.outlineUsesFillColor?
r.VTLOutlineMaterial.ATTRIBUTES_INFO_FILL:r.VTLOutlineMaterial.ATTRIBUTES_INFO_OUTLINE),u.outlineUsesFillColor);return u}F._inheritsLoose(A,C);return A}(m),k=function(C){function A(u,z,J,L){var M,O,N,Q,R,G,K,I,S;u=C.call(this,u,z,J,L)||this;z=u.getPaintProperty("line-pattern");u.lineMaterial=new v.VTLLineMaterial(u.computeAttributesKey(3,v.VTLLineMaterial.ATTRIBUTES,v.VTLLineMaterial.ATTRIBUTES_INFO,z?"line-dasharray":""));u.hasDataDrivenLine=(null==(M=u.getPaintProperty("line-blur"))?void 0:M.isDataDriven)||
(null==(O=u.getPaintProperty("line-color"))?void 0:O.isDataDriven)||(null==(N=u.getPaintProperty("line-gap-width"))?void 0:N.isDataDriven)||(null==(Q=u.getPaintProperty("line-offset"))?void 0:Q.isDataDriven)||(null==(R=u.getPaintProperty("line-opacity"))?void 0:R.isDataDriven)||(null==(G=u.getPaintProperty("line-pattern"))?void 0:G.isDataDriven)||(null==(K=u.getPaintProperty("line-dasharray"))?void 0:K.isDataDriven)||(null==(I=u.getLayoutProperty("line-cap"))?void 0:I.isDataDriven)||(null==(S=u.getPaintProperty("line-width"))?
void 0:S.isDataDriven);u.canUseThinTessellation=!1;!u.hasDataDrivenLine&&(M=u.getPaintProperty("line-width"),!M||"number"===typeof M&&.5*M<b.THIN_LINE_HALF_WIDTH_THRESHOLD)&&(M=u.getPaintProperty("line-offset"),!M||"number"===typeof M&&0===M)&&(u.canUseThinTessellation=!0);return u}F._inheritsLoose(A,C);A.prototype.getDashKey=function(u,z){switch(z){case 0:z="Butt";break;case 1:z="Round";break;case 2:z="Square";break;default:z="Butt"}return`dasharray-[${u.toString()}]-${z}`};return A}(m),c=function(C){function A(u,
z,J,L){var M,O,N,Q,R,G,K,I,S,V,aa,ca;u=C.call(this,u,z,J,L)||this;u.iconMaterial=new h.VTLIconMaterial(u.computeAttributesKey(4,h.VTLIconMaterial.ATTRIBUTES,h.VTLIconMaterial.ATTRIBUTES_INFO));u.textMaterial=new h.VTLTextMaterial(u.computeAttributesKey(6,h.VTLTextMaterial.ATTRIBUTES,h.VTLTextMaterial.ATTRIBUTES_INFO));u.hasDataDrivenIcon=(null==(M=u.getPaintProperty("icon-color"))?void 0:M.isDataDriven)||(null==(O=u.getPaintProperty("icon-halo-blur"))?void 0:O.isDataDriven)||(null==(N=u.getPaintProperty("icon-halo-color"))?
void 0:N.isDataDriven)||(null==(Q=u.getPaintProperty("icon-halo-width"))?void 0:Q.isDataDriven)||(null==(R=u.getPaintProperty("icon-opacity"))?void 0:R.isDataDriven)||(null==(G=u.getLayoutProperty("icon-size"))?void 0:G.isDataDriven);u.hasDataDrivenText=(null==(K=u.getPaintProperty("text-color"))?void 0:K.isDataDriven)||(null==(I=u.getPaintProperty("text-halo-blur"))?void 0:I.isDataDriven)||(null==(S=u.getPaintProperty("text-halo-color"))?void 0:S.isDataDriven)||(null==(V=u.getPaintProperty("text-halo-width"))?
void 0:V.isDataDriven)||(null==(aa=u.getPaintProperty("text-opacity"))?void 0:aa.isDataDriven)||(null==(ca=u.getLayoutProperty("text-size"))?void 0:ca.isDataDriven);return u}F._inheritsLoose(A,C);return A}(m),d=function(C){function A(u,z,J,L){u=C.call(this,u,z,J,L)||this;u.circleMaterial=new l.VTLCircleMaterial(u.computeAttributesKey(5,l.VTLCircleMaterial.ATTRIBUTES,l.VTLCircleMaterial.ATTRIBUTES_INFO));return u}F._inheritsLoose(A,C);return A}(m),x=function(){function C(A,u,z){var J,L,M,O,N;this.allowOverlap=
A.getLayoutValue("icon-allow-overlap",u);this.ignorePlacement=A.getLayoutValue("icon-ignore-placement",u);this.keepUpright=A.getLayoutValue("icon-keep-upright",u);this.optional=A.getLayoutValue("icon-optional",u);this.rotationAlignment=A.getLayoutValue("icon-rotation-alignment",u);2===this.rotationAlignment&&(this.rotationAlignment=z?0:1);z=A.getLayoutProperty("icon-anchor");null!=(J=z)&&J.isDataDriven?this._anchorProp=z:this.anchor=A.getLayoutValue("icon-anchor",u);z=A.getLayoutProperty("icon-offset");
null!=(L=z)&&L.isDataDriven?this._offsetProp=z:this.offset=A.getLayoutValue("icon-offset",u);z=A.getLayoutProperty("icon-padding");null!=(M=z)&&M.isDataDriven?this._paddingProp=z:this.padding=A.getLayoutValue("icon-padding",u);z=A.getLayoutProperty("icon-rotate");null!=(O=z)&&O.isDataDriven?this._rotateProp=z:this.rotate=A.getLayoutValue("icon-rotate",u);z=A.getLayoutProperty("icon-size");null!=(N=z)&&N.isDataDriven?this._sizeProp=z:this.size=A.getLayoutValue("icon-size",u)}C.prototype.update=function(A,
u){this._anchorProp&&(this.anchor=this._anchorProp.getValue(A,u));this._offsetProp&&(this.offset=this._offsetProp.getValue(A,u));this._paddingProp&&(this.padding=this._paddingProp.getValue(A,u));this._rotateProp&&(this.rotate=this._rotateProp.getValue(A,u));this._sizeProp&&(this.size=this._sizeProp.getValue(A,u))};return C}(),D=function(){function C(A,u,z){var J,L,M,O,N,Q,R,G,K,I,S;this.allowOverlap=A.getLayoutValue("text-allow-overlap",u);this.ignorePlacement=A.getLayoutValue("text-ignore-placement",
u);this.keepUpright=A.getLayoutValue("text-keep-upright",u);this.optional=A.getLayoutValue("text-optional",u);this.rotationAlignment=A.getLayoutValue("text-rotation-alignment",u);2===this.rotationAlignment&&(this.rotationAlignment=z?0:1);z=A.getLayoutProperty("text-anchor");null!=(J=z)&&J.isDataDriven?this._anchorProp=z:this.anchor=A.getLayoutValue("text-anchor",u);z=A.getLayoutProperty("text-justify");null!=(L=z)&&L.isDataDriven?this._justifyProp=z:this.justify=A.getLayoutValue("text-justify",u);
z=A.getLayoutProperty("text-letter-spacing");null!=(M=z)&&M.isDataDriven?this._letterSpacingProp=z:this.letterSpacing=A.getLayoutValue("text-letter-spacing",u);z=A.getLayoutProperty("text-line-height");null!=(O=z)&&O.isDataDriven?this._lineHeightProp=z:this.lineHeight=A.getLayoutValue("text-line-height",u);z=A.getLayoutProperty("text-max-angle");null!=(N=z)&&N.isDataDriven?this._maxAngleProp=z:this.maxAngle=A.getLayoutValue("text-max-angle",u);z=A.getLayoutProperty("text-max-width");null!=(Q=z)&&
Q.isDataDriven?this._maxWidthProp=z:this.maxWidth=A.getLayoutValue("text-max-width",u);z=A.getLayoutProperty("text-offset");null!=(R=z)&&R.isDataDriven?this._offsetProp=z:this.offset=A.getLayoutValue("text-offset",u);z=A.getLayoutProperty("text-padding");null!=(G=z)&&G.isDataDriven?this._paddingProp=z:this.padding=A.getLayoutValue("text-padding",u);z=A.getLayoutProperty("text-rotate");null!=(K=z)&&K.isDataDriven?this._rotateProp=z:this.rotate=A.getLayoutValue("text-rotate",u);z=A.getLayoutProperty("text-size");
null!=(I=z)&&I.isDataDriven?this._sizeProp=z:this.size=A.getLayoutValue("text-size",u);z=A.getLayoutProperty("text-writing-mode");null!=(S=z)&&S.isDataDriven?this._writingModeProp=z:this.writingMode=A.getLayoutValue("text-writing-mode",u)}C.prototype.update=function(A,u){this._anchorProp&&(this.anchor=this._anchorProp.getValue(A,u));this._justifyProp&&(this.justify=this._justifyProp.getValue(A,u));this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(A,u));this._lineHeightProp&&
(this.lineHeight=this._lineHeightProp.getValue(A,u));this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(A,u));this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(A,u));this._offsetProp&&(this.offset=this._offsetProp.getValue(A,u));this._paddingProp&&(this.padding=this._paddingProp.getValue(A,u));this._rotateProp&&(this.rotate=this._rotateProp.getValue(A,u));this._sizeProp&&(this.size=this._sizeProp.getValue(A,u));this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(A,
u))};return C}();B.BackgroundStyleLayer=p;B.CircleStyleLayer=d;B.FillStyleLayer=q;B.IconLayout=x;B.LineStyleLayer=k;B.StyleLayer=m;B.SymbolStyleLayer=c;B.TextLayout=D;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLBackgroundMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(B,F,w){w=function(l){function r(h){return l.call(this,h)||this}F._inheritsLoose(r,l);var v=r.prototype;v.geometryInfo=
function(){return r.GEOMETRY_LAYOUT};v.opacityInfo=function(){return null};v.attributes=function(){return r.ATTRIBUTES};v.attributesInfo=function(){return r.ATTRIBUTES_INFO};return r}(w.VTLMaterial);w.ATTRIBUTES=[];w.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}];w.ATTRIBUTES_INFO={};B.VTLBackgroundMaterial=w;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/maybe","../MemoryBuffer"],function(B,F,w,l){let r=function(){function f(a){this._locations=new Map;this._key=a}var g=f.prototype;g.defines=function(){return[]};g.getStride=function(){this._layoutInfo||this._buildAttributesInfo();return this._stride};g.getAttributeLocations=function(){0===this._locations.size&&this._buildAttributesInfo();return this._locations};g.getLayoutInfo=function(){this._layoutInfo||this._buildAttributesInfo();return this._layoutInfo};g.getEncodingInfos=
function(){this._propertyEncodingInfo||this._buildAttributesInfo();return this._propertyEncodingInfo};g.getUniforms=function(){this._uniforms||this._buildAttributesInfo();return this._uniforms};g.getShaderHeader=function(){this._shaderHeader||this._buildAttributesInfo();return this._shaderHeader};g.getShaderMain=function(){this._shaderMain||this._buildAttributesInfo();return this._shaderMain};g.setDataUniforms=function(a,b,m,p,q){var k=this.getUniforms();for(const c of k){const {name:d,type:x,getValue:D}=
c;k=D(m,b,p,q);if(null!==k)switch(x){case "float":a.setUniform1f(d,k);break;case "vec2":a.setUniform2fv(d,k);break;case "vec4":a.setUniform4fv(d,k)}}};g.encodeAttributes=function(a,b,m,p){const q=this.attributesInfo(),k=this.getEncodingInfos(),c=[];let d=0,x=0;for(const A of Object.keys(k)){var D,C=k[A];const {type:u,precisionFactor:z,isLayout:J}=q[A],L=J?m.getLayoutProperty(A):m.getPaintProperty(A),M=null==(D=L.interpolator)?void 0:D.getInterpolationRange(b);let O=0;for(const N of C){const {offset:Q,
bufferElementsToAdd:R}=N;if(0<R){for(C=0;C<R;C++)c.push(0);d+=x;x=N.bufferElementsToAdd}C=null!=p?p:L.getValue(M?M[O]:b,a);switch(u){case 0:case 1:c[d]|=this._encodeByte(C*(z||1),8*Q);break;case 2:case 3:c[d]|=this._encodeShort(C*(z||1),8*Q);break;case 4:case 5:c[d]|=this._encodeByte(C*(z||1),8*Q);c[d]|=this._encodeByte(C*(z||1),8*Q+8);break;case 6:case 7:c[d]|=this._encodeShort(C*(z||1),8*Q);c[d]|=this._encodeShort(C*(z||1),8*Q+16);break;case 8:case 9:c[d]|=this._encodeByte(C*(z||1),8*Q);c[d]|=this._encodeByte(C*
(z||1),8*Q+8);c[d]|=this._encodeByte(C*(z||1),8*Q+16);c[d]|=this._encodeByte(C*(z||1),8*Q+24);break;case 10:c[d]=this._encodeColor(C);break;case 11:case 12:this._encodePattern(d,c,C);break;default:throw Error("Unsupported encoding type");}O++}}return c};g.getAtributeState=function(a){const b=3+2*a;a=0|this._bit(b);return a|=this._bit(b+1)<<1};g._buildAttributesInfo=function(){const a=[],b={};var m={},p=-1;const q=this.attributesInfo();var k=this.attributes();let c=-1;for(const C of k){c++;k=this.getAtributeState(c);
if(0===k||3===k)continue;var d=q[C];const A=[];b[C]=A;d=d.type;for(let u=0;u<k;u++){const {dataType:z,bytesPerElement:J,count:L,normalized:M}=f._encodingInfo[d],O=J*L;let N=m[z];var x=0;!N||4<N.count+L?(p++,N={dataIndex:p,count:0,offset:0},4!==L&&(m[z]=N),a.push({location:-1,name:"a_data_"+p,count:L,type:z,normalized:M}),x=Math.ceil(Math.max(O/4,1))):(x=a[N.dataIndex],x.count+=L,x=Math.ceil(Math.max(x.count*J/4,1))-Math.ceil(Math.max(N.offset/4,1)));A.push({dataIndex:N.dataIndex,offset:N.offset,bufferElementsToAdd:x});
N.offset+=O;N.count+=L}}for(const C of a)switch(C.type){case 5120:case 5121:C.count=4;case 5122:case 5123:C.count+=C.count%2}this._buildVertexBufferLayout(a);m=0;p=this._layoutInfo.geometry;for(var D of p)this._locations.set(D.name,m++);if(D=this._layoutInfo.opacity)for(const C of D)this._locations.set(C.name,m++);this._buildShaderInfo(a,b);this._propertyEncodingInfo=b};g._buildVertexBufferLayout=function(a){const b={};var m=this.geometryInfo();let p=m[0].stride;if(0===a.length)b.geometry=m;else{const q=
[];let k=p;for(const c of a)p+=v(c.type)*c.count;for(const c of m)m={...c},m.stride=p,q.push(m);for(const c of a)q.push({name:c.name,count:c.count,type:c.type,offset:k,stride:p,normalized:c.normalized||!1,divisor:0}),k+=v(c.type)*c.count;b.geometry=q}this.opacityInfo()&&(b.opacity=this.opacityInfo());this._layoutInfo=b;this._stride=p};g._buildShaderInfo=function(a,b){let m="\n",p="\n";const q=[];for(var k of a)m+=`attribute ${this._getType(k.count)} ${k.name};\n`;var c=this.attributes();a=this.attributesInfo();
k=-1;for(const D of c){k++;const {name:C,type:A,precisionFactor:u,isLayout:z}=a[D];c=u&&1!==u?` * ${1/u}`:"";const {bytesPerElement:J,count:L}=f._encodingInfo[A];var d=M=>`a_data_${M.dataIndex}${h(L,M.offset,J)}`;switch(this.getAtributeState(k)){case 0:c=this._getType(L);var x=`u_${C}`;q.push({name:x,type:c,getValue:(M,O,N,Q)=>{N=z?M.getLayoutValue(D,O):M.getPaintValue(D,O);if(11===A){M=M.getDashKey(N,M.getLayoutValue("line-cap",O));Q=Q.getMosaicItemPosition(M,!1);if(w.isNone(Q))return null;const {tl:R,
br:G}=Q;return[R[0],G[1],G[0],R[1]]}if(12===A){Q=Q.getMosaicItemPosition(N,-1===D.indexOf("line-"));if(w.isNone(Q))return null;const {tl:R,br:G}=Q;return[R[0],G[1],G[0],R[1]]}return 10===A?(Q=N[3],[Q*N[0],Q*N[1],Q*N[2],Q]):N}});m+=`uniform ${c} ${x};\n`;p+=`${c} ${C} = ${x};\n`;break;case 1:x=d(b[D][0]);p+=`${this._getType(L)} ${C} = ${x}${c};\n`;break;case 2:{x=`u_t_${C}`;q.push({name:x,type:"float",getValue:(O,N,Q,R)=>(z?O.getLayoutProperty(D):O.getPaintProperty(D)).interpolator.interpolationUniformValue(Q,
N)});m+=`uniform float ${x};\n`;const M=d(b[D][0]);d=d(b[D][1]);p+=`${this._getType(L)} ${C} = mix(${M}${c}, ${d}${c}, ${x});\n`}}}this._shaderHeader=m;this._shaderMain=p;this._uniforms=q};g._bit=function(a){return(this._key&1<<a)>>a};g._getType=function(a){switch(a){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw Error("Invalid count");};g._encodeColor=function(a){const b=255*a[3];return l.i8888to32(a[0]*b,a[1]*b,a[2]*b,b)};g._encodePattern=function(a,b,m){if(m&&
m.rect){var p=m.rect,q=m.width;m=m.height;b[a]=this._encodeShort(p.x+2,0);b[a]|=this._encodeShort(p.y+2+m,16);b[a+1]=this._encodeShort(p.x+2+q,0);b[a+1]|=this._encodeShort(p.y+2,16)}};g._encodeByte=function(a,b){return(a&255)<<b};g._encodeShort=function(a,b){return(a&65535)<<b};F._createClass(f,[{key:"key",get:function(){return this._key}},{key:"type",get:function(){return this._key&7}}]);return f}();r._encodingInfo={[0]:{dataType:5120,bytesPerElement:1,count:1,normalized:!1},[1]:{dataType:5121,bytesPerElement:1,
count:1,normalized:!1},[2]:{dataType:5122,bytesPerElement:2,count:1,normalized:!1},[3]:{dataType:5123,bytesPerElement:2,count:1,normalized:!1},[4]:{dataType:5120,bytesPerElement:1,count:2,normalized:!1},[5]:{dataType:5121,bytesPerElement:1,count:2,normalized:!1},[6]:{dataType:5122,bytesPerElement:2,count:2,normalized:!1},[7]:{dataType:5123,bytesPerElement:2,count:2,normalized:!1},[8]:{dataType:5120,bytesPerElement:1,count:4,normalized:!1},[9]:{dataType:5121,bytesPerElement:1,count:4,normalized:!1},
[10]:{dataType:5121,bytesPerElement:1,count:4,normalized:!0},[11]:{dataType:5123,bytesPerElement:2,count:4,normalized:!1},[12]:{dataType:5123,bytesPerElement:2,count:4,normalized:!1}};const v=f=>{switch(f){case 5126:return 4;case 5124:return 4;case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1}},h=(f,g,a)=>{g/=a;if(1===f)switch(g){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(2===f)switch(g){case 0:return".xy";case 1:return".yz";
case 2:return".zw"}else if(3===f)switch(g){case 0:return".xyz";case 1:return".yzw"}return""};B.VTLMaterial=r;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/MemoryBuffer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(B){return function(){function F(l){this._array=[];0>=l&&console.error("strideInBytes must be positive!");this._stride=l}var w=F.prototype;w.reset=function(){this.array.length=0};w.toBuffer=function(){return(new Uint32Array(this._array)).buffer};
F.i1616to32=function(l,r){return 65535&l|r<<16};F.i8888to32=function(l,r,v,h){return l&255|(r&255)<<8|(v&255)<<16|h<<24};F.i8816to32=function(l,r,v){return l&255|(r&255)<<8|v<<16};B._createClass(F,[{key:"array",get:function(){return this._array}},{key:"index",get:function(){return 4*this._array.length/this._stride}},{key:"itemSize",get:function(){return this._stride}},{key:"sizeInBytes",get:function(){return 4*this._array.length}}]);return F}()})},"esri/views/2d/engine/vectorTiles/shaders/VTLCircleMaterial":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(B,F,w){w=function(l){function r(h){return l.call(this,h)||this}F._inheritsLoose(r,l);var v=r.prototype;v.geometryInfo=function(){return r.GEOMETRY_LAYOUT};v.opacityInfo=function(){return null};v.attributes=function(){return r.ATTRIBUTES};v.attributesInfo=function(){return r.ATTRIBUTES_INFO};return r}(w.VTLMaterial);w.ATTRIBUTES="circle-radius circle-color circle-opacity circle-stroke-width circle-stroke-color circle-stroke-opacity circle-blur".split(" ");
w.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}];w.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:1},"circle-color":{name:"color",type:10},"circle-opacity":{name:"opacity",type:1,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:1,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:10},"circle-stroke-opacity":{name:"stroke_opacity",type:1,precisionFactor:100},"circle-blur":{name:"blur",type:1,precisionFactor:32}};
B.VTLCircleMaterial=w;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLFillMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(B,F,w){let l=function(r){function v(f){return r.call(this,f)||this}F._inheritsLoose(v,r);var h=v.prototype;h.geometryInfo=function(){return v.GEOMETRY_LAYOUT};h.opacityInfo=function(){return null};h.attributes=function(){return v.ATTRIBUTES};h.attributesInfo=function(){return v.ATTRIBUTES_INFO};
return v}(w.VTLMaterial);l.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"];l.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}];l.ATTRIBUTES_INFO={"fill-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100},"fill-pattern":{name:"tlbr",type:12,isOptional:!0}};w=function(r){function v(f,g){f=r.call(this,f)||this;f.usefillColor=g;return f}F._inheritsLoose(v,r);var h=v.prototype;h.geometryInfo=function(){return v.GEOMETRY_LAYOUT};
h.opacityInfo=function(){return null};h.attributes=function(){return this.usefillColor?v.ATTRIBUTES_FILL:v.ATTRIBUTES_OUTLINE};h.attributesInfo=function(){return this.usefillColor?v.ATTRIBUTES_INFO_FILL:v.ATTRIBUTES_INFO_OUTLINE};return v}(w.VTLMaterial);w.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"];w.ATTRIBUTES_FILL=["fill-color","fill-opacity"];w.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,
normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}];w.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100}};w.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100}};B.VTLFillMaterial=l;B.VTLOutlineMaterial=w;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLLineMaterial":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(B,F,w){w=function(l){function r(h){return l.call(this,h)||this}F._inheritsLoose(r,l);var v=r.prototype;v.geometryInfo=function(){return r.GEOMETRY_LAYOUT};v.opacityInfo=function(){return null};v.attributes=function(){return r.ATTRIBUTES};v.attributesInfo=function(){return r.ATTRIBUTES_INFO};return r}(w.VTLMaterial);w.ATTRIBUTES="line-blur line-color line-gap-width line-offset line-opacity line-width line-pattern line-dasharray".split(" ");
w.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_extrude_offset",count:4,type:5120,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_dir_normal",count:4,type:5120,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:12,stride:16,normalized:!1,divisor:0}];w.ATTRIBUTES_INFO={"line-width":{name:"width",type:1,precisionFactor:2},"line-gap-width":{name:"gap_width",type:1,precisionFactor:2},"line-offset":{name:"offset",
type:0,precisionFactor:2},"line-color":{name:"color",type:10},"line-opacity":{name:"opacity",type:1,precisionFactor:100},"line-blur":{name:"blur",type:1,precisionFactor:4},"line-pattern":{name:"tlbr",type:12,isOptional:!0},"line-dasharray":{name:"tlbr",type:11,isOptional:!0}};B.VTLLineMaterial=w;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLSymbolMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],
function(B,F,w){const l=[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_texAngleRange",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}],r=[{name:"a_opacityInfo",count:1,type:5121,offset:0,stride:1,normalized:!1,divisor:0}];let v=function(h){function f(a){return h.call(this,a)||this}
F._inheritsLoose(f,h);var g=f.prototype;g.geometryInfo=function(){return l};g.opacityInfo=function(){return r};g.attributes=function(){return f.ATTRIBUTES};g.attributesInfo=function(){return f.ATTRIBUTES_INFO};return f}(w.VTLMaterial);v.ATTRIBUTES="icon-color icon-opacity icon-halo-blur icon-halo-color icon-halo-width icon-size".split(" ");v.ATTRIBUTES_INFO={"icon-color":{name:"color",type:10},"icon-opacity":{name:"opacity",type:1,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:10},
"icon-halo-width":{name:"halo_width",type:1,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:1,precisionFactor:4},"icon-size":{name:"size",type:1,precisionFactor:32,isLayout:!0}};w=function(h){function f(a){return h.call(this,a)||this}F._inheritsLoose(f,h);var g=f.prototype;g.geometryInfo=function(){return l};g.opacityInfo=function(){return r};g.attributes=function(){return f.ATTRIBUTES};g.attributesInfo=function(){return f.ATTRIBUTES_INFO};return f}(w.VTLMaterial);w.ATTRIBUTES="text-color text-opacity text-halo-blur text-halo-color text-halo-width text-size".split(" ");
w.ATTRIBUTES_INFO={"text-color":{name:"color",type:10},"text-opacity":{name:"opacity",type:1,precisionFactor:100},"text-halo-color":{name:"halo_color",type:10},"text-halo-width":{name:"halo_width",type:1,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:1,precisionFactor:4},"text-size":{name:"size",type:1,isLayout:!0}};B.VTLIconMaterial=v;B.VTLTextMaterial=w;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/Filter":function(){define(["../expression/expression",
"../expression/types"],function(B,F){return function(){function w(l){this._expression=l}w.prototype.filter=function(l,r){if(!this._expression)return!0;try{return this._expression.evaluate(l,r)}catch(v){return console.log(v.message),!0}};w.createFilter=function(l){if(!l)return null;this.isLegacyFilter(l)&&(l=this.convertLegacyFilter(l));try{const r=B.createExpression(l,null,F.BooleanType);return new w(r)}catch(r){return console.log(r.message),null}};w.isLegacyFilter=function(l){if(!Array.isArray(l)||
0===l.length)return!0;switch(l[0]){case "\x3d\x3d":case "!\x3d":case "\x3e":case "\x3c":case "\x3e\x3d":case "\x3c\x3d":return 3===l.length&&"string"===typeof l[1]&&!Array.isArray(l[2]);case "in":return 3<=l.length&&"string"===typeof l[1]&&!Array.isArray(l[2]);case "!in":return!0;case "any":case "all":for(let r=1;r<l.length;r++)if(!this.isLegacyFilter(l[1]))return!1;return!0;case "none":return!0;case "has":return 2===l.length&&("$id"===l[1]||"$type"===l[1]);case "!has":return!0;default:return!1}};
w.convertLegacyFilter=function(l){if(!Array.isArray(l)||0===l.length)return!0;const r=l[0];if(1===l.length)return"any"!==r;switch(r){case "\x3d\x3d":return w.convertComparison("\x3d\x3d",l[1],l[2]);case "!\x3d":return w.negate(w.convertComparison("\x3d\x3d",l[1],l[2]));case "\x3e":case "\x3c":case "\x3e\x3d":case "\x3c\x3d":return w.convertComparison(r,l[1],l[2]);case "in":return w.convertIn(l[1],l.slice(2));case "!in":return w.negate(w.convertIn(l[1],l.slice(2)));case "any":case "all":case "none":return w.convertCombining(r,
l.slice(1));case "has":return w.convertHas(l[1]);case "!has":return w.negate(w.convertHas(l[1]));default:throw Error("Unexpected legacy filter.");}};w.convertComparison=function(l,r,v){switch(r){case "$type":return[l,["geometry-type"],v];case "$id":return[l,["id"],v];default:return[l,["get",r],v]}};w.convertIn=function(l,r){switch(l){case "$type":return["in",["geometry-type"],["literal",r]];case "$id":return["in",["id"],["literal",r]];default:return["in",["get",l],["literal",r]]}};w.convertHas=function(l){switch(l){case "$type":return!0;
case "$id":return["has-id"];default:return["has",l]}};w.convertCombining=function(l,r){return[l].concat(r.map(this.convertLegacyFilter))};w.negate=function(l){return["!",l]};return w}()})},"esri/views/2d/engine/vectorTiles/expression/expression":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../Color ../../../../../core/colorUtils ../../../unitBezier ../GeometryUtils ./types".split(" "),function(B,F,w,l,r,v,h){function f(t,e,n){var y=typeof t;if("string"===
y||"boolean"===y||"number"===y||null===t){if(n)switch(n.kind){case "string":"string"!==y&&(t=da.toString(t));break;case "number":"number"!==y&&(t=da.toNumber(t));break;case "color":t=da.toColor(t)}t=["literal",t]}if(!Array.isArray(t)||0===t.length)throw Error("Expression must be a non empty array");y=t[0];if("string"!==typeof y)throw Error("First element of expression must be a string");const E=ia[y];if(void 0===E)throw Error(`Invalid expression operator "${y}"`);if(!E)throw Error(`Unimplemented expression operator "${y}"`);
return E.parse(t,e,n)}let g=function(){function t(n){this.parent=n;this.vars={}}var e=t.prototype;e.add=function(n,y){this.vars[n]=y};e.get=function(n){return this.vars[n]?this.vars[n]:this.parent?this.parent.get(n):null};return t}(),a=function(){function t(){this.type=h.ValueType}t.parse=function(e){if(1<e.length)throw Error('"id" does not expect arguments');return new t};t.prototype.evaluate=function(e,n){return null==e?void 0:e.id};return t}(),b=function(){function t(){this.type=h.StringType}t.parse=
function(e){if(1<e.length)throw Error('"geometry-type" does not expect arguments');return new t};t.prototype.evaluate=function(e,n){if(!e)return null;switch(e.type){case 1:return"Point";case 2:return"LineString";case 3:return"Polygon";default:return null}};return t}(),m=function(){function t(){this.type=h.ObjectType}t.parse=function(e){if(1<e.length)throw Error('"properties" does not expect arguments');return new t};t.prototype.evaluate=function(e,n){return null==e?void 0:e.values};return t}(),p=
function(){function t(){this.type=h.NumberType}t.parse=function(e){if(1<e.length)throw Error('"zoom" does not expect arguments');return new t};t.prototype.evaluate=function(e,n){return n};return t}(),q=function(){function t(e,n,y){this.lhs=e;this.rhs=n;this.compare=y;this.type=h.BooleanType}t.parse=function(e,n,y){if(3!==e.length&&4!==e.length)throw Error(`"${e[0]}" expects 2 or 3 arguments`);if(4===e.length)throw Error(`"${e[0]}" collator not supported`);return new t(f(e[1],n),f(e[2],n),y)};t.prototype.evaluate=
function(e,n){return this.compare(this.lhs.evaluate(e,n),this.rhs.evaluate(e,n))};return t}(),k=function(t){function e(){return t.apply(this,arguments)||this}F._inheritsLoose(e,t);e.parse=function(n,y){return q.parse(n,y,(E,H)=>E===H)};return e}(q),c=function(t){function e(){return t.apply(this,arguments)||this}F._inheritsLoose(e,t);e.parse=function(n,y){return q.parse(n,y,(E,H)=>E!==H)};return e}(q),d=function(t){function e(){return t.apply(this,arguments)||this}F._inheritsLoose(e,t);e.parse=function(n,
y){return q.parse(n,y,(E,H)=>E<H)};return e}(q),x=function(t){function e(){return t.apply(this,arguments)||this}F._inheritsLoose(e,t);e.parse=function(n,y){return q.parse(n,y,(E,H)=>E<=H)};return e}(q),D=function(t){function e(){return t.apply(this,arguments)||this}F._inheritsLoose(e,t);e.parse=function(n,y){return q.parse(n,y,(E,H)=>E>H)};return e}(q),C=function(t){function e(){return t.apply(this,arguments)||this}F._inheritsLoose(e,t);e.parse=function(n,y){return q.parse(n,y,(E,H)=>E>=H)};return e}(q),
A=function(){function t(e){this.arg=e;this.type=h.BooleanType}t.parse=function(e,n){if(2!==e.length)throw Error('"!" expects 1 argument');return new t(f(e[1],n))};t.prototype.evaluate=function(e,n){return!this.arg.evaluate(e,n)};return t}(),u=function(){function t(e){this.args=e;this.type=h.BooleanType}t.parse=function(e,n){const y=[];for(let E=1;E<e.length;E++)y.push(f(e[E],n));return new t(y)};t.prototype.evaluate=function(e,n){for(const y of this.args)if(!y.evaluate(e,n))return!1;return!0};return t}(),
z=function(){function t(e){this.args=e;this.type=h.BooleanType}t.parse=function(e,n){const y=[];for(let E=1;E<e.length;E++)y.push(f(e[E],n));return new t(y)};t.prototype.evaluate=function(e,n){for(const y of this.args)if(y.evaluate(e,n))return!0;return!1};return t}(),J=function(){function t(e){this.args=e;this.type=h.BooleanType}t.parse=function(e,n){const y=[];for(let E=1;E<e.length;E++)y.push(f(e[E],n));return new t(y)};t.prototype.evaluate=function(e,n){for(const y of this.args)if(y.evaluate(e,
n))return!1;return!0};return t}(),L=function(){function t(e,n,y){this.type=e;this.args=n;this.fallback=y}t.parse=function(e,n,y){if(4>e.length)throw Error('"case" expects at least 3 arguments');if(1===e.length%2)throw Error('"case" expects an odd number of arguments');let E;const H=[];for(let P=1;P<e.length-1;P+=2){const U=f(e[P],n),T=f(e[P+1],n,y);E||(E=T.type);H.push({condition:U,output:T})}e=f(e[e.length-1],n,y);E||(E=e.type);return new t(E,H,e)};t.prototype.evaluate=function(e,n){for(const y of this.args)if(y.condition.evaluate(e,
n))return y.output.evaluate(e,n);return this.fallback.evaluate(e,n)};return t}(),M=function(){function t(e,n){this.type=e;this.args=n}t.parse=function(e,n){if(2>e.length)throw Error('"coalesce" expects at least 1 argument');let y;const E=[];for(let H=1;H<e.length;H++){const P=f(e[H],n);y||(y=P.type);E.push(P)}return new t(y,E)};t.prototype.evaluate=function(e,n){for(const y of this.args){const E=y.evaluate(e,n);if(null!==E)return E}return null};return t}(),O=function(){function t(e,n,y,E,H){this.type=
e;this.input=n;this.labels=y;this.outputs=E;this.fallback=H}t.parse=function(e,n){if(3>e.length)throw Error('"match" expects at least 3 arguments');if(0===e.length%2)throw Error('"case" expects an even number of arguments');let y;const E=f(e[1],n),H=[],P={};let U;for(let X=2;X<e.length-1;X+=2){var T=e[X];Array.isArray(T)||(T=[T]);for(const ea of T){T=typeof ea;if("string"!==T&&"number"!==T)throw Error('"match" requires string or number literal as labels');if(!U)U=T;else if(T!==U)throw Error('"match" requires labels to have the same type');
P[ea]=H.length}T=f(e[X+1],n);y||(y=T.type);H.push(T)}return new t(y,E,P,H,f(e[e.length-1],n))};t.prototype.evaluate=function(e,n){const y=this.input.evaluate(e,n);return(this.outputs[this.labels[y]]||this.fallback).evaluate(e,n)};return t}(),N=function(){function t(n,y,E,H,P){this.operator=n;this.type=y;this.interpolation=E;this.input=H;this.stops=P}t.parse=function(n,y,E){const H=n[0];if(5>n.length)throw Error(`"${H}" expects at least 4 arguments`);const P=n[1];if(!Array.isArray(P)||0===P.length)throw Error(`"${P}" is not a valid interpolation`);
switch(P[0]){case "linear":if(1!==P.length)throw Error("Linear interpolation cannot have parameters");break;case "exponential":if(2!==P.length||"number"!==typeof P[1])throw Error("Exponential interpolation requires one numeric argument");break;case "cubic-bezier":if(5!==P.length)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(var U=1;5>U;U++){var T=P[U];if("number"!==typeof T||0>T||1<T)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");
}break;default:throw Error(`"${n[0]}" unknown interpolation type "${P[0]}"`);}if(1!==n.length%2)throw Error(`"${H}" expects an even number of arguments`);U=f(n[2],y,h.NumberType);let X;"interpolate-hcl"===H||"interpolate-lab"===H?X=h.ColorType:E&&"value"!==E.kind&&(X=E);E=[];for(T=3;T<n.length;T+=2){const ea=n[T];if("number"!==typeof ea)throw Error(`"${H}" requires stop inputs as literal numbers`);if(E.length&&E[E.length-1][0]>=ea)throw Error(`"${H}" requires strictly ascending stop inputs`);const ja=
f(n[T+1],y,X);X||(X=ja.type);E.push([ea,ja])}if(X&&X!==h.ColorType&&X!==h.NumberType&&("array"!==X.kind||X.itemType!==h.NumberType))throw Error(`"${H}" cannot interpolate type ${h.typeToString(X)}`);return new t(H,X,P,U,E)};var e=t.prototype;e.evaluate=function(n,y){var E=this.stops;if(1===E.length)return E[0][1].evaluate(n,y);var H=this.input.evaluate(n,y);if(H<=E[0][0])return E[0][1].evaluate(n,y);if(H>=E[E.length-1][0])return E[E.length-1][1].evaluate(n,y);let P=0;for(;++P<E.length&&!(H<E[P][0]););
const U=t.interpolationRatio(this.interpolation,H,E[P-1][0],E[P][0]);H=E[P-1][1].evaluate(n,y);const T=E[P][1].evaluate(n,y);if("interpolate"===this.operator){if("array"===this.type.kind&&Array.isArray(H)&&Array.isArray(T))return H.map((X,ea)=>v.interpolate(X,T[ea],U));if("color"===this.type.kind&&H instanceof w&&T instanceof w)return H=new w(H),n=new w(T),new w([v.interpolate(H.r,n.r,U),v.interpolate(H.g,n.g,U),v.interpolate(H.b,n.b,U),v.interpolate(H.a,n.a,U)]);if("number"===this.type.kind&&"number"===
typeof H&&"number"===typeof T)return v.interpolate(H,T,U);throw Error(`"${this.operator}" cannot interpolate type ${h.typeToString(this.type)}`);}if("interpolate-hcl"===this.operator)return n=l.toLCH(H),y=l.toLCH(T),E=y.h-n.h,n=l.toRGB({h:n.h+U*(180<E||-180>E?E-360*Math.round(E/360):E),c:v.interpolate(n.c,y.c,U),l:v.interpolate(n.l,y.l,U)}),new w({a:v.interpolate(H.a,T.a,U),...n});if("interpolate-lab"===this.operator)return n=l.toLAB(H),y=l.toLAB(T),n=l.toRGB({l:v.interpolate(n.l,y.l,U),a:v.interpolate(n.a,
y.a,U),b:v.interpolate(n.b,y.b,U)}),new w({a:v.interpolate(H.a,T.a,U),...n});throw Error(`Unexpected operator "${this.operator}"`);};e.interpolationUniformValue=function(n,y){const E=this.stops;if(1===E.length||n>=E[E.length-1][0])return 0;let H=0;for(;++H<E.length&&!(n<E[H][0]););return t.interpolationRatio(this.interpolation,y,E[H-1][0],E[H][0])};e.getInterpolationRange=function(n){const y=this.stops;if(1===y.length)return n=y[0][0],[n,n];var E=y[y.length-1][0];if(n>=E)return[E,E];for(E=0;++E<y.length&&
!(n<y[E][0]););return[y[E-1][0],y[E][0]]};t.interpolationRatio=function(n,y,E,H){let P=0;"linear"===n[0]?P=t.exponentialInterpolationRatio(y,1,E,H):"exponential"===n[0]?P=t.exponentialInterpolationRatio(y,n[1],E,H):"cubic-bezier"===n[0]&&(P=r.unitBezier(n[1],n[2],n[3],n[4])(t.exponentialInterpolationRatio(y,1,E,H),1E-5));0>P?P=0:1<P&&(P=1);return P};t.exponentialInterpolationRatio=function(n,y,E,H){H-=E;if(0===H)return 0;n-=E;return 1===y?n/H:(y**n-1)/(y**H-1)};return t}(),Q=function(){function t(e,
n,y){this.type=e;this.input=n;this.stops=y}t.parse=function(e,n){if(5>e.length)throw Error('"step" expects at least 4 arguments');if(1!==e.length%2)throw Error('"step" expects an even number of arguments');const y=f(e[1],n,h.NumberType);let E;const H=[];H.push([-Infinity,f(e[2],n)]);for(let P=3;P<e.length;P+=2){const U=e[P];if("number"!==typeof U)throw Error('"step" requires stop inputs as literal numbers');if(H.length&&H[H.length-1][0]>=U)throw Error('"step" requires strictly ascending stop inputs');
const T=f(e[P+1],n);E||(E=T.type);H.push([U,T])}return new t(E,y,H)};t.prototype.evaluate=function(e,n){const y=this.stops;if(1===y.length)return y[0][1].evaluate(e,n);const E=this.input.evaluate(e,n);let H=0;for(;++H<y.length&&!(E<y[H][0]););return this.stops[H-1][1].evaluate(e,n)};return t}(),R=function(){function t(e,n){this.type=e;this.output=n}t.parse=function(e,n,y){if(4>e.length)throw Error('"let" expects at least 3 arguments');if(1===e.length%2)throw Error('"let" expects an odd number of arguments');
const E=new g(n);for(let H=1;H<e.length-1;H+=2){const P=e[H];if("string"!==typeof P)throw Error(`"let" requires a string to define variable names - found ${P}`);E.add(P,f(e[H+1],n))}e=f(e[e.length-1],E,y);return new t(e.type,e)};t.prototype.evaluate=function(e,n){return this.output.evaluate(e,n)};return t}(),G=function(){function t(e,n){this.type=e;this.output=n}t.parse=function(e,n,y){if(2!==e.length||"string"!==typeof e[1])throw Error('"var" requires just one literal string argument');n=n.get(e[1]);
if(!n)throw Error(`${e[1]} must be defined before being used in a "var" expression`);return new t(y||h.ValueType,n)};t.prototype.evaluate=function(e,n){return this.output.evaluate(e,n)};return t}(),K=function(){function t(e,n,y){this.type=e;this.index=n;this.array=y}t.parse=function(e,n){if(3!==e.length)throw Error('"at" expects 2 arguments');const y=f(e[1],n,h.NumberType);e=f(e[2],n);return new t(e.type.itemType,y,e)};t.prototype.evaluate=function(e,n){const y=this.index.evaluate(e,n);e=this.array.evaluate(e,
n);if(0>y||y>=e.length)throw Error('"at" index out of bounds');if(y!==Math.floor(y))throw Error('"at" index must be an integer');return e[y]};return t}(),I=function(){function t(e,n){this.key=e;this.obj=n;this.type=h.ValueType}t.parse=function(e,n){let y;switch(e.length){case 2:return y=f(e[1],n),new t(y);case 3:return y=f(e[1],n),e=f(e[2],n),new t(y,e);default:throw Error('"get" expects 1 or 2 arguments');}};t.prototype.evaluate=function(e,n){const y=this.key.evaluate(e,n);return this.obj?this.obj.evaluate(e,
n)[y]:null==e?void 0:e.values[y]};return t}(),S=function(){function t(e,n){this.key=e;this.obj=n;this.type=h.BooleanType}t.parse=function(e,n){let y;switch(e.length){case 2:return y=f(e[1],n),new t(y);case 3:return y=f(e[1],n),e=f(e[2],n),new t(y,e);default:throw Error('"has" expects 1 or 2 arguments');}};t.prototype.evaluate=function(e,n){const y=this.key.evaluate(e,n);return this.obj?(e=this.obj.evaluate(e,n),y in e):!(null==e||!e.values[y])};return t}(),V=function(){function t(e,n){this.key=e;
this.vals=n;this.type=h.BooleanType}t.parse=function(e,n){if(3!==e.length)throw Error('"in" expects 2 arguments');return new t(f(e[1],n),f(e[2],n))};t.prototype.evaluate=function(e,n){const y=this.key.evaluate(e,n);return-1!==this.vals.evaluate(e,n).indexOf(y)};return t}(),aa=function(){function t(e,n,y){this.item=e;this.array=n;this.from=y;this.type=h.NumberType}t.parse=function(e,n){if(3>e.length||4<e.length)throw Error('"index-of" expects 3 or 4 arguments');const y=f(e[1],n),E=f(e[2],n);return 4===
e.length?(e=f(e[3],n,h.NumberType),new t(y,E,e)):new t(y,E)};t.prototype.evaluate=function(e,n){const y=this.item.evaluate(e,n),E=this.array.evaluate(e,n);if(this.from){e=this.from.evaluate(e,n);if(e!==Math.floor(e))throw Error('"index-of" index must be an integer');return E.indexOf(y,e)}return E.indexOf(y)};return t}(),ca=function(){function t(e){this.arg=e;this.type=h.NumberType}t.parse=function(e,n){if(2!==e.length)throw Error('"length" expects 2 arguments');e=f(e[1],n);return new t(e)};t.prototype.evaluate=
function(e,n){e=this.arg.evaluate(e,n);if("string"===typeof e||Array.isArray(e))return e.length;throw Error('"length" expects string or array');};return t}(),Y=function(){function t(e,n,y,E){this.type=e;this.array=n;this.from=y;this.to=E}t.parse=function(e,n){if(3>e.length||4<e.length)throw Error('"slice" expects 2 or 3 arguments');const y=f(e[1],n),E=f(e[2],n,h.NumberType);if(E.type!==h.NumberType)throw Error('"slice" index must return a number');if(4===e.length){e=f(e[3],n,h.NumberType);if(e.type!==
h.NumberType)throw Error('"slice" index must return a number');return new t(y.type,y,E,e)}return new t(y.type,y,E)};t.prototype.evaluate=function(e,n){const y=this.array.evaluate(e,n);if(!Array.isArray(y)&&"string"!==typeof y)throw Error('"slice" input must be an array or a string');const E=this.from.evaluate(e,n);if(0>E||E>=y.length)throw Error('"slice" index out of bounds');if(E!==Math.floor(E))throw Error('"slice" index must be an integer');if(this.to){e=this.to.evaluate(e,n);if(0>e||e>=y.length)throw Error('"slice" index out of bounds');
if(e!==Math.floor(e))throw Error('"slice" index must be an integer');return y.slice(E,e)}return y.slice(E)};return t}(),Z=function(){function t(){this.type=h.BooleanType}t.parse=function(e){if(1!==e.length)throw Error('"has-id" expects no arguments');return new t};t.prototype.evaluate=function(e,n){return e&&void 0!==e.id};return t}(),ba=function(){function t(e,n){this.args=e;this.calculate=n;this.type=h.NumberType}t.parse=function(e,n,y){e=e.slice(1).map(E=>f(E,n));return new t(e,y)};t.prototype.evaluate=
function(e,n){let y;this.args&&(y=this.args.map(E=>E.evaluate(e,n)));return this.calculate(y)};return t}(),ka=function(t){function e(){return t.apply(this,arguments)||this}F._inheritsLoose(e,t);e.parse=function(n,y){switch(n.length){case 2:return ba.parse(n,y,E=>-E[0]);case 3:return ba.parse(n,y,E=>E[0]-E[1]);default:throw Error('"-" expects 1 or 2 arguments');}};return e}(ba),la=function(t){function e(){return t.apply(this,arguments)||this}F._inheritsLoose(e,t);e.parse=function(n,y){return ba.parse(n,
y,E=>{let H=1;for(const P of E)H*=P;return H})};return e}(ba),ma=function(t){function e(){return t.apply(this,arguments)||this}F._inheritsLoose(e,t);e.parse=function(n,y){if(3===n.length)return ba.parse(n,y,E=>E[0]/E[1]);throw Error('"/" expects 2 arguments');};return e}(ba),na=function(t){function e(){return t.apply(this,arguments)||this}F._inheritsLoose(e,t);e.parse=function(n,y){if(3===n.length)return ba.parse(n,y,E=>E[0]%E[1]);throw Error('"%" expects 2 arguments');};return e}(ba),oa=function(t){function e(){return t.apply(this,
arguments)||this}F._inheritsLoose(e,t);e.parse=function(n,y){if(3===n.length)return ba.parse(n,y,E=>E[0]**E[1]);throw Error('"^" expects 1 or 2 arguments');};return e}(ba),pa=function(t){function e(){return t.apply(this,arguments)||this}F._inheritsLoose(e,t);e.parse=function(n,y){return ba.parse(n,y,E=>{let H=0;for(const P of E)H+=P;return H})};return e}(ba),W=function(){function t(e,n){this.args=e;this.calculate=n;this.type=h.NumberType}t.parse=function(e,n){const y=e.slice(1).map(E=>f(E,n));return new t(y,
t.ops[e[0]])};t.prototype.evaluate=function(e,n){let y;this.args&&(y=this.args.map(E=>E.evaluate(e,n)));return this.calculate(y)};return t}();W.ops={abs:t=>Math.abs(t[0]),acos:t=>Math.acos(t[0]),asin:t=>Math.asin(t[0]),atan:t=>Math.atan(t[0]),ceil:t=>Math.ceil(t[0]),cos:t=>Math.cos(t[0]),e:()=>Math.E,floor:t=>Math.floor(t[0]),ln:t=>Math.log(t[0]),ln2:()=>Math.LN2,log10:t=>Math.log(t[0])/Math.LN10,log2:t=>Math.log(t[0])/Math.LN2,max:t=>Math.max(...t),min:t=>Math.min(...t),pi:()=>Math.PI,round:t=>Math.round(t[0]),
sin:t=>Math.sin(t[0]),sqrt:t=>Math.sqrt(t[0]),tan:t=>Math.tan(t[0])};let qa=function(){function t(e){this.args=e;this.type=h.StringType}t.parse=function(e,n){return new t(e.slice(1).map(y=>f(y,n)))};t.prototype.evaluate=function(e,n){return this.args.map(y=>y.evaluate(e,n)).join("")};return t}(),ha=function(){function t(e,n){this.arg=e;this.calculate=n;this.type=h.StringType}t.parse=function(e,n){if(2!==e.length)throw Error(`${e[0]} expects 1 argument`);n=f(e[1],n);return new t(n,t.ops[e[0]])};t.prototype.evaluate=
function(e,n){return this.calculate(this.arg.evaluate(e,n))};return t}();ha.ops={downcase:t=>t.toLowerCase(),upcase:t=>t.toUpperCase()};let ra=function(){function t(n){this.args=n;this.type=h.ColorType}t.parse=function(n,y){if(4!==n.length)throw Error('"rgb" expects 3 arguments');n=n.slice(1).map(E=>f(E,y));return new t(n)};var e=t.prototype;e.evaluate=function(n,y){const E=this._validate(this.args[0].evaluate(n,y)),H=this._validate(this.args[1].evaluate(n,y));n=this._validate(this.args[2].evaluate(n,
y));return new w({r:E,g:H,b:n})};e._validate=function(n){if("number"!==typeof n||0>n||255<n)throw Error(`${n}: invalid color component`);return Math.round(n)};return t}(),sa=function(){function t(n){this.args=n;this.type=h.ColorType}t.parse=function(n,y){if(5!==n.length)throw Error('"rgba" expects 4 arguments');n=n.slice(1).map(E=>f(E,y));return new t(n)};var e=t.prototype;e.evaluate=function(n,y){const E=this._validate(this.args[0].evaluate(n,y)),H=this._validate(this.args[1].evaluate(n,y)),P=this._validate(this.args[2].evaluate(n,
y));n=this._validateAlpha(this.args[3].evaluate(n,y));return new w({r:E,g:H,b:P,a:n})};e._validate=function(n){if("number"!==typeof n||0>n||255<n)throw Error(`${n}: invalid color component`);return Math.round(n)};e._validateAlpha=function(n){if("number"!==typeof n||0>n||1<n)throw Error(`${n}: invalid alpha color component`);return n};return t}(),ta=function(){function t(e){this.color=e;this.type=h.arrayType(h.NumberType,4)}t.parse=function(e,n){if(2!==e.length)throw Error('"to-rgba" expects 1 argument');
e=f(e[1],n);return new t(e)};t.prototype.evaluate=function(e,n){return(new w(this.color.evaluate(e,n))).toRgba()};return t}(),fa=function(){function t(e,n){this.type=e;this.args=n}t.parse=function(e,n){var y=e[0];if(2>e.length)throw Error(`${y} expects at least one argument`);let E=1,H;if("array"===y){if(2<e.length){switch(e[1]){case "string":H=h.StringType;break;case "number":H=h.NumberType;break;case "boolean":H=h.BooleanType;break;default:throw Error('"array" type argument must be string, number or boolean');
}E++}else H=h.ValueType;if(3<e.length){var P=e[2];if(null!==P&&("number"!==typeof P||0>P||P!==Math.floor(P)))throw Error('"array" length argument must be a positive integer literal');E++}H=h.arrayType(H,P)}else switch(y){case "string":H=h.StringType;break;case "number":H=h.NumberType;break;case "boolean":H=h.BooleanType;break;case "object":H=h.ObjectType}for(y=[];E<e.length;E++)P=f(e[E],n),y.push(P);return new t(H,y)};t.prototype.evaluate=function(e,n){let y;for(const E of this.args){const H=E.evaluate(e,
n);y=h.getType(H);if(h.matchType(y,this.type))return H}throw Error(`Expected ${h.typeToString(this.type)} but got ${h.typeToString(y)}`);};return t}(),da=function(){function t(e,n){this.type=e;this.args=n}t.parse=function(e,n){var y=e[0];const E=t.types[y];if(E===h.BooleanType||E===h.StringType){if(2!==e.length)throw Error(`${y} expects one argument`);}else if(2>e.length)throw Error(`${y} expects at least one argument`);y=[];for(let H=1;H<e.length;H++){const P=f(e[H],n);y.push(P)}return new t(E,y)};
t.prototype.evaluate=function(e,n){if(this.type===h.BooleanType)return!!this.args[0].evaluate(e,n);if(this.type===h.StringType)return h.valueToString(this.args[0].evaluate(e,n));if(this.type===h.NumberType){for(const E of this.args){var y=Number(E.evaluate(e,n));if(!isNaN(y))return y}return null}if(this.type===h.ColorType){for(y of this.args)try{const E=t.toColor(y.evaluate(e,n));if(E instanceof w)return E}catch{}return null}};t.toBoolean=function(e){return!!e};t.toString=function(e){return h.valueToString(e)};
t.toNumber=function(e){const n=Number(e);if(isNaN(n))throw Error(`"${e}" is not a number`);return n};t.toColor=function(e){if(e instanceof w)return e;if("string"===typeof e){const n=w.fromString(e);if(n)return n;throw Error(`"${e}" is not a color`);}if(Array.isArray(e))return w.fromArray(e);throw Error(`"${e}" is not a color`);};return t}();da.types={"to-boolean":h.BooleanType,"to-color":h.ColorType,"to-number":h.NumberType,"to-string":h.StringType};let ua=function(){function t(e){this.val=e;this.type=
h.getType(e)}t.parse=function(e){if(2!==e.length)throw Error('"literal" expects 1 argument');return new t(e[1])};t.prototype.evaluate=function(e,n){return this.val};return t}(),va=function(){function t(e){this.arg=e;this.type=h.StringType}t.parse=function(e,n){if(2!==e.length)throw Error('"typeof" expects 1 argument');return new t(f(e[1],n))};t.prototype.evaluate=function(e,n){return h.typeToString(h.getType(this.arg.evaluate(e,n)))};return t}();const ia={array:fa,boolean:fa,collator:null,format:null,
image:null,literal:ua,number:fa,"number-format":null,object:fa,string:fa,"to-boolean":da,"to-color":da,"to-number":da,"to-string":da,typeof:va,accumulated:null,"feature-state":null,"geometry-type":b,id:a,"line-progress":null,properties:m,at:K,get:I,has:S,in:V,"index-of":aa,length:ca,slice:Y,"!":A,"!\x3d":c,"\x3c":d,"\x3c\x3d":x,"\x3d\x3d":k,"\x3e":D,"\x3e\x3d":C,all:u,any:z,case:L,coalesce:M,match:O,within:null,interpolate:N,"interpolate-hcl":N,"interpolate-lab":N,step:Q,let:R,var:G,concat:qa,downcase:ha,
"is-supported-script":null,"resolved-locale":null,upcase:ha,rgb:ra,rgba:sa,"to-rgba":ta,"-":ka,"*":la,"/":ma,"%":na,"^":oa,"+":pa,abs:W,acos:W,asin:W,atan:W,ceil:W,cos:W,e:W,floor:W,ln:W,ln2:W,log10:W,log2:W,max:W,min:W,pi:W,round:W,sin:W,sqrt:W,tan:W,zoom:p,"heatmap-density":null,"has-id":Z,none:J};B.ALL=u;B.ANY=z;B.Add=pa;B.Assert=fa;B.At=K;B.Calculate=W;B.Case=L;B.Coalesce=M;B.Coerce=da;B.Concat=qa;B.Div=ma;B.EQ=k;B.GE=C;B.GT=D;B.GeomType=b;B.Get=I;B.Has=S;B.HasID=Z;B.ID=a;B.In=V;B.IndexOf=aa;
B.Interpolate=N;B.LE=x;B.LT=d;B.Length=ca;B.Let=R;B.Literal=ua;B.Match=O;B.Mod=na;B.Mul=la;B.NE=c;B.NONE=J;B.NOT=A;B.Pow=oa;B.Properties=m;B.Rgb=ra;B.Rgba=sa;B.Slice=Y;B.Step=Q;B.String=ha;B.Sub=ka;B.ToRgba=ta;B.TypeOf=va;B.Var=G;B.Zoom=p;B.createExpression=f;B.ops=ia;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/core/colorUtils":function(){define(["exports"],function(B){function F(a,b){const m=[];let p,q;if(a[0].length!==b.length)throw"dimensions do not match";const k=a.length,c=a[0].length;
let d=0;for(p=0;p<k;p++){for(q=d=0;q<c;q++)d+=a[p][q]*b[q];m.push(d)}return m}function w(a){a=[a.r/255,a.g/255,a.b/255].map(b=>.04045>=b?b/12.92:((b+.055)/1.055)**2.4);a=F(f,a);return{x:100*a[0],y:100*a[1],z:100*a[2]}}function l(a){a=F(g,[a.x/100,a.y/100,a.z/100]).map(b=>Math.min(1,Math.max(.0031308>=b?12.92*b:1.055*b**(1/2.4)-.055,0)));return{r:Math.round(255*a[0]),g:Math.round(255*a[1]),b:Math.round(255*a[2])}}function r(a){a=[a.x/95.047,a.y/100,a.z/108.883].map(b=>b>(6/29)**3?b**(1/3):1/3*(29/
6)**2*b+4/29);return{l:116*a[1]-16,a:500*(a[0]-a[1]),b:200*(a[1]-a[2])}}function v(a){const b=a.l;a=[(b+16)/116+a.a/500,(b+16)/116,(b+16)/116-a.b/200].map(m=>m>6/29?m**3:3*(6/29)**2*(m-4/29));return{x:95.047*a[0],y:100*a[1],z:108.883*a[2]}}function h(a){if("r"in a&&"g"in a&&"b"in a)return a;if("l"in a&&"c"in a&&"h"in a){var b=a.c;var m=a.h;b={l:a.l,a:b*Math.cos(m),b:b*Math.sin(m)};return l(v(b))}if("l"in a&&"a"in a&&"b"in a)return l(v(a));if("x"in a&&"y"in a&&"z"in a)return l(a);if("h"in a&&"s"in
a&&"v"in a){{m=(a.h+360)%360/60;b=a.v/100*255;a=a.s/100*b;const p=a*(1-Math.abs(m%2-1));switch(Math.floor(m)){case 0:m={r:a,g:p,b:0};break;case 1:m={r:p,g:a,b:0};break;case 2:m={r:0,g:a,b:p};break;case 3:m={r:0,g:p,b:a};break;case 4:m={r:p,g:0,b:a};break;case 5:case 6:m={r:a,g:0,b:p};break;default:m={r:0,g:0,b:0}}m.r=Math.round(m.r+b-a);m.g=Math.round(m.g+b-a);m.b=Math.round(m.b+b-a);b=m}return b}return a}const f=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],g=[[3.2406,-1.5372,-.4986],
[-.9689,1.8758,.0415],[.0557,-.204,1.057]];B.darken=function(a,b){a=r(w(a));a.l*=1-b;return l(v(a))};B.toHSV=function(a){if("h"in a&&"s"in a&&"v"in a)return a;var b=h(a);{a=b.r;const m=b.g,p=b.b;b=Math.max(a,m,p);const q=b-Math.min(a,m,p);a=0===q?0:b===a?(m-p)/q%6:b===m?(p-a)/q+2:(a-m)/q+4;0>a&&(a+=6);a={h:60*a,s:100*(0===q?0:q/b),v:100/255*b}}return a};B.toLAB=function(a){return"l"in a&&"a"in a&&"b"in a?a:r(w(h(a)))};B.toLCH=function(a){if(!("l"in a&&"c"in a&&"h"in a)){{var b=r(w(h(a)));a=b.l;var m=
b.a;const p=b.b;b=Math.sqrt(m*m+p*p);m=Math.atan2(p,m);m=0<m?m:m+2*Math.PI;a={l:a,c:b,h:m}}}return a};B.toRGB=h;B.toXYZ=function(a){return"x"in a&&"y"in a&&"z"in a?a:w(h(a))};Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/expression/types":function(){define(["exports","../../../../../Color"],function(B,F){function w(k,c){return{kind:"array",itemType:k,n:c}}function l(k){if("array"===k.kind){const c=l(k.itemType);return"number"===typeof k.n?`array<${c}, ${k.n}>`:
"value"===k.itemType.kind?"array":`array<${c}>`}return k.kind}function r(k){if(null===k)return h;if("string"===typeof k)return g;if("boolean"===typeof k)return a;if("number"===typeof k)return f;if(k instanceof F)return b;if(Array.isArray(k)){let c;for(const d of k){const x=r(d);if(!c)c=x;else if(c!==x){c=p;break}}return w(c||p,k.length)}return"object"===typeof k?m:p}function v(k,c){if("array"===c.kind)return"array"===k.kind&&(0===k.n&&"value"===k.itemType.kind||v(k.itemType,c.itemType))&&("number"!==
typeof c.n||c.n===k.n);if("value"===c.kind)for(const d of q)if(v(k,d))return!0;return c.kind===k.kind}const h={kind:"null"},f={kind:"number"},g={kind:"string"},a={kind:"boolean"},b={kind:"color"},m={kind:"object"},p={kind:"value"},q=[h,f,g,a,b,m,w(p)];B.BooleanType=a;B.ColorType=b;B.NullType=h;B.NumberType=f;B.ObjectType=m;B.StringType=g;B.ValueType=p;B.arrayType=w;B.getType=r;B.matchType=v;B.typeToString=l;B.valueToString=function(k){if(null===k)return"";const c=typeof k;return"string"===c?k:"number"===
c||"boolean"===c?String(k):k instanceof F?k.toString():JSON.stringify(k)};Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleDefinition":function(){define(["exports"],function(B){let F=function(){};F.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0}};F.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0}};F.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0},
"line-cap":{type:"enum",values:["butt","round","square"],default:0},"line-join":{type:"enum",values:["bevel","round","miter"],default:2},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}};F.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:0},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",
minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:0},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",
default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:2},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:0},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},
"text-justify":{type:"enum",values:["auto","left","center","right"],default:2},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",
default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:2},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:0},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[0]}};F.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0}};F.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",
minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}};F.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:0}};F.linePaintDefinition={"line-blur":{type:"number",
minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:0},"line-width":{type:"number",minimum:0,default:1}};
F.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:0},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",
minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:0}};F.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",
minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};F.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",
minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:0}};B.StyleDefinition=F;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleProperty":function(){define(["../../../../../Color",
"../GeometryUtils","../expression/expression","../expression/types"],function(B,F,w,l){return function(){function r(h,f){this.isDataDriven=!1;this.interpolator=null;switch(h.type){case "number":var g=!0;break;case "color":g=!0;break;case "array":g="number"===h.value;break;default:g=!1}null==f&&(f=h.default);if(Array.isArray(f)&&0<f.length&&w.ops[f[0]]){g={number:l.NumberType,color:l.ColorType,string:l.StringType,boolean:l.BooleanType,enum:l.StringType};try{var a="array"===h.type?l.arrayType(g[h.value]||
l.ValueType,h.length):g[h.type];const b=w.createExpression(f,null,a);this.getValue=this._buildExpression(b,h);this.isDataDriven=!0;b instanceof w.Interpolate&&b.input instanceof w.Zoom&&(this.interpolator=b)}catch(b){console.log(b.message),this.getValue=this._buildSimple(h.default)}}else{g&&"interval"===f.type&&(g=!1);if(a=f&&f.stops&&0<f.stops.length)for(const b of f.stops)b[1]=this._validate(b[1],h);if(this.isDataDriven=f?!!f.property:!1)if(void 0!==f.default&&(f.default=this._validate(f.default,
h)),a)switch(f.type){case "identity":this.getValue=this._buildIdentity(f,h);break;case "categorical":this.getValue=this._buildCategorical(f,h);break;default:this.getValue=g?this._buildInterpolate(f,h):this._buildInterval(f,h)}else this.getValue=this._buildIdentity(f,h);else a?this.getValue=g?this._buildZoomInterpolate(f):this._buildZoomInterval(f):(f=this._validate(f,h),this.getValue=this._buildSimple(f))}}var v=r.prototype;v._validate=function(h,f){if("number"===f.type){if(h<f.minimum)return f.minimum;
if(h>f.maximum)return f.maximum}else"color"===f.type?h=r._parseColor(h):"enum"===f.type?"string"===typeof h&&(h=f.values.indexOf(h)):"array"===f.type&&"enum"===f.value?h=h.map(g=>"string"===typeof g?f.values.indexOf(g):g):"string"===f.type&&(h=l.valueToString(h));return h};v._buildSimple=function(h){return()=>h};v._buildExpression=function(h,f){return(g,a)=>{try{const b=h.evaluate(a,g);return void 0===b?f.default:this._validate(b,f)}catch(b){return console.log(b.message),f.default}}};v._buildIdentity=
function(h,f){return(g,a)=>{let b;a&&(b=a.values[h.property]);void 0!==b&&(b=this._validate(b,f));return null!=b?b:void 0!==h.default?h.default:f.default}};v._buildCategorical=function(h,f){return(g,a)=>{let b;a&&(b=a.values[h.property]);b=this._categorical(b,h.stops);return void 0!==b?b:void 0!==h.default?h.default:f.default}};v._buildInterval=function(h,f){return(g,a)=>{let b;a&&(b=a.values[h.property]);return"number"===typeof b?this._interval(b,h.stops):void 0!==h.default?h.default:f.default}};
v._buildInterpolate=function(h,f){return(g,a)=>{let b;a&&(b=a.values[h.property]);return"number"===typeof b?this._interpolate(b,h.stops,h.base||1):void 0!==h.default?h.default:f.default}};v._buildZoomInterpolate=function(h){return f=>this._interpolate(f,h.stops,h.base||1)};v._buildZoomInterval=function(h){return f=>this._interval(f,h.stops)};v._categorical=function(h,f){const g=f.length;for(let a=0;a<g;a++)if(f[a][0]===h)return f[a][1]};v._interval=function(h,f){const g=f.length;let a=0;for(let b=
0;b<g;b++)if(f[b][0]<=h)a=b;else break;return f[a][1]};v._interpolate=function(h,f,g){const a=f.length;for(let p=0;p<a;p++){const q=f[p];if(q[0]<=h)var b=q;else{var m=q;break}}if(b&&m){f=m[0]-b[0];h-=b[0];g=1===g?h/f:(g**h-1)/(g**f-1);if(Array.isArray(b[1])){b=b[1];m=m[1];h=[];for(f=0;f<b.length;f++)h.push(F.interpolate(b[f],m[f],g));return h}return F.interpolate(b[1],m[1],g)}if(b)return b[1];if(m)return m[1]};r._isEmpty=function(h){for(const f in h)if(h.hasOwnProperty(f))return!1;return!0};r._parseColor=
function(h){if(Array.isArray(h))return h;"string"===typeof h&&(h=new B(h));if(h instanceof B&&!this._isEmpty(h))return B.toUnitRGBA(h)};return r}()})},"esri/views/2d/layers/LayerView2D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/collectionUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../engine/Container ../../layers/support/ClipArea ../../layers/support/ClipRect ../../layers/support/Geometry ../../layers/support/Path".split(" "),
function(B,F,w,l,r,v,h,f,g,a,b,m,p,q,k,c){const d=l.ofType({key:"type",base:p,typeMap:{rect:q,path:c,geometry:k}});B.LayerView2DMixin=x=>{x=function(D){function C(){var u=D.apply(this,arguments)||this;u.clips=new d;u.moving=!1;u.attached=!1;u.lastUpdateId=-1;u.updateRequested=!1;return u}F._inheritsLoose(C,D);var A=C.prototype;A.initialize=function(){var u;this.container||(this.container=new m.Container);this.container.fadeTransitionEnabled=!0;this.container.opacity=0;this.container.clips=this.clips;
this.handles.add([v.init(this,"suspended",z=>{this.container&&(this.container.visible=!z);this.view&&!z&&this.updateRequested&&this.view.requestUpdate()},!0),v.init(this,["layer.opacity","container"],()=>{if(this.container){var z,J;this.container.opacity=null!=(z=null==(J=this.layer)?void 0:J.opacity)?z:1}},!0),v.init(this,["layer.blendMode"],z=>{this.container&&(this.container.blendMode=z)},!0),v.init(this,["layer.effect"],z=>{this.container&&(this.container.effect=z)},!0),this.clips.on("change",
()=>{this.container.clips=this.clips;this.notifyChange("clips")})]);null!=(u=this.view)&&u.whenLayerView?this.view.whenLayerView(this.layer).then(z=>{z!==this||this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{}):this.when().then(()=>{this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{})};A.destroy=function(){this.attached&&(this.detach(),this.attached=!1);this.handles.remove("initialize");this.updateRequested=!1};A.isVisibleAtScale=
function(u){var z=!0,J=this.layer;const L=J.minScale;J=J.maxScale;if(null!=L&&null!=J){z=!L;let M=!J;!z&&u<=L&&(z=!0);!M&&u>=J&&(M=!0);z=z&&M}return z};A.requestUpdate=function(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())};A.processUpdate=function(u){this.isFulfilled()&&!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",u),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(u)))};A.hitTest=
function(u,z){return Promise.resolve(null)};A.isUpdating=function(){return!1};A.isRendering=function(){return!1};A.canResume=function(){return D.prototype.canResume.call(this)?this.isVisibleAtScale(this.view.scale):!1};F._createClass(C,[{key:"updating",get:function(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!(!this.updatingHandles||!this.updatingHandles.updating)}}]);return C}(x);w.__decorate([h.property({type:d,set(D){D=r.referenceSetter(D,this._get("clips"),
d);this._set("clips",D)}})],x.prototype,"clips",void 0);w.__decorate([h.property()],x.prototype,"moving",void 0);w.__decorate([h.property()],x.prototype,"attached",void 0);w.__decorate([h.property()],x.prototype,"container",void 0);w.__decorate([h.property()],x.prototype,"suspended",void 0);w.__decorate([h.property({readOnly:!0})],x.prototype,"updateParameters",void 0);w.__decorate([h.property()],x.prototype,"updateRequested",void 0);w.__decorate([h.property()],x.prototype,"updating",null);w.__decorate([h.property()],
x.prototype,"view",void 0);return x=w.__decorate([b.subclass("esri.views.2d.layers.LayerView2D")],x)};Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/layers/support/ClipArea":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/set ../../../core/accessorSupport/decorators/subclass".split(" "),
function(B,F,w,l,r,v,h,f,g){w=function(a){function b(){return a.apply(this,arguments)||this}B._inheritsLoose(b,a);return b}(w.JSONSupport);return w=F.__decorate([g.subclass("esri.views.layers.support.ClipArea")],w)})},"esri/views/layers/support/ClipRect":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),
function(B,F,w,l,r,v,h,f){var g;l=g=function(a){function b(){var m=a.apply(this,arguments)||this;m.type="rect";m.left=null;m.right=null;m.top=null;m.bottom=null;return m}B._inheritsLoose(b,a);b.prototype.clone=function(){return new g({left:this.left,right:this.right,top:this.top,bottom:this.bottom})};B._createClass(b,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return b}(f);F.__decorate([w.property({type:[Number,String],json:{write:!0}})],l.prototype,"left",void 0);F.__decorate([w.property({type:[Number,
String],json:{write:!0}})],l.prototype,"right",void 0);F.__decorate([w.property({type:[Number,String],json:{write:!0}})],l.prototype,"top",void 0);F.__decorate([w.property({type:[Number,String],json:{write:!0}})],l.prototype,"bottom",void 0);F.__decorate([w.property({readOnly:!0})],l.prototype,"version",null);return l=g=F.__decorate([h.subclass("esri.views.layers.support.ClipRect")],l)})},"esri/views/layers/support/Geometry":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../geometry/Geometry ../../../geometry/support/jsonUtils ./ClipArea ../../../geometry/Extent ../../../geometry/Polygon".split(" "),
function(B,F,w,l,r,v,h,f,g,a,b,m,p){var q;w={base:g,key:"type",typeMap:{extent:m,polygon:p}};b=q=function(k){function c(){var d=k.apply(this,arguments)||this;d.type="geometry";d.geometry=null;return d}B._inheritsLoose(c,k);c.prototype.clone=function(){return new q({geometry:this.geometry.clone()})};B._createClass(c,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return c}(b);F.__decorate([l.property({types:w,json:{read:a.fromJSON,write:!0}})],b.prototype,"geometry",void 0);F.__decorate([l.property({readOnly:!0})],
b.prototype,"version",null);return b=q=F.__decorate([f.subclass("esri.views.layers.support.Geometry")],b)})},"esri/views/layers/support/Path":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),function(B,F,w,l,r,v,h,f){l=function(g){function a(){var b=g.apply(this,
arguments)||this;b.type="path";b.path=[];return b}B._inheritsLoose(a,g);B._createClass(a,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return a}(f);F.__decorate([w.property({type:[[[Number]]],json:{write:!0}})],l.prototype,"path",void 0);F.__decorate([w.property({readOnly:!0})],l.prototype,"version",null);return l=F.__decorate([h.subclass("esri.views.layers.support.Path")],l)})},"esri/views/2d/layers/support/Display":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers",
"../../engine/Bitmap","../../engine/BitmapContainer"],function(B,F,w,l){l=function(r){function v(f){var g=r.call(this)||this;g.requestRender=g.requestRender.bind(F._assertThisInitialized(g));g._layerView=f;g._canvas=document.createElement("canvas");g._context=g._canvas.getContext("2d");g._bitmap=new w.Bitmap(null,"standard",!1);g.addChild(g._bitmap);return g}F._inheritsLoose(v,r);var h=v.prototype;h.doRender=function(f){const g=f.state,a=this._createCustomRenderParams(f),b=this._canvas,m=this._bitmap,
p=window.devicePixelRatio;b.width=g.size[0]*p;b.height=g.size[1]*p;m.resolution=g.resolution;const q=g.clone();q.pixelRatio=p;m.pixelRatio=p;a.state=q;m.x=g.viewpoint.targetGeometry.x-Math.abs(g.extent.xmax-g.extent.xmin)/2;m.y=g.viewpoint.targetGeometry.y+Math.abs(g.extent.ymax-g.extent.ymin)/2;this._layerView.render(a);m.source=b;m.rotation=g.rotation;r.prototype.doRender.call(this,{...f,state:q})};h._createCustomRenderParams=function(f){return{globalOpacity:f.globalOpacity,state:f.state,stationary:f.stationary,
pixelRatio:window.devicePixelRatio,context:this._context}};return v}(l.BitmapContainer);B.Display=l;B.default=l;Object.defineProperty(B,"__esModule",{value:!0})})},"esri/views/2d/tiling/TileInfoViewPOT":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../layers/support/TileInfo","./TileInfoView","./TileKey"],function(B,F,w,l){return function(r){function v(){var f=r.apply(this,arguments)||this;f._fullCacheLodInfos=null;f._levelByScale={};return f}B._inheritsLoose(v,r);var h=v.prototype;
h.getTileParentId=function(f){f=l.pool.acquire(f);const g=0===f.level?null:l.getId(f.level-1,f.row>>1,f.col>>1,f.world);l.pool.release(f);return g};h.getTileCoverage=function(f,g,a){f=r.prototype.getTileCoverage.call(this,f,g,a);if(!f)return f;const b=1<<f.lodInfo.level;f.spans=f.spans.filter(m=>0<=m.row&&m.row<b);return f};h.scaleToLevel=function(f){this._fullCacheLodInfos||this._initializeFullCacheLODs(this._lodInfos);if(this._levelByScale[f])return this._levelByScale[f];{var g=this._fullCacheLodInfos;
if(f>g[0].scale)return g[0].level;let a;for(let b=0;b<g.length-1;b++)if(a=g[b+1],f>a.scale)return g=g[b],g.level+(g.scale-f)/(g.scale-a.scale);return g[g.length-1].level}};h._initializeFullCacheLODs=function(f){f=0===f[0].level?f.map(g=>({level:g.level,resolution:g.resolution,scale:g.scale})):F.create({size:this.tileInfo.size[0],spatialReference:this.tileInfo.spatialReference}).lods.map(g=>({level:g.level,resolution:g.resolution,scale:g.scale}));for(let g=0;g<f.length;g++)this._levelByScale[f[g].scale]=
f[g].level;this._fullCacheLodInfos=f};return v}(w)})},"*noref":1}});
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/Error ../../../core/lang ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/diffUtils ../../../geometry/support/aaBoundingRect ../engine/vectorTiles/TileHandler ../engine/vectorTiles/TileManager ../engine/vectorTiles/VectorTile ../engine/vectorTiles/VectorTileContainer ../engine/vectorTiles/decluttering/debugging ../engine/vectorTiles/style/StyleRepository ./LayerView2D ./support/Display ../tiling/TileInfoViewPOT ../tiling/TileQueue ../../layers/LayerView".split(" "),function(B,
F,w,l,r,v,h,f,g,a,b,m,p,q,k,c,d,x,D,C,A,u,z,J,L){function M(N){if(h.isNone(N))return 0;switch(N.type){case "partial":return Object.keys(N.diff).length;case "complete":return Math.max(Object.keys(N.oldValue).length,Object.keys(N.newValue).length);case "collection":return Object.keys(N.added).length+Object.keys(N.changed).length+Object.keys(N.removed).length}}const O=v.getLogger("esri.views.2d.layers.VectorTileLayerView2D");v=function(N){function Q(){var G=N.apply(this,arguments)||this;G._styleChanges=
[];G._fetchQueue=null;G._parseQueue=null;G._isTileHandlerReady=!1;G.fading=!1;return G}B._inheritsLoose(Q,N);var R=Q.prototype;R.initialize=function(){var G=this.layer.tileInfo;(G&&G.spatialReference).equals(this.view.spatialReference)?({style:G}=this.layer.currentStyleInfo,this._styleRepository=new C(G),this._tileInfoView=new z(this.layer.tileInfo,this.layer.fullExtent),this._vectorTileContainer=new x.VectorTileContainer(this._tileInfoView),this._tileHandler=new k.TileHandler(this.layer,this._styleRepository,
window.devicePixelRatio||1),this.container.addChild(this._vectorTileContainer),this.handles.add([this._vectorTileContainer.on("fade-start",()=>{this.fading=!0;this.notifyChange("updating");this.requestUpdate()}),this._vectorTileContainer.on("fade-complete",()=>{this._collisionBoxesDisplay&&this._collisionBoxesDisplay.requestRender();this.fading=!1;this.notifyChange("updating");this.requestUpdate()}),g.init(this.layer,"symbolCollisionBoxesVisible",K=>{K?(this._collisionBoxesDisplay=new u.Display({render:I=>
this._renderCollisionBoxes(I.context)}),this.container.addChild(this._collisionBoxesDisplay)):(this.container.removeChild(this._collisionBoxesDisplay),this._collisionBoxesDisplay=null)})])):this.addResolvingPromise(Promise.reject(new l("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer})))};R.destroy=function(){var G;this._stop();this.container.removeAllChildren();this._vectorTileContainer&&(this._vectorTileContainer.destroy(),
this._vectorTileContainer=null);null==(G=this._tileHandler)?void 0:G.destroy();this._tileHandler=null};R.hitTest=function(){var G=B._asyncToGenerator(function*(K,I){if(!this._tileHandlerPromise)return null;yield this._tileHandlerPromise;K=yield this._vectorTileContainer.hitTest(I);if(!K||0===K.length)return null;K=K[0]-1;var S=this._styleRepository;I=S.getStyleLayerByUID(K);if(!I)return null;S=S.getStyleLayerIndex(I.id);K=new w({attributes:{layerId:S,layerName:I.id,layerUID:K}});K.layer=this.layer;
K.sourceLayer=this.layer;return[K]});return function(K,I){return G.apply(this,arguments)}}();R.update=function(G){this._tileHandlerPromise&&this._isTileHandlerReady&&(G.pixelRatio!==this._tileHandler.devicePixelRatio?(this._start(),this._tileHandler.devicePixelRatio=G.pixelRatio):0<this._styleChanges.length?this._tileHandlerPromise=this._applyStyleChanges():(this._fetchQueue.pause(),this._parseQueue.pause(),this._fetchQueue.state=G.state,this._parseQueue.state=G.state,this._tileManager.update(G)||
this.requestUpdate(),this._parseQueue.resume(),this._fetchQueue.resume()))};R.attach=function(){this._start();this.handles.add([this.layer.on("paint-change",G=>{if(G.isDataDriven)this._styleChanges.push({type:0,data:G}),this.notifyChange("updating"),this.requestUpdate();else{const I=this._styleRepository;var K=I.getLayerById(G.layer);K&&(K=3===K.type,I.setPaintProperties(G.layer,G.paint),K&&this._vectorTileContainer.restartDeclutter(),this._vectorTileContainer.requestRender())}}),this.layer.on("layout-change",
G=>{const K=this._styleRepository,I=K.getLayerById(G.layer);if(I){var S=p.diff(I.layout,G.layout);h.isNone(S)||(p.hasDiff(S,"visibility")&&1===M(S)?(K.setLayoutProperties(G.layer,G.layout),3===I.type&&this._vectorTileContainer.restartDeclutter(),this._vectorTileContainer.requestRender()):(this._styleChanges.push({type:1,data:G}),this.notifyChange("updating"),this.requestUpdate()))}}),this.layer.on("style-layer-visibility-change",G=>{const K=this._styleRepository,I=K.getLayerById(G.layer);I&&(K.setStyleLayerVisibility(G.layer,
G.visibility),3===I.type&&this._vectorTileContainer.restartDeclutter(),this._vectorTileContainer.requestRender())}),this.layer.on("style-layer-change",G=>{this._styleChanges.push({type:2,data:G});this.notifyChange("updating");this.requestUpdate()}),this.layer.on("delete-style-layer",G=>{this._styleChanges.push({type:3,data:G});this.notifyChange("updating");this.requestUpdate()}),this.layer.on("load-style",()=>this._loadStyle())],this.declaredClass)};R.detach=function(){this._stop();this.handles.remove(this.declaredClass)};
R.moveStart=function(){this.requestUpdate()};R.viewChange=function(){this.requestUpdate()};R.moveEnd=function(){this._collisionBoxesDisplay&&this._vectorTileContainer.restartDeclutter();this.requestUpdate()};R.canResume=function(){let G=N.prototype.canResume.call(this);var K=this.layer;if(G&&K.currentStyleInfo){const I=this.view.scale;(K=K.currentStyleInfo)&&K.layerDefinition&&(K=K.layerDefinition,K.minScale&&K.minScale<I&&(G=!1),K.maxScale&&K.maxScale>I&&(G=!1))}return G};R.isUpdating=function(){const G=
this._vectorTileContainer.children;return!this._isTileHandlerReady||!this._fetchQueue||!this._parseQueue||this._fetchQueue.updating||this._parseQueue.updating||0<G.length&&0<G.filter(K=>K.invalidating).length||this.fading};R.acquireTile=function(G){const K=this._createVectorTile(G);this._tileHandlerPromise.then(()=>{this._fetchQueue.push(K.key).then(I=>this._parseQueue.push({key:K.key,data:I})).then(I=>{K.once("attach",()=>this.requestUpdate());K.setData(I);this.requestUpdate();this.notifyChange("updating")}).catch(I=>
{this.notifyChange("updating");f.isAbortError(I)||O.error(I)})});return K};R.releaseTile=function(G){G=G.key.id;this._fetchQueue.abort(G);this._parseQueue.abort(G);this.requestUpdate()};R._start=function(){this._stop();this._tileManager=new c.TileManager({acquireTile:I=>this.acquireTile(I),releaseTile:I=>this.releaseTile(I),tileInfoView:this._tileInfoView},this._vectorTileContainer);if(this.layer.currentStyleInfo){var G=new AbortController,K=this._tileHandler.start({signal:G.signal}).then(()=>{this._fetchQueue=
new J({tileInfoView:this._tileInfoView,process:(I,S)=>this._getTileData(I,S),concurrency:15});this._parseQueue=new J({tileInfoView:this._tileInfoView,process:(I,S)=>this._parseTileData(I,S),concurrency:8});this.requestUpdate();this._isTileHandlerReady=!0});this._tileHandler.spriteMosaic.then(I=>{this._vectorTileContainer.setStyleResources(I,this._tileHandler.glyphMosaic,this._styleRepository);this.requestUpdate()});this._tileHandlerAbortController=G;this._tileHandlerPromise=K}};R._stop=function(){if(this._tileHandlerAbortController&&
this._vectorTileContainer){var G=this._tileHandlerAbortController;G&&G.abort();this._tileHandlerPromise=null;this._isTileHandlerReady=!1;this._fetchQueue&&(this._fetchQueue.destroy(),this._fetchQueue=null);this._parseQueue&&(this._parseQueue.destroy(),this._parseQueue=null);this._tileManager&&(this._tileManager.destroy(),this._tileManager=null);this._vectorTileContainer.removeAllChildren()}};R._getTileData=function(){var G=B._asyncToGenerator(function*(K,I){K=yield this._tileHandler.fetchTileData(K,
I);this.notifyChange("updating");return K});return function(K,I){return G.apply(this,arguments)}}();R._parseTileData=function(){var G=B._asyncToGenerator(function*(K,I){return this._tileHandler.parseTileData(K,I)});return function(K,I){return G.apply(this,arguments)}}();R._applyStyleChanges=function(){var G=B._asyncToGenerator(function*(){this._isTileHandlerReady=!1;this._fetchQueue.pause();this._parseQueue.pause();this._fetchQueue.clear();this._parseQueue.clear();this._tileManager.clearCache();var K=
this._styleChanges;try{yield this._tileHandler.updateStyle(K)}catch(Y){O.error("error applying vector-tiles style update",Y.message),this._fetchQueue.resume(),this._parseQueue.resume(),this._isTileHandlerReady=!0}const I=this._styleRepository,S=[];K.forEach(Y=>{3===Y.type&&(Y=I.getLayerById(Y.data.layer))&&S.push(Y.uid)});const V=[];let aa;K.forEach(Y=>{const Z=Y.data;switch(Y.type){case 0:I.setPaintProperties(Z.layer,Z.paint);aa=Z.layer;break;case 1:I.setLayoutProperties(Z.layer,Z.layout);aa=Z.layer;
break;case 3:I.deleteStyleLayer(Z.layer);return;case 2:I.setStyleLayer(Z.layer,Z.index),aa=Z.layer.id}(Y=I.getLayerById(aa))&&V.push(Y.uid)});K=this._vectorTileContainer.children;if(0<S.length){this._vectorTileContainer.deleteStyleLayers(S);for(var ca of K)ca.deleteLayerData(S)}this._fetchQueue.resume();this._parseQueue.resume();if(0<V.length){ca=[];for(const Y of K)K=this._fetchQueue.push(Y.key).then(Z=>this._parseQueue.push({key:Y.key,data:Z,styleLayerUIDs:V})).then(Z=>Y.setData(Z)),ca.push(K);
yield Promise.all(ca)}this._styleChanges=[];this._isTileHandlerReady=!0;this.notifyChange("updating");this.requestUpdate()});return function(){return G.apply(this,arguments)}}();R._loadStyle=function(){var G=B._asyncToGenerator(function*(){var {style:K}=this.layer.currentStyleInfo;K=r.clone(K);this._isTileHandlerReady=!1;this._fetchQueue.pause();this._parseQueue.pause();this._fetchQueue.clear();this._parseQueue.clear();this.notifyChange("updating");this._styleRepository=new C(K);this._vectorTileContainer.destroy();
this._tileManager.clear();this._tileHandlerAbortController.abort();this._tileHandlerAbortController=new AbortController;const {signal:I}=this._tileHandlerAbortController;try{this._tileHandlerPromise=this._tileHandler.setStyle(this._styleRepository,K),yield this._tileHandlerPromise}catch(S){if(!f.isAbortError(S))throw S;}I.aborted||(K=yield this._tileHandler.spriteMosaic,this._vectorTileContainer.setStyleResources(K,this._tileHandler.glyphMosaic,this._styleRepository));this._fetchQueue.resume();this._parseQueue.resume();
this._isTileHandlerReady=!0;this.notifyChange("updating");this.requestUpdate()});return function(){return G.apply(this,arguments)}}();R._createVectorTile=function(G){const K=this._tileInfoView.getTileBounds(q.create(),G);return new d.VectorTile(G,K[0],K[3],512,512,this._styleRepository)};R._renderCollisionBoxes=function(G){for(const K of this._vectorTileContainer.children)if(K.symbols){const I=[];for(const [,S]of K.symbols)I.push(...S);D.drawColliders(G,I)}};return Q}(A.LayerView2DMixin(L));F.__decorate([a.property()],
v.prototype,"_fetchQueue",void 0);F.__decorate([a.property()],v.prototype,"_parseQueue",void 0);F.__decorate([a.property()],v.prototype,"_isTileHandlerReady",void 0);F.__decorate([a.property()],v.prototype,"fading",void 0);return v=F.__decorate([m.subclass("esri.views.2d.layers.VectorTileLayerView2D")],v)});