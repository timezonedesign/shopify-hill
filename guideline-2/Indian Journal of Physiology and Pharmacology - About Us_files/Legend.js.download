// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./support/ActiveLayerInfo ../../intl/locale".split(" "),function(E,M,v,A,u,J,H,I,R,p,z,d,e,c){const h=u.ofType(e),
g="esri.layers.BuildingSceneLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.TileLayer esri.layers.VoxelLayer esri.layers.WFSLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer".split(" "),
n=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];v=function(B){function r(l){l=B.call(this,l)||this;l._handles=new J;l._layerViewByLayerId={};l._layerInfosByLayerViewId={};l._activeLayerInfosByLayerViewId={};l._activeLayerInfosWithNoParent=new u;l.activeLayerInfos=new h;l.basemapLegendVisible=!1;l.groundLegendVisible=!1;l.hideLayersNotInCurrentView=!1;l.keepCacheOnDestroy=!1;l.respectLayerVisibility=!0;l.layerInfos=[];l.view=
null;return l}E._inheritsLoose(r,B);var G=r.prototype;G.initialize=function(){this._handles.add(H.init(this,"view",this._viewHandles),"view");this._handles.add(c.onLocaleChange(()=>this._refresh()))};G.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};G._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(H.init(this,"state",this._stateHandles),"state")};G._stateHandles=function(){this._resetAll();"ready"===this.state&&
this._watchPropertiesAndAllLayerViews()};G._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};G._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};G._destroyViewActiveLayerInfo=function(l){this._handles.remove(l);const t=this._activeLayerInfosByLayerViewId[l];delete this._activeLayerInfosByLayerViewId[l];t&&t.parent&&
t.parent.children.remove(t)};G._watchPropertiesAndAllLayerViews=function(){const {allLayerViews:l}=this.view;l.length&&this._refresh();this._handles.add(l.on("change",this._allLayerViewsChangeHandle.bind(this)),"all-layer-views");this._handles.add(H.watch(this,"layerInfos, basemapLegendVisible, groundLegendVisible",this._propertiesChangeHandle.bind(this)),"legend-properties")};G._allLayerViewsChangeHandle=function(l){l.removed.forEach(t=>this._destroyViewActiveLayerInfo(t.uid));this._refresh()};G._propertiesChangeHandle=
function(){this._destroyViewActiveLayerInfos();this._refresh()};G._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};G._sortActiveLayerInfos=function(l){if(!(2>l.length)){var t=[];l.forEach(w=>{if(!w.parent){var q=w.layer.parent;(q=(q=q&&"uid"in q&&this._layerViewByLayerId[q.uid])&&
this._activeLayerInfosByLayerViewId[q.uid])&&-1!==l.indexOf(q)&&(t.push(w),w.parent=q,q.children.add(w),this._sortActiveLayerInfos(q.children))}});l.removeMany(t);var P={};this.view.allLayerViews.forEach((w,q)=>P[w.layer.uid]=q);l.sort((w,q)=>(P[q.layer.uid]||0)-(P[w.layer.uid]||0))}};G._generateLayerViews=function(){const l=[];n.filter(this._filterLayerViews,this).map(this.get,this).filter(t=>null!=t).forEach(this._collectLayerViews("layerViews",l));return l};G._filterLayerViews=function(l){const t=
!this.groundLegendVisible&&"view.groundView.layerViews"===l;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===l||"view.basemapView.referenceLayerViews"===l))&&!t};G._collectLayerViews=function(l,t){const P=w=>{w&&w.forEach(q=>{t.push(q);P(q[l])});return t};return P};G._filterLayerViewsByLayerInfos=function(l){const t=this.layerInfos;return t&&t.length?t.some(P=>this._hasLayerInfo(P,l)):!0};G._hasLayerInfo=function(l,t){const P=this._isLayerUIDMatching(l.layer,t.layer.uid);P&&
(this._layerInfosByLayerViewId[t.uid]=l);return P};G._isLayerUIDMatching=function(l,t){return l&&(l.uid===t||this._hasLayerUID(l.layers,t))};G._hasLayerUID=function(l,t){return l&&l.some(P=>this._isLayerUIDMatching(P,t))};G._isLayerViewSupported=function(l){return g.includes(l.layer.declaredClass)?(this._layerViewByLayerId[l.layer.uid]=l,!0):!1};G._generateActiveLayerInfo=function(l){this._isLayerActive(l)?this._buildActiveLayerInfo(l):(this._handles.remove(l.uid),this._handles.add(H.watch(l,"legendEnabled, layer.legendEnabled",
()=>this._layerActiveHandle(l)),l.uid))};G._layerActiveHandle=function(l){this._isLayerActive(l)&&(this._handles.remove(l.uid),this._buildActiveLayerInfo(l))};G._isLayerActive=function(l){return this.respectLayerVisibility?l.legendEnabled&&l.get("layer.legendEnabled"):!0};G._buildActiveLayerInfo=function(l){var t,P=l.layer;const w=l.uid;var q=this._layerInfosByLayerViewId[w];let L=this._activeLayerInfosByLayerViewId[w];L||(L=new e({layer:P,layerView:l,title:q&&void 0!==q.title&&q.layer.uid===P.uid?
q.title:P.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:q&&q.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[w]=L);q=P.parent&&"uid"in P.parent&&this._layerViewByLayerId[null==(t=P.parent)?void 0:t.uid];L.parent=this._activeLayerInfosByLayerViewId[null==q?void 0:q.uid];if(!this._handles.has(w)){t=H.watch(P,"title",K=>this._titleHandle(K,L));q=H.watch(P,
"renderer?, opacity, pointSymbol?, lineSymbol?, polygonSymbol?",()=>this._constructLegendElements(L));const U=H.whenTrue(this.view,"stationary",()=>this._scaleHandle(L)),C=H.watch(l,"_effectiveRenderer",()=>this._constructLegendElements(L)),D=H.watch(P,"effect",()=>this._constructLegendElements(L));t=[t,q,U,C,D];this.respectLayerVisibility&&(l=H.watch(l,"legendEnabled",K=>this._legendEnabledHandle(K,L)),P=H.watch(P,"legendEnabled",K=>this._legendEnabledHandle(K,L)),t.push(l,P));this._handles.add(t,
w)}L.isScaleDriven||this._constructLegendElements(L);this._addActiveLayerInfo(L)};G._titleHandle=function(l,t){t.title=l;this._constructLegendElements(t)};G._legendEnabledHandle=function(l,t){l?this._addActiveLayerInfo(t):this._removeActiveLayerInfo(t)};G._scaleHandle=function(l){(l.isScaleDriven||l.hideLayersNotInCurrentView)&&this._constructLegendElements(l)};G._addActiveLayerInfo=function(l){const {layerView:t,layer:P}=l;if(this._isLayerActive(t)&&-1===this.activeLayerInfos.indexOf(l)){var w=l.parent;
if(w)-1===w.children.indexOf(l)&&w.children.push(l),this._sortActiveLayerInfos(w.children);else{var q;w=null==(q=this.layerInfos)?void 0:q.some(L=>L.layer.uid===P.uid);P.parent&&"uid"in P.parent&&!w?this._activeLayerInfosWithNoParent.add(l):(this.activeLayerInfos.add(l),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const L=[];this._activeLayerInfosWithNoParent.forEach(U=>{var C=U.layer.parent;C=C&&"uid"in C&&this._layerViewByLayerId[null==C?void 0:
C.uid];if(C=this._activeLayerInfosByLayerViewId[null==C?void 0:C.uid])L.push(U),U.parent=C});L.length&&(this._activeLayerInfosWithNoParent.removeMany(L),L.forEach(U=>this._addActiveLayerInfo(U)))}}};G._removeActiveLayerInfo=function(l){const t=l.parent;t?t.children.remove(l):this.activeLayerInfos.remove(l)};G._constructLegendElements=function(l){const t=l.layer;"featureCollections"in t&&t.featureCollections?l.buildLegendElementsForFeatureCollections(t.featureCollections):"renderer"in t&&t.renderer?
l.buildLegendElementsForRenderer(t.renderer):"url"in t&&t.url?l.buildLegendElementsForTools():l.children.forEach(P=>this._constructLegendElements(P))};E._createClass(r,[{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}}]);return r}(A);M.__decorate([I.property({type:h})],v.prototype,"activeLayerInfos",void 0);M.__decorate([I.property()],v.prototype,"basemapLegendVisible",void 0);M.__decorate([I.property()],v.prototype,"groundLegendVisible",void 0);M.__decorate([I.property()],
v.prototype,"hideLayersNotInCurrentView",void 0);M.__decorate([I.property()],v.prototype,"keepCacheOnDestroy",void 0);M.__decorate([I.property()],v.prototype,"respectLayerVisibility",void 0);M.__decorate([I.property()],v.prototype,"layerInfos",void 0);M.__decorate([I.property({readOnly:!0})],v.prototype,"state",null);M.__decorate([I.property()],v.prototype,"view",void 0);return v=M.__decorate([d.subclass("esri.widgets.Legend.LegendViewModel")],v)})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../kernel ../../../request ../../../symbols ../../../core/Accessor ../../../core/Collection ../../../core/Handles ../../../core/jsonMap ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/screenUtils ../../../core/urlUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../layers/effects/EffectView ../../../layers/effects/jsonUtils ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../renderers/support/jsonUtils ../../../renderers/support/rendererConversion ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../symbols/support/cimSymbolUtils ../../../symbols/support/renderUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils ../../smartMapping/support/utils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleFillSymbol".split(" "),
function(E,M,v,A,u,J,H,I,R,p,z,d,e,c,h,g,n,B,r,G,l,t,P,w,q,L,U,C,D,K,k,y,Q,V,W,a,f,F,O,Y,ba,ea){function ia(qa){return"esri.renderers.SimpleRenderer"===qa.declaredClass}function ca(qa){return"esri.renderers.ClassBreaksRenderer"===qa.declaredClass}function Z(qa){return"esri.renderers.UniqueValueRenderer"===qa.declaredClass}function ma(qa){return"esri.renderers.HeatmapRenderer"===qa.declaredClass}function ka(qa){return"esri.renderers.PointCloudClassBreaksRenderer"===qa.declaredClass}function fa(qa){return"esri.renderers.PointCloudStretchRenderer"===
qa.declaredClass}function ja(qa){return"esri.renderers.PointCloudUniqueValueRenderer"===qa.declaredClass}function ta(qa){return"esri.renderers.DotDensityRenderer"===qa.declaredClass}function pa(qa){return"esri.layers.BuildingSceneLayer"===qa.declaredClass}function ya(qa){qa="authoringInfo"in qa&&(null==qa?void 0:qa.authoringInfo);return"univariate-color-size"===(null==qa?void 0:qa.type)}function za(qa){qa="authoringInfo"in qa&&(null==qa?void 0:qa.authoringInfo);return"univariate-color-size"===(null==
qa?void 0:qa.type)&&"above-and-below"===(null==qa?void 0:qa.univariateTheme)}const Aa=d.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),Ba=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,Fa=new z.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Ga={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],
f32:[-3.4*1E39,3.4*1E39],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},Da=new ba({size:6,outline:{color:[128,128,128,.5],width:.5}}),La=new ea({style:"solid"}),Ma=new ba({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Ea={};H=function(qa){function Ha(m){m=qa.call(this,m)||this;m._handles=new p;m._hasColorRamp=!1;m._hasOpacityRamp=!1;m._hasSizeRamp=!1;m._webStyleSymbolCache=new Map;m._dotDensityUrlCache=new Map;m._scaleDrivenSizeVariable=null;m._hasClusterSizeVariable=
!1;m.children=new R;m.layerView=null;m.layer=null;m.legendElements=[];m.parent=null;m.hideLayersNotInCurrentView=!1;m.keepCacheOnDestroy=!1;m.respectLayerVisibility=!0;m.sublayerIds=[];m.title=null;m.view=null;return m}M._inheritsLoose(Ha,qa);var ha=Ha.prototype;ha.initialize=function(){const m=()=>this.notifyChange("ready");this._handles.add([n.on(this,"children","change",b=>{const {added:x,removed:N}=b,S=this._handles;x.forEach(T=>{const X=`activeLayerInfo-ready-watcher-${T.layer.uid}`;S.add(n.init(T,
"ready",m),X)});N.forEach(T=>S.remove(T.layer.uid));m()})]);this.keepCacheOnDestroy||(Ea={})};ha.destroy=function(){this._handles.destroy();this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=this._handles=null;this.keepCacheOnDestroy||(Ea=null)};ha.buildLegendElementsForFeatureCollections=function(){var m=M._asyncToGenerator(function*(b){if(this.hideLayersNotInCurrentView&&!(yield this._isLayerInCurrentView()))this.legendElements=[],this.notifyChange("ready");else{b=
Array.from(b,x=>{if("esri.layers.FeatureLayer"===x.declaredClass)return this._getRendererLegendElements(x.renderer,{title:x.title});if(x.featureSet&&x.featureSet.features.length){var N=x.layerDefinition,S=N&&N.drawingInfo;S=S&&U.fromJSON(S.renderer);N=Fa.read(N.geometryType);return S?this._getRendererLegendElements(S,{title:x.name,geometryType:N}):(Aa.warn("drawingInfo not available!"),null)}return null});try{const x=[];yield c.eachAlways(b).then(N=>{N.forEach(({value:S})=>S&&x.push(...S))});this.legendElements=
x;this.notifyChange("ready")}catch(x){Aa.warn("error while building legend for layer!",x)}}});return function(b){return m.apply(this,arguments)}}();ha.buildLegendElementsForRenderer=function(){var m=M._asyncToGenerator(function*(b){try{this.legendElements=(this.hideLayersNotInCurrentView?yield this._isLayerInCurrentView():1)?yield this._getRendererLegendElements(b):[],this.notifyChange("ready")}catch(x){Aa.warn("error while building legend for layer!",x)}});return function(b){return m.apply(this,
arguments)}}();ha.buildLegendElementsForTools=function(){var m=M._asyncToGenerator(function*(){var b=this;const x=this.layer;if("esri.layers.VoxelLayer"===x.declaredClass)this._constructLegendElementsForVoxellayer();else if("esri.layers.WMTSLayer"===x.declaredClass)this._constructLegendElementsForWMTSlayer();else if("esri.layers.WMSLayer"===x.declaredClass)yield this._constructLegendElementsForWMSSublayers();else if(pa(x))yield this._constructLegendElementsForBuildingSceneLayer();else if("esri.layers.MapImageLayer"===
x.declaredClass||"esri.layers.TileLayer"===x.declaredClass||pa(x))yield this._constructLegendElementsForSublayers();else{this._handles.remove("imageryLayers-watcher");var N="default";if("esri.layers.ImageryLayer"===x.declaredClass){var S,T;N=(null==x?void 0:null==(S=x.renderingRule)?void 0:S.functionName)||"default";S=null!=(T=x.bandIds)&&T.length?x.bandIds.join(""):"###";N=N+"_"+S}yield this._getLegendLayers(`${x.uid}-${N}`).then(function(){var X=M._asyncToGenerator(function*(aa){b.legendElements=
[];b.notifyChange("ready");aa=aa.map(function(){var na=M._asyncToGenerator(function*(ra){if("esri.layers.ImageryLayer"===x.declaredClass||"esri.layers.ImageryTileLayer"===x.declaredClass){const wa=x.watch(["renderingRule","bandIds"],()=>c.debounce(M._asyncToGenerator(function*(){Ea["default"]=null;x.renderer?yield b.buildLegendElementsForRenderer(x.renderer):yield b.buildLegendElementsForTools()}))());b._handles.add(wa,"imageryLayers-watcher")}(ra=b._generateSymbolTableElementForLegendLayer(ra))&&
ra.infos.length&&("esri.layers.ImageryLayer"===x.declaredClass&&(ra.title=x.title),b.legendElements.push(ra));b.notifyChange("ready")});return function(ra){return na.apply(this,arguments)}}());yield c.eachAlways(aa)});return function(aa){return X.apply(this,arguments)}}()).catch(X=>{Aa.warn("Request to server for legend has failed!",X)})}});return function(){return m.apply(this,arguments)}}();ha._isLayerInCurrentView=function(){var m=M._asyncToGenerator(function*(){const b=this.layer,x=this.layerView,
N=x&&"createQuery"in x&&"queryFeatureCount"in x;if(!(N||x&&"createQuery"in b&&"queryFeatureCount"in b))return!0;yield n.whenFalseOnce(x,"updating");const S=N?"createQuery"in x&&x.createQuery():"createQuery"in b&&b.createQuery();S.geometry=this.view.extent;return 0!==(N?"queryFeatureCount"in x&&(yield x.queryFeatureCount(S)):"queryFeatureCount"in b&&(yield b.queryFeatureCount(S)))});return function(){return m.apply(this,arguments)}}();ha._getParentLayerOpacity=function(m){let b=1;const x=m.parent;
x&&"uid"in x&&(b=this._getParentLayerOpacity(x));return m.opacity*b};ha._isGroupActive=function(){const m=this.children;return m.length?m.some(b=>b.ready):!1};ha._isScaleDrivenSizeVariable=function(m){if(m&&"size"!==m.type)return!1;const b=m.minSize,x=m.maxSize;return"object"===typeof b&&b?this._isScaleDrivenSizeVariable(b):"object"===typeof x&&x?this._isScaleDrivenSizeVariable(x):!!m.expression||Ba.test(m.valueExpression)};ha._isLayerScaleDriven=function(m){if("minScale"in m&&0<m.minScale||"maxScale"in
m&&0<m.maxScale)return!0;if("sublayers"in m&&m.sublayers)return m.sublayers.some(x=>this._isLayerScaleDriven(x));const b=m.parent;if(!1===m.loaded&&b&&"esri.layers.MapImageLayer"===b.declaredClass&&"source"in m&&m.source&&"map-layer"===m.source.type)for(const x of b.sourceJSON.layers)if(x.id===m.source.mapLayerId&&(0<x.minScale||0<x.maxScale))return!0;return!1};ha._constructLegendElementsForVoxellayer=function(){var m=M._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("voxel-style-watcher");
var b=this.layer;this._handles.add(n.watch(b,"style",()=>this._constructLegendElementsForVoxellayer()),"voxel-style-watcher");const x=e.unwrap(b.getVariableStyle(null)),N=[];if(x){var S;if(null!=(S=x.uniqueValues)&&S.length){const X=[];x.uniqueValues.forEach(aa=>{aa.enabled&&X.push({label:aa.label||`${aa.value}`,value:aa.value,symbol:new ea({color:aa.color,outline:null})})});X.length&&N.push({type:"symbol-table",title:x.label,infos:X})}else if(x.transferFunction){const {colorStops:X,stretchRange:aa}=
x.transferFunction;S=X.toArray().reverse();const na=aa.map((wa,da)=>`${0===da?O.SPECIAL_CHARS_LESS_THAN:O.SPECIAL_CHARS_GREATER_THAN} ${Y.formatNumberLabel(wa)}`).reverse(),ra=S.map(wa=>({color:wa.color,value:null,label:null}));ra[0].label=na[0];ra[ra.length-1].label=na[1];N.push({type:"color-ramp",title:x.label,infos:ra,preview:y.renderColorRampPreviewHTML(S.map(wa=>wa.color))})}}const T=b.opacity;b=N.reduce((X,aa)=>X.concat(this._getAllInfos(aa)),[]).filter(X=>!(null==X||!X.symbol)).map(X=>this._getSymbolPreview(X,
T));yield c.eachAlways(b);this.legendElements=N;this.notifyChange("ready")});return function(){return m.apply(this,arguments)}}();ha._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");const m=this.layer.activeLayer;this._handles.add(n.watch(this.layer,"activeLayer",()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");if(m.styleId&&m.styles){let b=null;m.styles.some(x=>m.styleId===x.id?(b=x.legendUrl,!0):!1);
b&&(this.legendElements=[{type:"symbol-table",title:m.title,infos:[{src:b,opacity:this.opacity}]}])}this.notifyChange("ready")};ha._constructLegendElementsForWMSSublayers=function(){var m=M._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("wms-sublayers-watcher");const b=this.layer;let x=null;if(b.customParameters||b.customLayerParameters)x={...b.customParameters,...b.customLayerParameters};this._handles.add(n.watch(this.layer,"sublayers",()=>this._constructLegendElementsForWMSSublayers()),
"wms-sublayers-watcher");this.legendElements=yield this._generateLegendElementsForWMSSublayers(b.sublayers,x);this.notifyChange("ready")});return function(){return m.apply(this,arguments)}}();ha._generateLegendElementsForWMSSublayers=function(){var m=M._asyncToGenerator(function*(b,x){const N=[];this._handles.add(b.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");b=b.toArray();for(const S of b)b=S.watch(["title","visible","legendEnabled"],()=>this._constructLegendElementsForWMSSublayers()),
this._handles.add(b,"wms-sublayers-watcher"),(!this.respectLayerVisibility||S.visible&&S.legendEnabled)&&(b=yield this._generateSymbolTableElementForWMSSublayer(S,x))&&b.infos.length&&N.unshift(b);return N});return function(b,x){return m.apply(this,arguments)}}();ha._generateSymbolTableElementForWMSSublayer=function(){var m=M._asyncToGenerator(function*(b,x){return!b.legendUrl&&b.sublayers?(x=(yield this._generateLegendElementsForWMSSublayers(b.sublayers,x)).filter(N=>N),{type:"symbol-table",title:b.title,
infos:x}):this._generateSymbolTableElementForLegendUrl(b,x)});return function(b,x){return m.apply(this,arguments)}}();ha._generateSymbolTableElementForLegendUrl=function(){var m=M._asyncToGenerator(function*(b,x){var N;let S=b.legendUrl;if(S){var T={type:"symbol-table",title:b.title||b.name||b.id&&b.id+"",infos:[]};x&&(S=g.addQueryParameters(S,x));x=null;b=null==(N=b.layer)?void 0:N.opacity;try{if(x=(yield J(S,{responseType:"image"})).data)x.style.opacity=b}catch{}T.infos.push({src:S,preview:x,opacity:b});
return T}});return function(b,x){return m.apply(this,arguments)}}();ha._getLegendLayers=function(m,b){const x=Ea&&Ea[m];return x?Promise.resolve(x):this._legendRequest(b).then(N=>{N=N.layers;return Ea[m]=N})};ha._legendRequest=function(m){var b=this.layer;m={f:"json",dynamicLayers:m};if("esri.layers.ImageryLayer"===b.declaredClass){var x=b.exportImageServiceParameters.renderingRule;x&&(m.renderingRule=JSON.stringify(x.toJSON()));b.bandIds&&(m.bandIds=b.bandIds.join());if(b.raster||b.viewId||b.customParameters){const {raster:N,
viewId:S,customParameters:T}=b;m={raster:N,viewId:S,...m,...T}}}x=b.url.replace(/(\/)+$/,"");"version"in b&&10.01<=b.version?(b=x.indexOf("?"),x=-1<b?x.substring(0,b)+"/legend"+x.substring(b):x+"/legend"):(b=x.toLowerCase().indexOf("/rest/"),b=x.substring(0,b)+x.substring(b+5,x.length),x="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(b)+"\x26returnbytes\x3dtrue");return J(x,{query:m}).then(N=>N.data)};ha._constructLegendElementsForBuildingSceneLayer=function(){var m=M._asyncToGenerator(function*(){this.legendElements=
[];this._handles.remove("sublayers-watcher");const b=this.layer;this._handles.add(n.watch(b,"sublayers",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=yield this._generateLegendElementsForBuildingSublayers(b.sublayers,this.opacity),this.notifyChange("ready")}catch(x){Aa.warn("Request to server for legend has failed!",x)}});return function(){return m.apply(this,arguments)}}();ha._generateLegendElementsForBuildingSublayers=function(){var m=M._asyncToGenerator(function*(b,
x){let N=[];this._handles.add(b.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");b=b.toArray();for(const T of b)if(b=T.watch(["renderer","opacity","title","visible"],()=>this._constructLegendElementsForBuildingSceneLayer()),this._handles.add(b,"sublayers-watcher"),!this.respectLayerVisibility||T.visible){b=T&&null!=T.opacity?T.opacity:null;var S=null!=b?b*x:x;"building-group"===T.type?(b={type:"symbol-table",title:T.title,infos:[]},S=yield this._generateLegendElementsForBuildingSublayers(T.sublayers,
S),b.infos.push(...S),N=[b,...N]):T.renderer&&(N=[...yield this._getRendererLegendElements(T.renderer,{title:T.title,opacity:S,sublayer:T}),...N])}return N.filter(T=>!!T&&("infos"in T?0<T.infos.length:!0))});return function(b,x){return m.apply(this,arguments)}}();ha._constructLegendElementsForSublayers=function(){var m=M._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("sublayers-watcher");const b=this.layer;this._handles.add(n.watch(b,"sublayers",()=>this._constructLegendElementsForSublayers),
"sublayers-watcher");try{this.legendElements=yield this._generateLegendElementsForSublayers(b.sublayers,this.opacity),this.notifyChange("ready")}catch(x){Aa.warn("Request to server for legend has failed!",x)}});return function(){return m.apply(this,arguments)}}();ha._generateLegendElementsForSublayers=function(){var m=M._asyncToGenerator(function*(b,x,N){const S=this.layer;let T=[];this._handles.add(b.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");b=b.toArray();
!N&&this.sublayerIds&&this.sublayerIds.length&&(b=this.sublayerIds.map(X=>S.findSublayerById(X)).filter(Boolean));for(const X of b)if(b=X.watch("renderer, opacity, title, visible, legendEnabled",()=>this._constructLegendElementsForSublayers()),this._handles.add(b,"sublayers-watcher"),!this.respectLayerVisibility||X.visible&&X.legendEnabled&&this._isSublayerInScale(X))b=X&&null!=X.opacity?X.opacity:null,b=null!=b?b*x:x,X.renderer&&!X.sublayers&&2<X.originIdOf("renderer")?(yield X.load(),T=[...yield this._getRendererLegendElements(X.renderer,
{title:X.title,opacity:b,sublayer:X}),...T]):(b=yield this._generateSymbolTableElementForSublayer(X,b,N))&&T.unshift(b);return T.filter(X=>!!X&&("infos"in X?0<X.infos.length:!0))});return function(b,x,N){return m.apply(this,arguments)}}();ha._generateSymbolTableElementForSublayer=function(){var m=M._asyncToGenerator(function*(b,x,N){if(!N){N=new Map;var S=this.layer,T=b.source;let X=null;if(T&&("map-layer"!==T.type||T.mapLayerId!==b.id||T.gdbVersion&&T.gdbVersion!==("gdbVersion"in S&&S.gdbVersion))||
2<b.originIdOf("renderer")||2<b.originIdOf("labelingInfo")||2<b.originIdOf("labelsVisible"))T=new q.ExportImageParameters({layer:this.layer}),X=T.hasDynamicLayers?T.dynamicLayers:null,T.destroy();(yield this._getLegendLayers(X||`${S.uid}-default`,X)).forEach(aa=>N.set(aa.layerId,aa))}S=N.get(b.id);return!S&&b.sublayers?(x=yield this._generateLegendElementsForSublayers(b.sublayers,x,N),{type:"symbol-table",title:b.title,infos:x}):this._generateSymbolTableElementForLegendLayer(S,b,x)});return function(b,
x,N){return m.apply(this,arguments)}}();ha._generateSymbolTableElementForLegendLayer=function(m,b,x){var N;if(!m||!m.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(m,b))return null;var S=null==b?void 0:b.renderer;let T=(null==b?void 0:b.title)||m.layerName;S&&(!b||2<(null==b?void 0:b.originIdOf("renderer")))&&(S=(null==b?void 0:b.title)||this._getRendererTitle(S,b))&&(T&&"string"!==typeof S&&"title"in S&&(S.title=T),T=S);const X={type:"symbol-table",title:T,legendType:m.legendType?
m.legendType:null,infos:[]},aa=b?this._sanitizeLegendForSublayer(m.legend.slice(),b):m.legend;0<(null==(N=m.legendGroups)?void 0:N.length)?m.legendGroups.forEach(na=>{var ra;const wa={type:"symbol-table",title:na.heading,legendType:m.legendType?m.legendType:null,infos:this._generateSymbolTableElementInfosForLegendLayer(aa.filter(da=>da.groupId===na.id),m.layerId,x)};0<(null==(ra=wa.infos)?void 0:ra.length)&&X.infos.push(wa)}):X.infos=this._generateSymbolTableElementInfosForLegendLayer(aa,m.layerId,
x);return 0<X.infos.length?X:null};ha._generateSymbolTableElementInfosForLegendLayer=function(m,b,x){return m.map(N=>{let S=N.url;if(N.imageData&&0<N.imageData.length)S=`data:image/png;base64,${N.imageData}`;else if(0!==S.indexOf("http"))S=u.addTokenParameter(`${this.layer.url}/${b}/images/${S}`);else return null;return{label:N.label,src:S,opacity:null==x?this.opacity:x,width:N.width,height:N.height}}).filter(N=>!!N)};ha._isSublayerInScale=function(m){const b=m.minScale||0;m=m.maxScale||0;return 0<
b&&b<this.scale||m>this.scale?!1:!0};ha._isLegendLayerInScale=function(m,b){b=b||this.layer;let x=null,N=null,S=!0;!b.minScale&&0!==b.minScale||!b.maxScale&&0!==b.maxScale?(0===m.minScale&&b.tileInfo&&(x=b.tileInfo.lods[0].scale),0===m.maxScale&&b.tileInfo&&(N=b.tileInfo.lods[b.tileInfo.lods.length-1].scale)):(x=Math.min(b.minScale,m.minScale)||b.minScale||m.minScale,N=Math.max(b.maxScale,m.maxScale));if(0<x&&x<this.scale||N>this.scale)S=!1;return S};ha._sanitizeLegendForSublayer=function(m,b){if("version"in
this.layer&&10.1>this.layer.version||0===m.length)return m;b=b.renderer;let x=null,N=null;m.some(S=>S.values)&&m.some((S,T)=>{S.values||(x=T,N=S,N.label||(N.label="others"));return null!=N});b?"unique-value"===b.type?N&&(m.splice(x,1),m.push(N)):"class-breaks"===b.type&&(N&&m.splice(x,1),m.reverse(),N&&m.push(N)):N&&(m.splice(x,1),m.push(N));return m};ha._getRendererLegendElements=function(){var m=M._asyncToGenerator(function*(b,x={}){var N=this.view;N=ia(b)||ca(b)||Z(b)||ma(b)||ta(b)?"2d"===N.type||
C.isSupportedRenderer3D(b):"raster-stretch"===b.type||"raster-colormap"===b.type||"raster-shaded-relief"===b.type||ka(b)||fa(b)||ja(b)||"vector-field"===b.type;return N?ka(b)||fa(b)||ja(b)||"esri.renderers.PointCloudRGBRenderer"===b.declaredClass?this._constructPointCloudRendererLegendElements(b,x):ta(b)?this._constructDotDensityRendererLegendElements(b):this._constructRendererLegendElements(b,x):(Aa.warn(`Renderer of type '${b.type}' not supported!`),[])});return function(b){return m.apply(this,
arguments)}}();ha._getPointCloudRendererTitle=function(m){return m.legendOptions&&m.legendOptions.title||m.field};ha._constructPointCloudRendererLegendElements=function(m,b={}){b=b.title;const x=[];let N=null;var S=null;if(ka(m))N={type:"symbol-table",title:b||this._getPointCloudRendererTitle(m),infos:[]},m.colorClassBreakInfos.forEach(T=>{N.infos.unshift({label:T.label||T.minValue+" - "+T.maxValue,value:[T.minValue,T.maxValue],symbol:this._getAppliedCloneSymbol(Da,T.color)})});else if(fa(m)){S=m.stops;
let T=null;if(S.length&&(1===S.length&&(T=S[0].color),!T)){const X=S[0].value,aa=S[S.length-1].value;null!=X&&null!=aa&&(T=W.getColorFromPointCloudStops(X+(aa-X)/2,S))}N={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(Da,T||Da.color)}]};S=W.getRampStopsForPointCloud(m.stops);S={type:"color-ramp",title:b||this._getPointCloudRendererTitle(m),infos:S,preview:y.renderColorRampPreviewHTML(S.map(X=>X.color))}}else ja(m)&&(N={type:"symbol-table",title:b||
this._getPointCloudRendererTitle(m),infos:[]},m.colorUniqueValueInfos.forEach(T=>{N.infos.push({label:T.label||T.values.join(", "),value:T.values.join(", "),symbol:this._getAppliedCloneSymbol(Da,T.color)})}));N&&N.infos.length&&x.push(N);S&&S.infos.length&&x.push(S);b=x.reduce((T,X)=>T.concat(X.infos),[]).filter(T=>!!T.symbol).map(T=>this._getSymbolPreview(T,this.opacity,{symbolConfig:{applyColorModulation:!!m.colorModulation}}));return c.eachAlways(b).then(()=>x)};ha._getElementInfoForDotDensity=
function(m,b){const {backgroundColor:x,outline:N,dotSize:S}=m;var T=this.effectList;T=null==T?void 0:T.effects.map(aa=>aa.toJSON());T=w.effectFunctionsFromJSON(T);T=S+"-"+b+"-"+x+"-"+(N&&JSON.stringify(N.toJSON()))+"-"+T;const X=this._dotDensityUrlCache;m=X.has(T)?X.get(T):y.renderDotDensityPreviewHTML(m,b);X.set(T,m);b=k.renderSymbol([[{shape:{type:"image",x:0,y:0,width:m.width,height:m.height,src:m.src},fill:null,stroke:null,offset:[0,0]}]],[m.width,m.height],{effectView:this.effectList});return{opacity:1,
src:m.src,preview:b,width:m.width,height:m.height}};ha._constructDotDensityRendererLegendElements=function(m){const b=m.calculateDotValue(this.view.scale),x={type:"symbol-table",title:{value:b&&Math.round(b),unit:m.legendOptions&&m.legendOptions.unit||""},infos:[]};m.attributes.forEach(N=>{const S=this._getElementInfoForDotDensity(m,N.color);S.label=N.label||N.valueExpressionTitle||N.field;x.infos.push(S)});return Promise.resolve([x])};ha._constructRendererLegendElements=function(){var m=M._asyncToGenerator(function*(b,
x={}){const {title:N,sublayer:S}=x,T=S||this.layer;b=yield this._loadRenderer(b);this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;const X=(yield this._getVisualVariableLegendElements(b,T))||[],aa={type:"symbol-table",title:N||this._getRendererTitle(b,T),infos:[]};let na=null,ra=!1;const wa=new Set;if(ya(b)){var da=N,la=za(b)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",ua=X.findIndex(oa=>"color-ramp"===oa.type);ua=-1!==ua?X.splice(ua,
1)[0]:null;var sa=X.findIndex(oa=>"size-ramp"===oa.type);sa=-1!==sa?X.splice(sa,1)[0]:null;var va=[];ua&&(da=ua.title,va.push(ua));sa&&(da=sa.title,va.push(sa));0<va.length&&X.push({type:la,title:da,infos:va})}else if(ma(b))da=a.getHeatmapRampStops(b),X.push({type:"heatmap-ramp",title:N,infos:da,preview:y.renderColorRampPreviewHTML(da.map(oa=>oa.color),{effectList:this.effectList})});else if(Z(b)){if((la=b&&b.authoringInfo)&&"relationship"===la.type){const {focus:oa,numClasses:xa,field1:Ia,field2:Ja}=
la;if(xa&&Ia&&Ja){ua=[Ia,Ja];la=f.getRotationAngleForFocus(oa)||0;for(da of ua){const {field:Na,normalizationField:Ka,label:Oa}=da;ua=Oa||{field:this._getFieldAlias(Na,T),normField:Ka&&this._getFieldAlias(Ka,T)};sa=Ma.clone();sa.angle=la;aa.infos.push({label:ua,symbol:sa});wa.add(sa);la+=90}da=f.getRelationshipRampElement({focus:oa,numClasses:xa,infos:b.uniqueValueInfos});X.unshift(da)}}else{const oa=b.field;b.uniqueValueInfos.forEach(xa=>{xa.symbol&&aa.infos.push({label:xa.label||this._getDomainName(oa,
xa.value,T)||xa.value,value:xa.value,symbol:xa.symbol})})}b.defaultSymbol&&(aa.infos.push({label:b.defaultLabel||"others",symbol:b.defaultSymbol}),ra=!0)}else if(ca(b))na=this._isUnclassedRenderer(b),na&&this._hasSizeRamp||(b.classBreakInfos.forEach(oa=>{oa.symbol&&aa.infos.unshift({label:oa.label||(na?null:oa.minValue+" - "+oa.maxValue),value:[oa.minValue,oa.maxValue],symbol:oa.symbol})}),na&&(aa.title=null),this._updateInfosforClassedSizeRenderer(b,aa.infos)),b.defaultSymbol&&!na&&(aa.infos.push({label:b.defaultLabel||
"others",symbol:b.defaultSymbol}),ra=!0);else if("raster-stretch"===b.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass||"esri.layers.WCSLayer"===this.layer.declaredClass)da=this._constructTileImageryStretchRendererElements(b),"stretch-ramp"===da.type?X.push(da):aa.infos=da;else{da=this.layer;b.statistics&&b.statistics.length&&(la=null!=b.statistics[0].min?b.statistics[0].min:b.statistics[0][0],ua=null!=b.statistics[0].max?b.statistics[0].max:b.statistics[0][1]);sa=[];sa=e.unwrap(da.renderingRule?
yield da.generateRasterInfo(da.renderingRule):da.serviceRasterInfo);const oa=sa.keyProperties.BandProperties;va=Ga[da.rasterInfo.pixelType.toLowerCase()];1===sa.bandCount?(la=null!=la?la:sa.statistics?sa.statistics[da.bandIds[0]].min:va[0],ua=null!=ua?ua:sa.statistics?sa.statistics[da.bandIds[0]].max:va[1],la||ua?X.push(this._getStretchLegendElements(b,{min:la,max:ua})):this._getServerSideLegend()):da.bandIds&&1===da.bandIds.length?(la=null!=la?la:sa.statistics?sa.statistics[da.bandIds[0]].min:va[0],
ua=null!=ua?ua:sa.statistics?sa.statistics[da.bandIds[0]].max:va[1],la||ua?X.push(this._getStretchLegendElements(b,{min:la,max:ua})):this._getServerSideLegend()):3<=sa.bandCount?oa&&oa.length>=sa.bandCount?da.bandIds&&3===da.bandIds.length?(sa=da.bandIds.map(xa=>oa[xa].BandName),aa.infos=this._createSymbolTableElementMultiBand(sa)):"lerc"===da.format?(sa=[0,1,2].map(xa=>oa[xa].BandName),aa.infos=this._createSymbolTableElementMultiBand(sa)):this._getServerSideLegend():"lerc"===da.format?(sa=["band1",
"band2","band3"],aa.infos=this._createSymbolTableElementMultiBand(sa)):this._getServerSideLegend():this._getServerSideLegend()}else if("raster-colormap"===b.type)b.colormapInfos.forEach(oa=>{aa.infos.push({label:oa.label,value:oa.value,symbol:this._getAppliedCloneSymbol(La,oa.color)})});else if(ia(b)){da=b.symbol;switch(x.geometryType){case "point":da="pointSymbol"in T&&T.pointSymbol;break;case "polyline":da="lineSymbol"in T&&T.lineSymbol;break;case "polygon":da="polygonSymbol"in T&&T.polygonSymbol}b.symbol&&
!this._hasSizeRamp&&aa.infos.push({label:b.label,symbol:da})}else"vector-field"===b.type?(b.outputUnit&&(this.title="("+b.toJSON().outputUnit+")"),aa.title=b.attributeField,da=b.getClassBreakInfos(),null!=da&&da.length?da.forEach(oa=>{aa.infos.push({label:oa.minValue+" - "+oa.maxValue,symbol:oa.symbol})}):aa.infos.push({label:b.attributeField,symbol:b.getDefaultSymbol()})):"raster-shaded-relief"===b.type&&X.push(this._getStretchLegendElements(b,{min:0,max:255}));const Ca=b.defaultSymbol;!Ca||ra||
ia(b)||na&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||X.push({type:"symbol-table",infos:[{label:b.defaultLabel||"others",symbol:Ca}]});aa.infos.length&&X.unshift(aa);const Pa=null==x.opacity?this.opacity:x.opacity,Qa=this._isTallSymbol("visualVariables"in b&&b.visualVariables),Ra="esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass;x=X.reduce((oa,xa)=>oa.concat(this._getAllInfos(xa)),[]).filter(oa=>!(null==oa||!oa.symbol)).map(oa=>
this._getSymbolPreview(oa,Pa,{isDefault:oa.symbol===Ca,applyScaleDrivenSize:!wa.has(oa.symbol),symbolConfig:{isTall:Qa,isSquareFill:Ra},effectList:wa.has(oa.symbol)?null:this.effectList}));b=null;yield c.eachAlways(x);return X});return function(b){return m.apply(this,arguments)}}();ha._getServerSideLegend=function(){setTimeout(()=>this.buildLegendElementsForTools(),0)};ha._getAllInfos=function(m){const b=null==m?void 0:m.infos;return b?b.reduce((x,N)=>x.concat(this._getAllInfos(N)),[]):[m]};ha._constructTileImageryStretchRendererElements=
function(m){function b(ra){var wa;const da=(null!=S&&null!=(wa=S.bandIds)&&wa.length?S.bandIds:Array.from(Array(Math.min(T.bandCount,3)).keys())).map(la=>ra&&ra[la]&&ra[la].BandName||"band"+(la+1));3>da.length?da.push(da[1]):3<da.length&&da.splice(3);return da}var x,N;const S=this.layer,T=S.rasterInfo,X=T.bandCount||m.statistics.length;var aa,na=[];na=T.keyProperties&&T.keyProperties.BandProperties;(aa=null!=m&&null!=(x=m.statistics)&&x.length?m.statistics:null==T?void 0:T.statistics)?(x=void 0!==
aa[0].min?aa[0].min:aa[0][0],aa=aa[0].max||aa[0][1]):(aa=Ga[S.rasterInfo.pixelType.toLowerCase()],x=aa[0],aa=aa[1]);S.hasStandardTime()&&(x=S.getStandardTimeValue(x),aa=S.getStandardTimeValue(aa));if(1===T.bandCount||1===(null==(N=S.bandIds)?void 0:N.length))return this._getStretchLegendElements(m,{min:x,max:aa});na=na&&na.length>=X?b(na):b();return this._createSymbolTableElementMultiBand(na)};ha._getStretchLegendElements=function(m,b){m=W.getStrectchRampStops(m.colorRamp,b);return{type:"stretch-ramp",
title:"",infos:m,preview:y.renderColorRampPreviewHTML(m.map(x=>x.color))}};ha._createSymbolTableElementMultiBand=function(m){const b=[],x=["red","green","blue"];m.forEach((N,S)=>{b.push({label:{colorName:x[S],bandName:N},src:O.RGB_IMG_SOURCE[S],opacity:1})});return b};ha._updateInfosforClassedSizeRenderer=function(m,b){const x=m.authoringInfo&&"class-breaks-size"===m.authoringInfo.type,N=m.classBreakInfos.some(S=>Q.isVolumetricSymbol(S.symbol));if(x&&N){const S=F.REAL_WORLD_MAX_SIZE;m=m.classBreakInfos.length;
const T=(S-F.REAL_WORLD_MIN_SIZE)/(1<m?m-1:m);b.forEach((X,aa)=>{X.size=S-T*aa})}};ha._isTallSymbol=function(m){let b=!1,x=!1;if(m)for(let N=0;N<m.length&&(!b||!x);N++){const S=m[N];"size"===S.type&&("height"===S.axis&&(b=!0),"width-and-depth"===S.axis&&(x=!0))}return b&&x};ha._getSymbolPreview=function(){var m=M._asyncToGenerator(function*(b,x,N){var S=null!=N&&N.isDefault||null!=b.size||!this._hasSizeRamp?b.size:h.px2pt(22);this._scaleDrivenSizeVariable&&null!=N&&N.applyScaleDrivenSize&&({getSize:S}=
yield new Promise((T,X)=>E(["../../../renderers/visualVariables/support/visualVariableUtils"],T,X)),S=S(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===b.symbol.type?b.symbol.style:null}));return y.renderPreviewHTML(b.symbol,{size:S,opacity:x,scale:!1,symbolConfig:null==N?void 0:N.symbolConfig,effectView:null==N?void 0:N.effectList}).then(T=>{b.preview=T;return b}).catch(()=>{b.preview=null;return b})});return function(b,x,N){return m.apply(this,arguments)}}();
ha._loadRenderer=function(){var m=M._asyncToGenerator(function*(b){var x,N;const S=[];var T=this.layer;b=b.clone();this._hasClusterSizeVariable=!1;const X="visualVariables"in b&&(null==(x=b.visualVariables)?void 0:x.some(na=>"size"===na.type&&"outline"!==na.target&&!Ba.test(na.valueExpression)));if(b&&"visualVariables"in b&&!X&&"featureReduction"in T&&"cluster"===(null==(N=T.featureReduction)?void 0:N.type)&&(x=e.unwrap(V.getClusterSizeVariable(this.layerView._effectiveRenderer,this.view)))){T=T.featureReduction;
if("clusterMinSize"in T&&"clusterMaxSize"in T){const {clusterMinSize:na,clusterMaxSize:ra}=T;x.legendOptions=new D({showLegend:na!==ra})}b.visualVariables=(b.visualVariables||[]).concat([x]);this._hasClusterSizeVariable=!0}const aa=yield this._getMedianColor(b);if(ca(b)||Z(b))T=(b.classBreakInfos||b.uniqueValueInfos).map(na=>this._fetchSymbol(na.symbol,aa).then(ra=>{na.symbol=ra}).catch(()=>{na.symbol=null})),Array.prototype.push.apply(S,T);S.push(this._fetchSymbol(b.symbol||b.defaultSymbol,b.defaultSymbol?
null:aa).then(na=>{this._applySymbolToRenderer(b,na,ia(b))}).catch(()=>{this._applySymbolToRenderer(b,null,ia(b))}));return c.eachAlways(S).then(()=>b)});return function(b){return m.apply(this,arguments)}}();ha._applySymbolToRenderer=function(m,b,x){x?m.symbol=b:m.defaultSymbol=b};ha._getMedianColor=function(){var m=M._asyncToGenerator(function*(b){if(!("visualVariables"in b&&b.visualVariables))return null;b=b.visualVariables.find(S=>"color"===S.type);if(!b)return null;var x=null,N=null;if(b.stops){if(1===
b.stops.length)return b.stops[0].color;x=b.stops[0].value;N=b.stops[b.stops.length-1].value}x+=(N-x)/2;({getColor:N}=yield new Promise((S,T)=>E(["../../../renderers/visualVariables/support/visualVariableUtils"],S,T)));return N(b,x)});return function(b){return m.apply(this,arguments)}}();ha._fetchSymbol=function(m,b){if(!m)return Promise.reject();if("web-style"===m.type){var x=m.portal;x=m.name+"-"+m.styleName+"-"+m.styleUrl+"-"+(x&&x.url)+"-"+(x&&x.user&&x.user.username);const N=this._webStyleSymbolCache;
N.has(x)||("2d"===this.view.type?N.set(x,m.fetchCIMSymbol()):N.set(x,m.fetchSymbol()));return N.get(x).then(S=>this._getAppliedCloneSymbol(S,b)).catch(()=>{Aa.warn("Fetching web-style failed!");return Promise.reject()})}return Promise.resolve(this._getAppliedCloneSymbol(m,b))};ha._getAppliedCloneSymbol=function(m,b){if(!m||!b)return m;m=m.clone();const x=b&&b.toRgba();-1<m.type.indexOf("3d")?this._applyColorTo3dSymbol(m,x):"cim"===m.type?K.applyCIMSymbolColor(m,b):m.color&&(m.color=new A(x||m.color));
return m};ha._applyColorTo3dSymbol=function(m,b){b&&m.symbolLayers.forEach(x=>{x&&(x.material||(x.material={}),x.material.color=new A(b))})};ha._getVisualVariableLegendElements=function(){var m=M._asyncToGenerator(function*(b,x){var N=this;if(!("visualVariables"in b&&b.visualVariables)||"vector-field"===b.type)return null;var S=b.visualVariables,T=[];const X=[],aa=[];for(const da of S)"color"===da.type?T.push(da):"size"===da.type?X.push(da):"opacity"===da.type&&aa.push(da);S=[...T,...X,...aa];let na;
if(0===T.length&&ca(b)&&b.classBreakInfos&&1===b.classBreakInfos.length)var ra=(ra=b.classBreakInfos[0])&&ra.symbol;0===T.length&&ia(b)&&(ra=b.symbol);ra&&(-1<ra.type.indexOf("3d")?(T=ra.symbolLayers.getItemAt(0),"water"===T.type?e.isSome(T.color)&&(na=T.color):e.isSome(T.material)&&e.isSome(T.material.color)&&(na=T.material.color)):ra.url||(na=ra.color));const wa=this.effectList;return(yield Promise.all(S.map(function(){var da=M._asyncToGenerator(function*(la){if(!la.legendOptions||!1!==la.legendOptions.showLegend){const sa=
N._getRampTitle(la,x);let va=null;var ua="getField"in x&&x.getField&&x.getField(la.field);ua=ua&&L.isDateField(ua);"color"===la.type?(la=yield W.getRampStops(la,null,ua),va={type:"color-ramp",title:sa,infos:la,preview:y.renderColorRampPreviewHTML(la.map(Ca=>Ca.color),{effectList:wa})},N._hasColorRamp||(N._hasColorRamp=!(null==va.infos||!va.infos.length))):"size"===la.type&&"outline"!==la.target?Ba.test(la.valueExpression)?N._hasClusterSizeVariable||(N._scaleDrivenSizeVariable=la):(va={type:"size-ramp",
title:N._hasClusterSizeVariable?N._getClusterTitle(la):sa,infos:yield F.getRampStops(b,la,yield N._getMedianColor(b),N.scale,N.view.type,ua)},N._hasSizeRamp||(N._hasSizeRamp=!(null==va.infos||!va.infos.length))):"opacity"===la.type&&(la=yield W.getRampStops(la,na,ua),va={type:"opacity-ramp",title:sa,infos:la,preview:y.renderColorRampPreviewHTML(la.map(Ca=>Ca.color),{effectList:wa})},N._hasOpacityRamp||(N._hasOpacityRamp=!(null==va.infos||!va.infos.length)));return va&&va.infos?va:null}});return function(la){return da.apply(this,
arguments)}}()))).filter(da=>!!da)});return function(b,x){return m.apply(this,arguments)}}();ha._getDomainName=function(m,b,x){return m&&"function"!==typeof m?(x=(m="getField"in x&&x.getField&&x.getField(m))&&"getFieldDomain"in x&&x.getFieldDomain?x.getFieldDomain(m.name):null)&&"coded-value"===x.type?x.getName(b):null:null};ha._getClusterTitle=function(m){var b=this.layer;m=m.field;if("featureReduction"in b&&b.featureReduction&&"cluster"===b.featureReduction.type&&(b=b.featureReduction,b=(b="popupTemplate"in
b&&b.popupTemplate)&&b.fieldInfos))for(const x of b)if(x.fieldName===m)return"cluster_count"===m?x.label||{showCount:!0}:x.label;return{showCount:!0}};ha._getRampTitle=function(m,b){let x=m.field,N=m.normalizationField,S=!1,T=!1,X=!1;var aa=null;x="function"===typeof x?null:x;N="function"===typeof N?null:N;aa=m.legendOptions&&m.legendOptions.title;if(null==aa)if(m.valueExpressionTitle)aa=m.valueExpressionTitle;else{if("renderer"in b&&b.renderer&&"authoringInfo"in b.renderer&&b.renderer.authoringInfo&&
b.renderer.authoringInfo.visualVariables)for(m=b.renderer.authoringInfo.visualVariables,aa=0;aa<m.length;aa++){const na=m[aa];if("color"===na.type){if("ratio"===na.style){S=!0;break}if("percent"===na.style){T=!0;break}if("percent-of-total"===na.style){X=!0;break}}}aa={field:x&&this._getFieldAlias(x,b),normField:N&&this._getFieldAlias(N,b),ratio:S,ratioPercent:T,ratioPercentTotal:X}}return aa};ha._getRendererTitle=function(m,b){if(m.legendOptions&&m.legendOptions.title)return m.legendOptions.title;
if(m.valueExpressionTitle)return m.valueExpressionTitle;let x=m.field,N=null,S=null;ca(m)&&(N=m.normalizationField,S="percent-of-total"===m.normalizationType);x="function"===typeof x?null:x;N="function"===typeof N?null:N;m=null;if(x||N)m={field:x&&this._getFieldAlias(x,b),normField:N&&this._getFieldAlias(N,b),normByPct:S};return m};ha._getFieldAlias=function(m,b){var x="popupTemplate"in b&&b.popupTemplate;x=x&&x.fieldInfos;let N=null;x&&x.some(T=>m===T.fieldName?(N=T,!0):!1);x=null;"getField"in b&&
b.getField?x=b.getField(m):"fieldsIndex"in b&&b.fieldsIndex&&(x=b.fieldsIndex.get(m));b=N||x;let S=null;b&&(S=N&&N.label||x&&x.alias||"name"in b&&b.name||"fieldName"in b&&b.fieldName);return S};ha._isUnclassedRenderer=function(m){const b=m.visualVariables;let x=!1;ca(m)&&m.classBreakInfos&&1===m.classBreakInfos.length&&b&&(x=m.field?b.some(N=>!(!N||m.field!==N.field||(m.normalizationField||N.normalizationField)&&m.normalizationField!==N.normalizationField)):!!b.length);return x};M._createClass(Ha,
[{key:"effectList",get:function(){const m=this.layer;let b=null;"effect"in m&&m.effect&&(b=new P.default,b.effect=m.effect,b.end(),b.scale=this.scale);return b}},{key:"opacity",get:function(){var m;const b=this.layer.opacity,x=null==(m=this.parent)?void 0:m.opacity;m=(m=this.layer.parent)&&"uid"in m?this._getParentLayerOpacity(m):null;return null!=x?x*b:null!=m?m*b:b}},{key:"ready",get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}},
{key:"scale",get:function(){return this.view&&this.view.scale}},{key:"isScaleDriven",get:function(){var m=this.layer;if(null===m)return!1;if("effect"in m&&m.effect&&Array.isArray(m.effect)||"featureReduction"in m&&m.featureReduction&&"cluster"===m.featureReduction.type)return!0;if("renderer"in m&&m.renderer){if("dot-density"===m.renderer.type)return!0;const b=m.get("renderer.valueExpression");if(Ba.test(b))return!0;if(m=m.get("renderer.visualVariables"))return m.some(x=>this._isScaleDrivenSizeVariable(x))}return this._isLayerScaleDriven(this.layer)}},
{key:"version",get:function(){return this._get("version")+1}}]);return Ha}(I);v.__decorate([B.property()],H.prototype,"children",void 0);v.__decorate([B.property({readOnly:!0})],H.prototype,"effectList",null);v.__decorate([B.property()],H.prototype,"layerView",void 0);v.__decorate([B.property()],H.prototype,"layer",void 0);v.__decorate([B.property()],H.prototype,"legendElements",void 0);v.__decorate([B.property({readOnly:!0})],H.prototype,"opacity",null);v.__decorate([B.property()],H.prototype,"parent",
void 0);v.__decorate([B.property({readOnly:!0,dependsOn:[]})],H.prototype,"ready",null);v.__decorate([B.property()],H.prototype,"hideLayersNotInCurrentView",void 0);v.__decorate([B.property()],H.prototype,"keepCacheOnDestroy",void 0);v.__decorate([B.property()],H.prototype,"respectLayerVisibility",void 0);v.__decorate([B.property({readOnly:!0})],H.prototype,"scale",null);v.__decorate([B.property()],H.prototype,"sublayerIds",void 0);v.__decorate([B.property({readOnly:!0})],H.prototype,"isScaleDriven",
null);v.__decorate([B.property()],H.prototype,"title",void 0);v.__decorate([B.property({readOnly:!0,dependsOn:["ready"],value:0})],H.prototype,"version",null);v.__decorate([B.property()],H.prototype,"view",void 0);return H=v.__decorate([t.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],H)})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),
function(E,M,v,A,u,J,H,I,R,p,z,d){function e(g){g=z.parse(g)||[];var n=(n=g[0])?"type"in n:!1;return n?[{scale:-1,effects:g}]:g}function c(g,n,B){var r,G,l,t;return null!=(r=g[0])&&r.effects&&null!=(G=n[0])&&G.effects?(-1===(null==(l=g[0])?void 0:l.scale)||-1===(null==(t=n[0])?void 0:t.scale))&&(1<g.length||1<n.length)&&0>=B?!1:d.canInterpolateEffects(g[0].effects,n[0].effects):!0}function h(g,n,B){var r,G;const l=g.length>n.length?g:n;g=g.length>n.length?n:g;const t=g[g.length-1];n=null!=(r=null==
t?void 0:t.scale)?r:B;r=null!=(G=null==t?void 0:t.effects)?G:[];for(G=g.length;G<l.length;G++)g.push({scale:n,effects:[...r]});for(G=0;G<l.length;G++)g[G].scale=-1===g[G].scale?B:g[G].scale,l[G].scale=-1===l[G].scale?B:l[G].scale,d.normalizeEffects(g[G].effects,l[G].effects)}A=function(g){function n(r){r=g.call(this,r)||this;r._from=null;r._to=null;r._final=null;r._current=[];r._time=0;r.duration=u("mapview-transitions-duration");r.effects=[];return r}M._inheritsLoose(n,g);var B=n.prototype;B.canTransitionTo=
function(r){try{return 0<this.scale&&c(this._current,e(r),this.scale)}catch{return!1}};B.transitionStep=function(r,G){this._applyTimeTransition(r);this._updateForScale(G)};B.end=function(){this._applyTimeTransition(this.duration)};B._transitionTo=function(r){0<this.scale&&c(this._current,r,this.scale)?(this._final=r,this._to=J.clone(r),h(this._current,this._to,this.scale),this._from=J.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=r);this._set("effects",this._current[0]?
J.clone(this._current[0].effects):[])};B._applyTimeTransition=function(r){if(this._to&&this._from&&this._current&&this._final){this._time+=r;r=Math.min(1,this._time/this.duration);for(let l=0;l<this._current.length;l++){const t=this._current[l],P=this._from[l],w=this._to[l];var G=P.scale;t.scale=G+(w.scale-G)*r;for(G=0;G<t.effects.length;G++)t.effects[G].interpolate(P.effects[G],w.effects[G],r)}1===r&&(this._current=this._final,this._set("effects",this._current[0]?J.clone(this._current[0].effects):
[]),this._from=this._to=this._final=null)}};B._updateForScale=function(r){this._set("scale",r);if(0!==this._current.length){var G=this._current,l=this._current.length-1,t,P=1;if(1===G.length||r>=G[0].scale)var w=t=G[0].effects;else if(r<=G[l].scale)w=t=G[l].effects;else for(let q=0;q<l;q++){const L=G[q],U=G[q+1];if(L.scale>=r&&U.scale<=r){P=(r-L.scale)/(U.scale-L.scale);t=L.effects;w=U.effects;break}}for(r=0;r<this.effects.length;r++)this.effects[r].interpolate(t[r],w[r],P)}};M._createClass(n,[{key:"effect",
set:function(r){const G=this._get("effect");r=r||"";if(G!==r){this._set("effect",r);try{this._transitionTo(e(r))}catch(l){this._transitionTo([]),H.getLogger(this.declaredClass).warn("Invalid Effect",{effect:r,error:l})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(r){this._updateForScale(r)}},{key:"transitioning",get:function(){return null!==this._to}}]);return n}(A);v.__decorate([I.property()],A.prototype,"_to",void 0);v.__decorate([I.property()],
A.prototype,"duration",void 0);v.__decorate([I.property({value:""})],A.prototype,"effect",null);v.__decorate([I.property({readOnly:!0})],A.prototype,"effects",void 0);v.__decorate([I.property({readOnly:!0})],A.prototype,"hasEffects",null);v.__decorate([I.property({value:0})],A.prototype,"scale",null);v.__decorate([I.property({readOnly:!0})],A.prototype,"transitioning",null);A=v.__decorate([p.subclass("esri.layers.effects.EffectView")],A);E.canInterpolateEffectStops=c;E.convertEffectToStops=e;E.default=
A;E.normalizeEffectStops=h;Object.defineProperty(E,"__esModule",{value:!0})})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./commonProperties ./sublayerUtils ../../views/support/floorFilterUtils".split(" "),
function(E,M,v,A,u,J,H,I,R,p,z,d,e,c){const h={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};E.ExportImageParameters=function(g){function n(r){r=g.call(this,r)||this;r.floors=null;r.scale=0;return r}M._inheritsLoose(n,g);var B=n.prototype;B.destroy=function(){this.layer=null};B.toJSON=
function(){var r=this.layer;r={dpi:r.dpi,format:r.imageFormat,transparent:r.imageTransparency,gdbVersion:r.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?r.dynamicLayers=this.dynamicLayers:r={...r,layers:this.layers,layerDefs:this.layerDefs};return r};M._createClass(n,[{key:"dynamicLayers",get:function(){if(!this.hasDynamicLayers)return null;const r=this.visibleSublayers.map(G=>{const l=c.getLayerFloorFilterClause(this.floors,G);return G.toExportImageJSON(l)});return r.length?JSON.stringify(r):
null}},{key:"hasDynamicLayers",get:function(){return this.layer&&e.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer)}},{key:"layer",set:function(r){this._get("layer")!==r&&(this._set("layer",r),this.handles.remove("layer"),r&&this.handles.add([r.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),r.on("sublayer-update",G=>this.notifyChange(h[G.propertyName]))],"layer"))}},{key:"layers",get:function(){const r=this.visibleSublayers;return r?r.length?"show:"+
r.map(G=>G.id).join(","):"show:-1":null}},{key:"layerDefs",get:function(){var r;const G=!(null==(r=this.floors)||!r.length);r=this.visibleSublayers.filter(l=>null!=l.definitionExpression||G&&null!=l.floorInfo);return r.length?JSON.stringify(r.reduce((l,t)=>{var P=c.getLayerFloorFilterClause(this.floors,t);P=J.isSome(P)?c.combineFloorsDefinitionExpression(P,t):t.definitionExpression;l[t.id]=P;return l},{})):null}},{key:"version",get:function(){this.commitProperty("layers");this.commitProperty("layerDefs");
this.commitProperty("dynamicLayers");this.commitProperty("timeExtent");const r=this.layer;r&&(r.commitProperty("dpi"),r.commitProperty("imageFormat"),r.commitProperty("imageTransparency"),r.commitProperty("gdbVersion"));return(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){const r=[];if(!this.layer)return r;var G=this.layer.sublayers;const l=t=>{const P=this.scale,w=0===t.minScale||P<=t.minScale,q=0===t.maxScale||P>=t.maxScale;t.visible&&(0===P||w&&q)&&(t.sublayers?t.sublayers.forEach(l):
r.unshift(t))};G&&G.forEach(l);G=this._get("visibleSublayers");return!G||G.length!==r.length||G.some((t,P)=>r[P]!==t)?r:G}}]);return n}(u.HandleOwnerMixin(A));v.__decorate([H.property({readOnly:!0})],E.ExportImageParameters.prototype,"dynamicLayers",null);v.__decorate([H.property()],E.ExportImageParameters.prototype,"floors",void 0);v.__decorate([H.property({readOnly:!0})],E.ExportImageParameters.prototype,"hasDynamicLayers",null);v.__decorate([H.property()],E.ExportImageParameters.prototype,"layer",
null);v.__decorate([H.property({readOnly:!0})],E.ExportImageParameters.prototype,"layers",null);v.__decorate([H.property({readOnly:!0})],E.ExportImageParameters.prototype,"layerDefs",null);v.__decorate([H.property({type:Number})],E.ExportImageParameters.prototype,"scale",void 0);v.__decorate([H.property(d.combinedViewLayerTimeExtentProperty)],E.ExportImageParameters.prototype,"timeExtent",void 0);v.__decorate([H.property({readOnly:!0})],E.ExportImageParameters.prototype,"version",null);v.__decorate([H.property({readOnly:!0})],
E.ExportImageParameters.prototype,"visibleSublayers",null);E.ExportImageParameters=v.__decorate([z.subclass("esri.layers.mixins.ExportImageParameters")],E.ExportImageParameters);Object.defineProperty(E,"__esModule",{value:!0})})},"esri/layers/support/sublayerUtils":function(){define(["exports"],function(E){function M(v,A){if(!v||!v.length)return!0;A=A.slice().reverse().flatten(({sublayers:H})=>H&&H.toArray().reverse()).map(H=>H.id).toArray();if(v.length>A.length)return!1;let u=0;const J=A.length;
for(const {id:H}of v){for(;u<J&&A[u]!==H;)u++;if(u>=J)return!1}return!0}E.isExportDynamic=function(v,A,u){return v.some(J=>{const H=J.source;return!(!H||"map-layer"===H.type&&H.mapLayerId===J.id&&(!H.gdbVersion||H.gdbVersion===u.gdbVersion))||2<J.originIdOf("renderer")||2<J.originIdOf("labelingInfo")||2<J.originIdOf("opacity")||2<J.originIdOf("labelsVisible")})?!0:!M(v,A)};E.isSublayerOverhaul=function(v){return!!v&&v.some(A=>null!=A.minScale||A.layerDefinition&&null!=A.layerDefinition.minScale)};
E.shouldWriteSublayerStructure=function(v,A,u){return A.flatten(({sublayers:J})=>J).length!==v.length||v.some(J=>J.originIdOf("minScale")>u||J.originIdOf("maxScale")>u||J.originIdOf("renderer")>u||J.originIdOf("labelingInfo")>u||J.originIdOf("opacity")>u||J.originIdOf("labelsVisible")>u||J.originIdOf("source")>u)?!0:!M(v,A)};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/renderers/support/rendererConversion":function(){define(["exports","../../core/has","../../core/Error","../../core/maybe",
"../../symbols/support/symbolConversion"],function(E,M,v,A,u){function J(p){return A.isNone(p)||"simple"===p.type||"unique-value"===p.type||"class-breaks"===p.type||"dictionary"===p.type}function H(p,z){if(!z)return null;z=Array.isArray(z)?z:[z];if(0<z.length){const d=z.map(c=>c.details.symbol.type||c.details.symbol.declaredClass).filter(c=>!!c);d.sort();const e=[];d.forEach((c,h)=>{0!==h&&c===d[h-1]||e.push(c)});return new v("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${e.join(", ")}) which are not supported in 3D`,
{renderer:p,symbolErrors:z})}return null}function I(p){const z=p.uniqueValueInfos.map(e=>u.to3D(e.symbol).error).filter(e=>!!e),d=u.to3D(p.defaultSymbol);d.error&&z.unshift(d.error);return H(p,z)}function R(p){const z=p.classBreakInfos.map(e=>u.to3D(e.symbol).error).filter(e=>!!e),d=u.to3D(p.defaultSymbol);d.error&&z.unshift(d.error);return H(p,z)}E.isSupportedRenderer3D=J;E.validateTo3D=function(p){if(A.isNone(p))return null;if(!J(p))return new v("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${p.type||
p.declaredClass}'`,{renderer:p});switch(p.type){case "simple":return H(p,u.to3D(p.symbol).error);case "unique-value":return I(p);case "class-breaks":return R(p)}return null};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(E,M,v){function A(d){d=v.toCIMSymbolJSON(d);if("CIMTextSymbol"===d.type)return d.height;let e=0;if(d.symbolLayers)for(const c of d.symbolLayers)v.isCIMMarker(c)&&c.size>
e?e=c.size:v.isCIMStroke(c)&&c.width>e?e=c.width:v.isCIMFill(c);return e}function u(d,e,c,h){if("CIMTextSymbol"===d.type)d.height*=e;else{if(c&&d.effects)for(const g of d.effects)I(g,e);if(d.symbolLayers)for(const g of d.symbolLayers)switch(g.type){case "CIMPictureMarker":case "CIMVectorMarker":J(g,e,h);break;case "CIMPictureStroke":case "CIMSolidStroke":null!=h&&h.preserveOutlineWidth||(g.width*=e);break;case "CIMPictureFill":g.height*=e;g.offsetX*=e;g.offsetY*=e;break;case "CIMHatchFill":u(g.lineSymbol,
e,!0,{...h,preserveOutlineWidth:!1}),g.offsetX*=e,g.offsetY*=e,g.separation*=e}}}function J(d,e,c){d.markerPlacement&&H(d.markerPlacement,e);d.offsetX*=e;d.offsetY*=e;d.anchorPoint&&"Absolute"===d.anchorPointUnits&&(d.anchorPoint={x:d.anchorPoint.x*e,y:d.anchorPoint.y*e});d.size*=e;if("CIMVectorMarker"===d.type&&d.markerGraphics)for(const h of d.markerGraphics)d.scaleSymbolsProportionally||u(h.symbol,e,!0,c)}function H(d,e){v.isCIMMarkerStrokePlacement(d)&&(d.offset*=e);switch(d.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":d.customEndingOffset*=
e;d.offsetAlongLine*=e;if(d.placementTemplate&&d.placementTemplate.length){var c=d.placementTemplate.map(h=>h*e);d.placementTemplate=c}break;case "CIMMarkerPlacementAlongLineVariableSize":d.maxRandomOffset*=e;d.placementTemplate&&d.placementTemplate.length&&(c=d.placementTemplate.map(h=>h*e),d.placementTemplate=c);break;case "CIMMarkerPlacementOnLine":d.startPointOffset*=e;break;case "CIMMarkerPlacementAtExtremities":d.offsetAlongLine*=e;break;case "CIMMarkerPlacementAtRatioPositions":d.beginPosition*=
e;d.endPosition*=e;break;case "CIMMarkerPlacementPolygonCenter":d.offsetX*=e;d.offsetY*=e;break;case "CIMMarkerPlacementInsidePolygon":d.offsetX*=e,d.offsetY*=e,d.stepX*=e,d.stepY*=e}}function I(d,e){switch(d.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":d.width*=e;break;case "CIMGeometricEffectBuffer":d.size*=e;break;case "CIMGeometricEffectCut":d.beginCut*=e;d.endCut*=e;d.middleCut*=e;break;case "CIMGeometricEffectDashes":d.customEndingOffset*=e;d.offsetAlongLine*=e;if(d.dashTemplate&&
d.dashTemplate.length){const c=d.dashTemplate.map(h=>h*e);d.dashTemplate=c}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":d.length*=e;break;case "CIMGeometricEffectMove":d.offsetX*=e;d.offsetY*=e;break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":d.offset*=e;break;case "CIMGeometricEffectRegularPolygon":d.radius*=e;break;case "CIMGeometricEffectTaperedPolygon":d.fromWidth*=e;d.length*=e;d.toWidth*=e;break;case "CIMGeometricEffectWave":d.amplitude*=
e,d.period*=e}}function R(d,e){let c;c="CIMTextSymbol"===d.type?d.symbol:d;d="CIMPolygonSymbol"===d.type;if(c.symbolLayers)for(const h of c.symbolLayers)if(!(h.colorLocked||d&&(v.isCIMStroke(h)||v.isCIMMarker(h)&&h.markerPlacement&&v.isCIMMarkerStrokePlacement(h.markerPlacement))))switch(h.type){case "CIMVectorMarker":h.markerGraphics.forEach(g=>{R(g.symbol,e)});break;case "CIMSolidStroke":case "CIMSolidFill":p(e,h.color);break;case "CIMHatchFill":R(h.lineSymbol,e)}}function p(d,e){for(const c of d)if(c.join(".")===
e.join("."))return;d.push(e)}function z(d,e){var c="CIMTextSymbol"===d.type?d.symbol:d;d="CIMPolygonSymbol"===d.type?!0:!1;if(c.symbolLayers)for(const h of c.symbolLayers)if(!(h.colorLocked||d&&(v.isCIMStroke(h)||v.isCIMMarker(h)&&h.markerPlacement&&v.isCIMMarkerStrokePlacement(h.markerPlacement))))switch(c=e.toArray(0),h.type){case "CIMVectorMarker":h.markerGraphics.forEach(g=>{z(g.symbol,e)});break;case "CIMSolidStroke":case "CIMSolidFill":h.color=c;break;case "CIMHatchFill":z(h.lineSymbol,e)}}
E.applyCIMSymbolColor=function(d,e){e instanceof M||(e=new M(e));d=v.toCIMSymbolJSON(d);z(d,e)};E.applyCIMSymbolRotation=function(d,e,c=!1){d=v.toCIMSymbolJSON(d);c&&0!==e&&(e=360-e);if("CIMTextSymbol"===d.type)d.angle=e;else if("CIMPointSymbol"===d.type&&d.symbolLayers){c=e-(d.angle||0);for(const h of d.symbolLayers)if(v.isCIMMarker(h)){let g=h.rotation||0;g=h.rotateClockwise?g-c:g+c;h.rotation=g}d.angle=e}};E.getCIMSymbolColor=function(d){d=v.toCIMSymbolJSON(d);const e=[];R(d,e);return e.length?
new M(v.fromCIMColor(e[0])):null};E.getCIMSymbolRotation=function(d,e=!1){d=v.toCIMSymbolJSON(d);return"CIMTextSymbol"===d.type||"CIMPointSymbol"===d.type?e&&0!==d.angle?360-d.angle:d.angle||0:0};E.getCIMSymbolSize=A;E.scaleCIMMarker=J;E.scaleCIMSymbolTo=function(d,e,c){const h=v.toCIMSymbolJSON(d);d=A(d);if(0===d)if("CIMTextSymbol"===h.type)h.height=e;else{if(h.symbolLayers)for(const g of h.symbolLayers)switch(g.type){case "CIMPictureMarker":case "CIMVectorMarker":g.size=e;break;case "CIMPictureStroke":case "CIMSolidStroke":g.width=
e}}else u(h,e/d,!1,c)};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/symbols/cim/utils":function(){define(["exports"],function(E){function M(v,A){"string"!==typeof v&&(v=String(v));switch(A){case "LowerCase":return v.toLowerCase();case "Allcaps":return v.toUpperCase();default:return v}}E._adjustTextCase=M;E.colorToArray=function(v){return[v.r,v.g,v.b,v.a]};E.createLabelOverrideFunction=function(v,A,u){const J=p=>{let z=p.length;for(;z--;)if(-1===" /-,\n".indexOf(p.charAt(z)))return!1;
return!0},H=[];var I=0;let R=-1;do R=A.indexOf("[",I),R>=I&&(R>I&&(I=A.substr(I,R-I),H.push([I,null,J(I)])),I=R+1,R=A.indexOf("]",I),R>=I&&(R>I&&(I=A.substr(I,R-I),(I=v[I])&&H.push([null,I,!1])),I=R+1));while(-1!==R);I<A.length-1&&(v=A.substr(I),H.push([v,null,J(v)]));return p=>{let z="",d=null;for(const e of H){const [c,h,g]=e;if(c)g?d=c:(d&&(z+=d,d=null),z+=c);else{const n=p.attributes[h];n&&(d&&(z+=d,d=null),z+=n)}}return M(z,u)}};E.evaluateValueOrFunction=function(v,A,u,J){return"function"===
typeof v?v(A,u,J):v};E.fromCIMColor=function(v){return v?{r:v[0],g:v[1],b:v[2],a:v[3]/255}:{r:0,g:0,b:0,a:0}};E.getValue=v=>isNaN(v)||!v?0:v;E.isCIMFill=function(v){return"CIMGradientFill"===v.type||"CIMHatchFill"===v.type||"CIMPictureFill"===v.type||"CIMSolidFill"===v.type||"CIMWaterFill"===v.type};E.isCIMMarker=function(v){return"CIMVectorMarker"===v.type||"CIMPictureMarker"===v.type||"CIMBarChartMarker"===v.type||"CIMCharacterMarker"===v.type||"CIMPieChartMarker"===v.type||"CIMStackedBarChartMarker"===
v.type};E.isCIMMarkerStrokePlacement=function(v){return"CIMMarkerPlacementAlongLineRandomSize"===v.type||"CIMMarkerPlacementAlongLineSameSize"===v.type||"CIMMarkerPlacementAlongLineVariableSize"===v.type||"CIMMarkerPlacementAtExtremities"===v.type||"CIMMarkerPlacementAtMeasuredUnits"===v.type||"CIMMarkerPlacementAtRatioPositions"===v.type||"CIMMarkerPlacementOnLine"===v.type||"CIMMarkerPlacementOnVertices"===v.type};E.isCIMStroke=function(v){return"CIMGradientStroke"===v.type||"CIMPictureStroke"===
v.type||"CIMSolidStroke"===v.type};E.resampleHermite=function(v,A,u,J,H,I,R=!0){const p=A/H;u/=I;const z=Math.ceil(p/2),d=Math.ceil(u/2);for(let h=0;h<I;h++)for(let g=0;g<H;g++){const n=4*(g+(R?I-h-1:h)*H);var e=0;let B=0,r=0,G=0,l=0,t=0,P=0;const w=(h+.5)*u;for(let q=Math.floor(h*u);q<(h+1)*u;q++){var c=Math.abs(w-(q+.5))/d;const L=(g+.5)*p;c*=c;for(let U=Math.floor(g*p);U<(g+1)*p;U++){let C=Math.abs(L-(U+.5))/z;e=Math.sqrt(c+C*C);-1<=e&&1>=e&&(e=2*e*e*e-3*e*e+1,0<e&&(C=4*(U+q*A),P+=e*v[C+3],r+=
e,255>v[C+3]&&(e=e*v[C+3]/250),G+=e*v[C],l+=e*v[C+1],t+=e*v[C+2],B+=e))}}J[n]=G/B;J[n+1]=l/B;J[n+2]=t/B;J[n+3]=P/r}};E.toCIMSymbolJSON=function(v){var A;return null==(A=v.data)?void 0:A.symbol};E.toKebabCase=v=>v&&v.toLowerCase().replace(/\s+/g,"-");Object.defineProperty(E,"__esModule",{value:!0})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),
function(E,M,v,A,u,J,H,I,R,p){function z(e,c,h){return e?v(e,{responseType:"image"}).then(g=>{g=g.data;const n=g.width,B=g.height,r=n/B;let G=c;h&&(G=Math.min(G,Math.max(n,B)));return{image:g,width:1>=r?Math.ceil(G*r):G,height:1>=r?G:Math.ceil(G/r)}}):Promise.reject(new u("renderUtils: imageDataSize","href not provided."))}const d=I.createProjector();E.renderSymbol=function(e,c,h){const g=Math.ceil(c[0]);c=Math.ceil(c[1]);if(!e.some(B=>!!B.length))return null;const n=h&&h.node||document.createElement("div");
null!=h.opacity&&(n.style.opacity=h.opacity.toString());null!=h.effectView&&(n.style.filter=p.getCSSFilterFromEffectList(h.effectView));d.append(n,R.renderSVG.bind(null,e,g,c,h));return n};E.tintImageWithColor=function(e,c,h,g,n){return z(e,c,n).then(B=>{const r=B.width?B.width:c,G=B.height?B.height:c;var l;if(l=B.image)l=h&&"ignore"!==g?"multiply"===g&&255===h.r&&255===h.g&&255===h.b&&1===h.a?!1:!0:!1;if(l){var t=B.image.width,P=B.image.height;J("edge")&&/\.svg$/i.test(e)&&(--t,--P);l=Math.ceil(r);
var w=Math.ceil(G);var q=document.createElement("canvas");q.width=l;q.height=w;q.style.width=l+"px";q.style.height=w+"px";q=q.getContext("2d");q.clearRect(0,0,l,w);l=q;l.drawImage(B.image,0,0,t,P,0,0,r,G);w=l.getImageData(0,0,r,G);q=[h.r/255,h.g/255,h.b/255,h.a];const U=A.toHSV(h);for(let C=0;C<w.data.length;C+=4){B=w.data;t=C;P=q;var L=U;switch(g){case "multiply":B[t+0]*=P[0];B[t+1]*=P[1];B[t+2]*=P[2];B[t+3]*=P[3];break;default:{const D=A.toHSV({r:B[t+0],g:B[t+1],b:B[t+2]});D.h=L.h;D.s=L.s;D.v=D.v/
100*L.v;L=A.toRGB(D);B[t+0]=L.r;B[t+1]=L.g;B[t+2]=L.b;B[t+3]*=P[3]}}}l.putImageData(w,0,0);e=l.canvas.toDataURL("image/png")}else(l=M.id&&M.id.findCredential(e))&&l.token&&(B=-1===e.indexOf("?")?"?":"\x26",e=`${e}${B}token=${l.token}`);return{url:e,width:r,height:G}}).catch(function(){return{url:e,width:c,height:c}})};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/core/colorUtils":function(){define(["exports"],function(E){function M(p,z){const d=[];let e,c;if(p[0].length!==z.length)throw"dimensions do not match";
const h=p.length,g=p[0].length;let n=0;for(e=0;e<h;e++){for(c=n=0;c<g;c++)n+=p[e][c]*z[c];d.push(n)}return d}function v(p){p=[p.r/255,p.g/255,p.b/255].map(z=>.04045>=z?z/12.92:((z+.055)/1.055)**2.4);p=M(I,p);return{x:100*p[0],y:100*p[1],z:100*p[2]}}function A(p){p=M(R,[p.x/100,p.y/100,p.z/100]).map(z=>Math.min(1,Math.max(.0031308>=z?12.92*z:1.055*z**(1/2.4)-.055,0)));return{r:Math.round(255*p[0]),g:Math.round(255*p[1]),b:Math.round(255*p[2])}}function u(p){p=[p.x/95.047,p.y/100,p.z/108.883].map(z=>
z>(6/29)**3?z**(1/3):1/3*(29/6)**2*z+4/29);return{l:116*p[1]-16,a:500*(p[0]-p[1]),b:200*(p[1]-p[2])}}function J(p){const z=p.l;p=[(z+16)/116+p.a/500,(z+16)/116,(z+16)/116-p.b/200].map(d=>d>6/29?d**3:3*(6/29)**2*(d-4/29));return{x:95.047*p[0],y:100*p[1],z:108.883*p[2]}}function H(p){if("r"in p&&"g"in p&&"b"in p)return p;if("l"in p&&"c"in p&&"h"in p){var z=p.c;var d=p.h;z={l:p.l,a:z*Math.cos(d),b:z*Math.sin(d)};return A(J(z))}if("l"in p&&"a"in p&&"b"in p)return A(J(p));if("x"in p&&"y"in p&&"z"in p)return A(p);
if("h"in p&&"s"in p&&"v"in p){{d=(p.h+360)%360/60;z=p.v/100*255;p=p.s/100*z;const e=p*(1-Math.abs(d%2-1));switch(Math.floor(d)){case 0:d={r:p,g:e,b:0};break;case 1:d={r:e,g:p,b:0};break;case 2:d={r:0,g:p,b:e};break;case 3:d={r:0,g:e,b:p};break;case 4:d={r:e,g:0,b:p};break;case 5:case 6:d={r:p,g:0,b:e};break;default:d={r:0,g:0,b:0}}d.r=Math.round(d.r+z-p);d.g=Math.round(d.g+z-p);d.b=Math.round(d.b+z-p);z=d}return z}return p}const I=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],R=[[3.2406,
-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];E.darken=function(p,z){p=u(v(p));p.l*=1-z;return A(J(p))};E.toHSV=function(p){if("h"in p&&"s"in p&&"v"in p)return p;var z=H(p);{p=z.r;const d=z.g,e=z.b;z=Math.max(p,d,e);const c=z-Math.min(p,d,e);p=0===c?0:z===p?(d-e)/c%6:z===d?(e-p)/c+2:(p-d)/c+4;0>p&&(p+=6);p={h:60*p,s:100*(0===c?0:c/z),v:100/255*z}}return p};E.toLAB=function(p){return"l"in p&&"a"in p&&"b"in p?p:u(v(H(p)))};E.toLCH=function(p){if(!("l"in p&&"c"in p&&"h"in p)){{var z=u(v(H(p)));
p=z.l;var d=z.a;const e=z.b;z=Math.sqrt(d*d+e*e);d=Math.atan2(e,d);d=0<d?d:d+2*Math.PI;p={l:p,c:z,h:d}}}return p};E.toRGB=H;E.toXYZ=function(p){return"x"in p&&"y"in p&&"z"in p?p:v(H(p))};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../core/Logger ../../widgets/support/jsxFactory".split(" "),function(E,M,v,A,u,J,H,I){function R(a,
f){a*=V/180;return Math.abs(f*Math.sin(a))+Math.abs(f*Math.cos(a))}function p(a){return a.map(f=>`${f.command} ${f.values.join(" ")}`).join(" ").trim()}function z(a,f,F,O){if(a){if("circle"===a.type)return I.tsx("circle",{fill:f,"fill-rule":"evenodd",stroke:F.color,"stroke-width":F.width,"stroke-linecap":F.cap,"stroke-linejoin":F.join,"stroke-dasharray":F.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,r:a.r});if("ellipse"===a.type)return I.tsx("ellipse",{fill:f,"fill-rule":"evenodd",stroke:F.color,
"stroke-width":F.width,"stroke-linecap":F.cap,"stroke-linejoin":F.join,"stroke-dasharray":F.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,rx:a.rx,ry:a.ry});if("rect"===a.type)return I.tsx("rect",{fill:f,"fill-rule":"evenodd",stroke:F.color,"stroke-width":F.width,"stroke-linecap":F.cap,"stroke-linejoin":F.join,"stroke-dasharray":F.dashArray,"stroke-miterlimit":"4",x:a.x,y:a.y,width:a.width,height:a.height});if("image"===a.type)return I.tsx("image",{href:a.src,x:a.x,y:a.y,width:a.width,height:a.height,
preserveAspectRatio:"none"});if("path"===a.type)return a="string"!==typeof a.path?p(a.path):a.path,I.tsx("path",{fill:f,"fill-rule":"evenodd",stroke:F.color,"stroke-width":F.width,"stroke-linecap":F.cap,"stroke-linejoin":F.join,"stroke-dasharray":F.dashArray,"stroke-miterlimit":"4",d:a});if("text"===a.type)return I.tsx("text",{fill:f,"fill-rule":"evenodd",stroke:F.color,"stroke-width":F.width,"stroke-linecap":F.cap,"stroke-linejoin":F.join,"stroke-dasharray":F.dashArray,"stroke-miterlimit":"4","text-anchor":O.align,
"text-decoration":O.decoration,kerning:O.kerning,rotate:O.rotate,"text-rendering":C,"font-style":O.font.style,"font-variant":O.font.variant,"font-weight":O.font.weight,"font-size":O.font.size,"font-family":O.font.family,x:a.x,y:a.y},a.text)}return null}function d(a){const f={fill:"none",pattern:null,linearGradient:null};if(a)if("type"in a&&"pattern"===a.type){var F=`patternId-${++L}`;f.fill=`url(#${F})`;f.pattern={id:F,x:a.x,y:a.y,width:a.width,height:a.height,image:{x:0,y:0,width:a.width,height:a.height,
href:a.src}}}else"type"in a&&"linear"===a.type?(F=`linearGradientId-${++U}`,f.fill=`url(#${F})`,f.linearGradient={id:F,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,stops:a.colors.map(O=>({offset:O.offset,color:O.color&&(new M(O.color)).toString()}))}):a&&(a=new M(a),f.fill=a.toString());return f}function e(a){const f={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(a&&(null!=a.width&&(f.width=a.width),a.cap&&(f.cap=a.cap),a.join&&(f.join=a.join.toString()),a.color&&(f.color=(new M(a.color)).toString()),
a.style)){let O=null;a.style in Q&&(O=Q[a.style]);if(Array.isArray(O)){O=O.slice(0);for(var F=0;F<O.length;++F)O[F]*=a.width;if("butt"!==a.cap){for(F=0;F<O.length;F+=2)O[F]-=a.width,1>O[F]&&(O[F]=1);for(F=1;F<O.length;F+=2)O[F]+=a.width}O=O.join(",")}f.dashArray=O}return f}function c(a,f){const F={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};a&&(F.align=a.align,F.decoration=a.decoration,F.kerning=a.kerning?"auto":"0",F.rotate=
a.rotated?"90":"0",F.font.style=f.style||"normal",F.font.variant=f.variant||"normal",F.font.weight=f.weight||"normal",F.font.size=f.size&&f.size.toString()||"10pt",F.font.family=f.family||"serif");return F}function h(a){const {pattern:f,linearGradient:F}=a;return f?I.tsx("pattern",{id:f.id,patternUnits:"userSpaceOnUse",x:f.x,y:f.y,width:f.width,height:f.height},I.tsx("image",{x:f.image.x,y:f.image.y,width:f.image.width,height:f.image.height,href:f.image.href})):F?(a=F.stops.map((O,Y)=>I.tsx("stop",
{key:`${Y}-stop`,offset:O.offset,"stop-color":O.color})),I.tsx("linearGradient",{id:F.id,gradientUnits:"userSpaceOnUse",x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2},a)):null}function g(a,f,F){return u.translate(a,u.identity(a),[f,F])}function n(a,f,F,O,Y){u.scale(a,u.identity(a),[f,F]);a[4]=a[4]*f-O*f+O;a[5]=a[5]*F-Y*F+Y;return a}function B(a,f,F,O){var Y=f%360*Math.PI/180;u.rotate(a,u.identity(a),Y);f=Math.cos(Y);Y=Math.sin(Y);const ba=a[4],ea=a[5];a[4]=ba*f-ea*Y+O*Y-F*f+F;a[5]=ea*f+ba*Y-F*Y-O*f+O;return a}
function r(a,f){k&&"left"in k?(k.left>a&&(k.left=a),k.right<a&&(k.right=a),k.top>f&&(k.top=f),k.bottom<f&&(k.bottom=f)):k={left:a,bottom:f,right:a,top:f}}function G(a){const f=a.args,F=f.length;switch(a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(a=0;a<F;a+=2)r(f[a],f[a+1]);y.x=f[F-2];y.y=f[F-1];break;case "H":for(a=0;a<F;++a)r(f[a],y.y);y.x=f[F-1];break;case "V":for(a=0;a<F;++a)r(y.x,f[a]);y.y=f[F-1];break;case "m":a=0;"x"in y||(r(y.x=f[0],y.y=f[1]),a=2);for(;a<F;a+=2)r(y.x+=
f[a],y.y+=f[a+1]);break;case "l":case "t":for(a=0;a<F;a+=2)r(y.x+=f[a],y.y+=f[a+1]);break;case "h":for(a=0;a<F;++a)r(y.x+=f[a],y.y);break;case "v":for(a=0;a<F;++a)r(y.x,y.y+=f[a]);break;case "c":for(a=0;a<F;a+=6)r(y.x+f[a],y.y+f[a+1]),r(y.x+f[a+2],y.y+f[a+3]),r(y.x+=f[a+4],y.y+=f[a+5]);break;case "s":case "q":for(a=0;a<F;a+=4)r(y.x+f[a],y.y+f[a+1]),r(y.x+=f[a+2],y.y+=f[a+3]);break;case "A":for(a=0;a<F;a+=7)r(f[a+5],f[a+6]);y.x=f[F-2];y.y=f[F-1];break;case "a":for(a=0;a<F;a+=7)r(y.x+=f[a+5],y.y+=f[a+
6])}}function l(a,f,F){const O=D[a.toLowerCase()];"number"===typeof O&&(O?f.length>=O&&(a={action:a,args:f.slice(0,f.length-f.length%O)},F.push(a),G(a)):(a={action:a,args:[]},F.push(a),G(a)))}function t(a){const f={x:0,y:0,width:0,height:0};if("circle"===a.type)f.x=a.cx-a.r,f.y=a.cy-a.r,f.width=2*a.r,f.height=2*a.r;else if("ellipse"===a.type)f.x=a.cx-a.rx,f.y=a.cy-a.ry,f.width=2*a.rx,f.height=2*a.ry;else if("image"===a.type||"rect"===a.type)f.x=a.x,f.y=a.y,f.width=a.width,f.height=a.height;else if("path"===
a.type){{const Y=("string"!==typeof a.path?p(a.path):a.path).match(K),ba=[];k={};y={};if(Y){a="";var F=[],O=Y.length;for(let ea=0;ea<O;++ea){const ia=Y[ea],ca=parseFloat(ia);isNaN(ca)?(a&&l(a,F,ba),F=[],a=ia):F.push(ca)}l(a,F,ba);a={x:0,y:0,width:0,height:0};k&&"left"in k&&(a.x=k.left,a.y=k.top,a.width=k.right-k.left,a.height=k.bottom-k.top)}else a=null}f.x=a.x;f.y=a.y;f.width=a.width;f.height=a.height}return f}function P(a){const f={x:0,y:0,width:0,height:0};let F=null,O=Number.NEGATIVE_INFINITY,
Y=Number.NEGATIVE_INFINITY;for(const ba of a)F?(F.x=Math.min(F.x,ba.x),F.y=Math.min(F.y,ba.y),O=Math.max(O,ba.x+ba.width),Y=Math.max(Y,ba.y+ba.height)):(F=f,F.x=ba.x,F.y=ba.y,O=ba.x+ba.width,Y=ba.y+ba.height);F&&(F.width=O-F.x,F.height=Y-F.y);return F}function w(a,f,F,O,Y,ba,ea,ia,ca){var Z=(ea&&ba?R(ba,f):f)/2,ma=(ea&&ba?R(ba,F):F)/2;ca&&(Z=ca[0],ma=ca[1],Z=(ea&&ba?R(ba,Z):Z)/2,ma=(ea&&ba?R(ba,ma):ma)/2);const ka=a.width+O,fa=a.height+O;ea=A.create();ca=A.create();var ja=!1;if(Y&&0!==ka&&0!==fa){Y=
ka/fa;ja=f>F?f:F;let ta=1,pa=1;isNaN(ja)||(1<Y?(ta=ja/ka,pa=ja/Y/fa):(pa=ja/fa,ta=ja*Y/ka));u.multiply(ca,ca,n(ea,ta,pa,Z,ma));ja=!0}Y=a.x+(ka-O)/2;a=a.y+(fa-O)/2;u.multiply(ca,ca,g(ea,Z-Y,ma-a));!ja&&(ka>f||fa>F)&&(O=ka/f>fa/F,f=(O?f:F)/(O?ka:fa),u.multiply(ca,ca,n(ea,f,f,Y,a)));ba&&u.multiply(ca,ca,B(ea,ba,Y,a));ia&&u.multiply(ca,ca,g(ea,ia[0],ia[1]));return`matrix(${ca[0]},${ca[1]},${ca[2]},${ca[3]},${ca[4]},${ca[5]})`}function q(a,f,F){a=null==a?void 0:a.effects.find(ia=>"bloom"===ia.type);if(!a)return null;
const {strength:O,radius:Y}=a;a=0<O?Y:0;const ba=(O+a)*f,ea=4*O+1;return I.tsx("filter",{id:`bloom${F}`,x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},I.tsx("feMorphology",{operator:"dilate",radius:(O+.5*a)*5**(f/100)*(.4+f/100),in:"SourceGraphic",result:"dilate"}),I.tsx("feGaussianBlur",{in:"dilate",stdDeviation:ba/25,result:"blur"}),I.tsx("feGaussianBlur",{in:"blur",stdDeviation:ba/50,result:"intensityBlur"}),I.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},
I.tsx("feFuncR",{type:"linear",slope:ea}),I.tsx("feFuncG",{type:"linear",slope:ea}),I.tsx("feFuncB",{type:"linear",slope:ea})),I.tsx("feMerge",null,I.tsx("feMergeNode",{in:"intensityBlur"}),I.tsx("feMergeNode",{in:"intensityBrightness"}),I.tsx("feGaussianBlur",{stdDeviation:O/10})))}let L=0,U=0;J=v("android");const C=v("chrome")||J&&4<=J?"auto":"optimizeLegibility",D={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},K=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let k={},y={};const Q={solid:"none",
shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},V=Math.PI;let W=1;E.computeBBox=P;E.generateFillAttributes=d;E.generateStrokeAttributes=e;E.generateTextAttributes=c;E.getBoundingBox=t;E.getTransformMatrix=w;E.renderDef=h;E.renderSVG=function(a,f,F,O){const Y=[],ba=[],ea=++W,ia=q(null==O?void 0:O.effectView,f,ea);var ca=null;if(ia){var Z;ca=null==O?void 0:null==
(Z=O.effectView)?void 0:Z.effects.find(ma=>"bloom"===ma.type);ca=(ca.strength?ca.strength+ca.radius/2:0)/3;ca=[Math.max(f+f*ca,10),Math.max(F+F*ca,10)]}for(const ma of a){a=[];Z=[];let ka=0,fa=0,ja=0;for(const ta of ma){const {shape:pa,fill:ya,stroke:za,font:Aa,offset:Ba}=ta;ka+=za&&za.width||0;const Fa=d(ya),Ga=e(za),Da="text"===pa.type?c(pa,Aa):null;Y.push(h(Fa));a.push(z(pa,Fa.fill,Ga,Da));Z.push(t(pa));Ba&&(fa+=Ba[0],ja+=Ba[1])}Z=w(P(Z),f,F,ka,null==O?void 0:O.scale,null==O?void 0:O.rotation,
null==O?void 0:O.useRotationSize,[fa,ja],ca);ba.push(I.tsx("g",{transform:Z},a))}null!=O&&O.useRotationSize&&null!=O&&O.rotation&&(f=R(null==O?void 0:O.rotation,f),F=R(null==O?void 0:O.rotation,F));ia&&(f=ca[0],F=ca[1]);return I.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:f,height:F},ia,I.tsx("defs",null,Y),ia?I.tsx("g",{filter:`url(#bloom${ea})`},ba):ba)};E.renderShape=z;Object.defineProperty(E,"__esModule",{value:!0})})},"esri/chunks/mat2df32":function(){define(["exports"],function(E){function M(){const R=
new Float32Array(6);R[0]=1;R[3]=1;return R}function v(R){const p=new Float32Array(6);p[0]=R[0];p[1]=R[1];p[2]=R[2];p[3]=R[3];p[4]=R[4];p[5]=R[5];return p}function A(R,p,z,d,e,c){const h=new Float32Array(6);h[0]=R;h[1]=p;h[2]=z;h[3]=d;h[4]=e;h[5]=c;return h}function u(R,p){return new Float32Array(R,p,6)}function J(R,p,z,d){const e=p[d];p=p[d+1];R[d]=z[0]*e+z[2]*p+z[4];R[d+1]=z[1]*e+z[3]*p+z[5]}function H(R,p,z,d=0,e=0,c=2){for(e=e||p.length/c;d<e;d++)J(R,p,z,d*c)}const I=Object.freeze({__proto__:null,
create:M,clone:v,fromValues:A,createView:u,transform:J,transformMany:H});E.clone=v;E.create=M;E.createView=u;E.fromValues=A;E.mat2df32=I;E.transform=J;E.transformMany=H})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(E,M){function v(w,q){w[0]=q[0];w[1]=q[1];w[2]=q[2];w[3]=q[3];w[4]=q[4];w[5]=q[5];return w}function A(w){w[0]=1;w[1]=0;w[2]=0;w[3]=1;w[4]=0;w[5]=0;return w}function u(w,q,L,U,C,D,K){w[0]=q;w[1]=L;w[2]=U;w[3]=C;w[4]=D;w[5]=K;return w}function J(w,q){const L=q[0],
U=q[1],C=q[2],D=q[3],K=q[4];q=q[5];let k=L*D-U*C;if(!k)return null;k=1/k;w[0]=D*k;w[1]=-U*k;w[2]=-C*k;w[3]=L*k;w[4]=(C*q-D*K)*k;w[5]=(U*K-L*q)*k;return w}function H(w){return w[0]*w[3]-w[1]*w[2]}function I(w,q,L){const U=q[0],C=q[1],D=q[2],K=q[3],k=q[4];q=q[5];const y=L[0],Q=L[1],V=L[2],W=L[3],a=L[4];L=L[5];w[0]=U*y+D*Q;w[1]=C*y+K*Q;w[2]=U*V+D*W;w[3]=C*V+K*W;w[4]=U*a+D*L+k;w[5]=C*a+K*L+q;return w}function R(w,q,L){const U=q[0],C=q[1],D=q[2],K=q[3],k=q[4];q=q[5];const y=Math.sin(L);L=Math.cos(L);w[0]=
U*L+D*y;w[1]=C*L+K*y;w[2]=U*-y+D*L;w[3]=C*-y+K*L;w[4]=k;w[5]=q;return w}function p(w,q,L){const U=q[1],C=q[2],D=q[3],K=q[4],k=q[5],y=L[0];L=L[1];w[0]=q[0]*y;w[1]=U*y;w[2]=C*L;w[3]=D*L;w[4]=K;w[5]=k;return w}function z(w,q,L){const U=q[0],C=q[1],D=q[2],K=q[3],k=q[4];q=q[5];const y=L[0];L=L[1];w[0]=U;w[1]=C;w[2]=D;w[3]=K;w[4]=U*y+D*L+k;w[5]=C*y+K*L+q;return w}function d(w,q){const L=Math.sin(q);q=Math.cos(q);w[0]=q;w[1]=L;w[2]=-L;w[3]=q;w[4]=0;w[5]=0;return w}function e(w,q){w[0]=q[0];w[1]=0;w[2]=0;
w[3]=q[1];w[4]=0;w[5]=0;return w}function c(w,q){w[0]=1;w[1]=0;w[2]=0;w[3]=1;w[4]=q[0];w[5]=q[1];return w}function h(w){return"mat2d("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+")"}function g(w){return Math.sqrt(w[0]**2+w[1]**2+w[2]**2+w[3]**2+w[4]**2+w[5]**2+1)}function n(w,q,L){w[0]=q[0]+L[0];w[1]=q[1]+L[1];w[2]=q[2]+L[2];w[3]=q[3]+L[3];w[4]=q[4]+L[4];w[5]=q[5]+L[5];return w}function B(w,q,L){w[0]=q[0]-L[0];w[1]=q[1]-L[1];w[2]=q[2]-L[2];w[3]=q[3]-L[3];w[4]=q[4]-L[4];w[5]=q[5]-L[5];
return w}function r(w,q,L){w[0]=q[0]*L;w[1]=q[1]*L;w[2]=q[2]*L;w[3]=q[3]*L;w[4]=q[4]*L;w[5]=q[5]*L;return w}function G(w,q,L,U){w[0]=q[0]+L[0]*U;w[1]=q[1]+L[1]*U;w[2]=q[2]+L[2]*U;w[3]=q[3]+L[3]*U;w[4]=q[4]+L[4]*U;w[5]=q[5]+L[5]*U;return w}function l(w,q){return w[0]===q[0]&&w[1]===q[1]&&w[2]===q[2]&&w[3]===q[3]&&w[4]===q[4]&&w[5]===q[5]}function t(w,q){const L=w[0],U=w[1],C=w[2],D=w[3],K=w[4];w=w[5];const k=q[0],y=q[1],Q=q[2],V=q[3],W=q[4];q=q[5];return Math.abs(L-k)<=M.EPSILON*Math.max(1,Math.abs(L),
Math.abs(k))&&Math.abs(U-y)<=M.EPSILON*Math.max(1,Math.abs(U),Math.abs(y))&&Math.abs(C-Q)<=M.EPSILON*Math.max(1,Math.abs(C),Math.abs(Q))&&Math.abs(D-V)<=M.EPSILON*Math.max(1,Math.abs(D),Math.abs(V))&&Math.abs(K-W)<=M.EPSILON*Math.max(1,Math.abs(K),Math.abs(W))&&Math.abs(w-q)<=M.EPSILON*Math.max(1,Math.abs(w),Math.abs(q))}const P=Object.freeze({__proto__:null,copy:v,identity:A,set:u,invert:J,determinant:H,multiply:I,rotate:R,scale:p,translate:z,fromRotation:d,fromScaling:e,fromTranslation:c,str:h,
frob:g,add:n,subtract:B,multiplyScalar:r,multiplyScalarAndAdd:G,exactEquals:l,equals:t,mul:I,sub:B});E.add=n;E.copy=v;E.determinant=H;E.equals=t;E.exactEquals=l;E.frob=g;E.fromRotation=d;E.fromScaling=e;E.fromTranslation=c;E.identity=A;E.invert=J;E.mat2d=P;E.mul=I;E.multiply=I;E.multiplyScalar=r;E.multiplyScalarAndAdd=G;E.rotate=R;E.scale=p;E.set=u;E.str=h;E.sub=B;E.subtract=B;E.translate=z})},"esri/symbols/support/utils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(E,M,v,A,u,J,H,I,R,p,z,d,e){function c(k){k=k.symbolLayers;if(!k)return null;let y=null;k.forEach(Q=>{if("object"!==Q.type||null==Q.resource.href)y="water"===Q.type?I.unwrap(Q.color):I.isSome(Q.material)?I.unwrap(Q.material.color):null});return y?new A(y):null}function h(k,y){if(null==y)return k;k=k.toRgba();k[3]*=y;return new A(k)}function g(k,y,Q){if(k=k.symbolLayers){var V=W=>{W=I.isSome(W)?W:null;y=y||W||null!=Q&&K;return h(y,Q)};k.forEach(W=>{if("object"!==W.type||null==W.resource.href||
y)if("water"===W.type)W.color=V(W.color);else{var a=I.isSome(W.material)?W.material.color:null;a=V(a);I.isNone(W.material)?W.material=new e.default({color:a}):W.material.color=a;null!=Q&&"outline"in W&&I.isSome(W.outline)&&I.isSome(W.outline.color)&&(W.outline.color=h(W.outline.color,Q))}})}}function n(k,y){return B.apply(this,arguments)}function B(){B=v._asyncToGenerator(function*(k,y){(k=k.symbolLayers)&&(yield J.forEach(k,function(){var Q=v._asyncToGenerator(function*(V){return r(V,y)});return function(V){return Q.apply(this,
arguments)}}()))});return B.apply(this,arguments)}function r(k,y){return G.apply(this,arguments)}function G(){G=v._asyncToGenerator(function*(k,y){switch(k.type){case "extrude":k.size="number"===typeof y[2]?y[2]:0;break;case "icon":case "line":case "text":y=l(y);I.isSome(y)&&(k.size=y);break;case "path":{const Q=w(y,p.ONES,[k.width,void 0,k.height]);k.width=U(y[0],k.width,1,Q);k.height=U(y[2],k.height,1,Q)}break;case "object":yield t(k,y)}});return G.apply(this,arguments)}function l(k){for(const y of k)if("number"===
typeof y)return y;return null}function t(k,y){return P.apply(this,arguments)}function P(){P=v._asyncToGenerator(function*(k,y){const {resourceSize:Q,symbolSize:V}=yield q(k),W=w(y,Q,V);k.width=U(y[0],V[0],Q[0],W);k.depth=U(y[1],V[1],Q[1],W);k.height=U(y[2],V[2],Q[2],W)});return P.apply(this,arguments)}function w(k,y,Q){for(let V=0;3>V;V++){const W=k[V];switch(W){case "symbol-value":return null!=Q[V]?Q[V]/y[V]:1;case "proportional":break;default:if(W&&y[V])return W/y[V]}}return 1}function q(k){return L.apply(this,
arguments)}function L(){L=v._asyncToGenerator(function*(k){const y=yield(yield new Promise((F,O)=>E(["./symbolLayerUtils"],F,O))).computeObjectLayerResourceSize(k,10),{width:Q,height:V,depth:W}=k;k=[Q,W,V];let a=1;for(var f=0;3>f;f++)if(null!=k[f]){a=k[f]/y[f];break}for(f=0;3>f;f++)null==k[f]&&(k[f]=y[f]*a);return{resourceSize:y,symbolSize:k}});return L.apply(this,arguments)}function U(k,y,Q,V){switch(k){case "proportional":return Q*V;case "symbol-value":return null!=y?y:Q;default:return k}}function C(){C=
v._asyncToGenerator(function*(k,y){if(k&&y){if(u.isSymbol3D(k))return n(k,y);if(u.isSymbol2D(k)&&(y=l(y),!I.isNone(y)))switch(k.type){case "simple-marker":k.size=y;break;case "picture-marker":{const Q=k.width/k.height;1<Q?(k.width=y,k.height=y*Q):(k.width=y*Q,k.height=y);break}case "simple-line":k.width=y;break;case "text":k.font.size=y}}});return C.apply(this,arguments)}const D=/\/resource\/(.*?)\.svg$/,K=new A("white");M.applyColorToSymbol=function(k,y,Q){if(k&&(y||null!=Q))if(y&&(y=new A(y)),u.isSymbol3D(k))g(k,
y,Q);else if(u.isSymbol2D(k)){if(y=y||k.color)k.color=h(y,Q);null!=Q&&"outline"in k&&k.outline&&k.outline.color&&(k.outline.color=h(k.outline.color,Q))}};M.applyOpacityToColor=h;M.applyRotationToSymbol=function(k,y,Q){k&&null!=y&&(u.isSymbol3D(k)?(k=k.symbolLayers)&&k.forEach(V=>{if(V&&"object"===V.type)switch(Q){case "tilt":V.tilt=y;break;case "roll":V.roll=y;break;default:V.heading=y}}):!u.isSymbol2D(k)||"simple-marker"!==k.type&&"picture-marker"!==k.type&&"text"!==k.type||(k.angle=y))};M.applySizesToSymbol=
function(k,y){return C.apply(this,arguments)};M.getCSSFilterFromEffectList=function(k){if(!k)return null;k=k.effects.filter(y=>"bloom"!==y.type).map(y=>y.toJSON());return z.effectFunctionsFromJSON(k)};M.getColorFromSymbol=function(k,y){if(!k)return null;let Q=null;u.isSymbol3D(k)?Q=c(k):u.isSymbol2D(k)&&(Q=k.color?new A(k.color):null);return Q?h(Q,y):null};M.getIconHref=function(k,y){y=y.resource.href;return!H("esri-canvas-svg-support")&&k.styleOrigin&&D.test(y)?y.replace(D,"/resource/png/$1.png"):
y};M.getSymbolOutlineSize=function(k){if(!k)return 0;if(u.isSymbol3D(k)){{const y=k.symbolLayers&&k.symbolLayers.length;y?(k=k.symbolLayers.getItemAt(y-1),k="outline"in k?I.get(k,"outline","size"):void 0):k=void 0}return I.isSome(k)?k:0}return(k=d.getStroke(k))&&R.px2pt(k.width)||0};M.isVolumetricSymbol=function(k){if(I.isNone(k)||!("symbolLayers"in k)||I.isNone(k.symbolLayers))return!1;switch(k.type){case "point-3d":return k.symbolLayers.some(y=>"object"===y.type);case "line-3d":return k.symbolLayers.some(y=>
"path"===y.type);case "polygon-3d":return k.symbolLayers.some(y=>"object"===y.type||"extrude"===y.type);default:return!1}};Object.defineProperty(M,"__esModule",{value:!0})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(E,M,v,A,u,J,H){function I(e){if(!e)return null;let c;switch(e.type){case "simple-fill":case "picture-fill":case "simple-marker":c=I(e.outline);break;
case "simple-line":{const h=J.pt2px(e.width);"none"!==e.style&&0!==h&&(c={color:e.color,style:d(e.style),width:h,cap:e.cap,join:"miter"===e.join?J.pt2px(e.miterLimit):e.join});break}default:c=null}return c}const R={left:"start",center:"middle",right:"end",justify:"start"},p={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},z=new u(1E3),d=function(){const e={};return function(c){if(e[c])return e[c];const h=c.replace(/-/g,"");return e[c]=h}}();v=new v([128,128,
128]);E.defaultThematicColor=v;E.dekebabifyLineStyle=d;E.getFill=function(e){const c=e.style;let h=null;if(e)switch(e.type){case "simple-marker":"cross"!==c&&"x"!==c&&(h=e.color);break;case "simple-fill":"solid"===c?h=e.color:"none"!==c&&(h={type:"pattern",x:0,y:0,src:M.getAssetUrl(`esri/symbols/patterns/${c}.png`),width:5,height:5});break;case "picture-fill":h={type:"pattern",src:e.url,width:J.pt2px(e.width)*e.xscale,height:J.pt2px(e.height)*e.yscale,x:J.pt2px(e.xoffset),y:J.pt2px(e.yoffset)};break;
case "text":h=e.color;break;case "cim":h=H.getCIMSymbolColor(e)}return h};E.getPatternUrlWithColor=function(e,c){const h=e+"-"+c;return void 0!==z.get(h)?Promise.resolve(z.get(h)):A(e,{responseType:"image"}).then(g=>{g=g.data;const n=g.naturalWidth,B=g.naturalHeight,r=document.createElement("canvas");r.width=n;r.height=B;const G=r.getContext("2d");G.fillStyle=c;G.fillRect(0,0,n,B);G.globalCompositeOperation="destination-in";G.drawImage(g,0,0);g=r.toDataURL();z.put(h,g);return g})};E.getSVGAlign=function(e){return e=
(e=e.horizontalAlignment)&&R[e.toLowerCase()]||"middle"};E.getSVGBaseline=function(e){return(e=e.verticalAlignment)&&p[e.toLowerCase()]||"alphabetic"};E.getSVGBaselineShift=function(e){return"bottom"===e.verticalAlignment?"super":null};E.getStroke=I;Object.defineProperty(E,"__esModule",{value:!0})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(E){return function(){function M(A,u){this._storage=new E.MemCacheStorage;this._storage.maxSize=A;u&&this._storage.registerRemoveFunc("",
u)}var v=M.prototype;v.put=function(A,u){this._storage.put(A,u,1,1)};v.pop=function(A){return this._storage.pop(A)};v.get=function(A){return this._storage.get(A)};v.clear=function(){this._storage.clearAll()};v.destroy=function(){this._storage.destroy()};return M}()})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/maybe ../../support/arcadeOnDemand ./utils".split(" "),function(E,M,v,A,u,J,H){function I(c,h){return R.apply(this,
arguments)}function R(){R=v._asyncToGenerator(function*(c,h){switch(c.type){case "web-style":var {previewWebStyleSymbol:g}=yield new Promise((n,B)=>E(["./previewWebStyleSymbol"],n,B));return g(c,I,h);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:g}=yield new Promise((n,B)=>E(["./previewSymbol3D"],n,B)),g(c,h);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:g}=
yield new Promise((n,B)=>E(["./previewSymbol2D"],n,B)),g(c,h);case "cim":return{previewCIMSymbol:g}=yield new Promise((n,B)=>E(["./previewCIMSymbol"],n,B)),g(c,h)}});return R.apply(this,arguments)}function p(c){return c&&"opacity"in c?c.opacity*p(c.parent):1}function z(){z=v._asyncToGenerator(function*(c,h){var g,n;if(c){var B=c.sourceLayer;B=null!=(g=u.isSome(h)&&null!=(n=h.useSourceLayer)&&n?B:c.layer)?g:B;g=p(B);if(u.isSome(c.symbol)&&(!u.isSome(h)||!0!==h.ignoreGraphicSymbol))return c="web-style"===
c.symbol.type?yield c.symbol.fetchSymbol(u.isSome(h)?h.abortOptions:null):c.symbol.clone(),H.applyColorToSymbol(c,null,g),c;var r=u.isSome(h)&&h.renderer||B&&"renderer"in B&&B.renderer;if(n=r&&"getSymbolAsync"in r?yield r.getSymbolAsync(c,h):null){n="web-style"===n.type?yield n.fetchSymbol(u.isSome(h)?h.abortOptions:null):n.clone();if(!("visualVariables"in r&&r.visualVariables&&r.visualVariables.length))return H.applyColorToSymbol(n,null,g),n;"arcadeRequiredForVisualVariables"in r&&r.arcadeRequiredForVisualVariables&&
(u.isNone(h)||u.isNone(h.arcade))&&(h={...u.unwrap(h)},h.arcade=yield J.loadArcade());B=yield new Promise((q,L)=>E(["../../renderers/visualVariables/support/visualVariableUtils"],q,L));var G=[],l=[],t=[],P=[];for(var w of r.visualVariables)switch(w.type){case "color":G.push(w);break;case "opacity":l.push(w);break;case "rotation":P.push(w);break;case "size":w.target||t.push(w)}w=(w=!!G.length&&G[G.length-1])?B.getColor(w,c,h):null;l=(l=!!l.length&&l[l.length-1])?B.getOpacity(l,c,h):null;null!=g&&(l=
null!=l?l*g:g);H.applyColorToSymbol(n,w,l);t.length&&(g=B.getAllSizes(t,c,h),yield H.applySizesToSymbol(n,g));for(const q of P)H.applyRotationToSymbol(n,B.getRotationAngle(q,c,h),q.axis);return n}}});return z.apply(this,arguments)}function d(){d=v._asyncToGenerator(function*(c,h){var g;if(c){var n=p(c.layer||c.sourceLayer);if(u.isSome(c.symbol)&&(!u.isSome(h)||!0!==h.ignoreGraphicSymbol))return c="web-style"===c.symbol.type?yield c.symbol.fetchSymbol(u.isSome(h)?h.abortOptions:null):c.symbol.clone(),
H.getColorFromSymbol(c,n);var B=u.isSome(h)&&h.renderer||c.get("layer.renderer")||c.get("sourceLayer.renderer"),r=yield B.getSymbolAsync(c,h);if(r){r="web-style"===r.type?yield r.fetchSymbol(u.isSome(h)?h.abortOptions:null):r.clone();r=H.getColorFromSymbol(r,n);if(!("visualVariables"in B)||"visualVariables"in B&&!B.visualVariables||"visualVariables"in B&&(null==(g=B.visualVariables)||!g.length))return r;B.arcadeRequiredForVisualVariables&&(u.isNone(h)||u.isNone(h.arcade))&&(h={...u.unwrap(h)},h.arcade=
yield J.loadArcade());g=yield new Promise((t,P)=>E(["../../renderers/visualVariables/support/visualVariableUtils"],t,P));var G=[],l=[];for(const t of B.visualVariables)switch(t.type){case "color":G.push(t);break;case "opacity":l.push(t)}B=(B=0<G.length?G[G.length-1]:null)?g.getColor(B,c,h):r;c=(r=0<l.length?l[l.length-1]:null)?g.getOpacity(r,c,h):null;null!=n&&(c=null!=c?c*n:n);return B?H.applyOpacityToColor(B,c):null}}});return d.apply(this,arguments)}let e=null;M.getDisplayedColor=function(c,h){return d.apply(this,
arguments)};M.getDisplayedSymbol=function(c,h){return z.apply(this,arguments)};M.renderColorRampPreviewHTML=function(c,h={}){var g="horizontal"===h.align;const {width:n=g?75:24,height:B=g?24:75,gradient:r=!0}=h;var G=window.devicePixelRatio,l=n*G,t=B*G;G=document.createElement("canvas");G.width=l;G.height=t;G.style.width=`${n}px`;G.style.height=`${B}px`;const P=G.getContext("2d");var w=g?l:0,q=g?0:t;if(r){const L=P.createLinearGradient(0,0,w,q);g=c.length;const U=1===g?0:1/(g-1);c.forEach((C,D)=>
L.addColorStop(D*U,C.toString()));P.fillStyle=L;P.fillRect(0,0,l,t)}else{l=g?l/c.length:l;t=g?t:t/c.length;q=w=0;for(const L of c)P.fillStyle=L.toString(),P.fillRect(w,q,l,t),w=g?w+l:0,q=g?0:q+t}c=document.createElement("div");c.style.width=`${n}px`;c.style.height=`${B}px`;c.style.filter=H.getCSSFilterFromEffectList(null==h?void 0:h.effectList);c.appendChild(G);return c};M.renderDotDensityPreviewHTML=function(c,h,g){const {backgroundColor:n,outline:B,dotSize:r}=c;g=g&&g.swatchSize||22;const G=Math.round(g*
g/r**2*.8),l=window.devicePixelRatio;c=document.createElement("canvas");const t=g*l;c.width=t;c.height=t;c.style.width=`${c.width/l}px`;c.style.height=`${c.height/l}px`;const P=c.getContext("2d");n&&(P.fillStyle=n.toCss(!0),P.fillRect(0,0,t,t),P.fill());P.fillStyle=h.toCss(!0);if(e&&e.length/2===G)for(h=0;h<2*G;h+=2)P.fillRect(e[h],e[h+1],r*l,r*l),P.fill();else for(e=[],h=0;h<2*G;h+=2){const w=Math.floor(Math.random()*(t-0+1)),q=Math.floor(Math.random()*(t-0+1));e.push(w,q);P.fillRect(w,q,r*l,r*l);
P.fill()}B&&(B.color&&(P.strokeStyle=B.color.toCss(!0)),P.lineWidth=B.width,P.strokeRect(0,0,t,t));g=new Image(g,g);g.src=c.toDataURL();return g};M.renderPreviewHTML=I;Object.defineProperty(M,"__esModule",{value:!0})})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports","../../../renderers/visualVariables/SizeVariable"],function(E,M){const v=(A,u)=>{A=A.featuresTilingScheme.getClosestInfoForScale(A.scale).level;return null!=u&&u.levels?u.levels[A]:null};E.getClusterSizeVariable=
function(A,u){if(!(A&&"visualVariables"in A&&A.visualVariables))return null;A=A.visualVariables.find(J=>"size"===J.type);return(u=v(u,A))?new M({field:A.field,minSize:u[2].size,minDataValue:u[2].value,maxSize:u[3].size,maxDataValue:u[3].value}):null};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../chunks/_rollupPluginBabelHelpers","../../../Color","./utils"],function(E,M,v,A,u){function J(e,c){const h=
[],g=e.length-1;5===e.length?h.push(0,2,4):h.push(0,g);return e.map((n,B)=>-1<h.indexOf(B)?u.createStopLabel(n,B,g,c):null)}function H(){H=v._asyncToGenerator(function*(e,c,h){let g=!1,n=[],B=[];if(e.stops){var r=e.stops;n=r.map(l=>l.value);(g=r.some(l=>!!l.label))&&(B=r.map(l=>l.label))}r=n[n.length-1];if(null==n[0]&&null==r)return null;const G=g?null:J(n,h);return(yield Promise.all(n.map(function(){var l=v._asyncToGenerator(function*(t,P){const w="opacity"===e.type?yield I(t,e,c):(yield new Promise((q,
L)=>E(["../../../renderers/visualVariables/support/visualVariableUtils"],q,L))).getColor(e,t);return{value:t,color:w,label:g?B[P]:G[P]}});return function(t,P){return l.apply(this,arguments)}}()))).reverse()});return H.apply(this,arguments)}function I(e,c){return R.apply(this,arguments)}function R(){R=v._asyncToGenerator(function*(e,c,h=d){h=new A(h);e=(yield new Promise((g,n)=>E(["../../../renderers/visualVariables/support/visualVariableUtils"],g,n))).getOpacity(c,e);null!=e&&(h.a=e);return h});return R.apply(this,
arguments)}function p(e,c){const {startIndex:h,endIndex:g,weight:n}=z(e,c);if(h===g)return c[h].color;e=A.blendColors(c[h].color,c[g].color,n);return new A(e)}function z(e,c){let h=0,g=c.length-1;c.some((n,B)=>{if(e<n.value)return g=B,!0;h=B;return!1});return{startIndex:h,endIndex:g,weight:(e-c[h].value)/(c[g].value-c[h].value)}}const d=new A([64,64,64]);M.getColorFromPointCloudStops=p;M.getRampStops=function(e,c,h){return H.apply(this,arguments)};M.getRampStopsForPointCloud=function(e){let c=!1,
h=[],g=[];h=e.map(r=>r.value);(c=e.some(r=>!!r.label))&&(g=e.map(r=>r.label));const n=h[h.length-1];if(null==h[0]&&null==n)return null;const B=c?null:J(h,!1);return h.map((r,G)=>{const l=p(r,e);return{value:r,color:l,label:c?g[G]:B[G]}}).reverse()};M.getStrectchRampStops=function(e,c){let h=[];if(e&&"multipart"===e.type)e.colorRamps.reverse().forEach(function(g,n){0===n?h.push({value:c.max,color:new A(g.toColor),label:"high"}):h.push({value:null,color:new A(g.toColor),label:""});n===e.colorRamps.length-
1?h.push({value:c.min,color:new A(g.fromColor),label:"low"}):h.push({value:null,color:new A(g.fromColor),label:""})});else{let g,n;e&&"algorithmic"===e.type?(g=e.fromColor,n=e.toColor):(g=[0,0,0,1],n=[255,255,255,1]);h=[{value:c.max,color:new A(n),label:"high"},{value:c.min,color:new A(g),label:"low"}]}return h};Object.defineProperty(M,"__esModule",{value:!0})})},"esri/widgets/Legend/support/utils":function(){define(["exports","../../../intl/date","../../../renderers/support/numberUtils"],function(E,
M,v){const A=M.convertDateFormatToIntlOptions("short-date");E.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];
E.SPECIAL_CHARS_GREATER_THAN="\x3e";E.SPECIAL_CHARS_LESS_THAN="\x3c";E.createStopLabel=function(u,J,H,I){let R="";0===J?R="\x3c ":J===H&&(R="\x3e ");J=null;J=I?M.formatDate(u,A):v.format(u);return R+J};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],function(E,M,v){function A(z,d){return z-d}function u(z,d){let e;e=Number(z.toFixed(d));e<z?z=e+1/10**d:(z=e,e-=1/10**d);e=Number(e.toFixed(d));z=Number(z.toFixed(d));
return[e,z]}function J(z,d,e,c,h){z=I(z,d,e,c);d=null==z.next||z.next<=h;return(null==z.previous||z.previous<=h)&&d||z.previous+z.next<=2*h}function H(z){z=String(z);var d=z.match(R);if(d&&d[1])return{integer:d[1].split("").length,fractional:d[3]?d[3].split("").length:0};if(-1<z.toLowerCase().indexOf("e")&&(d=z.split("e"),z=d[0],d=d[1],z&&d)){z=Number(z);d=Number(d);const e=0<d;e||(d=Math.abs(d));z=H(z);e?(z.integer+=d,z.fractional=d>z.fractional?0:z.fractional-d):(z.fractional+=d,z.integer=d>z.integer?
1:z.integer-d);return z}return{integer:0,fractional:0}}function I(z,d,e,c){const h={previous:null,next:null};if(null!=e){const g=z-e;h.previous=Math.floor(Math.abs(100*(d-e-g)/g))}null!=c&&(z=c-z,h.next=Math.floor(Math.abs(100*(c-d-z)/z)));return h}const R=/^-?(\d+)(\.(\d+))?$/i,p={maximumFractionDigits:20};E.format=function(z){return v.formatNumber(z,p)};E.numDigits=H;E.percentChange=I;E.round=function(z,d={}){z=z.slice(0);const {tolerance:e=2,strictBounds:c=!1,indexes:h=z.map((n,B)=>B)}=d;h.sort(A);
for(d=0;d<h.length;d++){const n=h[d],B=z[n],r=0===n?null:z[n-1],G=n===z.length-1?null:z[n+1],l=H(B).fractional;if(l){let t=0,P=!1;for(var g=void 0;t<=l&&!P;)g=u(B,t),g=c&&0===d?g[1]:g[0],P=J(B,g,r,G,e),t++;P&&(z[n]=g)}}return z};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(E,M){E.getHeatmapRampStops=function(v){v=v.colorStops;let A=v.length-1;if(v&&v[0]){const u=
v[A];u&&1!==u.ratio&&(v=v.slice(0),v.push(new M({ratio:1,color:u.color})),A++)}return v.map((u,J)=>{let H="";0===J?H="low":J===A&&(H="high");return{color:u.color,label:H,ratio:u.ratio}}).reverse()};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(E,M,v,A){function u(p){if(p){var {type:z}=p;return-1<z.indexOf("3d")?
A.getSymbolLayerFill(p.symbolLayers.getItemAt(0)):"simple-line"===z||"simple-marker"===p.type&&("x"===p.style||"cross"===p.style)?(p=v.getStroke(p))&&p.color:v.getFill(p)}}function J(p,z){const d=z.HH.label,e=z.LL.label,c=z.HL.label;z=z.LH.label;switch(p){case "HH":return{top:d,bottom:e,left:c,right:z};case "HL":return{top:c,bottom:z,left:e,right:d};case "LL":return{top:e,bottom:d,left:z,right:c};case "LH":return{top:z,bottom:c,left:d,right:e};default:return{top:d,bottom:e,left:c,right:z}}}function H(p){let z=
I[p];p&&null==z&&(z=I.HH);return z||0}const I={HH:315,HL:45,LL:135,LH:225},R={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};E.getRelationshipRampColors2D=function(p,z){const d=[],e=p.length**.5;p=M.clone(p);var c=(z||"HH").split("");z=c[0];for(c="H"===c[1];p.length;){const h=[];for(;h.length<e;)h.push(p.shift());c&&h.reverse();d.push(h)}"L"===z&&d.reverse();
return d};E.getRelationshipRampElement=function(p){const {focus:z,infos:d,numClasses:e}=p;var c=R[e];const h={};d.forEach(g=>{h[g.value]={label:g.label,fill:u(g.symbol)}});p=[];for(let g=0;g<e;g++){const n=[];for(let B=0;B<e;B++)n.push(h[c[g][B]].fill);p.push(n)}c=J(z,h);return{type:"relationship-ramp",numClasses:e,focus:z,colors:p,labels:c,rotation:H(z)}};E.getRotationAngleForFocus=H;Object.defineProperty(E,"__esModule",{value:!0})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(E,M,v,A,u,J,H,I,R,p,z,d,e,c,h,g,n){function B(a){const f=a.outline;var F=I.isSome(a.material)?a.material.color:null;F=I.isSome(F)?F.toHex():null;if(I.isNone(f)||"pattern"in f&&I.isSome(f.pattern)&&"style"===f.pattern.type&&"none"===f.pattern.style)return"fill"===a.type&&"#ffffff"===F?{color:"#bdc3c7",width:.75}:null;a=p.pt2px(f.size)||0;return{color:"rgba("+(I.isSome(f.color)?f.color.toRgba():"255,255,255,1")+")",width:Math.min(a,80),style:"pattern"in f&&I.isSome(f.pattern)&&"style"===f.pattern.type?
z.dekebabifyLineStyle(f.pattern.style):null,join:"butt",cap:"patternCap"in f?f.patternCap:"butt"}}function r(a,f){var F=f&&f.resource;F=F&&F.href;if(a.thumbnail&&a.thumbnail.url)return Promise.resolve(a.thumbnail.url);if(F&&"object"!==f.type)return Promise.resolve(g.getIconHref(a,f));const O=v.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return a.styleOrigin&&(a.styleOrigin.styleName||a.styleOrigin.styleUrl)?n.resolveWebStyleSymbol(a.styleOrigin,{portal:a.styleOrigin.portal},"webRef").catch(Y=>
Y).then(Y=>{var ba;return(null==Y?void 0:null==(ba=Y.thumbnail)?void 0:ba.url)||O}):Promise.resolve(O)}function G(a,f=1){const F=a.a;a=A.toHSV(a);const {r:O,g:Y,b:ba}=A.toRGB({h:a.h,s:a.s/f,v:100-(100-a.v)/f});return[O,Y,ba,F]}function l(a){return"water"===a.type?I.isNone(a.color)?null:a.color:I.isNone(a.material)||I.isNone(a.material.color)?null:a.material.color}function t(a,f=0){var F=l(a);if(!F){if("fill"===a.type)return null;f=c.adjustColorComponentBrightness(z.defaultThematicColor.r,f);return[f,
f,f,100]}a=F.toRgba();for(F=0;3>F;F++)a[F]=c.adjustColorComponentBrightness(a[F],f);return a}function P(a,f){return w.apply(this,arguments)}function w(){w=M._asyncToGenerator(function*(a,f){a=a.style;return"none"===a?null:{type:"pattern",x:0,y:0,src:yield z.getPatternUrlWithColor(v.getAssetUrl(`esri/symbols/patterns/${a}.png`),f.toCss(!0)),width:5,height:5}});return w.apply(this,arguments)}function q(a){return a.outline?B(a):{color:"rgba(0, 0, 0, 1)",width:1.5}}function L(a,f){a=l(a);if(!a)return null;
let F;F="rgba("+(c.adjustColorComponentBrightness(a.r,f)+",");F+=c.adjustColorComponentBrightness(a.g,f)+",";F+=c.adjustColorComponentBrightness(a.b,f)+",";return F+a.a+");"}function U(a,f){f=L(a,f);if(!f)return{};if("pattern"in a&&I.isSome(a.pattern)&&"style"===a.pattern.type&&"none"===a.pattern.style)return null;const F=Math.min(a.size?p.pt2px(a.size):.75,80);return{color:f,width:F,style:"pattern"in a&&I.isSome(a.pattern)&&"style"===a.pattern.type?z.dekebabifyLineStyle(a.pattern.style):null,cap:"cap"in
a?a.cap:null,join:"join"in a?"miter"===a.join?p.pt2px(2):a.join:null}}function C(a,f,F){F*=.75;return{type:"linear",x1:F?.25*F:0,y1:F?.5*F:0,x2:F||4,y2:F?.5*F:4,colors:[{color:a,offset:0},{color:f,offset:1}]}}function D(a){const f=a.depth,F=a.height;return(a=a.width)&&f&&F&&a===f&&a<F}function K(a,f,F){const O=[];if(!a)return O;switch(a.type){case "icon":switch(a.resource&&a.resource.primitive||d.defaultPrimitive){case "circle":O.push({shape:{type:"circle",cx:0,cy:0,r:.5*f},fill:t(a,0),stroke:B(a)});
break;case "square":O.push({shape:{type:"path",path:[{command:"M",values:[0,f]},{command:"L",values:[0,0]},{command:"L",values:[f,0]},{command:"L",values:[f,f]},{command:"Z",values:[]}]},fill:t(a,0),stroke:B(a)});break;case "triangle":O.push({shape:{type:"path",path:[{command:"M",values:[0,f]},{command:"L",values:[.5*f,0]},{command:"L",values:[f,f]},{command:"Z",values:[]}]},fill:t(a,0),stroke:B(a)});break;case "cross":O.push({shape:{type:"path",path:[{command:"M",values:[.5*f,0]},{command:"L",values:[.5*
f,f]},{command:"M",values:[0,.5*f]},{command:"L",values:[f,.5*f]}]},stroke:q(a)});break;case "x":O.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[f,f]},{command:"M",values:[f,0]},{command:"L",values:[0,f]}]},stroke:q(a)});break;case "kite":O.push({shape:{type:"path",path:[{command:"M",values:[0,.5*f]},{command:"L",values:[.5*f,0]},{command:"L",values:[f,.5*f]},{command:"L",values:[.5*f,f]},{command:"Z",values:[]}]},fill:t(a,0),stroke:B(a)})}break;case "object":switch(a.resource&&
a.resource.primitive||e.defaultPrimitive){case "cone":var Y=t(a,0);a=t(a,-.6);a=C(Y,a,F?20:f);f=c.getConeShapes(f,F);O.push({shape:f[0],fill:a});O.push({shape:f[1],fill:a});break;case "inverted-cone":F=t(a,0);a=t(a,-.6);a=C(F,a,f);f=c.getInvertedConeShapes(f);O.push({shape:f[0],fill:a});O.push({shape:f[1],fill:F});break;case "cube":f=c.getCubeShapes(f,F);O.push({shape:f[0],fill:t(a,0)});O.push({shape:f[1],fill:t(a,-.3)});O.push({shape:f[2],fill:t(a,-.5)});break;case "cylinder":{Y=t(a,0);const ba=
t(a,-.6);Y=C(Y,ba,F?20:f);f=c.getCylinderShapes(f,F);O.push({shape:f[0],fill:Y});O.push({shape:f[1],fill:Y});O.push({shape:f[2],fill:t(a,0)});break}case "diamond":f=c.getDiamondShapes(f);O.push({shape:f[0],fill:t(a,-.3)});O.push({shape:f[1],fill:t(a,0)});O.push({shape:f[2],fill:t(a,-.3)});O.push({shape:f[3],fill:t(a,-.7)});break;case "sphere":F=t(a,0);a=t(a,-.6);a=C(F,a);a.x1=0;a.y1=0;a.x2=.25*f;a.y2=.25*f;O.push({shape:{type:"circle",cx:0,cy:0,r:.5*f},fill:a});break;case "tetrahedron":f=c.getTetrahedronShapes(f),
O.push({shape:f[0],fill:t(a,-.3)}),O.push({shape:f[1],fill:t(a,0)}),O.push({shape:f[2],fill:t(a,-.6)})}}return O}function k(a,f){const F=f&&f.size?p.pt2px(f.size):null,O=f&&f.maxSize?p.pt2px(f.maxSize):null,Y=f&&f.disableUpsampling,ba=a.symbolLayers,ea=[];let ia=0,ca=0;const Z=ba.getItemAt(ba.length-1);let ma;Z&&"icon"===Z.type&&(ma=Z.size&&p.pt2px(Z.size));ba.forEach(ka=>{if("icon"===ka.type||"object"===ka.type){var fa="icon"===ka.type?ka.size&&p.pt2px(ka.size):0,ja=F||fa?Math.ceil(Math.min(F||fa,
O||120)):22;if(ka&&ka.resource&&ka.resource.href){var ta=r(a,ka).then(function(pa){const ya=ka.get("material.color");var za="icon"===ka.type?"multiply":"tint";return h.tintImageWithColor(pa,ja,ya,za,Y)}).then(function(pa){const ya=pa.width,za=pa.height;ia=Math.max(ia,ya);ca=Math.max(ca,za);return[{shape:{type:"image",x:0,y:0,width:ya,height:za,src:pa.url},fill:null,stroke:null}]});ea.push(ta)}else{let pa=ja;"icon"===ka.type&&ma&&F&&(pa=fa/ma*ja);fa="tall"===(null==f?void 0:f.symbolConfig)||(null==
f?void 0:null==(ta=f.symbolConfig)?void 0:ta.isTall)||("object"===ka.type?D(ka):!1);ia=Math.max(ia,fa?20:pa);ca=Math.max(ca,pa);ea.push(Promise.resolve(K(ka,pa,fa)))}}});return R.eachAlways(ea).then(function(ka){const fa=[];ka.forEach(function(ja){ja.value?fa.push(ja.value):ja.error&&W.warn("error while building swatchInfo!",ja.error)});return h.renderSymbol(fa,[ia,ca],{node:f&&f.node,scale:!1,opacity:f&&f.opacity})})}function y(a,f){const F=a.symbolLayers,O=[];a=g.isVolumetricSymbol(a);const Y=f&&
f.size?p.pt2px(f.size):null,ba=(f&&f.maxSize?p.pt2px(f.maxSize):null)||80;let ea=0,ia=0,ca;F.forEach((Z,ma)=>{if(Z&&("line"===Z.type||"path"===Z.type)){var ka=[];switch(Z.type){case "line":var fa=U(Z,0);if(I.isNone(fa))break;var ja=fa&&fa.width||0;0===ma&&(ca=ja);Z=Math.min(Y||ja,ba);ma=0===ma?Z:Y?ja/ca*Z:Z;ja=20<ma?2*ma:40;ia=Math.max(ia,ma);ea=Math.max(ea,ja);fa.width=ma;ka.push({shape:{type:"path",path:[{command:"M",values:[0,.5*ia]},{command:"L",values:[ea,.5*ia]}]},stroke:fa});break;case "path":fa=
Math.min(Y||22,ba);ma=t(Z,0);ja=t(Z,-.2);var ta=L(Z,-.4);ta=ta?{color:ta,width:1}:{};if("quad"===Z.profile){const pa=Z.width;Z=Z.height;Z=c.getPathSymbolShapes(pa&&Z?pa/Z:1,0===Z,0===pa);ta={...ta,join:"bevel"};ka.push({shape:Z[0],fill:ja,stroke:ta});ka.push({shape:Z[1],fill:ja,stroke:ta});ka.push({shape:Z[2],fill:ma,stroke:ta})}else ka.push({shape:c.shapes.pathSymbol3DLayer[0],fill:ja,stroke:ta}),ka.push({shape:c.shapes.pathSymbol3DLayer[1],fill:ma,stroke:ta});ea=ia=Math.max(ia,fa)}O.push(ka)}});
return Promise.resolve(h.renderSymbol(O,[ea,ia],{node:f&&f.node,scale:a,opacity:f&&f.opacity}))}function Q(a,f){return V.apply(this,arguments)}function V(){V=M._asyncToGenerator(function*(a,f){const F="mesh-3d"===a.type;a=a.symbolLayers;var O=f&&f.size?p.pt2px(f.size):null;const Y=f&&f.maxSize?p.pt2px(f.maxSize):null;O=O||22;const ba=[];let ea=0,ia=0;var ca=!1;for(let ta=0;ta<a.length;ta++){var Z=a.getItemAt(ta);const pa=[];if(!F||"fill"===Z.type){var ma=c.shapes.fill[0];switch(Z.type){case "fill":var ka=
B(Z);ca=Math.min(O,Y||120);ea=Math.max(ea,ca);ia=Math.max(ia,ca);ca=!0;var fa=t(Z,0),ja="pattern"in Z&&Z.pattern;Z=l(Z);!F&&I.isSome(ja)&&"style"===ja.type&&"solid"!==ja.style&&Z&&(fa=yield P(ja,Z));pa.push({shape:ma,fill:fa,stroke:ka});break;case "line":Z=U(Z,0);if(I.isNone(Z))break;Z={stroke:Z,shape:ma};ea=Math.max(ea,22);ia=Math.max(ia,22);pa.push(Z);break;case "extrude":ma={join:"round",width:1,...U(Z,-.4)};ka=t(Z,0);Z=t(Z,-.2);fa=Math.min(O,Y||120);ja=c.getExtrudeSymbolShapes(fa);ma.width=1;
pa.push({shape:ja[0],fill:Z,stroke:ma});pa.push({shape:ja[1],fill:Z,stroke:ma});pa.push({shape:ja[2],fill:ka,stroke:ma});Z=22*.7+.5*fa;ea=Math.max(ea,22);ia=Math.max(ia,Z);break;case "water":ca=l(Z),Z=G(ca),ma=G(ca,2),ka=G(ca,3),fa=c.getWaterSymbolShapes(),ca=!0,pa.push({shape:fa[0],fill:Z}),pa.push({shape:fa[1],fill:ma}),pa.push({shape:fa[2],fill:ka}),Z=Math.min(O,Y||120),ea=Math.max(ea,Z),ia=Math.max(ia,Z)}ba.push(pa)}}return Promise.resolve(h.renderSymbol(ba,[ea,ia],{node:f&&f.node,scale:ca,opacity:f&&
f.opacity}))});return V.apply(this,arguments)}const W=H.getLogger("esri.symbols.support.previewSymbol3D");E.getPatternDescriptor=P;E.getSymbolLayerFill=t;E.previewSymbol3D=function(a,f){if(0===a.symbolLayers.length)return Promise.reject(new J("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(a.type){case "point-3d":return k(a,f);case "line-3d":return y(a,f);case "polygon-3d":case "mesh-3d":return Q(a,f)}return Promise.reject(new J("symbolPreview: swatchInfo3D","symbol not supported."))};
Object.defineProperty(E,"__esModule",{value:!0})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(E,M){function v(A,u){return Math.round(Math.min(Math.max(A+191.25*u,0),255))}E.adjustColorBrightness=function(A,u){if("type"in A&&("linear"===A.type||"pattern"===A.type))return A;A=new M(A);return new M([v(A.r,u),v(A.g,u),v(A.b,u),A.a])};E.adjustColorComponentBrightness=v;E.getConeShapes=function(A,u){let J=u?20:A;u=u?4:6;J=22>=J?J-.5*u:J-u;u=.15*J;const H=J;
A-=u;return[{type:"ellipse",cx:.5*J,cy:A,rx:.5*J,ry:u},{type:"path",path:[{command:"M",values:[.5*H,0]},{command:"L",values:[H,A]},{command:"L",values:[0,A]},{command:"Z",values:[]}]}]};E.getCubeShapes=function(A,u){let J=u?20:A;var H=u?4:6;H=J=22>=J?J-.5*H:J-H;u=u?.35*J:.5*J;return[{type:"path",path:[{command:"M",values:[.5*H,0]},{command:"L",values:[H,.5*u]},{command:"L",values:[.5*H,u]},{command:"L",values:[0,.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*u]},{command:"L",
values:[.5*H,u]},{command:"L",values:[.5*H,A]},{command:"L",values:[0,A-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*H,u]},{command:"L",values:[.5*H,A]},{command:"L",values:[H,A-.5*u]},{command:"L",values:[H,.5*u]},{command:"Z",values:[]}]}]};E.getCylinderShapes=function(A,u){var J=u?20:A;u=u?4:6;J=22>=J?J-.5*u:J-u;u=.5*J;const H=.15*J;A-=H;return[{type:"ellipse",cx:.5*J,cy:A,rx:u,ry:H},{type:"path",path:[{command:"M",values:[0,H]},{command:"L",values:[0,A]},{command:"L",
values:[J,A]},{command:"L",values:[J,H]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*J,cy:H,rx:u,ry:H}]};E.getDiamondShapes=function(A){var u=A;u=22>u?u-2:u-4;const J=Math.floor(A/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*u,0]},{command:"L",values:[u,.5*A-J]},{command:"L",values:[.45*u-J,.5*A+J]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*u,0]},{command:"L",values:[.45*u-J,.5*A+J]},{command:"L",values:[0,.5*A-J]},{command:"Z",values:[]}]},{type:"path",
path:[{command:"M",values:[0,.5*A-J]},{command:"L",values:[.45*u-J,.5*A+J]},{command:"L",values:[.45*u,A]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*u,A]},{command:"L",values:[u,.5*A-J]},{command:"L",values:[.45*u-J,.5*A+J]},{command:"Z",values:[]}]}]};E.getExtrudeSymbolShapes=function(A){A*=.5;return[{type:"path",path:[{command:"M",values:[0,.7*11]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+A]},{command:"L",values:[0,22*.7+A-.7*11]},{command:"Z",
values:[]}]},{type:"path",path:[{command:"M",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+A]},{command:"L",values:[22,A]},{command:"L",values:[22,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[0,.7*11]},{command:"Z",values:[]}]}]};E.getInvertedConeShapes=function(A){let u=A;u=22>u?u-3:u-6;const J=.15*u,H=u;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[H,
0]},{command:"L",values:[.5*H,A-J]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*u,cy:0,rx:.5*u,ry:J}]};E.getPathSymbolShapes=function(A,u,J){let H=22,I=22;1>A?H*=.75:1<A&&(I*=1.25);let R=A=22;u&&J&&(H=I=A=R=0);return[{type:"path",path:[{command:"M",values:[A,0]},{command:"L",values:[J?A:.875*A,0]},{command:"L",values:[J?H-.5*A:0,I-.5*R]},{command:"L",values:[H-.5*A,I-.5*R]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[A,0]},{command:"L",values:[A,u?0:.125*R]},{command:"L",
values:[H-.5*A,u?I-.5*R:R]},{command:"L",values:[H-.5*A,I-.5*R]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[H-.5*A,I-.5*R]},{command:"L",values:[J?H-.5*A:0,I-.5*R]},{command:"L",values:[J?H-.5*A:0,u?I-.5*R:R]},{command:"L",values:[H-.5*A,u?I-.5*R:R]},{command:"Z",values:[]}]}]};E.getTetrahedronShapes=function(A){var u=A;u=22>u?u-1:u-2;return[{type:"path",path:[{command:"M",values:[.45*A,0]},{command:"L",values:[A,u]},{command:"L",values:[.45*A,.6*u]},{command:"Z",values:[]}]},
{type:"path",path:[{command:"M",values:[.45*A,0]},{command:"L",values:[.45*A,.6*u]},{command:"L",values:[0,u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,u]},{command:"L",values:[.45*A,.6*u]},{command:"L",values:[A,u]},{command:"Z",values:[]}]}]};E.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
E.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],
cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],
tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",
path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(E,M,v,A,u,J,H,I,R,p,z){function d(c,h,g,n,B){var r=c.data;const G={portal:g&&g.portal||J.getDefault(),url:u.urlToObject(c.baseUrl),origin:"portal-item"};r=r.items.find(q=>q.name===h);if(!r)return Promise.reject(new A("symbolstyleutils:symbol-name-not-found",`The symbol name '${h}' could not be found`,{symbolName:h}));let l=H.fromJSON(p.symbolUrlFromStyleItem(r,n),G),t=r.thumbnail&&r.thumbnail.href;const P=r.thumbnail&&r.thumbnail.imageData;v.isDevEnvironment()&&(l=v.adjustStaticAGOUrl(l),
t=v.adjustStaticAGOUrl(t));const w={portal:g.portal,url:u.urlToObject(u.removeFile(l)),origin:"portal-item"};return p.requestJSON(l,B).then(q=>{q="cimRef"===n?p.makeCIMSymbolRef(q.data):q.data;if((q=I.fromJSON(q,w))&&M.isSymbol3D(q)){if(t){const L=H.fromJSON(t,G);q.thumbnail=new z.default({url:L})}else P&&(q.thumbnail=new z.default({url:`data:image/png;base64,${P}`}));c.styleUrl?q.styleOrigin=new R({portal:g.portal,styleUrl:c.styleUrl,name:h}):c.styleName&&(q.styleOrigin=new R({portal:g.portal,styleName:c.styleName,
name:h}))}return q})}function e(c,h,g){const n=p.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,c.name);return p.requestJSON(n,g).then(B=>{B=p.makeCIMSymbolRef(B.data);return I.fromJSON(B,{portal:h.portal,url:u.urlToObject(u.removeFile(n)),origin:"portal-item"})})}E.fetchSymbolFromStyle=d;E.resolveWebStyleSymbol=function(c,h,g,n){return c.name?c.styleName&&"Esri2DPointSymbolsStyle"===c.styleName?e(c,h,n):p.fetchStyle(c,h,n).then(B=>d(B,c.name,h,g,n)):Promise.reject(new A("symbolstyleutils:style-symbol-reference-name-missing",
"Missing name in style symbol reference"))};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(E){const M=/^devext.arcgis.com$/,v=/^qaext.arcgis.com$/,A=/^[\w-]*\.mapsdevext.arcgis.com$/,u=/^[\w-]*\.mapsqa.arcgis.com$/,J=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,M,v,/^jsapps.esri.com$/,A,u];E.adjustStaticAGOUrl=function(H,I){return H?(I=I||globalThis.location.hostname)?null!=I.match(M)||null!=I.match(A)?H.replace("static.arcgis.com",
"staticdev.arcgis.com"):null!=I.match(v)||null!=I.match(u)?H.replace("static.arcgis.com","staticqa.arcgis.com"):H:H:H};E.isDevEnvironment=function(H){H=H||globalThis.location.hostname;return J.some(I=>{var R;return null!=(null==(R=H)?void 0:R.match(I))})};E.isTelemetryDevEnvironment=function(H){H=H||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(J).some(I=>{var R;return null!=(null==(R=H)?void 0:R.match(I))})};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../Color ../../../symbols ../../../renderers/support/numberUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ./utils".split(" "),
function(E,M,v,A,u,J,H,I,R){function p(D,K){const k=D.length-1;return D.map((y,Q)=>R.createStopLabel(y,Q,k,K))}function z(){z=v._asyncToGenerator(function*(D,K,k,y,Q,V){var W,a,f=K.legendOptions;f=f&&f.customValues;const F=c(D,k);var O=null!=K.minSize&&null!=K.maxSize;k=K.stops&&1<K.stops.length;var Y=!!K.target;if(F&&(f||O||k&&!Y)){var ba=I.isVolumetricSymbol(F),ea=null,ia=O=null;O=ba&&!k?J.round([K.minDataValue,K.maxDataValue]):f||(yield B(K,F,y,Q));f=null==D?void 0:D.authoringInfo;var ca=(Y="univariate-color-size"===
(null==f?void 0:f.type))&&"above-and-below"===(null==f?void 0:f.univariateTheme);!O&&k&&(O=K.stops.map(fa=>fa.value),(ea=K.stops.some(fa=>!!fa.label))&&(ia=K.stops.map(fa=>fa.label)));ba&&2<(null==(W=O)?void 0:W.length)&&!ca&&(O=[O[0],O[O.length-1]]);if(!O)return null;Y&&5!==(null==(a=O)?void 0:a.length)&&(O=G({minSize:O[0],maxSize:O[O.length-1]}));var Z=ba?d(D,O):null,ma=I.getSymbolOutlineSize(F),ka=ea?null:p(O,V);return(yield Promise.all(O.map(function(){var fa=v._asyncToGenerator(function*(ja,
ta){const pa=ba?Z[ta]:yield P(K,F,ja,y,Q),ya=q(ca&&"class-breaks"===D.type?e(D,ta):F,pa);return{value:ja,symbol:ya,label:ea?ia[ta]:ka[ta],size:pa,outlineSize:ma}});return function(ja,ta){return fa.apply(this,arguments)}}()))).reverse()}});return z.apply(this,arguments)}function d(D,K){D=null==D?void 0:D.authoringInfo;const k="univariate-color-size"===(null==D?void 0:D.type);let y=[12,30];if(k){const Q=K[0],V=K[K.length-1];y=K.map(W=>12+(W-Q)/(V-Q)*18)}k&&"below"===(null==D?void 0:D.univariateTheme)&&
y.reverse();return y}function e(D,K){const k=D.classBreakInfos,y=k.length;K=2>y||!(2<=K)?k[0].symbol.clone():k[y-1].symbol.clone();D.visualVariables.some(Q=>"color"===Q.type)&&(-1<K.type.indexOf("3d")?g(K):n(K));return K}function c(D,K){let k=null,y=null;"simple"===D.type?k=D.symbol:"class-breaks"===D.type?(k=(D=D.classBreakInfos)&&D[0]&&D[0].symbol,y=1<D.length):"unique-value"===D.type&&(k=(D=D.uniqueValueInfos)&&D[0]&&D[0].symbol,y=1<D.length);if(!k||h(k))return null;k=k.clone();if(K||y)-1<k.type.indexOf("3d")?
g(k):n(k);return k}function h(D){return D?u.isSymbol3D(D)?D.symbolLayers?D.symbolLayers.some(K=>K&&"fill"===K.type):!1:-1!==D.type.indexOf("fill"):!1}function g(D){"line-3d"===D.type?D.symbolLayers.forEach(K=>{K.material={color:C}}):D.symbolLayers.forEach(K=>{"icon"!==K.type||K.resource&&K.resource.href?K.material={color:U}:(K.material={color:L},K.outline={color:C,size:1.5})})}function n(D){"cim"===D.type?H.applyCIMSymbolColor(D,new A(U)):-1!==D.type.indexOf("line")?D.color=C:(D.color=L,"simple-marker"===
D.type&&(D.outline={color:C,width:1.5}))}function B(D,K,k,y){return r.apply(this,arguments)}function r(){r=v._asyncToGenerator(function*(D,K,k,y){const Q=(yield new Promise((a,f)=>E(["../../../renderers/visualVariables/support/visualVariableUtils"],a,f))).getSizeRangeAtScale(D,k,y),V=Q&&G(Q);if(Q||V){var W=V.map(a=>{{const f=Q.minSize,F=Q.maxSize,O=D.minDataValue,Y=D.maxDataValue;let ba=null;a=ba=a<=f?O:a>=F?Y:(a-f)/(F-f)*(Y-O)+O}return a});W=J.round(W);for(let a=1;a<W.length-1;a++){const f=yield l(D,
K,W[a],W[a-1],k,y);f&&(W[a]=f[0],V[a]=f[1])}return W}});return r.apply(this,arguments)}function G(D){const K=D.minSize;D=(D.maxSize-K)/4;const k=[];for(let y=0;5>y;y++)k.push(K+D*y);return k}function l(D,K,k,y,Q,V){return t.apply(this,arguments)}function t(){t=v._asyncToGenerator(function*(D,K,k,y,Q,V){const W=yield P(D,K,k,Q,V);y=yield P(D,K,y,Q,V);var a=J.numDigits(k),f=a.fractional,F=a.integer;let O=a=null;0<k&&1>k&&(a=10**f,k*=a,F=J.numDigits(k).integer);for(f=F-1;0<=f;f--){var Y=10**f;F=Math.floor(k/
Y)*Y;Y*=Math.ceil(k/Y);null!=a&&(F/=a,Y/=a);let ba=(F+Y)/2;[,ba]=J.round([F,ba,Y],{indexes:[1]});const ea=yield P(D,K,F,Q,V),ia=yield P(D,K,Y,Q,V),ca=yield P(D,K,ba,Q,V),Z=J.percentChange(W,ea,y,null),ma=J.percentChange(W,ia,y,null),ka=J.percentChange(W,ca,y,null);let fa=20>=Z.previous,ja=20>=ma.previous;fa&&ja&&(Z.previous<=ma.previous?(fa=!0,ja=!1):(ja=!0,fa=!1));fa?O=[F,ea]:ja?O=[Y,ia]:20>=ka.previous&&(O=[ba,ca]);if(O)break}return O});return t.apply(this,arguments)}function P(D,K,k,y,Q){return w.apply(this,
arguments)}function w(){w=v._asyncToGenerator(function*(D,K,k,y,Q){const {getSize:V}=yield new Promise((W,a)=>E(["../../../renderers/visualVariables/support/visualVariableUtils"],W,a));return V(D,k,{scale:y,view:Q,shape:"simple-marker"===K.type?K.style:null})});return w.apply(this,arguments)}function q(D,K){D=D.clone();if(u.isSymbol3D(D))I.isVolumetricSymbol(D)||D.symbolLayers.forEach(k=>{"fill"!==k.type&&(k.size=K)});else if("esri.symbols.SimpleMarkerSymbol"===D.declaredClass)D.size=K;else if("esri.symbols.PictureMarkerSymbol"===
D.declaredClass){const k=D.width,y=D.height;D.height=K;D.width=k/y*K}else"esri.symbols.SimpleLineSymbol"===D.declaredClass?D.width=K:"esri.symbols.TextSymbol"===D.declaredClass&&D.font&&(D.font.size=K);return D}const L=[255,255,255],U=[200,200,200],C=[128,128,128];M.REAL_WORLD_MAX_SIZE=30;M.REAL_WORLD_MIN_SIZE=12;M.getRampStops=function(D,K,k,y,Q,V){return z.apply(this,arguments)};Object.defineProperty(M,"__esModule",{value:!0})})},"esri/widgets/smartMapping/support/utils":function(){define("exports ../../../Color ../../../core/maybe ../../../intl/date ../../../intl/number ../../../renderers/support/utils ../../../renderers/visualVariables/SizeVariable".split(" "),
function(E,M,v,A,u,J,H){E.formatDateLabel=function(I){return A.formatDate(new Date(I),J.timelineDateFormatOptions)};E.formatNumberLabel=function(I){const R=Math.floor(Math.log10(Math.abs(I)))+1;return u.formatNumber(I,{notation:1E6<=Math.abs(I)?"compact":"standard",minimumSignificantDigits:2,maximumSignificantDigits:4>R||6<R?4:R})};E.getDeviationValues=function(I,R,p){if(!v.isSome(R)||!v.isSome(I))return[];const z=[];for(let d=-1*p;d<=p;d++)0!==d&&z.push(R+d*I);return z};E.getDynamicPathForSizeStops=
function(I){const {max:R,min:p,padding:z,pathHeight:d,pathWidth:e,stops:c}=I,h=R-p;let g=`M0 0 L${e} 0 `,n;I=3===c.length?[c[0],c[1],c[2]]:[c[0],c[2],c[4]];const B=Math.min.apply(Math,I.map(G=>G.size)),r=Math.max(Math.abs(I[0].size-I[1].size),Math.abs(I[2].size-I[1].size));I.reverse();I.forEach(({size:G,value:l},t)=>{l=Math.round(d-(l-p)/h*d);n=Math.round((G-B)/r*100)/100*e;0===n&&(n=z*e);0===t&&(g+=`L${n} 0 `);g+=`L${n} ${l} `});return g+=`L${n} ${d} L0 ${d} L0 0 Z`};E.getFillFromColor=function(I){return I instanceof
M?I.toCss(!0):M.fromString(I).toCss(!0)};E.getPathForSizeStops=function(I){const {bottomValue:R,bottomWidth:p,max:z,min:d,pathHeight:e,pathWidth:c,topValue:h,topWidth:g}=I;I=g*c;const n=p*c,B=z-d;return`M${I} 0 L${I} ${Math.round(e-(h-d)/B*e)} L${n} ${Math.round(e-(R-d)/B*e)} L${n} ${e} L0 ${e} L0 0 Z`};E.getSizesFromVariable=function(I){let R=I.maxSize;I=I.minSize;R instanceof H&&(R=R.stops[0].size);I instanceof H&&(I=I.stops[0].size);return[R,I]};E.getStopChanges=function(I,R,p){const z=p.length-
1,d=p[0],e=p[z]-d,c=R-I,h=[];for(let g=1;g<z;g++)h.push({index:g,value:(p[g]-d)/e*c+I});h.unshift({index:0,value:I});h.push({index:z,value:R});return h};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../intl/date ./numberUtils ../visualVariables/support/ColorStop".split(" "),function(E,M,v,A,u,J){function H(c,h,g){let n="";0===h?n=z.lt+" ":h===g&&(n=z.gt+" ");return n+c}function I(c){let h=c.minValue,
g=c.maxValue;const n=c.isFirstBreak?"":z.gt+" ";c="percent-of-total"===c.normalizationType?z.pct:"";h=null==h?"":u.format(h);g=null==g?"":u.format(g);return n+h+c+" "+z.ld+" "+g+c}function R(c,h){return"normalizationField"in c&&c.normalizationField?{type:"normalized-field",field:c.field,normalizationField:c.normalizationField}:"field"in c&&c.field?{type:"field",field:c.field}:"valueExpression"in c&&c.valueExpression?{type:"expression",expression:c.valueExpression,title:c.valueExpressionTitle,returnType:h}:
null}const p=v.getLogger("esri.renderers.support.utils"),z={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},d={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},e={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};v=A.convertDateFormatToIntlOptions("short-date");E.calculateDateFormatInterval=
function(c){c=c.map(r=>new Date(r));const h=c.length;let g=Infinity,n=null;for(let r=0;r<h-1;r++){const G=c[r];let l=Infinity,t=null;for(let P=r+1;P<h;P++){var B=c[P];B=G.getFullYear()!==B.getFullYear()&&"year"||G.getMonth()!==B.getMonth()&&"month"||G.getDate()!==B.getDate()&&"day"||G.getHours()!==B.getHours()&&"hour"||G.getMinutes()!==B.getMinutes()&&"minute"||G.getSeconds()!==B.getSeconds()&&"second"||"millisecond";const w=d[B];w<l&&(l=w,t=B)}l<g&&(g=l,n=t)}return n};E.createClassBreakLabel=I;E.createColorStops=
function(c){const {values:h,colors:g,labelIndexes:n,isDate:B,dateFormatOptions:r}=c;return h.map((G,l)=>{let t=null;if(!n||-1<n.indexOf(l)){let P;(P=B?A.formatDate(G,r):u.format(G))&&(t=H(P,l,h.length-1))}return new J({value:G,color:g[l],label:t})})};E.createUniqueValueLabel=function(c){const {value:h,domain:g,fieldInfo:n,dateFormatInterval:B}=c;c=String(h);const r=g&&"codedValues"in g&&g.codedValues?g.getName(h):null;r?c=r:"number"===typeof h&&(c=n&&"date"===n.type?A.formatDate(h,B&&A.convertDateFormatToIntlOptions(e[B])):
u.format(h));return c};E.getAttribute=R;E.getAttributes=function(c,h){const g=[];if("class-breaks"===c.type||"heatmap"===c.type)g.push(R(c,"number"));else if("unique-value"===c.type){var n=c.authoringInfo;if(n&&"relationship"===n.type){if(n.field1&&n.field2){var B=n.field2.field;const r=n.field2.normalizationField;g.push(R({field:n.field1.field,normalizationField:n.field1.normalizationField}));g.push(R({field:B,normalizationField:r}))}}else B=c.uniqueValueInfos[0],n=null,B&&B.value&&(B=typeof c.uniqueValueInfos[0].value,
"string"===B||"number"===B)&&(n=B),g.push(R(c,n)),[c.field2,c.field3].forEach(r=>r&&g.push({type:"field",field:r}))}else"dot-density"===c.type&&c.attributes.forEach(r=>g.push(R(r,"number")));(c=h?h(c):"visualVariables"in c?c.visualVariables:null)&&c.forEach(r=>g.push(R(r,"number")));return M.unique(g.filter(Boolean),(r,G)=>"field"===r.type&&"field"===G.type?r.field===G.field:"normalized-field"===r.type&&"normalized-field"===G.type?r.field===G.field&&r.normalizationField===G.normalizationField:"expression"===
r.type&&"expression"===G.type?r.expression===G.expression:!1)};E.setLabelsForClassBreaks=function(c){const h=c.classBreakInfos,g=c.normalizationType;let n=[];if(h&&h.length)if("standard-deviation"===c.classificationMethod)p.warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");else if(c.round){n.push(h[0].minValue);for(const B of h)n.push(B.maxValue);n=u.round(n);h.forEach((B,r)=>{B.label=I({minValue:0===r?n[0]:n[r],maxValue:n[r+1],isFirstBreak:0===
r,normalizationType:g})})}else h.forEach((B,r)=>{B.label=I({minValue:B.minValue,maxValue:B.maxValue,isFirstBreak:0===r,normalizationType:g})})};E.timelineDateFormatOptions=v;E.updateClassBreak=function(c){if("standard-deviation"===c.classificationMethod)p.warn("updateClassBreak","cannot update labels for class breaks generated using 'standard-deviation' method.");else{var h=c.classBreaks,g=c.change,n=g.index;g=g.value;var B=h.length,r=-1,G=-1;0===n?r=n:n===B?G=n-1:(G=n-1,r=n);c=c.normalizationType;
n=null;-1<r&&r<B&&(n=h[r],n.minValue=g,n.label=I({minValue:n.minValue,maxValue:n.maxValue,isFirstBreak:0===r,normalizationType:c}));-1<G&&G<B&&(n=h[G],n.maxValue=g,n.label=I({minValue:n.minValue,maxValue:n.maxValue,isFirstBreak:0===G,normalizationType:c}))}};E.updateColorStops=function(c){const {stops:h,changes:g,isDate:n,dateFormatOptions:B}=c,r=h.map(l=>l.value);c=[];for(const l of g)c.push(l.index),r[l.index]=l.value;const G=u.round(r,{indexes:c});h.forEach((l,t)=>{l.value=r[t];if(null!=l.label){let P,
w=null;(P=n?A.formatDate(G[t],B):u.format(G[t]))&&(w=H(P,t,h.length-1));l.label=w}})};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/widgets/Legend/styles/Card":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/Handles ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../symbols/support/svgUtils ../../../symbols/support/utils ../../Widget ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/decorators/accessibleHandler ../../support/decorators/messageBundle ../../../core/Logger ../../support/jsxFactory ../../support/widgetUtils ../../../intl/substitute".split(" "),
function(E,M,v,A,u,J,H,I,R,p,z,d,e,c,h,g,n,B,r,G,l,t,P){const w=window.devicePixelRatio;v=function(q){function L(C,D){C=q.call(this,C,D)||this;C._handles=new A;C._hasIndicators=!1;C._selectedSectionName=null;C._sectionNames=[];C._sectionMap=new Map;C.activeLayerInfos=null;C.headingLevel=3;C.layout="stack";C.messages=null;C.messagesCommon=null;C.type="card";C.view=null;return C}E._inheritsLoose(L,q);var U=L.prototype;U.initialize=function(){this.own([this.watch("activeLayerInfos",C=>{this._handles.removeAll();
this._watchForSectionChanges(C)})])};U.destroy=function(){this._handles.destroy();this._handles=null};U.render=function(){this._hasIndicators="auto"===this.layout&&768>=this.view.container.clientWidth||"stack"===this.layout;var C=this.activeLayerInfos;C=C&&C.toArray().map(k=>this._renderLegendForLayer(k)).filter(k=>!!k);this._hasIndicators?this._selectedSectionName&&-1!==this._sectionNames.indexOf(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=
null;const D=this._sectionNames.length;var K=this._sectionNames.map((k,y)=>{y=P.substitute(this.messagesCommon.pagination.pageText,{index:y+1,total:D});return l.tsx("div",{key:k,role:"tab",id:k,"aria-label":y,"aria-controls":`${k}-panel`,"aria-selected":(this._selectedSectionName===k).toString(),tabIndex:this._selectedSectionName===k?0:-1,title:y,onclick:this._selectSection,onkeydown:this._focusSection,bind:this,class:this.classes("esri-legend--card__carousel-indicator",{["esri-legend--card__carousel-indicator--activated"]:this._selectedSectionName===
k}),"data-section-name":k})});K=this._hasIndicators&&1<D?l.tsx("div",{class:"esri-legend--card__carousel-indicator-container",key:"carousel-navigation",role:"tablist"},K):null;C=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):C&&C.length?C:null;return l.tsx("div",{class:this.classes("esri-legend--card",{["esri-legend--stacked"]:this._hasIndicators})},C?C:l.tsx("div",{class:"esri-legend--card__message"},this.messages.noLegend),K)};U._selectSection=function(C){if(C=C.target.getAttribute("data-section-name"))this._selectedSectionName=
C};U._focusSection=function(C){switch(C.key){case "ArrowLeft":case "ArrowRight":this._switchSectionOnArrowPress(C);break;case "Enter":case " ":this._selectSection(C)}};U._switchSectionOnArrowPress=function(C){const D=C.key,K="ArrowLeft"===D?-1:1;C=C.target.getAttribute("data-section-name");C=this._sectionNames.indexOf(C);const k=this._sectionNames;let y=null;-1!==C&&(k[C+K]?y=document.getElementById(k[C+K]):"ArrowLeft"===D?y=document.getElementById(k[k.length-1]):"ArrowRight"===D&&(y=document.getElementById(k[0])),
y&&y.focus())};U._watchForSectionChanges=function(C){this._generateSectionNames();C&&(C.forEach(D=>{const K=`activeLayerInfo-${D.layer.uid}-version-change`;this._handles.remove(K);this._watchForSectionChanges(D.children);this._handles.add(D.watch("version",()=>this._generateSectionNames()),K)}),this._handles.remove("activeLayerInfos-collection-change"),this._handles.add(C.on("change",()=>this._watchForSectionChanges(C)),"activeLayerInfos-collection-change"))};U._generateSectionNames=function(){this._sectionNames.length=
0;this._selectedSectionName=null;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)};U._getSectionName=function(C,D,K){return`${this.id}${C.uid}-type-${D.type}-${K}`};U._generateSectionNamesForActiveLayerInfo=function(C){C.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);C.legendElements&&C.legendElements.forEach((D,K)=>{this._sectionNames.push(this._getSectionName(C.layer,D,K))})};U._renderLegendForLayer=function(C){if(!C.ready)return null;
if(C.children.length){var D=C.children.map(K=>this._renderLegendForLayer(K)).toArray();return l.tsx("div",{key:C.layer.uid,class:this.classes("esri-legend--card__service","esri-legend--card__group-layer")},l.tsx("div",{class:"esri-legend--card__service-caption-container"},C.title),D)}{if((D=C.legendElements)&&!D.length)return null;const K=D.some(k=>"relationship-ramp"===k.type);D=D.map((k,y)=>this._renderLegendForElement(k,C,y,K)).filter(k=>!!k);return D.length?l.tsx("div",{key:C.layer.uid,class:this.classes("esri-legend--card__service",
{["esri-legend--card__group-layer-child"]:!!C.parent})},l.tsx("div",{class:"esri-legend--card__service-caption-container"},l.tsx("div",{class:"esri-legend--card__service-caption-text"},C.title)),l.tsx("div",{class:"esri-legend--card__service-content"},D)):null}};U._renderLegendForElement=function(C,D,K,k=!1){var y="color-ramp"===C.type,Q="opacity-ramp"===C.type,V="size-ramp"===C.type;const W=D.layer;var a=null;"string"===typeof C.title?a=C.title:C.title&&(a=C.title,y=g.getTitle(this.messages,a,y||
Q),a=a.title?`${a.title} (${y})`:y);K=this._getSectionName(W,C,K);y=this._hasIndicators?l.tsx("div",null,l.tsx(n.Heading,{level:this.headingLevel,class:"esri-legend--card__carousel-title"},D.title),l.tsx(n.Heading,{level:this.headingLevel+1,class:"esri-legend--card__layer-caption"},a)):a?l.tsx(n.Heading,{level:this.headingLevel,class:"esri-legend--card__layer-caption"},a):null;a=D.effectList;Q=null;"symbol-table"===C.type?(V=C.infos.map((f,F)=>this._renderLegendForElementInfo(f,D,C.legendType,F)).filter(f=>
!!f),V.length&&(Q=l.tsx("div",{class:this.classes({["esri-legend--card__label-container"]:!(V[0].properties.classes&&V[0].properties.classes["esri-legend--card__symbol-row"])&&!k,["esri-legend--card__relationship-label-container"]:k})},V))):"color-ramp"===C.type||"opacity-ramp"===C.type||"heatmap-ramp"===C.type?Q=this._renderLegendForRamp(C,W.opacity,a):V?Q=this._renderSizeRamp(C,W.opacity):"relationship-ramp"===C.type?Q=c.renderRelationshipRamp(C,this.id,W.opacity,a):"univariate-above-and-below-ramp"===
C.type?Q=this._renderUnivariateAboveAndBelowRamp(C,W.opacity,a):"univariate-color-size-ramp"===C.type&&(Q=this._renderUnivariateColorSizeRamp(C,W.opacity,a));if(!Q)return null;k=l.tsx("div",{key:K,class:"esri-legend--card__section",id:`${K}-panel`,role:"tabpanel","aria-labelledby":K,tabIndex:0},[y,Q]);this._sectionMap.set(K,k);return k};U._renderUnivariateAboveAndBelowRamp=function(C,D,K){const {sizeRampElement:k,colorRampElement:y}=h.getUnivariateAboveAndBelowRampElements(C,D,"horizontal");if(!k)return null;
C=h.getUnivariateSizeRampSize(k,"full",!0,"horizontal");var Q=h.getUnivariateColorRampSize(k,"above",!0,"horizontal"),V=h.getUnivariateColorRampSize(k,"below",!0,"horizontal");Q=h.getUnivariateColorRampPreview(y,{width:Q,height:12,rampAlignment:"horizontal",opacity:D,type:"above",effectList:K});D=h.getUnivariateColorRampPreview(y,{width:V,height:12,rampAlignment:"horizontal",opacity:D,type:"below",effectList:K});V=h.getUnivariateColorRampMargin(k,"card");K=k.infos.map(a=>a.label);const W=K.length-
1;K=K.map((a,f)=>0===f||f===W?l.tsx("div",{key:f},a):null);V={marginTop:"3px",marginLeft:`${V}px`,display:"flex"};C={width:`${C}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return l.tsx("div",{class:"esri-legend--card__layer-row",key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},l.tsx("div",{class:this.classes("esri-legend--card__symbol-container","esri-legend__size-ramp--horizontal"),styles:{display:"flex",flexDirection:"row"}},k.infos.map((a,f)=>l.tsx("div",
{key:f,class:"esri-legend--card__symbol",bind:a.preview,afterCreate:g.attachToNode}))),Q?l.tsx("div",{class:"esri-univariate-above-and-below-ramp__color--card",styles:V,key:"color-ramp-preview"},l.tsx("div",{bind:Q,afterCreate:g.attachToNode}),l.tsx("div",{bind:D,afterCreate:g.attachToNode})):null,l.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},l.tsx("div",{class:"esri-legend__ramp-labels",styles:C},K)))};U._renderUnivariateColorSizeRamp=function(C,D,K){const {sizeRampElement:k,
colorRampElement:y}=h.getUnivariateColorSizeRampElements(C,"horizontal");if(!k)return null;C=h.getUnivariateSizeRampSize(k,"full",!1,"horizontal");var Q=h.getUnivariateColorRampSize(k,"full",!1,"horizontal");D=h.getUnivariateColorRampPreview(y,{width:Q,height:12,rampAlignment:"horizontal",opacity:D,type:"full",effectList:K});Q=h.getUnivariateColorRampMargin(k,"card");const V=k.infos.length-1;K=k.infos.map((W,a)=>0===a||a===V?l.tsx("div",{key:a},W.label):null);Q={marginTop:"3px",marginLeft:`${Q}px`,
display:"flex"};C={width:`${C}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return l.tsx("div",{class:"esri-legend--card__layer-row",key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},l.tsx("div",{class:this.classes("esri-legend--card__symbol-container","esri-legend__size-ramp--horizontal"),styles:{display:"flex",flexDirection:"row"}},k.infos.map((W,a)=>l.tsx("div",{key:a,class:"esri-legend--card__symbol",bind:W.preview,afterCreate:g.attachToNode}))),
l.tsx("div",{class:"esri-univariate-above-and-below-ramp__color--card",styles:Q,key:"color-ramp-preview"},l.tsx("div",{bind:D,afterCreate:g.attachToNode})),l.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},l.tsx("div",{class:"esri-legend__ramp-labels",styles:C},K)))};U._renderLegendForElementInfo=function(C,D,K,k){var y=D.layer;if(C.type)return this._renderLegendForElement(C,D,k);K=g.isImageryStretchedLegend(y,K);if(C.preview){var Q;if(!C.symbol||-1===C.symbol.type.indexOf("simple-fill")){if(!C.label)return l.tsx("div",
{key:k,bind:C.preview,afterCreate:g.attachToNode});D={["esri-legend--card__symbol-cell"]:this._hasIndicators};return l.tsx("div",{key:k,class:this.classes("esri-legend--card__layer-row",{["esri-legend--card__symbol-row"]:this._hasIndicators})},l.tsx("div",{class:this.classes(D),bind:C.preview,afterCreate:g.attachToNode}),l.tsx("div",{class:this.classes("esri-legend--card__image-label",{["esri-legend--card__label-cell"]:this._hasIndicators})},g.getTitle(this.messages,C.label,!1)||""))}let W=K=255,
a=255,f=0,F=255,O=255,Y=255,ba=0;const ea=C.symbol.color&&C.symbol.color.a,ia=C.symbol.outline&&C.symbol.outline.color&&C.symbol.outline.color.a;ea&&(K=C.symbol.color.r,W=C.symbol.color.g,a=C.symbol.color.b,f=C.symbol.color.a*y.opacity);ia&&(F=C.symbol.outline.color.r,O=C.symbol.outline.color.g,Y=C.symbol.outline.color.b,ba=C.symbol.outline.color.a*y.opacity);var V=(y=null!=(V=null==(Q=C.symbol.color)?void 0:Q.isBright)?V:!0)?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";D={background:ea?`rgba(${K}, ${W}, ${a}, ${f})`:
"none",color:y?"black":"white",textShadow:`-1px -1px 0 ${V},\n                                              1px -1px 0 ${V},\n                                              -1px 1px 0 ${V},\n                                              1px 1px 0 ${V}`,border:ia?`1px solid rgba(${F}, ${O}, ${Y}, ${ba})`:"none",filter:d.getCSSFilterFromEffectList(D.effectList)};return l.tsx("div",{key:k,class:"esri-legend--card__layer-row"},l.tsx("div",{class:"esri-legend--card__label-element",styles:D}," ",C.label,
" "))}if(C.src)return D=this._renderImage(C,y,K),l.tsx("div",{key:k,class:"esri-legend--card__layer-row"},D,l.tsx("div",{class:"esri-legend--card__image-label"},C.label||""))};U._renderImage=function(C,D,K){const {label:k,src:y,opacity:Q}=C;K={["esri-legend--card__imagery-layer-image--stretched"]:K,["esri-legend--card__symbol"]:!K};D={opacity:`${null!=Q?Q:D.opacity}`};return l.tsx("img",{alt:g.getTitle(this.messages,k,!1),src:y,border:0,width:C.width,height:C.height,class:this.classes(K),styles:D})};
U._renderSizeRampLines=function(C){C=C.infos;var D=C[0],K=C[C.length-1],k=D.symbol;C=this._hasIndicators;D=u.pt2px(D.size+D.outlineSize)*w;K=u.pt2px(K.size+K.outlineSize)*w;const y=C?D:D+50*w,Q=C?D/2+50*w:D;var V;k?-1<k.type.indexOf("3d")?(V=k.symbolLayers&&k.symbolLayers.length)?(V=k.symbolLayers.getItemAt(V-1).get("resource.primitive"),V="triangle"===V||"cone"===V||"tetrahedron"===V):V=void 0:V="triangle"===k.style:V=void 0;if(k)if(-1<k.type.indexOf("3d")){var W=k.symbolLayers&&k.symbolLayers.length;
W?(k=k.symbolLayers.getItemAt(W-1),k=k.resource&&k.resource.primitive,k="circle"===k||"cross"===k||"kite"===k||"sphere"===k||"cube"===k||"diamond"===k):k=void 0}else k=k.style,k="circle"===k||"diamond"===k||"cross"===k;else k=void 0;W=document.createElement("canvas");W.width=y;W.height=Q;W.style.width=`${W.width/w}px`;W.style.height=`${W.height/w}px`;const a=W.getContext("2d");if(C){a.beginPath();var f=y/2-K/2;a.moveTo(0,0);a.lineTo(f,Q);f=y/2+K/2;a.moveTo(y,0);a.lineTo(f,Q)}else a.beginPath(),a.moveTo(0,
Q/2-K/2),a.lineTo(y,0),a.moveTo(0,Q/2+K/2),a.lineTo(y,Q);a.strokeStyle="#ddd";a.stroke();return l.tsx("div",{bind:W,afterCreate:g.attachToNode,styles:C?{display:"flex",marginTop:`-${V?0:k?D/2:0}px`,marginBottom:`-${V?K:k?K/2:0}px`}:{display:"flex",marginRight:`-${V?0:k?D/2:0}px`,marginLeft:`-${V?0:k?K/2:0}px`}})};U._renderSizeRamp=function(C,D){var K=C.infos;const k=K[0].label,y=K[K.length-1].label;let Q=K[0].preview;K=K[K.length-1].preview;const V=this._hasIndicators,W={"flex-direction":V?"column":
"row-reverse"};Q&&(Q=Q.cloneNode(!0),Q.style.display="flex");K&&(K=K.cloneNode(!0),K.style.display="flex");D={opacity:null!=D?`${D}`:""};return l.tsx("div",{class:this.classes("esri-legend--card__layer-row",{["esri-legend--card__size-ramp-row"]:V})},l.tsx("div",{class:"esri-legend--card__ramp-label"},V?k:y),l.tsx("div",{class:"esri-legend--card__size-ramp-container",styles:W},l.tsx("div",{bind:Q,afterCreate:g.attachToNode,class:"esri-legend--card__size-ramp-preview",styles:D}),this._renderSizeRampLines(C),
l.tsx("div",{bind:K,afterCreate:g.attachToNode,class:"esri-legend--card__size-ramp-container",styles:D})),l.tsx("div",{class:"esri-legend--card__ramp-label"},V?y:k))};U._renderLegendForRamp=function(C,D,K){var k=C.infos;const y="heatmap-ramp"===C.type,Q=k.length-1;var V=2<Q&&!y?25*Q:100,W=V+20;const a=k.slice(0).reverse();a.forEach((O,Y)=>{O.offset=y?O.ratio:Y/Q});const f=a.length-1;C=(C=0!==a.length%2&&a[a.length/2|0])&&l.tsx("div",{class:"esri-legend--card__interval-separators-container"},l.tsx("div",
{class:"esri-legend--card__interval-separator"},"|"),l.tsx("div",{class:"esri-legend--card__ramp-label"},C.label));const F=k[k.length-1].label;k=k[0].label;V=z.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:a[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:V,height:25},fill:{type:"linear",x1:10,y1:0,x2:V+10,y2:0,colors:a},stroke:{width:0}},{shape:{type:"path",path:`M${V+10} 0 L${W} ${12.5} L${V+10} ${25} Z`},fill:a[f].color,stroke:{width:0}}]],W,25);({messages:W}=
this);D={filter:d.getCSSFilterFromEffectList(K),opacity:null==D?null:`${D}`};return l.tsx("div",{class:"esri-legend--card__layer-row"},l.tsx("div",{class:"esri-legend--card__ramp-label"},y?W[F]:F),l.tsx("div",{class:"esri-legend--card__symbol-container"},l.tsx("div",{styles:D},V),C),l.tsx("div",{class:"esri-legend--card__ramp-label"},y?W[k]:k))};return L}(e);M.__decorate([J.property()],v.prototype,"activeLayerInfos",void 0);M.__decorate([J.property()],v.prototype,"headingLevel",void 0);M.__decorate([J.property()],
v.prototype,"layout",void 0);M.__decorate([J.property(),r.messageBundle("esri/widgets/Legend/t9n/Legend")],v.prototype,"messages",void 0);M.__decorate([J.property(),r.messageBundle("esri/t9n/common")],v.prototype,"messagesCommon",void 0);M.__decorate([J.property({readOnly:!0})],v.prototype,"type",void 0);M.__decorate([J.property()],v.prototype,"view",void 0);M.__decorate([B.accessibleHandler()],v.prototype,"_selectSection",null);return v=M.__decorate([p.subclass("esri.widgets.Legend.styles.Card")],
v)})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define("exports ../../../../symbols/support/svgUtils ../../../../symbols/support/utils ../../../support/widgetUtils ../../../../core/has ../../../../core/Logger ../../../support/jsxFactory".split(" "),function(E,M,v,A,u,J,H){function I(z,d,e){const c=`${e}_arrowStart`;e=`${e}_arrowEnd`;z="left"===z;const h={markerStart:null,markerEnd:null};switch(d){case "HL":z?h.markerStart=`url(#${e})`:h.markerEnd=`url(#${c})`;break;case "LL":h.markerStart=
`url(#${e})`;break;case "LH":z?h.markerEnd=`url(#${c})`:h.markerStart=`url(#${e})`;break;default:h.markerEnd=`url(#${c})`}return h}function R(z,d,e,c,h=60){const {focus:g,numClasses:n,colors:B,rotation:r}=z;z=!!g;const G=Math.sqrt(h**2+h**2)+(z?0:5),l=[],t=[];var P=[],w=(h||75)/n;for(var q=0;q<n;q++){var L=q*w;for(var U=0;U<n;U++){var C=U*w;const D=M.generateFillAttributes(B[q][U]),K=M.generateStrokeAttributes(null);C={type:"rect",x:C,y:L,width:w,height:w};l.push(M.renderDef(D));t.push(M.renderShape(C,
D.fill,K,null));P.push(M.getBoundingBox(C))}}w=null;z||(w="margin: -15px -15px -18px -15px");q=I("left",g,d);L=I("right",g,d);U=M.computeBBox(P);P=M.getTransformMatrix(U,G,G,0,!1,r,!1);U=M.getTransformMatrix(U,G,G,0,!1,z?-45:null,!1);e={filter:v.getCSSFilterFromEffectList(c),opacity:null==e?null:`${e}`};return H.tsx("div",{styles:e,class:z?p.diamondMidColRamp:p.squareTableCell},H.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:G,height:G,style:w},H.tsx("defs",null,H.tsx("marker",{id:`${d}_arrowStart`,
markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},H.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),H.tsx("marker",{id:`${d}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},H.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),l),H.tsx("g",{transform:P},t),H.tsx("g",{transform:U},H.tsx("line",{fill:"none",stroke:"#555555",
"stroke-width":"1","marker-start":q.markerStart,"marker-end":q.markerEnd,x1:-10,y1:h-15,x2:-10,y2:15}),H.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":L.markerStart,"marker-end":L.markerEnd,x1:15,y1:h+10,x2:h-15,y2:h+10}))))}const p={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",
diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",
squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};E.renderRelationshipRamp=function(z,d,e,c){const {focus:h,labels:g}=z,n=!!h;z=R(z,d,e,c);return n?H.tsx("div",{class:p.diamondContainer},H.tsx("div",{class:p.diamondLeftCol},g.left),H.tsx("div",{class:p.diamondMidCol},H.tsx("div",{class:p.diamondMidColLabel},g.top),z,H.tsx("div",{class:p.diamondMidColLabel},g.bottom)),H.tsx("div",{class:p.diamondRightCol},
g.right)):H.tsx("div",{class:p.squareTable},H.tsx("div",{class:p.squareTableRow},H.tsx("div",{class:A.classes(p.squareTableCell,p.squareTableLabel,p.squareTableLabelRightBottom)},g.left),H.tsx("div",{class:p.squareTableCell}),H.tsx("div",{class:A.classes(p.squareTableCell,p.squareTableLabel,p.squareTableLabelLeftBottom)},g.top)),H.tsx("div",{class:p.squareTableRow},H.tsx("div",{class:p.squareTableCell}),z,H.tsx("div",{class:p.squareTableCell})),H.tsx("div",{class:p.squareTableRow},H.tsx("div",{class:A.classes(p.squareTableCell,
p.squareTableLabel,p.squareTableLabelRightTop)},g.bottom),H.tsx("div",{class:p.squareTableCell}),H.tsx("div",{class:A.classes(p.squareTableCell,p.squareTableLabel,p.squareTableLabelLeftTop)},g.right)))};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/widgets/Legend/styles/support/univariateUtils":function(){define("exports ../../../../core/screenUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../symbols/support/symbolUtils ../../../support/widgetUtils ../../../../core/has ../../../../core/Logger ../../../support/jsxFactory".split(" "),
function(E,M,v,A,u,J,H,I,R){function p(g="vertical"){return"vertical"===g?R.tsx("svg",{height:"4",width:"10"},R.tsx("line",{x1:"0",y1:"2",x2:"10",y2:"2",style:"stroke:rgb(200, 200, 200);stroke-width:1"})):R.tsx("svg",{height:"10",width:"10"},R.tsx("line",{x1:"5",y1:"0",x2:"5",y2:"10",style:"stroke:rgb(200, 200, 200);stroke-width:1"}))}function z(g,n="vertical"){const B=document.createElement("div");B.style.height="20px";B.className=h.univariateAboveAndBelowSymbol;null!=g&&(B.style.opacity=g.toString());
c.append(B,p.bind(null,n));return B}function d(g,n,B="vertical",r){g.infos.forEach((G,l)=>{if(r&&2===l)G.preview=z(n,B);else{l=M.pt2px(G.size)+("horizontal"===B?20:10);const t="div"===G.preview.tagName.toLowerCase(),P=t?G.preview:document.createElement("div");P.className=h.univariateAboveAndBelowSymbol;"horizontal"===B?P.style.width=`${l}px`:P.style.height=`${l}px`;t||P.appendChild(G.preview);G.preview=P}})}function e(g,n,B,r="vertical"){let G=0;g=g.infos;const l=Math.floor(g.length/2);var t="full"===
n||"above"===n?0:l;for(n="full"===n||"below"===n?g.length-1:l;t<=n;t++)if(B&&t===l)G+="horizontal"===r?10:20;else{const P=M.pt2px(g[t].size)+("horizontal"===r?20:10);G+=P}return Math.round(G)}const c=A.createProjector(),h={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};E.getUnivariateAboveAndBelowRampElements=function(g,n,B="vertical"){var r=g.infos;g=r.filter(({type:t})=>"size-ramp"===t)[0];r=r.filter(({type:t})=>"color-ramp"===t)[0];
g&&(g={...g},g.infos=[...g.infos],d(g,n,B,!0));r&&(r={...r},r.infos=[...r.infos]);if("horizontal"===B){var G,l;null==(G=g)?void 0:G.infos.reverse();null==(l=r)?void 0:l.infos.reverse()}return{sizeRampElement:g,colorRampElement:r}};E.getUnivariateColorRampMargin=function(g,n="classic"){g=g.infos;return"classic"===n?(M.pt2px(g[0].size)+10)/2:(M.pt2px(g[0].size)-M.pt2px(g[g.length-1].size))/2};E.getUnivariateColorRampPreview=function(g,n){if(!g)return null;g=g.infos.map(B=>B.color);g=u.renderColorRampPreviewHTML("full"===
n.type?g:"above"===n.type?g.slice(0,3):g.slice(2,5),{width:n.width,height:n.height,align:n.rampAlignment,effectList:n.effectList});g.className=h.colorRamp;null!=n.opacity&&(g.style.opacity=n.opacity.toString());return g};E.getUnivariateColorRampSize=function(g,n,B,r="vertical"){const G=e(g,n,B,r);g=g.infos;var l=Math.floor(g.length/2);const t="full"===n||"above"===n?0:l;l="full"===n||"below"===n?g.length-1:l;B=B?"vertical"===r?20:10:0;r="vertical"===r?10*("full"===n?2:1):20*("full"===n?2:1);return Math.round(G-
(M.pt2px("full"===n?g[t].size+g[l].size:"above"===n?g[t].size:g[l].size)/2+B/2+r/2))};E.getUnivariateColorSizeRampElements=function(g,n="vertical"){var B=g.infos;g=B.filter(({type:l})=>"size-ramp"===l)[0];B=B.filter(({type:l})=>"color-ramp"===l)[0];g&&(g={...g},g.infos=[...g.infos],d(g,null,n,!1));B&&(B={...B},B.infos=[...B.infos]);if("horizontal"===n){var r,G;null==(r=g)?void 0:r.infos.reverse();null==(G=B)?void 0:G.infos.reverse()}return{sizeRampElement:g,colorRampElement:B}};E.getUnivariateSizeRampSize=
e;Object.defineProperty(E,"__esModule",{value:!0})})},"esri/widgets/Legend/support/styleUtils":function(){define(["exports","../../../intl","../../../intl/substitute"],function(E,M,v){E.attachToNode=function(A){A.appendChild(this)};E.getTitle=function(A,u,J){if(u){if("string"===typeof u||"number"===typeof u)return u;if("value"in u||"unit"in u)return v.substitute(A.dotValue,u);if("colorName"in u||"bandName"in u)return A[u.colorName]+": "+(A[u.bandName]||u.bandName);if("showCount"in u)return u.showCount?
A.clusterCountTitle:null;var H=null;J?H=u.ratioPercentTotal?"showRatioPercentTotal":u.ratioPercent?"showRatioPercent":u.ratio?"showRatio":u.normField?"showNormField":u.field?"showField":null:J||(H=u.normField?"showNormField":u.normByPct?"showNormPct":u.field?"showField":null);return H?v.substitute("showField"===H?"{field}":A[H],{field:u.field,normField:u.normField}):null}};E.isImageryStretchedLegend=function(A,u){return!!(u&&"Stretched"===u&&10.3<=A.version&&"esri.layers.ImageryLayer"===A.declaredClass)};
E.isRendererTitle=function(A,u){return!u};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/widgets/support/Heading":function(){define("exports ../../core/mathUtils ./widgetUtils ../../core/has ../../core/Logger ./jsxFactory".split(" "),function(E,M,v,A,u,J){const H={heading:"esri-widget__heading"};E.CSS=H;E.Heading=function(I,R){const p=`h${M.clamp(Math.ceil(I.level),1,6)}`;delete I.level;return J.tsx(p,{...I,class:v.classes(H.heading,I.class)},R)};Object.defineProperty(E,"__esModule",{value:!0})})},
"esri/widgets/Legend/styles/Classic":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../Widget ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../../core/Logger ../../support/jsxFactory ../../../intl/number".split(" "),
function(E,M,v,A,u,J,H,I,R,p,z,d,e,c,h,g,n,B){const r={display:"flex",alignItems:"flex-start"},G={marginLeft:"3px"},l={display:"table-cell",verticalAlign:"middle"};v=function(t){function P(q,L){q=t.call(this,q,L)||this;q.activeLayerInfos=null;q.headingLevel=3;q.messages=null;q.type="classic";return q}E._inheritsLoose(P,t);var w=P.prototype;w.render=function(){var q=this.activeLayerInfos;q=q&&q.toArray().map(L=>this._renderLegendForLayer(L)).filter(L=>!!L);return n.tsx("div",null,q&&q.length?q:n.tsx("div",
{class:"esri-legend__message"},this.messages.noLegend))};w._renderLegendForLayer=function(q){if(!q.ready)return null;var L=!!q.children.length;const U=`${"esri-legend__"}${q.layer.uid}-version-${q.version}`,C=q.title?e.Heading({level:this.headingLevel,class:this.classes("esri-widget__heading","esri-legend__service-label")},q.title):null;if(L)return L=q.children.map(D=>this._renderLegendForLayer(D)).toArray(),n.tsx("div",{key:U,class:this.classes("esri-legend__service","esri-legend__group-layer")},
C,L);if((L=q.legendElements)&&!L.length)return null;L=L.map(D=>this._renderLegendForElement(D,q.layer,q.effectList)).filter(D=>!!D);return L.length?n.tsx("div",{key:U,class:this.classes("esri-legend__service",{["esri-legend__group-layer-child"]:!!q.parent}),tabIndex:0},C,n.tsx("div",{class:"esri-legend__layer"},L)):null};w._renderLegendForElement=function(q,L,U,C){var D="color-ramp"===q.type,K="opacity-ramp"===q.type;const k="size-ramp"===q.type;let y=null;if("symbol-table"===q.type||k){var Q=q.infos.map(W=>
this._renderLegendForElementInfo(W,L,U,k,q.legendType)).filter(W=>!!W);Q.length&&(y=n.tsx("div",{class:"esri-legend__layer-body"},Q))}else"color-ramp"===q.type||"opacity-ramp"===q.type||"heatmap-ramp"===q.type||"stretch-ramp"===q.type?y=this._renderLegendForRamp(q,L.opacity):"relationship-ramp"===q.type?y=p.renderRelationshipRamp(q,this.id,L.opacity,U):"univariate-above-and-below-ramp"===q.type?y=this._renderUnivariateAboveAndBelowRamp(q,L.opacity,U):"univariate-color-size-ramp"===q.type&&(y=this._renderUnivariateColorSizeRamp(q,
L.opacity,U));if(!y)return null;Q=q.title;var V=null;"string"===typeof Q?V=Q:Q&&(V=d.getTitle(this.messages,Q,D||K),V=d.isRendererTitle(Q,D||K)&&Q.title?`${Q.title} (${V})`:V);D=C?"esri-legend__layer-child-table":"esri-legend__layer-table";K=V?n.tsx("div",{class:"esri-legend__layer-caption"},V):null;return n.tsx("div",{class:this.classes(D,{["esri-legend__layer-table--size-ramp"]:k||!C})},K,y)};w._renderUnivariateAboveAndBelowRamp=function(q,L,U){const {sizeRampElement:C,colorRampElement:D}=z.getUnivariateAboveAndBelowRampElements(q,
L);if(!C)return null;var K=z.getUnivariateColorRampSize(C,"above",!0);q=z.getUnivariateColorRampSize(C,"below",!0);const k=z.getUnivariateColorRampPreview(D,{width:12,height:K,rampAlignment:"vertical",opacity:L,type:"above",effectList:U});L=z.getUnivariateColorRampPreview(D,{width:12,height:q,rampAlignment:"vertical",opacity:L,type:"below",effectList:U});var y=z.getUnivariateColorRampMargin(C);const Q=C.infos.map(F=>F.label);U=Q.map((F,O)=>{const Y=2===O;return 0===O?n.tsx("div",{key:O,class:F?k?
"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},F):Y?n.tsx("div",null):null});const V=Q.length-1,W=Math.floor(Q.length/2),a=Q.map((F,O)=>{const Y=O===V;return O===W||Y?n.tsx("div",{key:O,class:F?k?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},F):null}),f={display:"table-cell",verticalAlign:"middle"};y={marginTop:`${y}px`};K={height:`${K}px`};q={height:`${q}px`};return n.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:r},
n.tsx("div",{class:"esri-legend__layer-body"},C.infos.map((F,O)=>n.tsx("div",{class:this.classes("esri-legend__layer-row","esri-legend__size-ramp")},n.tsx("div",{class:"esri-legend__symbol",styles:f,bind:F.preview,afterCreate:d.attachToNode}),k||0!==O%2?null:n.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},Q[O])))),k?n.tsx("div",{styles:y,key:"color-ramp-preview"},n.tsx("div",{styles:G},n.tsx("div",{styles:l},n.tsx("div",{class:"esri-legend__ramps",bind:k,afterCreate:d.attachToNode})),
n.tsx("div",{styles:l},n.tsx("div",{class:"esri-legend__ramp-labels",styles:K},U))),n.tsx("div",{styles:G},n.tsx("div",{styles:l},n.tsx("div",{class:"esri-legend__ramps",bind:L,afterCreate:d.attachToNode})),n.tsx("div",{styles:l},n.tsx("div",{class:"esri-legend__ramp-labels",styles:q},a)))):null)};w._renderUnivariateColorSizeRamp=function(q,L,U){const {sizeRampElement:C,colorRampElement:D}=z.getUnivariateColorSizeRampElements(q);if(!C)return null;var K=z.getUnivariateColorRampMargin(C);q=z.getUnivariateColorRampSize(C,
"full",!1);L=z.getUnivariateColorRampPreview(D,{width:12,height:q,rampAlignment:"vertical",opacity:L,type:"full",effectList:U});const k=C.infos.length-1;U=C.infos.map((Q,V)=>0===V||V===k?n.tsx("div",{key:V,class:Q.label?D?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},Q.label):null);const y={display:"table-cell",verticalAlign:"middle"};K={marginTop:`${K}px`};q={height:`${q}px`};return n.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:r},n.tsx("div",{class:"esri-legend__layer-body"},
C.infos.map(Q=>n.tsx("div",{class:this.classes("esri-legend__layer-row","esri-legend__size-ramp")},n.tsx("div",{class:"esri-legend__symbol",styles:y,bind:Q.preview,afterCreate:d.attachToNode})))),n.tsx("div",{styles:K,key:"color-ramp-preview"},n.tsx("div",{styles:G},n.tsx("div",{styles:l},n.tsx("div",{class:"esri-legend__ramps",bind:L,afterCreate:d.attachToNode})),n.tsx("div",{styles:l},n.tsx("div",{class:"esri-legend__ramp-labels",styles:q},U)))))};w._renderLegendForRamp=function(q,L){const U=q.infos,
C="heatmap-ramp"===q.type,D="stretch-ramp"===q.type,K=q.preview;K.className=`${"esri-legend__color-ramp"} ${"opacity-ramp"===q.type?"esri-legend__opacity-ramp":""}`;null!=L&&(K.style.opacity=L.toString());q=U.map(k=>n.tsx("div",{class:k.label?"esri-legend__ramp-label":null},C?this.messages[k.label]:D?this._getStretchStopLabel(k):k.label));L={height:K.style.height};return n.tsx("div",{class:"esri-legend__layer-row"},n.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},
n.tsx("div",{class:"esri-legend__ramps",bind:K,afterCreate:d.attachToNode})),n.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},n.tsx("div",{class:"esri-legend__ramp-labels",styles:L},q)))};w._getStretchStopLabel=function(q){return q.label?this.messages[q.label]+": "+("string"===typeof q.value?q.value:B.formatNumber(q.value,{style:"decimal",notation:-1<q.value.toString().indexOf("e")?"scientific":"standard"})):""};w._renderLegendForElementInfo=function(q,L,U,C,D){if(q.type)return this._renderLegendForElement(q,
L,U,!0);U=null;D=d.isImageryStretchedLegend(L,D);q.preview?U=n.tsx("div",{class:"esri-legend__symbol",bind:q.preview,afterCreate:d.attachToNode}):q.src&&(U=this._renderImage(q,L,D));if(!U)return null;L={["esri-legend__imagery-layer-info--stretched"]:D};return n.tsx("div",{class:"esri-legend__layer-row"},n.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",{["esri-legend__imagery-layer-info--stretched"]:D,["esri-legend__size-ramp"]:!D&&C})},U),n.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",
L)},d.getTitle(this.messages,q.label,!1)||""))};w._renderImage=function(q,L,U){const {label:C,src:D,opacity:K}=q;U={["esri-legend__imagery-layer-image--stretched"]:U,["esri-legend__symbol"]:!U};L={opacity:`${null!=K?K:L.opacity}`};return n.tsx("img",{alt:d.getTitle(this.messages,C,!1),src:D,border:0,width:q.width,height:q.height,class:this.classes(U),styles:L})};return P}(R);M.__decorate([A.property()],v.prototype,"activeLayerInfos",void 0);M.__decorate([A.property()],v.prototype,"headingLevel",void 0);
M.__decorate([A.property(),h.messageBundle("esri/widgets/Legend/t9n/Legend")],v.prototype,"messages",void 0);M.__decorate([A.property({readOnly:!0})],v.prototype,"type",void 0);return v=M.__decorate([I.subclass("esri.widgets.Legend.styles.Classic")],v)})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widgetUtils ./support/decorators/messageBundle ../core/Logger ./support/jsxFactory".split(" "),function(E,M,v,A,
u,J,H,I,R,p,z,d,e,c,h,g,n,B){J=function(r){function G(t,P){t=r.call(this,t,P)||this;t._handles=new v;t.activeLayerInfos=null;t.basemapLegendVisible=!1;t.groundLegendVisible=!1;t.headingLevel=3;t.hideLayersNotInCurrentView=!1;t.keepCacheOnDestroy=!1;t.respectLayerVisibility=!0;t.iconClass="esri-icon-layer-list";t.label=void 0;t.layerInfos=null;t.messages=null;t.style=new c;t.view=null;t.viewModel=new d;return t}E._inheritsLoose(G,r);var l=G.prototype;l.initialize=function(){this.own(A.on(this,"view",
"resize",()=>this.scheduleRender()),A.on(this,"activeLayerInfos","change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),A.watch(this,"headingLevel",t=>{const {style:P}=this;P&&(P.headingLevel=t)}),A.init(this,"style",(t,P)=>{P&&t!==P&&P.destroy();t&&(t.activeLayerInfos=this.activeLayerInfos,"card"===t.type&&(t.view=this.view),t.headingLevel=this.headingLevel)}))};l.destroy=function(){this._handles.destroy();this._handles=null};l.castStyle=function(t){if(t instanceof e||t instanceof c)return t;
if("string"===typeof t)return"card"===t?new e:new c;if(t&&"string"===typeof t.type){const P={...t};delete P.type;return new ("card"===t.type?e:c)(P)}return new c};l.render=function(){return B.tsx("div",{class:this.classes("esri-legend","esri-widget",this.style instanceof c?"esri-widget--panel":null)},this.style.render())};l._refreshActiveLayerInfos=function(t){this._handles.removeAll();t.forEach(P=>this._renderOnActiveLayerInfoChange(P));this.scheduleRender()};l._renderOnActiveLayerInfoChange=function(t){var P=
A.init(t,"version",()=>this.scheduleRender());this._handles.add(P,`version_${t.layer.uid}`);P=A.on(t,"children","change",()=>{t.children.forEach(w=>this._renderOnActiveLayerInfoChange(w))});this._handles.add(P,`children_${t.layer.uid}`);t.children.forEach(w=>this._renderOnActiveLayerInfoChange(w))};return G}(z);M.__decorate([u.aliasOf("viewModel.activeLayerInfos")],J.prototype,"activeLayerInfos",void 0);M.__decorate([u.aliasOf("viewModel.basemapLegendVisible")],J.prototype,"basemapLegendVisible",
void 0);M.__decorate([u.aliasOf("viewModel.groundLegendVisible")],J.prototype,"groundLegendVisible",void 0);M.__decorate([R.property()],J.prototype,"headingLevel",void 0);M.__decorate([u.aliasOf("viewModel.hideLayersNotInCurrentView")],J.prototype,"hideLayersNotInCurrentView",void 0);M.__decorate([u.aliasOf("viewModel.keepCacheOnDestroy")],J.prototype,"keepCacheOnDestroy",void 0);M.__decorate([u.aliasOf("viewModel.respectLayerVisibility")],J.prototype,"respectLayerVisibility",void 0);M.__decorate([R.property()],
J.prototype,"iconClass",void 0);M.__decorate([R.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],J.prototype,"label",void 0);M.__decorate([u.aliasOf("viewModel.layerInfos")],J.prototype,"layerInfos",void 0);M.__decorate([R.property(),g.messageBundle("esri/widgets/Legend/t9n/Legend")],J.prototype,"messages",void 0);M.__decorate([R.property()],J.prototype,"style",void 0);M.__decorate([I.cast("style")],J.prototype,"castStyle",null);M.__decorate([u.aliasOf("viewModel.view")],J.prototype,
"view",void 0);M.__decorate([R.property()],J.prototype,"viewModel",void 0);return J=M.__decorate([p.subclass("esri.widgets.Legend")],J)});