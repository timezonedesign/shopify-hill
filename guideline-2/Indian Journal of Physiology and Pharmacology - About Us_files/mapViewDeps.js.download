// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/engine/Stage":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../core/events ../../../core/has ../../../core/maybe ../../../core/scheduling ../../../core/watchUtils ../../../chunks/common ../../../chunks/mat2d ../../../chunks/mat2df64 ../../../chunks/mat3f32 ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../symbols/cim/CIMResourceManager ../../webgl/BufferObject ../../webgl/FramebufferObject ../../webgl/checkWebGLError ../../webgl/enums ../../../chunks/builtins ../../webgl/programUtils ../../webgl/Texture ../../webgl/VertexArrayObject ../../webgl/context-util ./Container ./webgl/enums ./webgl/Painter ./webgl/Profiler ./webgl/shaders/StencilPrograms ../support/Timeline ../../support/screenshotUtils ../../webgl/RenderingContext".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e,d,g,m,n,r,t,z,w,B,A,x,E,D,K,H,I){g=function(J){function M(L,S){var Q=J.call(this)||this;Q._trash=new Set;Q._clipData=new Float32Array(8);Q._upperLeft=l.create();Q._upperRight=l.create();Q._lowerLeft=l.create();Q._lowerRight=l.create();Q._mat2=f.create();Q._clipRendererInitialized=!1;Q._renderRemainingTime=0;Q._lastFrameRenderTime=0;Q.renderRequested=!1;Q.stage=G._assertThisInitialized(Q);Q._stationary=!0;const {canvas:P=document.createElement("canvas"),alpha:R=
!0,stencil:N=!0,contextOptions:W={}}=S;Q._canvas=P;const X=w.createContextOrErrorHTML(P,1,{alpha:R,antialias:!1,depth:!0,stencil:N});Q.context=new I.RenderingContext(v.isSome(X)?X:null,W);Q.resourceManager=new q;Q.painter=new x(Q.context,G._assertThisInitialized(Q),Q.resourceManager);y("esri-2d-profiler")&&(Q._debugOutput=document.createElement("div"),Q._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),L.appendChild(Q._debugOutput));Q._renderParameters={drawPhase:0,
state:Q.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1,blendMode:null,deltaTime:-1,time:0,inFadeTransition:!1,effects:null,context:Q.context,painter:Q.painter,timeline:S.timeline||new K.Timeline,renderingOptions:S.renderingOptions,requireFBO:!1,profiler:new E.Profiler(Q.context,Q._debugOutput),dataUploadCounter:0};Q._taskHandle=p.addFrameTask({render:T=>Q.renderFrame(T)});Q._taskHandle.pause();Q._lostWebGLContextHandle=C.on(P,"webglcontextlost",()=>{Q.emit("webgl-error",{error:new F("webgl-context-lost")})});
P.setAttribute("style","width: 100%; height:100%; display:block;");L.appendChild(P);return Q}G._inheritsLoose(M,J);var O=M.prototype;O.destroy=function(){this.removeAllChildren();this._emptyTrash();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&
(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.highlightOptions=null;this.resourceManager.destroy();this.painter.dispose();this.context.dispose();this._canvas=null};O.trashDisplayObject=function(L){this._trash.add(L);this.requestRender()};O.untrashDisplayObject=function(L){return this._trash.delete(L)};
O.requestRender=function(){this._renderRemainingTime=2E3;this.renderRequested||(this.renderRequested=!0,this.emit("will-render"),this._taskHandle.resume())};O.renderFrame=function(L){this._renderRemainingTime-=this._lastFrameRenderTime?L.time-this._lastFrameRenderTime:0;0>=this._renderRemainingTime&&this._taskHandle.pause();this._lastFrameRenderTime=L.time;this.renderRequested=!1;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=
window.devicePixelRatio;this._renderParameters.globalOpacity=1;this._renderParameters.time=L.time;this._renderParameters.deltaTime=L.deltaTime;this._renderParameters.effects=null;this.processRender(this._renderParameters);this._emptyTrash();this.emit("post-render")};O._createTransforms=function(){return{dvs:c.create()}};O.renderChildren=function(L){for(const S of this.children)S.beforeRender(L);this._renderChildren(this.children,L);for(const S of this.children)S.afterRender(L)};O._renderChildren=
function(L,S){const Q=this.context;S.profiler.recordStart("drawLayers");S.dataUploadCounter=0;this._beforeRenderChildren(S);S.drawPhase=A.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(Q,this.background);for(const P of L)P.processRender(S);this.painter.renderLayers(Q);S.drawPhase=A.WGLDrawPhase.HIGHLIGHT;this.painter.beforeRenderLayers(Q);for(const P of L)P.processRender(S);this.painter.renderLayers(Q);if(this._isLabelDrawPhaseRequired(L)){S.drawPhase=A.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(Q);
for(const P of L)P.processRender(S);this.painter.renderLayers(Q)}if(y("esri-tiles-debug")){S.drawPhase=A.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(Q);for(const P of L)P.processRender(S);this.painter.renderLayers(Q)}S.profiler.recordEnd("drawLayers");this._afterRenderChildren()};O._beforeRenderChildren=function(L){const {context:S}=this,{state:Q,pixelRatio:P}=L;S.enforceState();S.setClearDepth(1);S.setClearColor(0,0,0,0);S.clear(S.gl.COLOR_BUFFER_BIT|S.gl.DEPTH_BUFFER_BIT);const {size:R,rotation:N}=
Q;var W=Math.round(R[0]*P);L=Math.round(R[1]*P);this._boundFBO=S.getBoundFramebufferObject();if(Q.spatialReference&&(Q.spatialReference._isWrappable?Q.spatialReference._isWrappable():Q.spatialReference.isWrappable)){var X=b.toRadian(N),T=Math.abs(Math.cos(X)),U=Math.abs(Math.sin(X)),V=Math.round(Q.worldScreenWidth);if(Math.round(W*T+L*U)<=V)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===W&&this._clipFBO.height===L||(this._clipFBO=new d(S,{colorTarget:0,depthStencilTarget:3,width:W,height:L}));
var Z=(this.state.padding.left-this.state.padding.right)/2,ca=(this.state.padding.bottom-this.state.padding.top)/2,ea=.5*W,fa=.5*L,ia=1/W,ja=1/L;V=.5*V*P;var Y=.5*(W*U+L*T);W=this._upperLeft;T=this._upperRight;U=this._lowerLeft;var aa=this._lowerRight;h.set(W,-V,-Y);h.set(T,V,-Y);h.set(U,-V,Y);h.set(aa,V,Y);a.identity(this._mat2);a.translate(this._mat2,this._mat2,[ea+Z,fa-ca]);0!==N&&a.rotate(this._mat2,this._mat2,X);h.transformMat2d(W,W,this._mat2);h.transformMat2d(T,T,this._mat2);h.transformMat2d(U,
U,this._mat2);h.transformMat2d(aa,aa,this._mat2);X=this._clipData;X.set([2*U[0]*ia-1,2*(L-U[1])*ja-1,2*aa[0]*ia-1,2*(L-aa[1])*ja-1,2*W[0]*ia-1,2*(L-W[1])*ja-1,2*T[0]*ia-1,2*(L-T[1])*ja-1]);this._clipRendererInitialized||this._initializeClipRenderer(S);this._clipVBO.setData(X);this._boundFBO=S.getBoundFramebufferObject();S.bindFramebuffer(this._clipFBO);S.setDepthWriteEnabled(!0);S.setStencilWriteMask(255);S.setClearColor(0,0,0,0);S.setClearDepth(1);S.setClearStencil(0);S.clear(S.gl.COLOR_BUFFER_BIT|
S.gl.DEPTH_BUFFER_BIT|S.gl.STENCIL_BUFFER_BIT);S.setDepthWriteEnabled(!1);this._clipFrame=!0}}else this._clipFrame=!1};O._afterRenderChildren=function(){const L=this.context;L.logIno();if(this._clipFrame&&this._clipRendererInitialized){L.bindFramebuffer(this._boundFBO);this._boundFBO=null;L.bindVAO(this._clipVAO);L.useProgram(this._clipStencilProgram);L.setDepthWriteEnabled(!1);L.setDepthTestEnabled(!1);L.setStencilTestEnabled(!0);L.setBlendingEnabled(!1);L.setColorMask(!1,!1,!1,!1);L.setStencilOp(7680,
7680,7681);L.setStencilWriteMask(255);L.setStencilFunction(519,1,255);L.drawElements(4,6,5123,0);L.bindVAO();L.setColorMask(!0,!0,!0,!0);if(null!=this.background){const {r:S,g:Q,b:P,a:R}=this.background.color;L.setClearColor(R*S/255,R*Q/255,R*P/255,R)}else L.setClearColor(0,0,0,0);L.clear(L.gl.COLOR_BUFFER_BIT);L.setBlendingEnabled(!0);L.setStencilFunction(514,1,255);this.painter.blitTexture(L,this._clipFBO.colorTexture,9728,1);L.setStencilTestEnabled(!1)}};O.doRender=function(L){const S=this.context,
{state:Q,pixelRatio:P}=L;this._resizeCanvas(L);this.context.enforceState();S.setViewport(0,0,P*Q.size[0],P*Q.size[1]);S.setDepthWriteEnabled(!0);S.setStencilWriteMask(255);J.prototype.doRender.call(this,L)};O.takeScreenshot=function(){var L=G._asyncToGenerator(function*(S){const {framebufferWidth:Q,framebufferHeight:P}={framebufferWidth:Math.round(this._renderParameters.state.size[0]*S.resolutionScale),framebufferHeight:Math.round(this._renderParameters.state.size[1]*S.resolutionScale)};var R=this.context,
N=this._state.clone();if(null!=S.rotation){var W=N.viewpoint;N.viewpoint.rotation=S.rotation;N.viewpoint=W}var X={...this._renderParameters,drawPhase:null,globalOpacity:1,stationary:!0,state:N,pixelRatio:1,time:Date.now(),deltaTime:0,blendMode:null,effects:null,inFadeTransition:!1};const T=new d(R,{colorTarget:0,depthStencilTarget:3,width:Q,height:P});N=R.getBoundFramebufferObject();W=R.getViewport();R.bindFramebuffer(T);R.setViewport(0,0,Q,P);this._renderChildren(S.children,X);X=this._readbackScreenshot({...S.cropArea,
y:P-(S.cropArea.y+S.cropArea.height)});R.bindFramebuffer(N);R.setViewport(W.x,W.y,W.width,W.height);this.requestRender();1===S.outputScale?R=X:(R=new ImageData(Math.round(X.width*S.outputScale),Math.round(X.height*S.outputScale)),H.resampleHermite(X,R,!0));return H.encodeResult(R,{format:S.format,quality:S.quality,rotation:0,disableDecorations:!1},document.createElement("canvas"),{flipY:!0,premultipliedAlpha:!0})});return function(S){return L.apply(this,arguments)}}();O._readbackScreenshot=function(L){const S=
this.context.gl,Q=H.createEmptyImageData(L.width,L.height,document.createElement("canvas"));S.readPixels(L.x,L.y,L.width,L.height,6408,5121,new Uint8Array(Q.data.buffer));return Q};O._resizeCanvas=function(L){const S=this._canvas,Q=S.style,{state:{size:P},pixelRatio:R}=L;L=P[0];const N=P[1],W=Math.round(L*R),X=Math.round(N*R);if(S.width!==W||S.height!==X)S.width=W,S.height=X;Q.width=L+"px";Q.height=N+"px"};O._initializeClipRenderer=function(L){if(this._clipRendererInitialized)return!0;const S=D.stencil.attributes,
Q=r.createProgram(L,D.stencil);if(!Q)return!1;const P=e.createVertex(L,35040,32);var R=new Uint16Array([0,1,2,2,1,3]);R=e.createIndex(L,35044,R);L=new z(L,S,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:P},R);this._clipStencilProgram=Q;this._clipVBO=P;this._clipVAO=L;return this._clipRendererInitialized=!0};O._emptyTrash=function(){for(;0<this._trash.size;){const L=Array.from(this._trash);this._trash.clear();for(const S of L)S.processDetach()}};
O._isLabelDrawPhaseRequired=function(L){let S=!1;for(const Q of L){if(!(Q instanceof B.Container)){S=S||!1;break}if(Q.hasLabels)return!0;S=S||this._isLabelDrawPhaseRequired(Q.children)}return S};G._createClass(M,[{key:"background",get:function(){return this._background},set:function(L){this._background=L;this.requestRender()}},{key:"highlightOptions",get:function(){return this._highlightOptions},set:function(L){this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=
null);if(this._highlightOptions=L)this._highlightOptionsHandle=k.init(this._highlightOptions,"version",()=>{this.painter.setHighlightOptions(L);this.requestRender()})}},{key:"renderingOptions",get:function(){return this._renderingOptions},set:function(L){this._renderingOptions=L;this.requestRender()}},{key:"state",get:function(){return this._state},set:function(L){this._state=L;this.requestRender()}},{key:"stationary",get:function(){return this._stationary},set:function(L){this._stationary!==L&&(this._stationary=
L,this.requestRender())}}]);return M}(B.Container);u.EXTRA_RENDER_TIME=2E3;u.Stage=g;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/CIMResourceManager":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../request","../../core/Error","../../core/promiseUtils"],function(u,G,F,C){function y(v,p){if(v.includes(";base64,")){const k=new Image;k.src=v;return k.decode().then(()=>({ok:!0,value:k})).catch(b=>C.isAbortError(b)?{ok:!1,error:b}:{ok:!1,error:new F("invalid-resource",
`Could not fetch requested resource at ${v}`)})}return G(v,{responseType:"image",...p}).then(k=>({ok:!0,value:k.data})).catch(k=>C.isAbortError(k)?{ok:!1,error:k}:{ok:!1,error:new F("invalid-resource",`Could not fetch requested resource at ${v}`)})}return function(){function v(){this._resourceMap=new Map;this._inFlightResourceMap=new Map}var p=v.prototype;p.destroy=function(){this._inFlightResourceMap.clear();this._resourceMap.clear()};p.getResource=function(k){var b;return null!=(b=this._resourceMap.get(k))?
b:null};p.fetchResource=function(){var k=u._asyncToGenerator(function*(b,a){const f={width:0,height:0},c=this._resourceMap;var h=c.get(b);if(h)return f.width=h.width,f.height=h.height,f;if(h=this._inFlightResourceMap.get(b))return h;h=y(b,a);this._inFlightResourceMap.set(b,h);return h=h.then(l=>{this._inFlightResourceMap.delete(b);l.ok&&(c.set(b,l.value),l=l.value,f.width=l.width,f.height=l.height);return f})});return function(b,a){return k.apply(this,arguments)}}();p.deleteResource=function(k){this._inFlightResourceMap.delete(k);
this._resourceMap.delete(k)};return v}()})},"esri/views/2d/engine/Container":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../chunks/mat3f32","../../../layers/effects/EffectView","./DisplayObject"],function(u,G,F,C,y){y=function(v){function p(){var b=v.apply(this,arguments)||this;b._childrenSet=new Set;b._needsSort=!1;b.children=[];b._effectView=null;return b}G._inheritsLoose(p,v);var k=p.prototype;k.updateTransitionProperties=function(b,a){v.prototype.updateTransitionProperties.call(this,
b,a);this._effectView&&(this._effectView.transitionStep(b,a),this._effectView.transitioning&&this.requestRender())};k.doRender=function(b){b=this.createRenderParams(b);this.renderChildren(b)};k.addChild=function(b){return this.addChildAt(b,this.children.length)};k.addChildAt=function(b,a=this.children.length){if(!b||this.contains(b))return b;this._needsSort=!0;const f=b.parent;f&&f!==this&&f.removeChild(b);a>=this.children.length?this.children.push(b):this.children.splice(a,0,b);this._childrenSet.add(b);
b.parent=this;b.stage=this.stage;this!==this.stage&&(b.clips=this.clips);this.requestRender();return b};k.contains=function(b){return this._childrenSet.has(b)};k.removeAllChildren=function(){this._childrenSet.clear();this._needsSort=!0;for(const b of this.children)this!==this.stage&&(b.clips=null),b.stage=null,b.parent=null;this.children.length=0};k.removeChild=function(b){return this.contains(b)?this.removeChildAt(this.children.indexOf(b)):b};k.removeChildAt=function(b){if(0>b||b>=this.children.length)return null;
this._needsSort=!0;b=this.children.splice(b,1)[0];this._childrenSet.delete(b);this!==this.stage&&(b.clips=null);b.stage=null;b.parent=null;return b};k.sortChildren=function(b){this._needsSort&&(this.children.sort(b),this._needsSort=!1)};k._createTransforms=function(){return{dvs:F.create()}};k.onAttach=function(){v.prototype.onAttach.call(this);const b=this.stage;for(const a of this.children)a.stage=b};k.onDetach=function(){v.prototype.onDetach.call(this);for(const b of this.children)b.stage=null};
k.renderChildren=function(b){for(const a of this.children)a.beforeRender(b);for(const a of this.children)a.processRender(b);for(const a of this.children)a.afterRender(b)};k.createRenderParams=function(b){return{...b,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:b.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition}};G._createClass(p,[{key:"blendMode",get:function(){return this._blendMode},set:function(b){this._blendMode=b;this.requestRender()}},{key:"clips",
get:function(){return this._clips},set:function(b){this._clips=b;this.children.forEach(a=>a.clips=b)}},{key:"computedEffects",get:function(){var b,a;return null!=(b=null==(a=this._effectView)?void 0:a.effects)?b:null}},{key:"effect",get:function(){var b,a;return null!=(b=null==(a=this._effectView)?void 0:a.effect)?b:""},set:function(b){if(this._effectView||b)this._effectView||(this._effectView=new C.default),this._effectView.effect=b,this.requestRender()}}]);return p}(y.DisplayObject);u.Container=
y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),function(u,G,F,C,y,v,p,k,b,a,f,c){function h(e){e=f.parse(e)||[];var d=(d=e[0])?"type"in d:!1;return d?
[{scale:-1,effects:e}]:e}function l(e,d,g){var m,n,r,t;return null!=(m=e[0])&&m.effects&&null!=(n=d[0])&&n.effects?(-1===(null==(r=e[0])?void 0:r.scale)||-1===(null==(t=d[0])?void 0:t.scale))&&(1<e.length||1<d.length)&&0>=g?!1:c.canInterpolateEffects(e[0].effects,d[0].effects):!0}function q(e,d,g){var m,n;const r=e.length>d.length?e:d;e=e.length>d.length?d:e;const t=e[e.length-1];d=null!=(m=null==t?void 0:t.scale)?m:g;m=null!=(n=null==t?void 0:t.effects)?n:[];for(n=e.length;n<r.length;n++)e.push({scale:d,
effects:[...m]});for(n=0;n<r.length;n++)e[n].scale=-1===e[n].scale?g:e[n].scale,r[n].scale=-1===r[n].scale?g:r[n].scale,c.normalizeEffects(e[n].effects,r[n].effects)}C=function(e){function d(m){m=e.call(this,m)||this;m._from=null;m._to=null;m._final=null;m._current=[];m._time=0;m.duration=y("mapview-transitions-duration");m.effects=[];return m}G._inheritsLoose(d,e);var g=d.prototype;g.canTransitionTo=function(m){try{return 0<this.scale&&l(this._current,h(m),this.scale)}catch{return!1}};g.transitionStep=
function(m,n){this._applyTimeTransition(m);this._updateForScale(n)};g.end=function(){this._applyTimeTransition(this.duration)};g._transitionTo=function(m){0<this.scale&&l(this._current,m,this.scale)?(this._final=m,this._to=v.clone(m),q(this._current,this._to,this.scale),this._from=v.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=m);this._set("effects",this._current[0]?v.clone(this._current[0].effects):[])};g._applyTimeTransition=function(m){if(this._to&&this._from&&
this._current&&this._final){this._time+=m;m=Math.min(1,this._time/this.duration);for(let r=0;r<this._current.length;r++){const t=this._current[r],z=this._from[r],w=this._to[r];var n=z.scale;t.scale=n+(w.scale-n)*m;for(n=0;n<t.effects.length;n++)t.effects[n].interpolate(z.effects[n],w.effects[n],m)}1===m&&(this._current=this._final,this._set("effects",this._current[0]?v.clone(this._current[0].effects):[]),this._from=this._to=this._final=null)}};g._updateForScale=function(m){this._set("scale",m);if(0!==
this._current.length){var n=this._current,r=this._current.length-1,t,z=1;if(1===n.length||m>=n[0].scale)var w=t=n[0].effects;else if(m<=n[r].scale)w=t=n[r].effects;else for(let B=0;B<r;B++){const A=n[B],x=n[B+1];if(A.scale>=m&&x.scale<=m){z=(m-A.scale)/(x.scale-A.scale);t=A.effects;w=x.effects;break}}for(m=0;m<this.effects.length;m++)this.effects[m].interpolate(t[m],w[m],z)}};G._createClass(d,[{key:"effect",set:function(m){const n=this._get("effect");m=m||"";if(n!==m){this._set("effect",m);try{this._transitionTo(h(m))}catch(r){this._transitionTo([]),
p.getLogger(this.declaredClass).warn("Invalid Effect",{effect:m,error:r})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(m){this._updateForScale(m)}},{key:"transitioning",get:function(){return null!==this._to}}]);return d}(C);F.__decorate([k.property()],C.prototype,"_to",void 0);F.__decorate([k.property()],C.prototype,"duration",void 0);F.__decorate([k.property({value:""})],C.prototype,"effect",null);F.__decorate([k.property({readOnly:!0})],
C.prototype,"effects",void 0);F.__decorate([k.property({readOnly:!0})],C.prototype,"hasEffects",null);F.__decorate([k.property({value:0})],C.prototype,"scale",null);F.__decorate([k.property({readOnly:!0})],C.prototype,"transitioning",null);C=F.__decorate([a.subclass("esri.layers.effects.EffectView")],C);u.canInterpolateEffectStops=l;u.convertEffectToStops=h;u.default=C;u.normalizeEffectStops=q;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/DisplayObject":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Evented ../../../core/has ../../../core/maybe ../../../core/promiseUtils".split(" "),
function(u,G,F,C,y,v){const p=1/C("mapview-transitions-duration");F=function(k){function b(){var f=k.apply(this,arguments)||this;f._fadeOutResolver=null;f._fadeInResolver=null;f._clips=null;f.computedVisible=!0;f.computedOpacity=1;f.fadeTransitionEnabled=!1;f.inFadeTransition=!1;f._isReady=!1;f._opacity=1;f._stage=null;f._visible=!0;return f}G._inheritsLoose(b,k);var a=b.prototype;a._getTransforms=function(){y.isNone(this._transforms)&&(this._transforms=this._createTransforms());return this._transforms};
a.fadeIn=function(){if(this._fadeInResolver)return this._fadeInResolver.promise;this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null);this.computedOpacity=0;this.fadeTransitionEnabled=!0;this._fadeInResolver=v.createResolver();this.requestRender();return this._fadeInResolver.promise};a.fadeOut=function(){if(this._fadeOutResolver)return this._fadeOutResolver.promise;this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this.fadeTransitionEnabled=!0;this._fadeOutResolver=
v.createResolver();this.requestRender();return this._fadeOutResolver.promise};a.beforeRender=function(f){this.updateTransitionProperties(f.deltaTime,f.state.scale)};a.afterRender=function(f){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)};a.remove=function(){var f;null==(f=this.parent)?void 0:f.removeChild(this)};a.setTransform=function(f){};
a.processRender=function(f){this.stage&&this.computedVisible&&this.doRender(f)};a.requestRender=function(){this.stage&&this.stage.requestRender()};a.processDetach=function(){this.onDetach();this.emit("detach")};a.updateTransitionProperties=function(f,c){if(this.fadeTransitionEnabled){c=this._fadeOutResolver||!this.visible?0:this.opacity;const h=this.computedOpacity;h===c?this.computedVisible=this.visible:(f*=p,this.computedOpacity=h>c?Math.max(c,h-f):Math.min(c,h+f),this.computedVisible=0<this.computedOpacity,
f=c===this.computedOpacity,this.inFadeTransition=!f,f||this.requestRender())}else this.computedOpacity=this.opacity,this.computedVisible=this.visible};a.onAttach=function(){};a.onDetach=function(){};a.doRender=function(f){};a.ready=function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())};G._createClass(b,[{key:"clips",get:function(){return this._clips},set:function(f){this._clips=f;this.requestRender()}},{key:"isReady",get:function(){return this._isReady}},{key:"opacity",
get:function(){return this._opacity},set:function(f){this._opacity!==f&&(this._opacity=Math.min(1,Math.max(f,0)),this.requestRender())}},{key:"stage",get:function(){return this._stage},set:function(f){if(this._stage!==f){var c=this._stage;(this._stage=f)?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):c.trashDisplayObject(this)}}},{key:"transforms",get:function(){return this._getTransforms()}},{key:"visible",get:function(){return this._visible},set:function(f){this._visible!==
f&&(this._visible=f,this.requestRender())}}]);return b}(F);u.DisplayObject=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(u){u.WGLGeometryType=void 0;(function(G){G[G.FILL=0]="FILL";G[G.LINE=1]="LINE";G[G.MARKER=2]="MARKER";G[G.TEXT=3]="TEXT";G[G.LABEL=4]="LABEL"})(u.WGLGeometryType||(u.WGLGeometryType={}));u.WGLGeometryTransactionStatus=void 0;(function(G){G[G.SUCCEEDED=0]="SUCCEEDED";G[G.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(u.WGLGeometryTransactionStatus||
(u.WGLGeometryTransactionStatus={}));u.WGLDrawPhase=void 0;(function(G){G[G.NONE=0]="NONE";G[G.MAP=1]="MAP";G[G.LABEL=2]="LABEL";G[G.LABEL_ALPHA=4]="LABEL_ALPHA";G[G.HITTEST=8]="HITTEST";G[G.HIGHLIGHT=16]="HIGHLIGHT";G[G.CLIP=32]="CLIP";G[G.DEBUG=64]="DEBUG";G[G.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(u.WGLDrawPhase||(u.WGLDrawPhase={}));u.VVType=void 0;(function(G){G[G.SIZE=0]="SIZE";G[G.COLOR=1]="COLOR";G[G.OPACITY=2]="OPACITY";G[G.ROTATION=3]="ROTATION"})(u.VVType||(u.VVType={}));u.WGLVVFlag=void 0;
(function(G){G[G.NONE=0]="NONE";G[G.OPACITY=1]="OPACITY";G[G.COLOR=2]="COLOR";G[G.ROTATION=4]="ROTATION";G[G.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";G[G.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";G[G.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";G[G.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(u.WGLVVFlag||(u.WGLVVFlag={}));u.WGLVVTarget=void 0;(function(G){G[G.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";G[G.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";G[G.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";
G[G.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(u.WGLVVTarget||(u.WGLVVTarget={}));u.MosaicType=void 0;(function(G){G[G.SPRITE=0]="SPRITE";G[G.GLYPH=1]="GLYPH"})(u.MosaicType||(u.MosaicType={}));Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/Painter":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/Renderbuffer ../../../webgl/Texture ../../../webgl/VertexArrayObject ../brushes ../vectorTiles/shaders/VTLMaterialManager ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/BlendEffect ./effects/FeatureEffect ./effects/HighlightEffect ./effects/HittestEffect ./effects/post-processing/EffectManager ./painter/RenderPass".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e,d,g,m,n,r,t,z,w){function B(x,E,D,K){return x!==q.WGLDrawPhase.HIGHLIGHT&&(1!==K||G.isSome(E)&&"normal"!==E||G.isSome(D)&&0<D.length)}const A={[q.WGLGeometryType.FILL]:c.brushes.fill,[q.WGLGeometryType.LINE]:c.brushes.line,[q.WGLGeometryType.MARKER]:c.brushes.marker,[q.WGLGeometryType.TEXT]:c.brushes.text};return function(){function x(D,K,H){this.context=D;this._blitRenderer=new l.BitBlitRenderer;this._brushCache=new Map;this._vtlMaterialManager=new h;this._blendEffect=
new m.BlendEffect;this.effects={highlight:new r,hittest:new t.HittestEffect,integrate:new g.AnimationEffect,insideEffect:new n.FeatureEffect("inside"),outsideEffect:new n.FeatureEffect("outside")};this.materialManager=new e(D);this.textureManager=new d(K,H);this._effectsManager=new z.EffectManager(K)}var E=x.prototype;E.getRenderTarget=function(){return this._renderTarget};E.setRenderTarget=function(D){this._renderTarget=D};E.getFbos=function(D,K){if(D!==this._lastWidth||K!==this._lastHeight){this._lastWidth=
D;this._lastHeight=K;if(this._fbos){for(var H in this._fbos)this._fbos[H].resize(D,K);return this._fbos}H={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:D,height:K};const I={colorTarget:0,depthStencilTarget:3};this._stencilBuf=D=new b(this.context,{width:D,height:K,internalFormat:34041});this._fbos={output:new C(this.context,I,H,D),blend:new C(this.context,I,H,D),effect0:new C(this.context,I,H,D)}}return this._fbos};E.getSharedStencilBuffer=function(){return this._stencilBuf};
E.beforeRenderLayers=function(D,K=null){const {width:H,height:I}=D.getViewport();this._prevFBO=D.getBoundFramebufferObject();const J=this.getFbos(H,I);D.bindFramebuffer(J.output);D.setColorMask(!0,!0,!0,!0);D.setDepthWriteEnabled(!0);if(G.isSome(K)){const {r:M,g:O,b:L,a:S}=K.color;D.setClearColor(S*M/255,S*O/255,S*L/255,S)}else D.setClearColor(0,0,0,0);D.setClearDepth(1);D.clear(D.gl.COLOR_BUFFER_BIT|D.gl.DEPTH_BUFFER_BIT);D.setDepthWriteEnabled(!1)};E.beforeRenderLayer=function(D,K,H){const {context:I,
blendMode:J,effects:M,requireFBO:O,drawPhase:L}=D;O||B(L,J,M,H)?(I.bindFramebuffer(this._fbos.blend),I.setColorMask(!0,!0,!0,!0),I.setClearColor(0,0,0,0),I.setDepthWriteEnabled(!0),I.setClearDepth(1),I.clear(I.gl.COLOR_BUFFER_BIT|I.gl.DEPTH_BUFFER_BIT),I.setDepthWriteEnabled(!1)):(D=this._getOutputFBO(),I.bindFramebuffer(D));I.setDepthWriteEnabled(!1);I.setDepthTestEnabled(!1);I.setStencilTestEnabled(!0);I.setClearStencil(K);I.setStencilWriteMask(255);I.clear(I.gl.STENCIL_BUFFER_BIT)};E.compositeLayer=
function(D,K){const {context:H,blendMode:I,effects:J,requireFBO:M,drawPhase:O}=D;if(M||B(O,I,J,K)){G.isSome(J)&&0<J.length&&O===q.WGLDrawPhase.MAP&&this._applyEffects(D,J);var L=this._getOutputFBO();H.bindFramebuffer(L);H.setStencilTestEnabled(!1);H.setStencilWriteMask(0);H.setBlendingEnabled(!0);H.setBlendFunctionSeparate(1,771,1,771);H.setColorMask(!0,!0,!0,!0);L=G.isNone(I)||O===q.WGLDrawPhase.HIGHLIGHT?"normal":I;this._blendEffect.draw(D,this._fbos.blend.colorTexture,9728,L,K)}};E.renderLayers=
function(D){D.bindFramebuffer(this._prevFBO);if(this._fbos){var K=this._getOutputFBO();D.setStencilTestEnabled(!1);D.setStencilWriteMask(0);this.blitTexture(D,K.colorTexture,9728)}};E.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._brushCache&&(this._brushCache.forEach(D=>D.dispose()),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(const D in this._fbos)this._fbos[D]&&
this._fbos[D].dispose();if(this.effects)for(const D in this.effects)this.effects[D]&&this.effects[D].dispose();this._effectsManager.dispose();this._vtlMaterialManager&&(this._vtlMaterialManager.dispose(),this._vtlMaterialManager=null);this._prevFBO=null};E.getGeometryBrush=function(D){D=A[D];let K=this._brushCache.get(D);void 0===K&&(K=new D,this._brushCache.set(D,K));return this._brushCache.get(D)};E.renderObject=function(D,K,H,I){H=c.brushes[H];if(!H)return null;let J=this._brushCache.get(H);void 0===
J&&(J=new H,this._brushCache.set(H,J));J.prepareState(D,K,I);J.draw(D,K,I)};E.renderObjects=function(D,K,H,I){H=c.brushes[H];if(!H)return null;let J=this._brushCache.get(H);void 0===J&&(J=new H,this._brushCache.set(H,J));J.drawMany(D,K,I)};E.registerRenderPass=function(D){const K=D.brushes.map(H=>{this._brushCache.has(H)||this._brushCache.set(H,new H);return this._brushCache.get(H)});return new w(K,D)};E.setHighlightOptions=function(D){this.effects.highlight.setHighlightOptions(D)};E.blitTexture=
function(D,K,H,I=1){D.setBlendingEnabled(!0);D.setBlendFunctionSeparate(1,771,1,771);D.setColorMask(!0,!0,!0,!0);this._blitRenderer.render(D,K,H,I)};E.getPostProcessingEffects=function(D){return this._effectsManager.getPostProcessingEffects(D)};E._getOutputFBO=function(){return null!=this._renderTarget?this._renderTarget:this._fbos.output};E._applyEffects=function(D,K){const {context:H}=D;K=this._effectsManager.getPostProcessingEffects(K);for(const {postProcessingEffect:I,effect:J}of K)H.bindFramebuffer(this._fbos.blend),
I.draw(D,this._fbos.blend,J)};u._createClass(x,[{key:"vectorTilesMaterialManager",get:function(){return this._vtlMaterialManager}}]);return x}()})},"esri/views/2d/engine/brushes":function(){define("exports ./flow/BrushFlow ./webgl/brushes/BrushBitmap ./webgl/brushes/BrushClip ./webgl/brushes/WGLBrushInfo ./webgl/brushes/WGLBrushStencil ./webgl/brushes/WGLBrushVTLBackground ./webgl/brushes/WGLBrushVTLCircle ./webgl/brushes/WGLBrushVTLFill ./webgl/brushes/WGLBrushVTLLine ./webgl/brushes/WGLBrushVTLSymbol ./webgl/brushes/WGLGeometryBrushFill ./webgl/brushes/WGLGeometryBrushLabel ./webgl/brushes/WGLGeometryBrushLine ./webgl/brushes/WGLGeometryBrushMarker ./webgl/brushes/WGLGeometryBrushText ./webgl/brushes/raster/BrushRasterBitmap ./webgl/brushes/raster/BrushVectorField".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e,d,g){const m={vtlBackground:p.WGLBrushVTLBackground,vtlFill:b.WGLBrushVTLFill,vtlLine:a.WGLBrushVTLLine,vtlCircle:k.WGLBrushVTLCircle,vtlSymbol:f.WGLBrushVTLSymbol};u.brushes={marker:q,line:l,fill:c,text:e,label:h,clip:C,stencil:v,bitmap:F,raster:d,rasterVF:g,flow:G,tileInfo:y,vtlBackground:p.WGLBrushVTLBackground,vtlFill:b.WGLBrushVTLFill,vtlLine:a.WGLBrushVTLLine,vtlCircle:k.WGLBrushVTLCircle,vtlSymbol:f.WGLBrushVTLSymbol};u.vtlBrushes=m;Object.defineProperty(u,
"__esModule",{value:!0})})},"esri/views/2d/engine/flow/BrushFlow":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../webgl/brushes/WGLBrush"],function(u,G,F){F=function(v){function p(){return v.apply(this,arguments)||this}u._inheritsLoose(p,v);var k=p.prototype;k.dispose=function(){};k.prepareState=function(b){({context:b}=b);b.setColorMask(!0,!0,!0,!0);b.setStencilFunction(514,0,255)};k.draw=function(b,a){const {context:f}=b,{displayData:c}=a;if(!G.isNone(c)&&
("loaded"===c.state.name&&c.prepareForRendering(f,C,y),"attached"===c.state.name)){var h=c.state.resources,l=b.painter.materialManager.getProgram(b,{vsPath:"raster/flow",fsPath:"raster/flow",attributes:C});f.setFaceCullingEnabled(!1);f.setBlendingEnabled(!0);f.setBlendFunctionSeparate(1,771,1,1);f.useProgram(l);l.setUniform1f("u_time",b.time/1E3);l.setUniform1f("u_fadeDuration",c.flowStyle.renderSettings.fadeDuration);l.setUniform1f("u_lineSpeed",c.flowStyle.renderSettings.lineSpeed);l.setUniformMatrix3fv("u_dvsMat3",
a.transforms.dvs);l.setUniformMatrix3fv("u_displayViewMat3",b.state.displayViewMat3);l.setUniform4f("u_lineColor",c.flowStyle.renderSettings.lineColor[0]*b.globalOpacity,c.flowStyle.renderSettings.lineColor[1]*b.globalOpacity,c.flowStyle.renderSettings.lineColor[2]*b.globalOpacity,c.flowStyle.renderSettings.lineColor[3]*b.globalOpacity);l.setUniform1f("u_lineHalfWidth",c.flowStyle.renderSettings.lineRenderWidth/2);f.bindVAO(h.vertexArray);f.drawElements(4,h.indexBuffer.size,5125,0);c.flowStyle.animated&&
a.requestRender()}};return p}(F);const C=new Map;C.set("a_positionAndSide",0);C.set("a_timeInfo",1);C.set("a_extrude",2);const y={geometry:[{name:"a_positionAndSide",count:3,type:5126,offset:0,stride:32,normalized:!1},{name:"a_timeInfo",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:"a_extrude",count:2,type:5126,offset:24,stride:32,normalized:!1}]};return F})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(function(){return function(){function u(){this.name=this.constructor.name||
"UnnamedBrush"}var G=u.prototype;G.prepareState=function(F,C,y){};G.draw=function(F,C,y){};G.drawMany=function(F,C,y){for(const v of C)this.draw(F,v,y)};return u}()})},"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../definitions","../VertexStream","./WGLBrush"],function(u,G,F,C){const y={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],samplingMode:9729,
mips:!1},trilinear:{defines:[],samplingMode:9987,mips:!0}};return function(v){function p(){var b=v.apply(this,arguments)||this;b._desc={vsPath:"raster/bitmap",fsPath:"raster/bitmap",attributes:new Map([["a_position",0],["a_texcoord",1]])};return b}u._inheritsLoose(p,v);var k=p.prototype;k.dispose=function(){this._quad&&this._quad.dispose()};k.prepareState=function({context:b},a){b.setBlendingEnabled(!0);"additive"===a.blendFunction?b.setBlendFunctionSeparate(1,1,1,1):b.setBlendFunctionSeparate(1,
771,1,771);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0);b.setStencilFunction(514,a.stencilRef,255)};k.draw=function(b,a){const {context:f,renderingOptions:c,painter:h}=b;if(a.source){b.timeline.begin(this.name);this._quad||(this._quad=new F(f,[0,0,1,0,0,1,1,1]));if("dynamic"===c.samplingMode){({state:e}=b);var l=a.resolution/a.pixelRatio/e.resolution,q=Math.round(b.pixelRatio)!==b.pixelRatio;l=1.05<l||.95>l;var e=e.rotation||l||q||a.isSourceScaled||a.rotation?y.bilinear:
y.nearest}else e=y[c.samplingMode];q=h.materialManager.getProgram(b,this._desc,e.defines);var {coordScale:d,computedOpacity:g,transforms:m}=a;a.setSamplingProfile(e);a.bind(b.context,G.TEXTURE_BINDING_BITMAP);f.useProgram(q);q.setUniformMatrix3fv("u_dvsMat3",m.dvs);q.setUniform1i("u_texture",G.TEXTURE_BINDING_BITMAP);q.setUniform2fv("u_coordScale",d);q.setUniform1f("u_opacity",g);this._quad.draw();b.timeline.end(this.name)}};return p}(C)})},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],
function(u){u.ANGLE_FACTOR_256=256/360;u.ATTRIBUTE_DATA_ANIMATION=1;u.ATTRIBUTE_DATA_DD0=3;u.ATTRIBUTE_DATA_DD1=3;u.ATTRIBUTE_DATA_FILTER_FLAGS=0;u.ATTRIBUTE_DATA_VV=2;u.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;u.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};u.BITSET_GENERIC_LOCK_COLOR=2;u.BITSET_LINE_SCALE_DASH=4;u.BITSET_MARKER_ALIGNMENT_MAP=1;u.BITSET_MARKER_ALIGNMENT_SCREEN=0;u.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE=4;u.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY=
8;u.BITSET_TYPE_FILL_OUTLINE=1;u.BUFFER_DATA_MINIMUM_SIZE=128;u.BUFFER_DATA_POOL_SIZE=4;u.COLLISION_BOX_PADDING=16;u.COLLISION_BUCKET_SIZE=128;u.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;u.COLLISION_MAX_ZOOM_DELTA=1;u.COLLISION_PLACEMENT_PADDING=8;u.COLLISION_TILE_BOX_SIZE=4;u.DEBUG_LABELS=!1;u.DISPLAY_RECORD_INT_PER_ELEMENT=8;u.DOT_DENSITY_MAX_FIELDS=8;u.EFFECT_FLAG_0=4;u.ENABLE_EARLY_LABEL_DISCARD=!1;u.EXTRUDE_SCALE=64;u.FILTER_FLAG_0=2;u.GLYPH_SIZE=24;u.HEURISTIC_GLYPHS_PER_FEATURE=10;u.HEURISTIC_GLYPHS_PER_LINE=
50;u.HIGHLIGHT_FLAG=1;u.HITTEST_SEARCH_SIZE=6;u.MAGIC_LABEL_LINE_HEIGHT=29;u.MAX_FILTERS=2;u.MAX_GPU_UPLOADS_PER_FRAME=2;u.MIN_MAX_ZOOM_PRECISION_FACTOR=10;u.NAN_MAGIC_NUMBER=1E-30;u.PATCH_PIXEL_BUFFER_ALLOC_SIZE=500;u.PICTURE_FILL_COLOR=4294967295;u.RASTER_TILE_SIZE=256;u.SPRITE_PADDING=2;u.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;u.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;u.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;u.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;u.TEXTURE_BINDING_BITMAP=0;u.TEXTURE_BINDING_GLYPH_ATLAS=0;u.TEXTURE_BINDING_HIGHLIGHT_0=
5;u.TEXTURE_BINDING_HIGHLIGHT_1=6;u.TEXTURE_BINDING_RENDERER_0=5;u.TEXTURE_BINDING_RENDERER_1=6;u.TEXTURE_BINDING_SPRITE_ATLAS=0;u.TEXT_PLACEMENT_PADDING=8;u.THIN_LINE_HALF_WIDTH_THRESHOLD=1.05;u.TILE_SIZE=512;u.VTL_HIGH_RES_CUTOFF=1.15;u.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;u.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;u.WEBGL_MAX_INNER_STOPS=6;u.WEBGL_MAX_STOPS=8;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["../../../webgl/BufferObject","../../../webgl/VertexArrayObject"],
function(u,G){return function(){function F(y,v){this.rctx=y;this._vertexBuffer=u.createVertex(y,35044,new Uint16Array(v));this._vao=new G(y,new Map([["a_position",0]]),{geometry:[{name:"a_position",count:2,type:5122,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer});this._count=v.length/2}var C=F.prototype;C.bind=function(){this._vao.bind()};C.unbind=function(){this._vao.unbind()};C.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};C.draw=function(){this.rctx.bindVAO(this._vao);
this.rctx.drawArrays(5,0,this._count)};return F}()})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/programUtils".split(" "),function(u,G,F,C,y,v,p){return function(k){function b(){var f=k.apply(this,arguments)||this;f._color=F.fromValues(0,1,0,1);return f}u._inheritsLoose(b,k);var a=b.prototype;a.dispose=function(){this._program&&
this._program.dispose()};a.prepareState=function({context:f}){f.setStencilTestEnabled(!0);f.setBlendingEnabled(!1);f.setFaceCullingEnabled(!1);f.setColorMask(!1,!1,!1,!1);f.setStencilOp(7680,7680,7681);f.setStencilWriteMask(255);f.setStencilFunction(519,0,255)};a.draw=function(f,c){const {context:h,state:l}=f;f=C.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:5122}]});c=c.getVAO(h,l,f.attributes,f.bufferLayouts);G.isNone(c.indexBuffer)||(this._program||(this._program=
p.createProgram(h,v.background)),h.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),this._program.setUniformMatrix3fv("u_dvsMat3",l.displayMat3),h.bindVAO(c),h.drawElements(4,c.indexBuffer.size,5125,0),h.bindVAO())};return b}(y)})},"esri/chunks/vec4f32":function(){define(["exports"],function(u){function G(){return new Float32Array(4)}function F(m){const n=new Float32Array(4);n[0]=m[0];n[1]=m[1];n[2]=m[2];n[3]=m[3];return n}
function C(m,n,r,t){const z=new Float32Array(4);z[0]=m;z[1]=n;z[2]=r;z[3]=t;return z}function y(m,n){return new Float32Array(m,n,4)}function v(){return G()}function p(){return C(1,1,1,1)}function k(){return C(1,0,0,0)}function b(){return C(0,1,0,0)}function a(){return C(0,0,1,0)}function f(){return C(0,0,0,1)}const c=G(),h=p(),l=k(),q=b(),e=a(),d=f(),g=Object.freeze({__proto__:null,create:G,clone:F,fromValues:C,createView:y,zeros:v,ones:p,unitX:k,unitY:b,unitZ:a,unitW:f,ZEROS:c,ONES:h,UNIT_X:l,UNIT_Y:q,
UNIT_Z:e,UNIT_W:d});u.ONES=h;u.UNIT_W=d;u.UNIT_X=l;u.UNIT_Y=q;u.UNIT_Z=e;u.ZEROS=c;u.clone=F;u.create=G;u.createView=y;u.fromValues=C;u.ones=p;u.unitW=f;u.unitX=k;u.unitY=b;u.unitZ=a;u.vec4f32=g;u.zeros=v})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ./color ./enums ./SymbolProperties ../../../webgl/Texture".split(" "),function(u,G,F,C,y,v,p,k,b){function a(L){const S={};for(const Q of L)S[Q.name]=
Q.strideInBytes;return S}function f(L){switch(L){case p.WGLGeometryType.MARKER:return D;case p.WGLGeometryType.FILL:return K;case p.WGLGeometryType.LINE:return H;case p.WGLGeometryType.TEXT:return I;case p.WGLGeometryType.LABEL:return J}}function c(L){switch(L%4){case 0:case 2:return 4;case 1:case 3:return 1}}function h(L){switch(L){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}function l(L){const S={};for(const Q in L){let P=0;S[Q]=L[Q].map(R=>
{const N={...R,normalized:R.normalized||!1,divisor:R.divisor||0,offset:P,stride:0};P+=R.count*h(R.type);return N});S[Q].forEach(R=>R.stride=P)}return S}const q=F.getLogger("esri.views.2d.engine.webgl.Utils");F=[{name:"geometry",strideInBytes:36,divisor:0}];const e=[{name:"geometry",strideInBytes:32,divisor:0}],d=[{name:"geometry",strideInBytes:20,divisor:0}],g=[{name:"geometry",strideInBytes:12,divisor:0}],m=[{name:"geometry",strideInBytes:40,divisor:0}],n=[{name:"geometry",strideInBytes:36,divisor:0}],
r=[{name:"geometry",strideInBytes:36,divisor:0}],t=a(F),z=a(e),w=a(d),B=a(g),A=a(m),x=a(n),E=a(r),D=["geometry"],K=["geometry"],H=["geometry"],I=["geometry"],J=["geometry"],M=new Map,O=L=>{if(!L)return!1;L=L.trim();return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(L)&&/[\dz]$/i.test(L)&&4<L.length?!0:!1};u.C_FILL_STRIDE_SPEC=z;u.C_FILL_STRIDE_SPEC_DD=B;u.C_FILL_STRIDE_SPEC_SIMPLE=w;u.C_FILL_VERTEX_DEF=e;u.C_FILL_VERTEX_DEF_DD=g;u.C_FILL_VERTEX_DEF_SIMPLE=d;u.C_ICON_STRIDE_SPEC=t;u.C_ICON_VERTEX_DEF=
F;u.C_LABEL_STRIDE_SPEC=E;u.C_LABEL_VERTEX_DEF=r;u.C_LINE_STRIDE_SPEC=A;u.C_LINE_VERTEX_DEF=m;u.C_TEXT_STRIDE_SPEC=x;u.C_TEXT_VERTEX_DEF=n;u.C_VBO_GEOMETRY="geometry";u.C_VBO_INFO={["geometry"]:35044};u.C_VBO_PERINSTANCE="per_instance";u.C_VBO_PERINSTANCE_VV="per_instance_vv";u.allocateTypedArrayBuffer=function(L,S){switch(S%4){case 0:case 2:return new Uint32Array(Math.floor(L*S/4));case 1:case 3:return new Uint8Array(L*S)}};u.allocateTypedArrayBufferwithData=function(L,S){switch(S%4){case 0:case 2:return new Uint32Array(L);
case 1:case 3:return new Uint8Array(L)}};u.charCodes=function(L){const S=[];for(let Q=0;Q<L.length;Q++)S.push(L.charCodeAt(Q));return S};u.copyMeshData=function(L,S,Q,P,R,N,W){for(const U in N){var X=N[U].stride,T=c(X);const V=N[U].data,Z=Q[U].data,ca=X*R.vertexCount/T,ea=X*L/T;X=X*R.vertexFrom/T;for(T=0;T<ca;++T)Z[T+ea]=V[T+X]}Q=R.indexCount;for(N=0;N<Q;++N)P[N+S]=W[N+R.indexFrom]-R.vertexFrom+L};u.createGeometryData=function(L,S){const Q=[];for(let P=0;5>P;++P){const R=f(P),N={};for(const W of R)N[W]=
{data:S(P,W)};Q.push({data:L(P),buffers:N})}return Q};u.createProgramDescriptor=(L,S)=>{if(!M.has(L)){const R=l(S);var Q=R;var P={};for(const N in Q){const W=Q[N];P[N]=W.length?W[0].stride:0}Q=P;P=new Map;for(const N in S)for(const W of S[N])P.set(W.name,W.location);S=P;M.set(L,{strides:Q,bufferLayouts:R,attributes:S})}return M.get(L)};u.createTextureFromTexelData=function(L,S){let Q,P;C.isPowerOfTwo(S.width)&&C.isPowerOfTwo(S.height)?(Q=!0,P=9987):(Q=!1,P=9729);return new b(L,{target:3553,pixelFormat:6408,
internalFormat:6408,dataType:5121,hasMipmap:Q,samplingMode:P,wrapMode:33071,flipped:!0},S)};u.forEachGeometryType=function(L){L(p.WGLGeometryType.FILL);L(p.WGLGeometryType.LINE);L(p.WGLGeometryType.MARKER);L(p.WGLGeometryType.TEXT);L(p.WGLGeometryType.LABEL)};u.geometryToMappedGeometry=function(L){return{vertexFrom:void 0,vertexTo:void 0,geometry:L}};u.getBytes=h;u.getCapType=function(L){switch(L){case "butt":return 0;case "round":return 1;case "square":return 2;default:return q.error(new G("mapview-invalid-type",
`Cap type ${L} is not a valid option. Defaulting to round`)),1}};u.getJoinType=function(L){switch(L){case "miter":return 2;case "bevel":return 0;case "round":return 1;default:return q.error(new G("mapview-invalid-type",`Join type ${L} is not a valid option. Defaulting to round`)),1}};u.getNamedBuffers=f;u.getPMSResourceSize=function(L){const S="maxVVSize"in L&&L.maxVVSize;L="width"in L&&L.width||"size"in L&&L.size||0;return S?S:L};u.getPixelArrayCtor=function(L){switch(L){case 5121:return Uint8Array;
case 32819:return Uint16Array;case 5126:return Float32Array;default:q.error(new G("webgl-utils",`Unable to handle type ${L}`))}};u.getPixelBytes=function(L){switch(L){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:q.error(new G("webgl-utils",`Unable to handle type ${L}`))}};u.getStrides=function(L,{fill:S}){switch(L){case p.WGLGeometryType.MARKER:return t;case p.WGLGeometryType.FILL:return"dot-density"===S?B:"simple"===S?w:z;case p.WGLGeometryType.LINE:return A;case p.WGLGeometryType.TEXT:return x;
case p.WGLGeometryType.LABEL:return E}};u.getTextProperties=function(L){return k.TextProperties.pool.acquire(L.color?v.copyAndPremultiply(L.color):[255,255,255,255],L.haloColor?v.copyAndPremultiply(L.haloColor):[255,255,255,255],y.pt2px(L.haloSize),y.pt2px(L.font.size),L.angle*Math.PI/180,L.xoffset/L.font.size,L.yoffset/L.font.size,"left"===L.horizontalAlignment?0:"right"===L.horizontalAlignment?1:.5,"top"===L.verticalAlignment?0:"bottom"===L.verticalAlignment?1:.5)};u.getTransformParams=function(L){const {transform:S,
hasZ:Q,hasM:P}=L;return{transform:S,hasZ:Q,hasM:P}};u.getUrl=L=>"imageData"in L&&L.imageData&&"contentType"in L&&L.contentType?`data:${L.contentType};base64,${L.imageData}`:"url"in L?L.url:null;u.getVVType=function(L){switch(L){case "opacity":return p.VVType.OPACITY;case "color":return p.VVType.COLOR;case "rotation":return p.VVType.ROTATION;case "size":return p.VVType.SIZE;default:return q.error(`Cannot interpret unknown vv: ${L}`),null}};u.is3D=L=>L.type&&-1!==L.type.toLowerCase().indexOf("3d");
u.isDefined=function(L){return null!=L};u.isGIF=L=>"url"in L&&L.url&&L.url.includes(".gif")||"contentType"in L&&"image/gif"===L.contentType||"imageData"in L&&L.imageData.includes("data:image/gif");u.isImageResource=L=>"url"in L&&L.url||"imageData"in L&&L.imageData;u.isNumber=function(L){return"number"===typeof L};u.isPNG=L=>"url"in L&&L.url&&L.url.includes(".png")||"contentType"in L&&"image/png"===L.contentType||"imageData"in L&&L.imageData.includes("data:image/png");u.isSVGImage=L=>L.includes("data:image/svg+xml");
u.isSVGResource=L=>"path"in L&&O(L.path);u.isSimple=function(L){switch(L.type){case "line":return"CIMSolidStroke"===L.cim.type&&!L.dashTemplate;case "fill":return"CIMSolidFill"===L.cim.type;case "esriSFS":return"esriSFSSolid"===L.style||"esriSFSNull"===L.style;case "esriSLS":return"esriSLSSolid"===L.style||"esriSLSNull"===L.style;default:return!1}};u.isValidSVG=O;u.shouldRepeat=function(L){switch("cim"in L?L.cim.type:L.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!1;
default:return!0}};u.strideToPackingFactor=c;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/color":function(){define(["exports","./number"],function(u,G){function F(v,p){Array.isArray(p)?(v[0]=p[0],v[1]=p[1],v[2]=p[2],v[3]=p[3]):(v[0]=p.r,v[1]=p.g,v[2]=p.b,v[3]=p.a);return v}function C(v,p=0,k=!1){const b=v[p+3];v[p+0]*=b;v[p+1]*=b;v[p+2]*=b;k||(v[p+3]*=255);return v}const y=[0,0,0,0];u.copyAndPremultiply=function(v){return C(F([],v))};u.premultiplyAlpha=C;u.premultiplyAlphaRGBA=
function(v){if(!v)return 0;const {r:p,g:k,b,a}=v;return G.i8888to32(p*a,k*a,b*a,255*a)};u.premultiplyAlphaRGBAArray=function(v){if(!v)return 0;const [p,k,b,a]=v;return G.i8888to32(a/255*p,a/255*k,a/255*b,a)};u.premultiplyAlphaUint32=function(v){C(F(y,v));return G.i8888to32(y[0],y[1],y[2],y[3])};u.white=[255,255,255,1];Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(u){function G(y,v,p){return Math.round(Math.max(Math.min(y,
p),v))}const F=new Float32Array(1),C=new Uint32Array(F.buffer);u.i16=function(y){return G(y,-32768,32767)};u.i1616to32=function(y,v){return 65535&y|v<<16};u.i32=function(y){return G(y,-2147483648,2147483647)};u.i8=function(y){return G(y,-128,127)};u.i8816to32=function(y,v,p){return y&255|(v&255)<<8|p<<16};u.i8888to32=function(y,v,p,k){return y&255|(v&255)<<8|(p&255)<<16|k<<24};u.numTo32=function(y){return y|0};u.toFloat32=function(y){C[0]=y;return F[0]};u.toUint32=function(y){F[0]=y;return C[0]};
u.u16=function(y){return G(y,0,65535)};u.u32=function(y){return G(y,0,4294967295)};u.u32to4Xu8=function(y){return[y&255,(y&65280)>>>8,(y&16711680)>>>16,(y&4278190080)>>>24]};u.u4u4to8=function(y,v){return 15&y|(15&v)<<4};u.u8=function(y){return G(y,0,255)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["exports","../../../../core/ObjectPool"],function(u,G){let F=function(){function C(){this.color=[0,0,0,0];this.haloColor=[0,0,0,
0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}var y=C.prototype;y.acquire=function(v,p,k,b,a,f,c,h,l){this.color=v;this.haloColor=p;this.haloSize=k;this.size=b;this.angle=a;this.offsetX=f;this.offsetY=c;this.hAnchor=h;this.vAnchor=l};y.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=
this.haloColor[3]=0};return C}();F.pool=new G(F);u.TextProperties=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["exports","./sources/resolver"],function(u,G){G={shaders:{vertexShader:G.resolveIncludes("background/background.vert"),fragmentShader:G.resolveIncludes("background/background.frag")},attributes:new Map([["a_pos",0]])};u.background=G;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define("exports ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/ShaderCompiler ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ./shaderRepository".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c){const h=new b(function(l){let q=c;l.split("/").forEach(e=>{q&&(q=q[e])});return q});u.resolveIncludes=function(l){return h.resolveIncludes(l)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\ngl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\nvec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nlowp vec4 color \x3d texture2D(u_tex, v_uv);\ngl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_pos, 0.0, 1.0);\nv_uv \x3d a_tex;\n}"},blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\nreturn max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\nfloat vIn \x3d rgb2v(Cb);\nvec3 hsvTint \x3d rgb2hsv(Cs);\nvec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\nreturn hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 0.0) ? 0.0 : (Cs \x3d\x3d 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 1.0) ? 1.0 : (Cs \x3d\x3d 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\nreturn (Cs \x3d\x3d 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\nif (Cs \x3c\x3d 0.5) {\nreturn Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n}\nif (Cb \x3c\x3d 0.25) {\nreturn Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n}\nreturn Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\nreturn min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\nreturn max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\nreturn dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\nreturn maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\nfloat lum \x3d lumv3(color);\nfloat mincol \x3d minv3(color);\nfloat maxcol \x3d maxv3(color);\nif (mincol \x3c 0.0) {\ncolor \x3d lum + ((color - lum) * lum) / (lum - mincol);\n}\nif (maxcol \x3e 1.0) {\ncolor \x3d lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n}\nreturn color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\nfloat lbase \x3d lumv3(cbase);\nfloat llum \x3d lumv3(clum);\nfloat ldiff \x3d llum - lbase;\nvec3 color \x3d cbase + vec3(ldiff);\nreturn clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\nfloat minbase \x3d minv3(cbase);\nfloat sbase \x3d satv3(cbase);\nfloat ssat \x3d satv3(csat);\nvec3 color;\nif (sbase \x3e 0.0) {\ncolor \x3d (cbase - minbase) * ssat / sbase;\n} else {\ncolor \x3d vec3(0.0);\n}\nreturn setLum(color, clum);\n}\nvoid main() {\nvec4 src \x3d texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\ngl_FragColor \x3d src *  u_opacity;\n#else\nvec4 dst \x3d texture2D(u_backbufferTexture, v_uv);\nvec3 Cs \x3d src.a \x3d\x3d 0.0 ? src.rgb : vec3(src.rgb / src.a);\nvec3 Cb \x3d dst.a \x3d\x3d 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\nfloat as \x3d u_opacity * src.a;\nfloat ab \x3d dst.a;\n#ifdef DESTINATION_OVER\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n#endif\n#ifdef SOURCE_IN\nvec4 color \x3d vec4(as * Cs * ab, as * ab);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef DESTINATION_IN\nvec4 color \x3d vec4(ab * Cb * as, ab * as);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef SOURCE_OUT\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n#endif\n#ifdef DESTINATION_OUT\ngl_FragColor \x3d vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n#endif\n#ifdef SOURCE_ATOP\ngl_FragColor \x3d vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n#endif\n#ifdef DESTINATION_ATOP\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n#endif\n#ifdef XOR\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\nas * (1.0 - ab) + ab * (1.0 - as));\n#endif\n#ifdef MULTIPLY\ngl_FragColor \x3d vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\nas + ab * (1.0 - as));\n#endif\n#ifdef SCREEN\ngl_FragColor \x3d vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef OVERLAY\nvec3 f \x3d vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DARKEN\ngl_FragColor \x3d vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LIGHTER\ngl_FragColor \x3d vec4(as * Cs + ab * Cb, as + ab);\n#endif\n#ifdef LIGHTEN\ngl_FragColor \x3d vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_DODGE\nvec3 f \x3d vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_BURN\nvec3 f \x3d vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HARD_LIGHT\nvec3 f \x3d vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SOFT_LIGHT\nvec3 f \x3d vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DIFFERENCE\ngl_FragColor \x3d vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef EXCLUSION\nvec3 f \x3d Cs + Cb - 2.0 * Cs * Cb;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef INVERT\ngl_FragColor \x3d vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n#endif\n#ifdef VIVID_LIGHT\nvec3 f \x3d vec3(vividLight(Cb.r, Cs.r),\nvividLight(Cb.g, Cs.g),\nvividLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HUE\nvec3 f \x3d setLumSat(Cs,Cb,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SATURATION\nvec3 f \x3d setLumSat(Cb,Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR\nvec3 f \x3d setLum(Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LUMINOSITY\nvec3 f \x3d setLum(Cb,Cs);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef PLUS\ngl_FragColor \x3d clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n#endif\n#ifdef MINUS\ngl_FragColor \x3d vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n#endif\n#ifdef AVERAGE\nvec3 f \x3d (Cb + Cs) / 2.0;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef REFLECT\nvec3 f \x3d vec3(reflectBlend(Cb.r, Cs.r),\nreflectBlend(Cb.g, Cs.g),\nreflectBlend(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#endif\n}",
"blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_position , 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\nfloat b \x3d 1.0 / 6.0;\nfloat v2 \x3d v * v;\nfloat v3 \x3d v2 * v;\nfloat w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\nfloat w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\nfloat w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\nfloat w3 \x3d b * v3;\nreturn vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\nvec4 w \x3d computeWeights(v);\nfloat g0 \x3d w.x + w.y;\nfloat g1 \x3d w.z + w.w;\nfloat h0 \x3d 1.0 - (w.y / g0) + v;\nfloat h1 \x3d 1.0 + (w.w / g1) - v;\nreturn vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\nvec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\nvec2 texel \x3d coords * texSize - 0.5;\nvec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\nvec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\nvec2 coords10 \x3d coords + hgX.x * eX;\nvec2 coords00 \x3d coords - hgX.y * eX;\nvec2 coords11 \x3d coords10 + hgY.x * eY;\nvec2 coords01 \x3d coords00 + hgY.x * eY;\ncoords10 \x3d coords10 - hgY.y * eY;\ncoords00 \x3d coords00 - hgY.y * eY;\nvec4 color00 \x3d texture2D(sampler, coords00);\nvec4 color10 \x3d texture2D(sampler, coords10);\nvec4 color01 \x3d texture2D(sampler, coords01);\nvec4 color11 \x3d texture2D(sampler, coords11);\ncolor00 \x3d mix(color00, color01, hgY.z);\ncolor10 \x3d mix(color10, color11, hgY.z);\ncolor00 \x3d mix(color00, color10, hgX.z);\nreturn color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 texelStart \x3d floor(coords * texSize);\nvec2 coord0 \x3d texelStart / texSize;\nvec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\nvec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\nvec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\nvec4 color0 \x3d texture2D(sampler, coord0);\nvec4 color1 \x3d texture2D(sampler, coord1);\nvec4 color2 \x3d texture2D(sampler, coord2);\nvec4 color3 \x3d texture2D(sampler, coord3);\nvec2 blend \x3d fract(coords * texSize);\nvec4 color01 \x3d mix(color0, color1, blend.x);\nvec4 color23 \x3d mix(color2, color3, blend.x);\nvec4 color \x3d mix(color01, color23, blend.y);\n#ifdef NNEDGE\nfloat alpha \x3d floor(color0.a * color1.a * color2.a * color3.a + 0.5);\ncolor \x3d color * alpha + (1.0 - alpha) * texture2D(sampler, coords);\n#endif\nreturn color;\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\nvec2 invSize \x3d 1.0 / texSize;\nvec2 texel \x3d coords * texSize;\nvec2 texel_i \x3d floor(texel);\nvec2 texel_frac \x3d fract(texel);\nvec4 colorP \x3d texture2D(sampler, texel_i * invSize);\nvec4 colorP1 \x3d vec4(colorP);\nvec4 colorP2 \x3d vec4(colorP);\nvec4 colorP3 \x3d vec4(colorP);\nvec4 colorP4 \x3d vec4(colorP);\nvec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\nvec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\nvec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\nvec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\nif (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\ncolorP1 \x3d colorA;\n}\nif (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\ncolorP2 \x3d colorB;\n}\nif (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\ncolorP3 \x3d colorC;\n}\nif (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\ncolorP4 \x3d colorD;\n}\nvec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\nvec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\nreturn mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\nvec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\nfloat flags \x3d data0.r * 255.0;\nfloat groupMinZoom \x3d data0.g * 255.0;\nfloat isVisible \x3d getFilterBit(flags, 0);\nfloat wouldClip \x3d step(groupMinZoom, u_zoomLevel);\nfloat direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\nfloat dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\nvec4 nextState \x3d vec4(texel + direction * dt);\ngl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\ngl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump float u_sigma;\nuniform sampler2D u_texture;\nmediump float gauss1(mediump vec2 dir) {\nreturn exp(-dot(dir, dir) / (2.0 * u_sigma * u_sigma));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\nreturn u_channelSelector * sample;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\nmediump float w \x3d gauss1(i * u_direction.xy);\ntot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\nweight +\x3d w;\n}\nvoid main(void) {\nmediump float tot \x3d 0.0;\nmediump float weight \x3d 0.0;\naccumGauss1(-5.0, tot, weight);\naccumGauss1(-4.0, tot, weight);\naccumGauss1(-3.0, tot, weight);\naccumGauss1(-2.0, tot, weight);\naccumGauss1(-1.0, tot, weight);\naccumGauss1(0.0, tot, weight);\naccumGauss1(1.0, tot, weight);\naccumGauss1(2.0, tot, weight);\naccumGauss1(3.0, tot, weight);\naccumGauss1(4.0, tot, weight);\naccumGauss1(5.0, tot, weight);\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump float u_sigma;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\nmediump float y \x3d texture2D(u_texture, v_texcoord)[3];\nconst mediump float y0 \x3d 0.5;\nmediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * u_sigma);\nmediump float d \x3d (y - y0) / m0;\nreturn d;\n}\nmediump vec4 shade(mediump float d) {\nmediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\nmappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\nreturn texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\nmediump float d \x3d estimateDistance();\ngl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlayTexture;\nuniform bool u_maskEnabled;\nuniform bool u_overlayEnabled;\nvarying mediump vec2 v_texCoord;\nconst lowp float barrelFactor \x3d 1.1;\nlowp vec2 barrel(lowp vec2 uv) {\nlowp vec2 uvn \x3d uv * 2.0 - 1.0;\nif (uvn.x \x3d\x3d 0.0 \x26\x26 uvn.y \x3d\x3d 0.0) {\nreturn vec2(0.5, 0.5);\n}\nlowp float theta \x3d atan(uvn.y, uvn.x);\nlowp float r \x3d pow(length(uvn), barrelFactor);\nreturn r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main(void)\n{\nlowp vec4 color \x3d texture2D(u_readbackTexture, barrel(v_texCoord));\ncolor \x3d (color + (1.0 - color.a) * u_background);\nlowp float mask \x3d u_maskEnabled ? texture2D(u_maskTexture, v_texCoord).a : 1.0;\ncolor *\x3d mask;\nlowp vec4 overlayColor \x3d u_overlayEnabled ? texture2D(u_overlayTexture, v_texCoord) : vec4(0);\ngl_FragColor \x3d overlayColor + (1.0 - overlayColor.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec4 u_drawPos;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\nv_texCoord \x3d a_pos;\ngl_Position \x3d vec4(u_drawPos.xy + vec2(a_pos - 0.5) * u_drawPos.zw, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec3 id) {\nhighp vec3  texel \x3d unpackDisplayIdTexel(id);\nhighp float size \x3d float(u_attributeTextureSize);\nhighp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256);\nhighp float col \x3d mod(u32, size);\nhighp float row \x3d (u32 - col) / size;\nhighp float u \x3d col / size;\nhighp float v \x3d row / size;\nreturn vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec3 id) {\nvec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\nbool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\nif (isMagic) {\nreturn NAN_MAGIC_NUMBER;\n}\nreturn (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float POSITION_PRECISION \x3d 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION \x3d 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;\nconst int BITSET_GENERIC_LOCK_COLOR \x3d 1;\nconst int BITSET_MARKER_ALIGNMENT_MAP \x3d 0;\nconst int BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE \x3d 2;\nconst int BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY \x3d 3;\nconst int BITSET_TYPE_FILL_OUTLINE \x3d 0;\nconst int BITSET_LINE_SCALE_DASH \x3d 2;",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying highp vec3 v_id;\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\nvarying mediump vec4 v_aux1;\n#ifdef PATTERN\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef OUTLINED_FILL\nvarying lowp float v_isOutline;\n#endif\n#ifdef DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\n#ifdef OUTLINED_FILL\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.frag\x3e\nlowp vec4 drawLine() {\nfloat v_lineWidth \x3d v_aux1.x;\nvec2  v_normal    \x3d v_aux1.yz;\nLineData inputs \x3d LineData(\nv_color,\nv_normal,\nv_lineWidth,\nv_opacity,\nv_id\n);\nreturn shadeLine(inputs);\n}\n#endif\nlowp vec4 drawFill() {\nlowp vec4 out_color \x3d vec4(0.);\n#ifdef ID\nout_color \x3d vec4(v_id, 0.0);\n#elif defined(PATTERN)\nmediump vec4 v_tlbr \x3d v_aux1;\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\nout_color \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\nvec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\nvec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\nvec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\nvec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\nvec4 isPositive0 \x3d step(0.0, difference0);\nvec4 isPositive1 \x3d step(0.0, difference1);\nfloat weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\nfloat lessThanEqZero \x3d step(weightSum, 0.0);\nfloat greaterThanZero \x3d 1.0 - lessThanEqZero ;\nfloat divisor \x3d (weightSum + lessThanEqZero);\nvec4 weights0 \x3d difference0 * isPositive0 / divisor;\nvec4 weights1 \x3d difference1 * isPositive1 / divisor;\nvec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\nvec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\nfloat diffMax \x3d max(max4(difference0), max4(difference1));\nfloat lessThanZero \x3d step(diffMax, 0.0);\nfloat greaterOrEqZero \x3d 1.0 - lessThanZero;\nvec4 isMax0 \x3d step(diffMax, difference0);\nvec4 isMax1 \x3d step(diffMax, difference1);\nvec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\nvec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\nout_color \x3d preEffectColor;\n#else\nout_color \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\nout_color.a \x3d 1.0;\n#endif\nreturn out_color;\n}\nvoid main() {\n#ifdef OUTLINED_FILL\nif (v_isOutline \x3e 0.5) {\ngl_FragColor \x3d drawLine();\n} else {\ngl_FragColor \x3d drawFill();\n}\n#else\ngl_FragColor \x3d drawFill();\n#endif\n}",
"fill.vert":"#define PACKED_LINE\nprecision highp float;\nattribute float a_bitset;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_aux2;\nattribute vec4 a_aux3;\n#ifndef SIMPLE\nattribute vec4 a_aux1;\nattribute vec2 a_zoomRange;\n#else\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#endif\n#endif\nuniform vec2 u_tileOffset;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\nreturn featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef OUTLINED_FILL\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.vert\x3e\nvoid drawLine(out lowp vec4 out_color, out highp vec3 out_pos) {\nLineData outputs \x3d buildLine(\nout_pos,\na_id,\na_pos,\na_color,\n(a_aux3.xy - 128.) / 16.,\n(a_aux3.zw - 128.) / 16.,\n0.,\na_aux2.z / 16.,\na_bitset,\nvec4(0.),\nvec2(0.),\na_aux2.w / 16.\n);\nv_id      \x3d outputs.id;\nv_color   \x3d outputs.color;\nv_opacity \x3d outputs.opacity;\nv_aux1    \x3d vec4(outputs.lineHalfWidth, outputs.normal, 0.);\nout_color \x3d outputs.color;\n}\n#endif\nvoid drawFill(out lowp vec4 out_color, out highp vec3 out_pos) {\nfloat a_bitSet \x3d a_bitset;\nv_color   \x3d getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\nout_color \x3d v_color;\nout_pos   \x3d u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\n#ifdef PATTERN\nvec4  a_tlbr   \x3d a_aux1;\nfloat a_width  \x3d a_aux2.x;\nfloat a_height \x3d a_aux2.y;\nvec2  a_offset \x3d a_aux2.zw;\nvec2  a_scale  \x3d a_aux3.xy;\nfloat a_angle  \x3d a_aux3.z;\nvec2 scale \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_scale;\nfloat width \x3d u_pixelRatio * u_zoomFactor * a_width * scale.x;\nfloat height \x3d u_pixelRatio * u_zoomFactor * a_height * scale.y;\nfloat angle \x3d C_256_TO_RAD * a_angle;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nmat3 patternMatrix \x3d mat3(cosA / width, sinA / height, 0,\n-sinA / width, cosA / height, 0,\n0,            0,             1);\nvec2 tileOffset \x3d vec2(u_tileOffset.x * cosA - u_tileOffset.y * sinA, u_tileOffset.x * sinA + u_tileOffset.y * cosA);\ntileOffset \x3d mod(tileOffset, vec2(a_aux2.x, a_aux2.y));\nvec2 symbolOffset \x3d (a_offset - tileOffset - SIGNED_BYTE_TO_UNSIGNED) / vec2(width, height);\nv_tileTextureCoord \x3d (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\nv_aux1 \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\nvec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\nvec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\nfloat size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\nv_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\nv_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\nv_dotTextureCoords \x3d (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\n}\nvoid main()\n{\nINIT;\nlowp vec4 color \x3d vec4(0.);\nhighp vec3 pos  \x3d vec3(0.);\n#ifdef OUTLINED_FILL\nv_isOutline \x3d getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE);\nif (v_isOutline \x3e 0.5) {\ndrawLine(color, pos);\n} else {\ndrawFill(color, pos);\n}\n#else\ndrawFill(color, pos);\n#endif\ngl_Position \x3d vec4(clip(color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying highp float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\nvec2 v_size \x3d v_sizeTex.xy;\nvec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nfloat outlineWidth \x3d v_outlineWidth;\n#ifdef HIGHLIGHT\noutlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n#endif\nif (outlineWidth \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\nfloat clampedOutlineSize \x3d min(outlineWidth, size);\noutlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\ngl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n}\nelse {\ngl_FragColor \x3d v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d v_opacity * texColor * v_color;\n#endif\n#ifdef HIGHLIGHT\ngl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d vec4(v_id, 0.0);\n#endif\n}",
"icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\nfloat r \x3d getSize(baseSize.y) / referenceSize;\nbaseSize.xy *\x3d r;\noffset.xy *\x3d r;\nfloat scaleSymbolProportionally \x3d getBit(bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\noutlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\nreturn baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\nfloat isMapAligned \x3d getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nvec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\nreturn getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\nINIT;\nvec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec2  a_offset \x3d a_vertexOffset / 16.0;\nfloat a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\nfloat a_bitSet \x3d a_bitSetAndDistRatio.x;\nvec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\nvec2 v_tex      \x3d a_texCoords / u_mosaicSize;\nv_color    \x3d getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity  \x3d getOpacity();\nv_id       \x3d norm(a_id);\nv_filters  \x3d getFilterFlags();\nv_pos      \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + getOffset(a_offset, a_bitSet);\nv_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\nv_isThin   \x3d getBit(a_bitSet, BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE);\n#ifdef VV_COLOR\nv_overridingOutlineColor \x3d v_isThin;\n#else\nv_overridingOutlineColor \x3d 0.0;\n#endif\nv_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\nv_outlineColor \x3d a_outlineColor;\nv_distRatio \x3d a_bitSetAndDistRatio.y / 126.0;\n#endif\ngl_Position \x3d vec4(clip(v_color, v_pos, v_filters, a_zoomRange), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\nfloat glyphAngle \x3d angle * 360.0 / 254.0;\nfloat mapAngle \x3d u_mapRotation * 360.0 / 254.0;\nfloat diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\nfloat z \x3d 0.0;\nz +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_currentZoom)));\nz +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\nz +\x3d 2.0 * (1.0 - step(u_currentZoom, maxZoom));\nreturn z;\n}\nvoid main()\n{\nINIT;\nfloat groupMinZoom    \x3d getMinZoom();\nfloat glyphMinZoom    \x3d a_glyphData.x;\nfloat glyphMaxZoom    \x3d a_glyphData.y;\nfloat glyphAngle      \x3d a_glyphData.z;\nfloat a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\nfloat a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\nvec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\nfloat a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\nfloat fontSize           \x3d a_texAndSize.z;\nfloat haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\nvec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  pos          \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\nfloat fontScale    \x3d fontSize / SDF_FONT_SIZE;\nfloat halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\nfloat animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\nv_color     \x3d animation * ((1.0 - u_isHalo) * a_color + (u_isHalo * a_haloColor));\nv_opacity   \x3d 1.0;\nv_tex       \x3d a_texCoords / u_mosaicSize;\nv_edgeDistanceOffset \x3d u_isHalo * haloSize / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\nvec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\nvec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\nvec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\ngl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\nv_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif\n#ifdef SDF\nvarying mediump float v_lineWidthRatio;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.frag\x3e\nvoid main()\n{\nLineData inputs \x3d LineData(\nv_color,\nv_normal,\nv_lineHalfWidth,\nv_opacity,\n#ifndef OUTLINED_FILL\n#ifdef PATTERN\nv_tlbr,\nv_patternSize,\n#endif\n#ifdef SDF\nv_lineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance,\n#endif\n#endif\nv_id\n);\ngl_FragColor \x3d shadeLine(inputs);\n}",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.vert\x3e\nvoid main()\n{\nINIT;\nhighp vec3 pos \x3d vec3(0.);\nLineData outputs \x3d buildLine(\npos,\na_id,\na_pos,\na_color,\na_offsetAndNormal.xy / 16.,\na_offsetAndNormal.zw / 16.,\na_accumulatedDistanceAndHalfWidth.x,\na_accumulatedDistanceAndHalfWidth.y / 16.,\na_segmentDirection.w,\na_tlbr,\na_segmentDirection.xy / 16.,\na_aux.x / 16.\n);\nv_id              \x3d outputs.id;\nv_color           \x3d outputs.color;\nv_normal          \x3d outputs.normal;\nv_lineHalfWidth   \x3d outputs.lineHalfWidth;\nv_opacity         \x3d outputs.opacity;\n#ifndef OUTLINED_FILL\n#ifdef PATTERN\nv_tlbr          \x3d outputs.tlbr;\nv_patternSize   \x3d outputs.patternSize;\n#endif\n#ifdef SDF\nv_lineWidthRatio \x3d outputs.lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d outputs.accumulatedDistance;\n#endif\n#endif\ngl_Position \x3d vec4(clip(outputs.color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}"},
shared:{line:{"common.glsl":"#if !defined(OUTLINED_FILL) \x26\x26 defined(PATTERN)\nuniform mediump vec2 u_mosaicSize;\n#endif\nstruct LineData {\nlowp vec4 color;\nmediump vec2 normal;\nmediump float lineHalfWidth;\nlowp float opacity;\n#ifndef OUTLINED_FILL\n#ifdef PATTERN\nmediump vec4 tlbr;\nmediump vec2 patternSize;\n#endif\n#ifdef SDF\nmediump float lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nhighp float accumulatedDistance;\n#endif\n#endif\nhighp vec3 id;\n};","line.frag":"uniform lowp float u_blur;\n#if !defined(OUTLINED_FILL) \x26\x26 !defined(HIGHLIGHT)\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\nuniform highp float u_pixelRatio;\n#endif\n#endif\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT) \x26\x26 !defined(OUTLINED_FILL)\nlowp vec4 getLineColor(LineData line) {\nmediump float adjustedPatternWidth \x3d line.patternSize.x * 2.0 * line.lineWidthRatio;\nmediump float relativeTexX \x3d fract(u_pixelRatio * line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY \x3d 0.5 + 0.25 * line.normal.y;\nmediump vec2 texCoord \x3d mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * line.lineHalfWidth;\nreturn line.opacity * clamp(0.5 - dist, 0.0, 1.0) * line.color;\n}\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT) \x26\x26 !defined(OUTLINED_FILL)\nlowp vec4 getLineColor(LineData line) {\nmediump float lineHalfWidth \x3d line.lineHalfWidth;\nmediump float adjustedPatternWidth \x3d line.patternSize.x * 2.0 * lineHalfWidth / line.patternSize.y;\nmediump float relativeTexX \x3d fract(u_pixelRatio * line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY \x3d 0.5 + 0.5 * line.normal.y;\nmediump vec2 texCoord \x3d mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexY, relativeTexX));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\nreturn line.opacity * line.color * color;\n}\n#else\nlowp vec4 getLineColor(LineData line) {\nreturn line.opacity * line.color;\n}\n#endif\nvec4 shadeLine(LineData line)\n{\nmediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(line.lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nmediump float fragDist \x3d length(line.normal) * line.lineHalfWidth;\nlowp float alpha \x3d clamp(thinLineFactor * (line.lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\nlowp vec4 out_color \x3d getLineColor(line) * alpha;\n#ifdef HIGHLIGHT\nout_color.a \x3d step(1.0 / 255.0, out_color.a);\n#endif\n#ifdef ID\nif (out_color.a \x3c 1.0 / 255.0) {\ndiscard;\n}\nout_color \x3d vec4(line.id, 0.0);\n#endif\nreturn out_color;\n}",
"line.vert":"float getBaseLineHalfWidth(in float lineHalfWidth, in float referenceHalfWidth) {\n#ifdef VV_SIZE\nfloat lineWidth \x3d 2.0 * lineHalfWidth;\nreturn 0.5 * (lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\nreturn lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\nfloat halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\nhalfWidth \x3d max(halfWidth, 2.0);\n#endif\nreturn halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\nfloat thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nreturn thinLineFactor * halfWidth * offset;\n}\nLineData buildLine(\nout vec3 out_pos,\nin vec3 in_id,\nin vec2 in_pos,\nin vec4 in_color,\nin vec2 in_offset,\nin vec2 in_normal,\nin float in_accumulatedDist,\nin float in_lineHalfWidth,\nin float in_bitSet,\nin vec4 in_tlbr,\nin vec2 in_segmentDirection,\nin float in_referenceHalfWidth\n)\n{\nfloat aa        \x3d 0.5 * u_antialiasing;\nfloat baseWidth \x3d getBaseLineHalfWidth(in_lineHalfWidth, in_referenceHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\nfloat z         \x3d 2.0 * step(baseWidth, 0.0);\nvec2  dist      \x3d getDist(in_offset, halfWidth);\nvec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\nvec3  pos       \x3d u_dvsMat3 * vec3(in_pos * POSITION_PRECISION, 1.0) + offset;\n#ifdef OUTLINED_FILL\nvec4  color     \x3d in_color;\nfloat opacity   \x3d 1.0;\n#else\nvec4  color     \x3d getColor(in_color, in_bitSet, 0);\nfloat opacity   \x3d getOpacity();\n#ifdef SDF\nconst float SDF_PATTERN_HALF_WIDTH \x3d 15.5;\nfloat scaleDash \x3d getBit(in_bitSet, BITSET_LINE_SCALE_DASH);\nfloat lineWidthRatio \x3d (scaleDash * max(halfWidth - 0.55 * u_antialiasing, 0.25) + (1.0 - scaleDash)) / SDF_PATTERN_HALF_WIDTH;\n#endif\n#endif\nout_pos \x3d vec3(pos.xy, z);\nreturn LineData(\ncolor,\nin_normal,\nhalfWidth,\nopacity,\n#ifndef OUTLINED_FILL\n#ifdef PATTERN\nin_tlbr / u_mosaicSize.xyxy,\nvec2(in_tlbr.z - in_tlbr.x, in_tlbr.w - in_tlbr.y),\n#endif\n#ifdef SDF\nlineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nin_accumulatedDist * u_zoomFactor + dot(in_segmentDirection, dist),\n#endif\n#endif\nnorm(in_id)\n);\n}"}},
text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec3 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\nfloat SDF_CUTOFF \x3d (2.0 / 8.0);\nfloat SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\nedge /\x3d 2.0;\n#endif\nlowp float aa \x3d v_antialiasingWidth;\nlowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\ngl_FragColor \x3d alpha * v_color * v_opacity;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d vec4(v_id, 0.0);\n#endif\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_zoomRange;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nfloat getTextSize(inout vec2 offset, inout float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\nfloat r \x3d getSize(baseSize) / referenceSize;\nbaseSize *\x3d r;\noffset.xy *\x3d r;\nreturn baseSize;\n#endif\nreturn baseSize;\n}\nvoid main()\n{\nINIT;\nfloat a_referenceSize \x3d a_aux.z * a_aux.z / 256.0;\nfloat a_bitSet        \x3d a_aux.w;\nfloat a_fontSize      \x3d a_texFontSize.z;\nvec2  a_offset        \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  in_pos        \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat fontSize      \x3d getTextSize(a_offset, a_fontSize, a_referenceSize);\nfloat fontScale     \x3d fontSize / SDF_FONT_SIZE;\nvec3  offset        \x3d getRotation() * vec3(a_offset, 0.0);\nmat3  extrudeMatrix \x3d getBit(a_bitSet, 0) \x3d\x3d 1.0 ? u_displayViewMat3 : u_displayMat3;\nv_color   \x3d u_isHalo * a_haloColor + (1.0 - u_isHalo) * getColor(a_color, a_bitSet, 1);\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\nv_tex     \x3d a_texCoords / u_mosaicSize;\nv_pos     \x3d u_dvsMat3 * in_pos + extrudeMatrix * offset;\nv_edgeDistanceOffset \x3d u_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\ngl_Position \x3d  vec4(clip(v_color, v_pos, getFilterFlags(), a_zoomRange), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\nreturn floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\nfloat offset \x3d pow(2.0, float(bitIndex));\nreturn mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\nreturn getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\nreturn getBit(bitset, 0);\n}\nhighp vec3 unpackDisplayIdTexel(in highp vec3 bitset) {\nfloat isAggregate \x3d getBit(bitset.b, 7);\nreturn (1.0 - isAggregate) * bitset + isAggregate * (vec3(bitset.rgb) - vec3(0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\nfloat r \x3d mod(rshift(u32, 0), 255.0);\nfloat g \x3d mod(rshift(u32, 8), 255.0);\nfloat b \x3d mod(rshift(u32, 16), 255.0);\nfloat a \x3d mod(rshift(u32, 24), 255.0);\nreturn vec4(r, g, b, a);\n}\nvec3 norm(in vec3 v) {\nreturn v /\x3d 255.0;\n}\nvec4 norm(in vec4 v) {\nreturn v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\nreturn max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\nreturn (bytes - 127.0) / 127.0;\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec3 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nuniform mediump float u_currentZoom;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\ntarget.rgba \x3d getAttributeData2(a_id);\n#else\nvec4 data0 \x3d getAttributeData2(a_id);\nvec4 data1 \x3d getAttributeData3(a_id);\ntarget.r \x3d u88VVToFloat(data0.rg * 255.0);\ntarget.g \x3d u88VVToFloat(data0.ba * 255.0);\ntarget.b \x3d u88VVToFloat(data1.rg * 255.0);\ntarget.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n#define INIT loadVisualVariableData(VV_ADATA)\n#else\n#define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\nfloat isColorLocked   \x3d getBit(a_bitSet, index);\nreturn getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\nreturn a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\nreturn getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\nreturn 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\nreturn getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\nreturn in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\nreturn getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\nreturn mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\nreturn ceil(getAttributeData0(a_id).x * 255.0);\n#else\nreturn getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\nreturn getAttributeData1(a_id);\n}\nfloat getMinZoom() {\nvec4 data0 \x3d getAttributeData0(a_id) * 255.0;\nreturn data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\nreturn isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}\nvec3 clip(inout vec4 color, inout vec3 pos, in float filterFlags, in vec2 minMaxZoom) {\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef INSIDE\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#elif defined(OUTSIDE)\npos.z +\x3d 2.0 * getFilterBit(filterFlags, 1);\n#elif defined(HIGHLIGHT)\n#if !defined(HIGHLIGHT_ALL)\npos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n#endif\npos.z +\x3d 2.0 * (step(minMaxZoom.y, u_currentZoom) + (1.0 - step(minMaxZoom.x, u_currentZoom)));\nreturn pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifndef OUTSIDE_LABELS_VISIBLE\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#endif\nreturn pos;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n#define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n#define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\nreturn (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nfloat interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\ninterpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\nreturn u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nif (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\nreturn u_vvSizeFieldStopsSizes[0];\n}\nfor (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\nif (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\nfloat f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\nreturn mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n}\n}\nreturn u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nreturn u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue) {\nif (isNan(opacityValue)) {\nreturn 1.0;\n}\nif (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\nreturn u_vvOpacities[0];\n}\nfor (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\nif (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\nfloat f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\nreturn mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n}\n}\nreturn u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat4(1, 0, 0, 0,\n0, 1, 0, 0,\n0, 0, 1, 0,\n0, 0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat4(cosA, sinA, 0, 0,\n-sinA,  cosA, 0, 0,\n0,     0, 1, 0,\n0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat3(1, 0, 0,\n0, 1, 0,\n0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * -rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat3(cosA, -sinA, 0,\nsinA, cosA, 0,\n0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\nif (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\nreturn fallback;\n}\nif (colorValue \x3c\x3d u_vvColorValues[0]) {\nreturn u_vvColors[0];\n}\nfor (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\nif (u_vvColorValues[i] \x3e\x3d colorValue) {\nfloat f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\nreturn mix(u_vvColors[i-1], u_vvColors[i], f);\n}\n}\nreturn u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\nreturn getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\nreturn u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\nfloat outSize \x3d getVVStopsSize(vvSize, size);\nreturn isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\nreturn getVVUnitValue(vvSize, size);\n#else\nreturn size;\n#endif\n}"},
"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\ngl_FragColor \x3d texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\nfloat mirrorFactor \x3d 1.2 - factor;\nreturn mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\ngl_FragColor \x3d u_bloomStrength * (\nlerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\nlerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\nlerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\nlerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\nlerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n);\n}"},
gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d float(SIGMA);\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\nvec4 texel \x3d texture2D(u_texture, v_uv);\nvec3 luma \x3d vec3(0.299, 0.587, 0.114);\nfloat v \x3d dot(texel.xyz, luma);\nvec4 outputColor \x3d vec4(u_defaultColor.rgb, u_defaultOpacity);\nfloat alpha \x3d smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\ngl_FragColor \x3d mix(outputColor, texel, alpha);\n}"}},
blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d u_sigma;\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist \x3d 1.0;\nconst float sampleStrength \x3d 2.2;\nvoid main(void) {\nfloat samples[10];\nsamples[0] \x3d -0.08;\nsamples[1] \x3d -0.05;\nsamples[2] \x3d -0.03;\nsamples[3] \x3d -0.02;\nsamples[4] \x3d -0.01;\nsamples[5] \x3d  0.01;\nsamples[6] \x3d  0.02;\nsamples[7] \x3d  0.03;\nsamples[8] \x3d  0.05;\nsamples[9] \x3d  0.08;\nvec2 dir \x3d 0.5 - v_uv;\nfloat dist \x3d sqrt(dir.x * dir.x + dir.y * dir.y);\ndir \x3d dir / dist;\nvec4 color \x3d texture2D(u_colorTexture,v_uv);\nvec4 sum \x3d color;\nfor (int i \x3d 0; i \x3c 10; i++) {\nsum +\x3d texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n}\nsum *\x3d 1.0 / 11.0;\nfloat t \x3d dist * sampleStrength;\nt \x3d clamp(t, 0.0, 1.0);\ngl_FragColor \x3d mix(color, sum, t);\n}"}},
dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\nvec4 minColor \x3d texture2D(u_minColor, vec2(0.5));\nvec4 maxColor \x3d texture2D(u_maxColor, vec2(0.5));\nvec4 color \x3d texture2D(u_texture, v_uv);\nvec3 minColorUnpremultiply \x3d minColor.rgb / minColor.a;\nvec3 maxColorUnpremultiply \x3d maxColor.rgb / maxColor.a;\nvec3 colorUnpremultiply \x3d color.rgb / color.a;\nvec3 range \x3d maxColorUnpremultiply - minColorUnpremultiply;\ngl_FragColor \x3d vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}",
"min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\nvec2 srcPixel \x3d floor(gl_FragCoord.xy) * float(CELL_SIZE);\nvec2 onePixel \x3d vec2(1.0) / u_srcResolution;\nvec2 uv \x3d (srcPixel + 0.5) / u_srcResolution;\nvec4 minColor \x3d vec4(1.0);\nvec4 maxColor \x3d vec4(0.0);\nfor (int y \x3d 0; y \x3c CELL_SIZE; ++y) {\nfor (int x \x3d 0; x \x3c CELL_SIZE; ++x) {\nvec2 offset \x3d uv + vec2(x, y) * onePixel;\nminColor \x3d min(minColor, texture2D(u_minTexture, offset));\nmaxColor \x3d max(maxColor, texture2D(u_maxTexture, offset));\n}\n}\ngl_FragData[0] \x3d minColor;\ngl_FragData[1] \x3d maxColor;\n}"}},
"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nvarying vec2 v_uv;\nvoid main() {\nvec4 layerColor \x3d texture2D(u_layerFBOTexture, v_uv);\nvec4 blurColor \x3d texture2D(u_blurTexture, v_uv);\ngl_FragColor \x3d ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"},"drop-shadow.vert":"precision mediump float;\nattribute vec2 a_position;\nuniform highp mat3 u_displayViewMat3;\nuniform highp vec2 u_offset;\nvarying vec2 v_uv;\nvoid main() {\nvec3 offset \x3d u_displayViewMat3 * vec3(u_offset, 0.0);\ngl_Position \x3d vec4(a_position, 0.0, 1.0) + vec4(offset, 0.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"},
"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 \x3d mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 \x3d mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 \x3d mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 \x3d mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 \x3d mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 \x3d mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 \x3d mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 \x3d mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 \x3d mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\nG[0] \x3d g0,\nG[1] \x3d g1,\nG[2] \x3d g2,\nG[3] \x3d g3,\nG[4] \x3d g4,\nG[5] \x3d g5,\nG[6] \x3d g6,\nG[7] \x3d g7,\nG[8] \x3d g8;\nmat3 I;\nfloat cnv[9];\nvec3 sample;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 9; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nfloat M \x3d (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\nfloat S \x3d (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\ngl_FragColor \x3d vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},
sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\ngl_FragColor \x3d vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},
"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\ngl_FragColor \x3d vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},
filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\nvec4 rgbw \x3d u_coefficients * vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\nfloat a \x3d color.a;\ngl_FragColor \x3d vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"}},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\nuniform lowp float u_opacity;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\nvec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\nfloat alpha \x3d u_opacity * color.a;\ngl_FragColor \x3d vec4(alpha * color.rgb, alpha);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include \x3craster/common/projection.glsl\x3e\n#endif\n#ifdef BICUBIC\n#include \x3cfiltering/bicubic.glsl\x3e\n#endif\n#ifdef BILINEAR\n#include \x3cfiltering/bilinear.glsl\x3e\n#endif\nvec2 getPixelLocation(vec2 coords) {\nvec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\ntargetLocation \x3d projectPixelLocation(targetLocation);\n#endif\nreturn targetLocation;\n}\nbool isOutside(vec2 coords){\nif (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\nreturn true;\n} else {\nreturn false;\n}\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#elif defined(BILINEAR)\nvec4 color \x3d sampleBilinear(u_image, pixelLocation, u_srcImageSize);\n#else\nvec4 color \x3d texture2D(u_image, pixelLocation);\n#endif\nreturn color;\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\nvec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\nfloat maxI \x3d 255.0;\nfloat mid \x3d 128.0;\nfloat c \x3d u_contrastOffset;\nfloat b \x3d u_brightnessOffset;\nvec4 v;\nif (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n} else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n} else if (c \x3d\x3d 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\nv \x3d (sign(v) + 1.0) / 2.0;\n} else if (c \x3d\x3d -100.0) {\nv \x3d vec4(mid, mid, mid, currentPixel.a);\n}\nreturn vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\nvec2 index_image \x3d floor(coords * u_targetImageSize);\nvec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\nvec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\nvec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\nvec2 srcLocation;\nvec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\nif (pos.s \x3c\x3d pos.t) {\nvec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\nvec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n} else {\nvec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\nvec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n}\nreturn srcLocation;\n}"},
flow:{"flow.frag":"precision highp float;\nvarying float v_side;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nuniform float u_time;\nuniform float u_fadeDuration;\nuniform float u_lineSpeed;\nuniform vec4 u_lineColor;\nuniform float u_lineHalfWidth;\nvoid main(void) {\nvec4 color \x3d u_lineColor;\nfloat edgeWidth \x3d min(2.0 * u_lineHalfWidth - 1.0, 1.0);\nfloat edgeStart \x3d (u_lineHalfWidth - edgeWidth) / u_lineHalfWidth;\nif (edgeStart \x3c 0.95) {\nfloat s \x3d step(edgeStart, abs(v_side));\ncolor.a *\x3d (1.0 - s) + s * (1.0 - (abs(v_side) - edgeStart) / (1.0 - edgeStart));\n}\nfloat t \x3d mod(v_timeSeed * (v_totalTime + u_fadeDuration) + u_time * u_lineSpeed, v_totalTime + u_fadeDuration) - v_time;\ncolor.a *\x3d step(0.0, t) * exp(-2.3 * t / u_fadeDuration);\ncolor.rgb *\x3d color.a;\ngl_FragColor \x3d color;\n}",
"flow.vert":"precision highp float;\nattribute vec3 a_positionAndSide;\nattribute vec3 a_timeInfo;\nattribute vec2 a_extrude;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nuniform float u_lineHalfWidth;\nvarying float v_side;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvoid main(void) {\nvec2 position \x3d a_positionAndSide.xy;\nfloat side \x3d a_positionAndSide.z;\nvec2 xy \x3d (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(a_extrude * u_lineHalfWidth, 0.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_side \x3d side;\nv_time \x3d a_timeInfo.x;\nv_totalTime \x3d a_timeInfo.y;\nv_timeSeed \x3d a_timeInfo.z;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\nif (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\nreturn 0.0;\n}\nelse {\nreturn e;\n}\n}\nvec3 rgb2hsv(vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\nval \x3d clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\nvec4 rgb \x3d colorize(vec4(val, val, val, 1.0), 255.0);\nvec3 hsv \x3d rgb2hsv(rgb.xyz);\nhsv.z \x3d hillshade;\nreturn vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nif (currentPixel.a \x3d\x3d 0.0) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nvec2 onePixel \x3d 1.0 / u_srcImageSize;\nif (pixelLocation.s \x3c onePixel.s) {\naxy[0] \x3d 1.0;\ndxy[0] \x3d 1.0;\ngxy[0] \x3d 1.0;\n}\nif (pixelLocation.t \x3c onePixel.t) {\naxy[1] \x3d 1.0;\nbxy[1] \x3d 1.0;\ncxy[1] \x3d 1.0;\n}\nif (pixelLocation.s \x3e 1.0 - onePixel.s) {\ncxy[0] \x3d -1.0;\nfxy[0] \x3d -1.0;\nixy[0] \x3d -1.0;\n}\nif (pixelLocation.t \x3e 1.0 - onePixel.t) {\ngxy[1] \x3d -1.0;\nhxy[1] \x3d -1.0;\nixy[1] \x3d -1.0;\n}\nvec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\nvec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\nvec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\nvec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\nvec4 ve \x3d texture2D(u_image, pixelLocation);\nvec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\nvec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\nvec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\nvec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\nfloat dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\nfloat dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\nfloat dzd \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\nfloat hillshade \x3d 0.0;\nif (u_hillshadeType \x3d\x3d 0){\nfloat cosDelta \x3d u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\nfloat z \x3d (u_cosZs[0] + cosDelta) / dzd;\nif (z \x3c 0.0)  z \x3d 0.0;\nhillshade \x3d z;\n} else {\nfor (int k \x3d 0; k \x3c 6; k++) {\nfloat cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\nfloat z \x3d (u_cosZs[k] + cosDelta) / dzd;\nif (z \x3c 0.0) z \x3d 0.0;\nhillshade \x3d hillshade + z * u_weights[k];\nif (k \x3d\x3d 5) break;\n}\n}\nfloat alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n#ifdef APPLY_COLORMAP\ngl_FragColor \x3d overlay(ve.r, u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\ngl_FragColor \x3d vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}",
"hillshade.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\nfloat clrIndex \x3d clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\nvec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\nvec4 color \x3d texture2D(u_colormap, clrPosition);\nvec4 result \x3d vec4(color.rgb, color.a * currentPixel.a);\nreturn result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nvec4 result \x3d colorize(currentPixel, 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * u_opacity;\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
magdir:{"magdir.frag":"precision mediump float;\nvarying vec4 v_color;\nuniform lowp float u_opacity;\nvoid main() {\ngl_FragColor \x3d v_color * u_opacity;\n}","magdir.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nuniform float u_rotation;\nuniform vec4 u_colors[12];\nvarying vec4 v_color;\nvoid main()\n{\nfloat angle \x3d a_offset.y + u_rotation;\n#ifndef ROTATION_GEOGRAPHIC\nangle \x3d 3.14159265359 * 2.0 - angle - 3.14159265359 / 2.0;\n#endif\nvec2 offset \x3d vec2(cos(angle), sin(angle)) * a_offset.x;\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 pos \x3d a_pos + offset * sizePercentage * u_symbolSize;\nv_color \x3d u_colors[int(a_vv.x)];\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
reproject:{"reproject.frag":"precision mediump float;\nvarying vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 1.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\n}","reproject.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_position;\ngl_Position \x3d vec4(2.0 * (a_position - 0.5), 0.0, 1.0);\n}"},
scalar:{"scalar.frag":"precision mediump float;\nuniform lowp float u_opacity;\nvarying vec2 v_pos;\nconst vec4 outlineColor \x3d vec4(0.2, 0.2, 0.2, 1.0);\nconst float outlineSize \x3d 0.02;\nconst float innerRadius \x3d 0.25;\nconst float outerRadius \x3d 0.42;\nconst float innerSquareLength \x3d 0.15;\nvoid main() {\nmediump float dist \x3d length(v_pos);\nmediump float fillalpha1 \x3d smoothstep(outerRadius, outerRadius + outlineSize, dist);\nfillalpha1 *\x3d (1.0-smoothstep(outerRadius + outlineSize, outerRadius + 0.1 + outlineSize, dist));\n#ifdef INNER_CIRCLE\nmediump float fillalpha2 \x3d smoothstep(innerRadius, innerRadius + outlineSize, dist);\nfillalpha2 *\x3d (1.0-smoothstep(innerRadius + outlineSize, innerRadius + 0.1 + outlineSize, dist));\n#else\nmediump float fillalpha2 \x3d (abs(v_pos.x) \x3c innerSquareLength ? 1.0 : 0.0) * (abs(v_pos.y) \x3c innerSquareLength ? 1.0 : 0.0);\n#endif\ngl_FragColor \x3d (fillalpha2 + fillalpha1) * outlineColor * u_opacity;\n}",
"scalar.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nvarying vec2 v_pos;\nvoid main()\n{\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 size \x3d u_symbolSize * sizePercentage;\nvec2 pos \x3d a_pos + a_offset * size;\nv_pos \x3d a_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\nif (val \x3e\x3d maxCutOff) {\nreturn maxOutput;\n} else if (val \x3c\x3d minCutOff) {\nreturn minOutput;\n}\nfloat stretchedVal;\nif (useGamma) {\nfloat tempf \x3d 1.0;\nfloat outRange \x3d maxOutput - minOutput;\nfloat relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\nif (gamma \x3e 1.0) {\ntempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n}\nstretchedVal \x3d (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n} else {\nstretchedVal \x3d minOutput + (val - minCutOff) * factor;\n}\nreturn stretchedVal;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\n#ifdef NOOP\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\nreturn;\n#endif\nif (u_bandCount \x3d\x3d 1) {\nfloat grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\nvec4 result \x3d colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\ngl_FragColor \x3d vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n} else {\nfloat redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\nfloat greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor \x3d vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n}\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\ngl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\ngl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},
tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\nlowp vec4 color \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\nmediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\nvec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\nv_tex \x3d a_pos;\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/vec4f32 ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../../core/has ../../../../webgl/checkWebGLError ../../../../webgl/enums ../../../../../chunks/builtins ../../../../webgl/programUtils ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l){return function(q){function e(){var g=q.apply(this,arguments)||this;g._color=G.fromValues(1,0,0,1);return g}u._inheritsLoose(e,q);var d=e.prototype;d.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&
(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);this._canvas=null};d.prepareState=function({context:g}){g.setBlendingEnabled(!0);g.setBlendFunctionSeparate(1,771,1,771);g.setColorMask(!0,!0,!0,!0);g.setStencilWriteMask(0);g.setStencilTestEnabled(!1)};d.draw=function(g,m){({context:g}=g);if(m.isReady){this._loadWGLResources(g);g.bindVAO(this._outlineVertexArrayObject);g.useProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs);
this._outlineProgram.setUniform2f("u_coord_range",m.rangeX,m.rangeY);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);g.drawArrays(3,0,4);var n=this._getTexture(g,m);n&&(g.bindVAO(this._tileInfoVertexArrayObject),g.useProgram(this._tileInfoProgram),g.bindTexture(n,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",m.rangeX/
m.width,m.rangeY/m.height),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",n.descriptor.width,n.descriptor.height),g.drawArrays(5,0,4));g.bindVAO()}};d._loadWGLResources=function(g){if(!this._outlineProgram||!this._tileInfoProgram){var m=b.createProgram(g,h.background),n=b.createProgram(g,l.tileInfo),r={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},t=new Int8Array([0,0,1,0,1,1,0,1]);t=F.createVertex(g,35044,
t);t=new f(g,h.background.attributes,r,{geometry:t});var z=new Int8Array([0,0,1,0,0,1,1,1]);z=F.createVertex(g,35044,z);g=new f(g,l.tileInfo.attributes,r,{geometry:z});this._outlineProgram=m;this._tileInfoProgram=n;this._outlineVertexArrayObject=t;this._tileInfoVertexArrayObject=g}};d._getTexture=function(g,m){if(m.texture&&m.triangleCountReportedInDebug===m.triangleCount)return m.texture;m.triangleCountReportedInDebug=m.triangleCount;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id",
"canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const n=m.triangleCount;let r=m.key.id;0<m.triangleCount&&(r+=`, ${n}`);const t=this._canvas,z=t.getContext("2d");z.font="24px sans-serif";z.textAlign="left";z.textBaseline="top";z.clearRect(0,0,300,32);1E5<n?(z.fillStyle="red",z.fillRect(0,0,300,32),z.fillStyle="black"):(z.clearRect(0,0,300,32),z.fillStyle="blue");z.fillText(r,0,0);m.texture=new a(g,{target:3553,
pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071},t);return m.texture};return e}(c)})},"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["exports","./sources/resolver"],function(u,G){G={shaders:{vertexShader:G.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:G.resolveIncludes("tileInfo/tileInfo.frag")},attributes:new Map([["a_pos",0]])};u.tileInfo=G;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/vec4f32 ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../../core/has ../../../../webgl/checkWebGLError ../../../../webgl/enums ../../../../../chunks/builtins ../../../../webgl/programUtils ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ./WGLBrush ../shaders/BackgroundPrograms".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h){return function(l){function q(){var d=l.apply(this,arguments)||this;d._color=G.fromValues(1,0,0,1);d._initialized=!1;return d}u._inheritsLoose(q,l);var e=q.prototype;e.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};e.prepareState=function({context:d},g){d.setDepthWriteEnabled(!1);d.setDepthTestEnabled(!1);d.setStencilTestEnabled(!0);
d.setBlendingEnabled(!1);d.setColorMask(!1,!1,!1,!1);d.setStencilOp(7680,7680,7681);d.setStencilWriteMask(255);d.setStencilFunctionSeparate(1032,516,g.stencilRef,255)};e.draw=function(d,g){({context:d}=d);this._initialized||this._initialize(d);d.bindVAO(this._solidVertexArrayObject);d.useProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",g.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",[g.rangeX,g.rangeY]);this._solidProgram.setUniform1f("u_depth",0);
this._solidProgram.setUniform4fv("u_color",this._color);d.drawArrays(5,0,4);d.bindVAO()};e._initialize=function(d){if(this._initialized)return!0;const g=b.createProgram(d,h.background);if(!g)return!1;var m=new Int8Array([0,0,1,0,0,1,1,1]);m=F.createVertex(d,35044,m);d=new f(d,h.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:m});this._solidProgram=g;this._solidVertexArrayObject=d;return this._initialized=!0};return q}(c)})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../chunks/mat3f32 ../../../../../chunks/vec4f32 ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../../core/has ../../../../webgl/checkWebGLError ../../../../webgl/enums ../../../../../chunks/builtins ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../definitions ../enums ../number ./WGLBrush".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e,d,g){k=function(m){function n(){var t=m.apply(this,arguments)||this;t._color=v.fromValues(1,0,0,1);t._patternMatrix=y.create();t._programOptions={id:!1,pattern:!1};return t}G._inheritsLoose(n,m);var r=n.prototype;r.dispose=function(){this._vao&&(this._vao.dispose(),this._vao=null)};r.drawMany=function(t,z){const {context:w,painter:B,styleLayerUID:A}=t;this._loadWGLResources(t);const x=t.displayLevel;var E=t.styleLayer,D=E.backgroundMaterial;const K=B.vectorTilesMaterialManager;
var H=E.getPaintValue("background-color",x);const I=E.getPaintValue("background-opacity",x),J=E.getPaintValue("background-pattern",x),M=void 0!==J,O=H[3]*I,L=t.spriteMosaic;let S,Q;const P=(window.devicePixelRatio|1)>q.VTL_HIGH_RES_CUTOFF?2:1;t=t.drawPhase===e.WGLDrawPhase.HITTEST;const R=this._programOptions;R.id=t;R.pattern=M;D=K.getMaterialProgram(w,D,R);w.bindVAO(this._vao);w.useProgram(D);if(M){H=L.getMosaicItemPosition(J,!0);if(C.isSome(H)){const {tl:N,br:W,page:X}=H;S=W[0]-N[0];Q=W[1]-N[1];
H=L.getPageSize(X);C.isSome(H)&&(L.bind(w,9729,X,q.VTL_TEXTURE_BINDING_UNIT_SPRITES),D.setUniform4f("u_tlbr",N[0],N[1],W[0],W[1]),D.setUniform2fv("u_mosaicSize",H),D.setUniform1i("u_texture",q.VTL_TEXTURE_BINDING_UNIT_SPRITES))}D.setUniform1f("u_opacity",I)}else this._color[0]=O*H[0],this._color[1]=O*H[1],this._color[2]=O*H[2],this._color[3]=O,D.setUniform4fv("u_color",this._color);D.setUniform1f("u_depth",E.z||0);t&&(E=d.u32to4Xu8(A+1),D.setUniform4fv("u_id",E));for(const N of z)D.setUniform1f("u_coord_range",
N.rangeX),D.setUniformMatrix3fv("u_dvsMat3",N.transforms.dvs),M&&(E=P*N.width*Math.max(2**(Math.round(x)-N.key.level),1),z=E/F.nextPowerOfTwo(S),E/=F.nextPowerOfTwo(Q),this._patternMatrix[0]=z,this._patternMatrix[4]=E,D.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),w.setStencilFunction(514,N.stencilRef,255),w.drawArrays(5,0,4)};r._loadWGLResources=function(t){if(!this._vao){var {context:z,styleLayer:w}=t;t=w.backgroundMaterial;var B=new Int8Array([0,0,1,0,0,1,1,1]);B=p.createVertex(z,
35044,B);this._vao=new l(z,t.getAttributeLocations(),t.getLayoutInfo(),{geometry:B})}};return n}(g);u.WGLBrushVTLBackground=k;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../number ./WGLBrush".split(" "),function(u,G,F,C,y,v){v=function(p){function k(){var a=p.apply(this,arguments)||this;a._programOptions={id:!1};return a}G._inheritsLoose(k,
p);var b=k.prototype;b.dispose=function(){};b.drawMany=function(a,f){const {context:c,displayLevel:h,requiredLevel:l,state:q,drawPhase:e,painter:d,spriteMosaic:g,styleLayerUID:m}=a;if(f.some(A=>{var x,E;return null!=(x=null==(E=A.layerData.get(m))?void 0:E.circleIndexCount)?x:!1})){a=a.styleLayer;var n=a.circleMaterial,r=d.vectorTilesMaterialManager,t=a.getPaintValue("circle-translate",h),z=a.getPaintValue("circle-translate-anchor",h),w=e===C.WGLDrawPhase.HITTEST,B=this._programOptions;B.id=w;r=r.getMaterialProgram(c,
n,B);c.useProgram(r);r.setUniformMatrix3fv("u_displayMat3",1===z?q.displayMat3:q.displayViewMat3);r.setUniform2fv("u_circleTranslation",t);r.setUniform1f("u_depth",a.z);r.setUniform1f("u_antialiasingWidth",1.2);t=-1;w&&(w=y.u32to4Xu8(m+1),r.setUniform4fv("u_id",w));for(const A of f)A.layerData.has(m)&&(A.key.level!==t&&(t=A.key.level,n.setDataUniforms(r,h,a,t,g)),f=A.layerData.get(m),f.circleIndexCount&&(f.prepareForRendering(c),w=f.circleVertexArrayObject,F.isNone(w)||(c.bindVAO(w),r.setUniformMatrix3fv("u_dvsMat3",
A.transforms.dvs),l!==A.key.level?c.setStencilFunction(514,A.stencilRef,255):c.setStencilFunction(516,255,255),c.drawElements(4,f.circleIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*f.circleIndexStart),A.triangleCount+=f.circleIndexCount/3)))}};return k}(v);u.WGLBrushVTLCircle=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../enums ../number ./WGLBrush".split(" "),
function(u,G,F,C,y,v,p){const k=1/65536;p=function(b){function a(){var c=b.apply(this,arguments)||this;c._fillProgramOptions={id:!1,pattern:!1};c._outlineProgramOptions={id:!1};return c}G._inheritsLoose(a,b);var f=a.prototype;f.dispose=function(){};f.drawMany=function(c,h){const {displayLevel:l,drawPhase:q,renderPass:e,spriteMosaic:d,styleLayerUID:g}=c;var m=!1;for(var n of h)if(n.layerData.has(g)){var r=n.layerData.get(g);if(0<r.fillIndexCount||0<r.outlineIndexCount){m=!0;break}}if(m){m=c.styleLayer;
var t=m.getPaintProperty("fill-pattern");r=(n=void 0!==t)&&t.isDataDriven;if(n&&!r){var z=t.getValue(l);z=d.getMosaicItemPosition(z,!0)}t=!n&&m.getPaintValue("fill-antialias",l);var w=!0,B=1;if(!n){var A=m.getPaintProperty("fill-color"),x=m.getPaintProperty("fill-opacity");null!=A&&A.isDataDriven||null!=x&&x.isDataDriven||(B=m.getPaintValue("fill-color",l),B=m.getPaintValue("fill-opacity",l)*B[3],1<=B&&(w=!1))}if(!w||"opaque"!==e){var E;q===y.WGLDrawPhase.HITTEST&&(E=v.u32to4Xu8(g+1));A=m.getPaintValue("fill-translate",
l);x=m.getPaintValue("fill-translate-anchor",l);(w||"translucent"!==e)&&this._drawFill(c,g,m,h,A,x,n,z,r,E);z=!m.hasDataDrivenOutlineColor&&m.outlineUsesFillColor&&1>B;t&&"opaque"!==e&&!z&&this._drawOutline(c,g,m,h,A,x,E)}}};f._drawFill=function(c,h,l,q,e,d,g,m,n,r){if(!g||n||!F.isNone(m)){var {context:t,displayLevel:z,state:w,drawPhase:B,painter:A,pixelRatio:x,spriteMosaic:E}=c;c=l.fillMaterial;var D=A.vectorTilesMaterialManager,K=x>C.VTL_HIGH_RES_CUTOFF?2:1,H=B===y.WGLDrawPhase.HITTEST,I=this._fillProgramOptions;
I.id=H;I.pattern=g;D=D.getMaterialProgram(t,c,I);t.useProgram(D);F.isSome(m)&&({page:m}=m,I=E.getPageSize(m),F.isSome(I)&&(E.bind(t,9729,m,C.VTL_TEXTURE_BINDING_UNIT_SPRITES),D.setUniform2fv("u_mosaicSize",I),D.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES)));D.setUniformMatrix3fv("u_displayMat3",1===d?w.displayMat3:w.displayViewMat3);D.setUniform2fv("u_fillTranslation",e);D.setUniform1f("u_depth",l.z+k);H&&D.setUniform4fv("u_id",r);e=-1;for(const J of q)if(J.layerData.has(h)&&(J.key.level!==
e&&(e=J.key.level,c.setDataUniforms(D,z,l,e,E)),q=J.layerData.get(h),q.fillIndexCount&&(q.prepareForRendering(t),d=q.fillVertexArrayObject,!F.isNone(d)))){t.bindVAO(d);D.setUniformMatrix3fv("u_dvsMat3",J.transforms.dvs);t.setStencilFunction(514,J.stencilRef,255);g&&D.setUniform1f("u_patternFactor",J.rangeX/(K*J.width*Math.max(2**(Math.round(z)-J.key.level),1)));if(n){d=q.patternMap;if(!d)continue;for(const [M,O]of d)d=E.getPageSize(M),F.isSome(d)&&(E.bind(t,9729,M,C.VTL_TEXTURE_BINDING_UNIT_SPRITES),
D.setUniform2fv("u_mosaicSize",d),D.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES),t.drawElements(4,O[1],5125,Uint32Array.BYTES_PER_ELEMENT*O[0]))}else t.drawElements(4,q.fillIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*q.fillIndexStart);J.triangleCount+=q.fillIndexCount/3}}};f._drawOutline=function(c,h,l,q,e,d,g){const {context:m,displayLevel:n,state:r,drawPhase:t,painter:z,pixelRatio:w,spriteMosaic:B}=c;c=l.outlineMaterial;var A=z.vectorTilesMaterialManager;const x=.75/w,E=t===y.WGLDrawPhase.HITTEST,
D=this._outlineProgramOptions;D.id=E;A=A.getMaterialProgram(m,c,D);m.useProgram(A);A.setUniformMatrix3fv("u_displayMat3",1===d?r.displayMat3:r.displayViewMat3);A.setUniform2fv("u_fillTranslation",e);A.setUniform1f("u_depth",l.z+k);A.setUniform1f("u_outline_width",x);E&&A.setUniform4fv("u_id",g);e=-1;for(const K of q)K.layerData.has(h)&&(K.key.level!==e&&(e=K.key.level,c.setDataUniforms(A,n,l,e,B)),q=K.layerData.get(h),q.prepareForRendering(m),q.outlineIndexCount&&(d=q.outlineVertexArrayObject,F.isNone(d)||
(m.bindVAO(d),A.setUniformMatrix3fv("u_dvsMat3",K.transforms.dvs),m.setStencilFunction(514,K.stencilRef,255),m.drawElements(4,q.outlineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*q.outlineIndexStart),K.triangleCount+=q.outlineIndexCount/3)))};return a}(p);u.WGLBrushVTLFill=p;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../enums ../number ./WGLBrush".split(" "),
function(u,G,F,C,y,v,p){p=function(k){function b(){var f=k.apply(this,arguments)||this;f._programOptions={id:!1,pattern:!1,sdf:!1};return f}G._inheritsLoose(b,k);var a=b.prototype;a.dispose=function(){};a.drawMany=function(f,c){const {context:h,displayLevel:l,state:q,drawPhase:e,painter:d,pixelRatio:g,spriteMosaic:m,styleLayerUID:n}=f;if(c.some(J=>{var M,O;return null!=(M=null==(O=J.layerData.get(n))?void 0:O.lineIndexCount)?M:!1})){f=f.styleLayer;var r=f.lineMaterial,t=d.vectorTilesMaterialManager,
z=f.getPaintValue("line-translate",l),w=f.getPaintValue("line-translate-anchor",l),B=f.getPaintProperty("line-pattern"),A=void 0!==B,x=A&&B.isDataDriven;if(A&&!x){B=B.getValue(l);var E=m.getMosaicItemPosition(B)}var D;B=!1;if(!A){var K=f.getPaintProperty("line-dasharray");B=(D=void 0!==K)&&K.isDataDriven;D&&!B&&(E=K.getValue(l),E=f.getDashKey(E,f.getLayoutValue("line-cap",l)),E=m.getMosaicItemPosition(E))}K=1/g;var H=e===y.WGLDrawPhase.HITTEST,I=this._programOptions;I.id=H;I.pattern=A;I.sdf=D;D=t.getMaterialProgram(h,
r,I);h.useProgram(D);D.setUniformMatrix3fv("u_displayViewMat3",q.displayViewMat3);D.setUniformMatrix3fv("u_displayMat3",1===w?q.displayMat3:q.displayViewMat3);D.setUniform2fv("u_lineTranslation",z);D.setUniform1f("u_depth",f.z);D.setUniform1f("u_antialiasing",K);H&&(z=v.u32to4Xu8(n+1),D.setUniform4fv("u_id",z));E&&F.isSome(E)&&({page:z}=E,w=m.getPageSize(z),F.isSome(w)&&(m.bind(h,9729,z,C.VTL_TEXTURE_BINDING_UNIT_SPRITES),D.setUniform2fv("u_mosaicSize",w),D.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES)));
z=-1;for(const J of c)if(J.layerData.has(n)&&(J.key.level!==z&&(z=J.key.level,r.setDataUniforms(D,l,f,z,m)),D.setUniform1f("u_zoomFactor",2**(l-z)/g),c=J.layerData.get(n),c.lineIndexCount&&(c.prepareForRendering(h),w=c.lineVertexArrayObject,!F.isNone(w)))){h.bindVAO(w);D.setUniformMatrix3fv("u_dvsMat3",J.transforms.dvs);h.setStencilFunction(514,J.stencilRef,255);if(x||B){w=c.patternMap;if(!w)continue;for(const [M,O]of w)w=m.getPageSize(M),F.isSome(w)&&(m.bind(h,9729,M,C.VTL_TEXTURE_BINDING_UNIT_SPRITES),
D.setUniform2fv("u_mosaicSize",w),D.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES),h.drawElements(4,O[1],5125,Uint32Array.BYTES_PER_ELEMENT*O[0]))}else h.drawElements(4,c.lineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*c.lineIndexStart);J.triangleCount+=c.lineIndexCount/3}}};return b}(p);u.WGLBrushVTLLine=p;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec2f32 ../../vectorTiles/decluttering/config ../definitions ../enums ../GeometryUtils ../number ./WGLBrush".split(" "),
function(u,G,F,C,y,v,p,k,b,a){const f=1/65536;a=function(c){function h(){var q=c.apply(this,arguments)||this;q._iconProgramOptions={id:!1,sdf:!1};q._sdfProgramOptions={id:!1};q._spritesTextureSize=C.create();return q}G._inheritsLoose(h,c);var l=h.prototype;l.dispose=function(){};l.drawMany=function(q,e){const {drawPhase:d,styleLayerUID:g}=q,m=q.styleLayer;let n;d===p.WGLDrawPhase.HITTEST&&(n=b.u32to4Xu8(g+1));this._drawIcons(q,m,e,n);this._drawText(q,m,e,n)};l._drawIcons=function(q,e,d,g){const {context:m,
displayLevel:n,drawPhase:r,painter:t,spriteMosaic:z,state:w,styleLayerUID:B}=q,A=e.iconMaterial;var x=t.vectorTilesMaterialManager,E=!1;for(var D of d)if(D.layerData.has(B)){var K=D.layerData.get(B);if(0<K.iconPerPageElementsMap.size){E=!0;break}}if(E){E=e.getPaintValue("icon-translate",n);D=e.getPaintValue("icon-translate-anchor",n);var H=e.getLayoutValue("icon-rotation-alignment",n);2===H&&(H=0===e.getLayoutValue("symbol-placement",n)?1:0);var I=0===H;I=e.getLayoutValue("icon-keep-upright",n)&&
I;var J=K.isIconSDF;K=r===p.WGLDrawPhase.HITTEST;var M=this._iconProgramOptions;M.id=K;M.sdf=J;x=x.getMaterialProgram(m,A,M);m.useProgram(x);x.setUniformMatrix3fv("u_displayViewMat3",0===H?w.displayViewMat3:w.displayMat3);x.setUniformMatrix3fv("u_displayMat3",1===D?w.displayMat3:w.displayViewMat3);x.setUniform2fv("u_iconTranslation",E);x.setUniform1f("u_depth",e.z);x.setUniform1f("u_mapRotation",k.degToByte(w.rotation));x.setUniform1f("u_keepUpright",I?1:0);x.setUniform1f("u_level",10*n);x.setUniform1i("u_texture",
v.VTL_TEXTURE_BINDING_UNIT_SPRITES);x.setUniform1f("u_fadeDuration",y.FADE_DURATION/1E3);K&&x.setUniform4fv("u_id",g);g=-1;for(const O of d)if(O.layerData.has(B)&&(O.key.level!==g&&(g=O.key.level,A.setDataUniforms(x,n,e,g,z)),K=O.layerData.get(B),0!==K.iconPerPageElementsMap.size&&(K.prepareForRendering(m),K.updateOpacityInfo(),d=K.iconVertexArrayObject,!F.isNone(d)))){m.bindVAO(d);x.setUniformMatrix3fv("u_dvsMat3",O.transforms.dvs);x.setUniform1f("u_time",(performance.now()-K.lastOpacityUpdate)/
1E3);for(const [L,S]of K.iconPerPageElementsMap)this._renderIconRange(q,x,S,L,O)}}};l._renderIconRange=function(q,e,d,g,m){const {context:n,spriteMosaic:r}=q;this._spritesTextureSize[0]=r.getWidth(g)/4;this._spritesTextureSize[1]=r.getHeight(g)/4;e.setUniform2fv("u_mosaicSize",this._spritesTextureSize);r.bind(n,9729,g,v.VTL_TEXTURE_BINDING_UNIT_SPRITES);n.setStencilTestEnabled(!0);n.setStencilFunction(516,255,255);n.setStencilWriteMask(0);n.drawElements(4,d[1],5125,Uint32Array.BYTES_PER_ELEMENT*d[0]);
m.triangleCount+=d[1]/3};l._drawText=function(q,e,d,g){const {context:m,displayLevel:n,drawPhase:r,glyphMosaic:t,painter:z,pixelRatio:w,spriteMosaic:B,state:A,styleLayerUID:x}=q;q=e.textMaterial;const E=z.vectorTilesMaterialManager;var D=!1;for(var K of d)if(K.layerData.has(x)){var H=K.layerData.get(x);if(0<H.glyphPerPageElementsMap.size){D=!0;break}}if(D&&(H=e.getPaintProperty("text-opacity"),!H||H.isDataDriven||0!==H.getValue(n))){H=e.getPaintProperty("text-color");var I=!H||H.isDataDriven||0<H.getValue(n)[3];
H=e.getPaintProperty("text-halo-width");K=e.getPaintProperty("text-halo-color");var J=(!H||H.isDataDriven||0<H.getValue(n))&&(!K||K.isDataDriven||0<K.getValue(n)[3]);if(I||J){H=e.getLayoutValue("text-rotation-alignment",n);2===H&&(H=0===e.getLayoutValue("symbol-placement",n)?1:0);K=0===H;K=e.getLayoutValue("text-keep-upright",n)&&K;D=r===p.WGLDrawPhase.HITTEST;var M=.8*3/w;this._glyphTextureSize||(this._glyphTextureSize=C.fromValues(t.width/4,t.height/4));var O=e.getPaintValue("text-translate",n),
L=e.getPaintValue("text-translate-anchor",n),S=this._sdfProgramOptions;S.id=D;var Q=E.getMaterialProgram(m,q,S);m.useProgram(Q);Q.setUniformMatrix3fv("u_displayViewMat3",0===H?A.displayViewMat3:A.displayMat3);Q.setUniformMatrix3fv("u_displayMat3",1===L?A.displayMat3:A.displayViewMat3);Q.setUniform2fv("u_textTranslation",O);Q.setUniform1f("u_depth",e.z+f);Q.setUniform2fv("u_mosaicSize",this._glyphTextureSize);Q.setUniform1f("u_mapRotation",k.degToByte(A.rotation));Q.setUniform1f("u_keepUpright",K?
1:0);Q.setUniform1f("u_level",10*n);Q.setUniform1i("u_texture",v.VTL_TEXTURE_BINDING_UNIT_GLYPHS);Q.setUniform1f("u_antialiasingWidth",M);Q.setUniform1f("u_fadeDuration",y.FADE_DURATION/1E3);D&&Q.setUniform4fv("u_id",g);g=-1;for(const P of d)P.layerData.has(x)&&(P.key.level!==g&&(g=P.key.level,q.setDataUniforms(Q,n,e,g,B)),H=P.layerData.get(x),0!==H.glyphPerPageElementsMap.size&&(H.prepareForRendering(m),H.updateOpacityInfo(),d=H.textVertexArrayObject,F.isNone(d)||(m.bindVAO(d),Q.setUniformMatrix3fv("u_dvsMat3",
P.transforms.dvs),m.setStencilTestEnabled(!0),m.setStencilFunction(516,255,255),m.setStencilWriteMask(0),d=(performance.now()-H.lastOpacityUpdate)/1E3,Q.setUniform1f("u_time",d),H.glyphPerPageElementsMap.forEach((R,N)=>{this._renderGlyphRange(m,R,N,t,Q,J,I,P)}))))}}};l._renderGlyphRange=function(q,e,d,g,m,n,r,t){g.bind(q,9729,d,v.VTL_TEXTURE_BINDING_UNIT_GLYPHS);n&&(m.setUniform1f("u_halo",1),q.drawElements(4,e[1],5125,Uint32Array.BYTES_PER_ELEMENT*e[0]),t.triangleCount+=e[1]/3);r&&(m.setUniform1f("u_halo",
0),q.drawElements(4,e[1],5125,Uint32Array.BYTES_PER_ELEMENT*e[0]),t.triangleCount+=e[1]/3)};return h}(a);u.WGLBrushVTLSymbol=a;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/config":function(){define(["exports"],function(u){u.COLLISION_GRID_CELL_SIZE=32;u.DECLUTTER_BUDGET=1.5;u.DECLUTTER_TILES=!0;u.FADE_DURATION=200;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["exports"],function(u){function G(k,
b){k%=b;return 0<=k?k:k+b}const F=Number.POSITIVE_INFINITY,C=Math.PI,y=128/C,v=256/360,p=1/Math.LN2;u.C_256_TO_RAD=C/128;u.C_2PI=2*C;u.C_DEG_TO_256=v;u.C_DEG_TO_RAD=C/180;u.C_INFINITY=F;u.C_PI=C;u.C_PI_BY_2=C/2;u.C_RAD_TO_256=y;u.C_SQRT2=1.414213562;u.C_SQRT2_INV=1/1.414213562;u.between=function(k,b,a){return k>=b&&k<=a||k>=a&&k<=b};u.degToByte=function(k){return G(k*v,256)};u.interpolate=function(k,b,a){return k*(1-a)+b*a};u.log2=function(k){return Math.log(k)*p};u.positiveMod=G;u.radToByte=function(k){return G(k*
y,256)};u.sqr=function(k){return k*k};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/RandomLCG ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../../core/has ../../../../webgl/checkWebGLError ../../../../webgl/enums ../../../../../chunks/builtins ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../definitions ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q){return function(e){function d(){var m=e.apply(this,arguments)||this;m._dotTextureSize=0;m._dotTextures=null;m._dotSamplers=new Int32Array([f.TEXTURE_BINDING_RENDERER_0,f.TEXTURE_BINDING_RENDERER_1]);return m}u._inheritsLoose(d,e);var g=d.prototype;g.dispose=function(){this._disposeTextures()};g.getGeometryType=function(){return c.WGLGeometryType.FILL};g.drawGeometry=function(m,n,r,t){const {context:z,painter:w,rendererInfo:B,requiredLevel:A}=m;var x=q.FillMaterialKey.load(r.materialKey);
var E={geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:3,type:5121},{location:2,name:"a_bitset",count:1,type:5121}]};x.dotDensity?E.geometry.push({location:3,name:"a_inverseArea",count:1,type:5126}):(E.geometry.push({location:3,name:"a_color",count:4,type:5121,normalized:!0}),x.simple||E.geometry.push({location:4,name:"a_aux1",count:4,type:5123}),E.geometry.push({location:5,name:"a_aux2",count:4,type:5121},{location:6,name:"a_aux3",count:4,type:5121}),x.simple||
E.geometry.push({location:7,name:"a_zoomRange",count:2,type:5123}));E=h.createProgramDescriptor(x.data,E);const {bufferLayouts:D,attributes:K}=E;t=w.materialManager.getMaterialProgram(m,x,"materials/fill",K,t);z.useProgram(t);this._setSharedUniforms(t,m,n);t.setUniform2f("u_tileOffset",512*n.key.col,512*n.key.row);x.textureBinding&&(w.textureManager.bindTextures(z,t,x),t.setUniform1f("u_zoomFactor",1/2**(A-n.key.level)/m.pixelRatio));E=1/m.pixelRatio;t.setUniform1f("u_blur",E);t.setUniform1f("u_antialiasing",
E);this._setSizeVVUniforms(x,t,B,n);this._setColorAndOpacityVVUniforms(x,t,B);if(x.dotDensity){x=f.TILE_SIZE/B.ddDotSize;E=x*window.devicePixelRatio*x*window.devicePixelRatio;n=1/2**(A-n.key.level);const H=1/n*(1/n);m=B.ddDotScale?m.state.scale/B.ddDotScale:1;t.setUniform1f("u_tileZoomFactor",n);t.setUniform1f("u_tileDotsOverArea",E/(f.TILE_SIZE*window.devicePixelRatio*f.TILE_SIZE*window.devicePixelRatio));t.setUniformMatrix4fv("u_dotColors",B.ddColors);t.setUniform4fv("u_isActive",B.ddActiveDots);
t.setUniform4fv("u_dotBackgroundColor",B.ddBackgroundColor);t.setUniform1f("u_dotValue",Math.max(1,B.ddDotValue*m*H));this._bindDotDensityTextures(z,t,B,x)}r.draw(z,D,K)};g._disposeTextures=function(){if(this._dotTextures){for(let m=0;m<this._dotTextures.length;m++)this._dotTextures[m].dispose();this._dotTextures=null}};g._bindDotDensityTextures=function(m,n,r,t){r=this._createDotDensityTextures(m,t,r.ddSeed);n.setUniform1iv("u_dotTextures",this._dotSamplers);for(n=0;n<r.length;n++)m.bindTexture(r[n],
this._dotSamplers[n])};g._createDotDensityTextures=function(m,n,r){if(this._dotTextureSize!==n||this._seed!==r)this._disposeTextures(),this._dotTextureSize=n,this._seed=r;null===this._dotTextures&&(r=new G(r),this._dotTextures=[this._allocDotDensityTexture(m,n,r),this._allocDotDensityTexture(m,n,r)]);return this._dotTextures};g._allocDotDensityTexture=function(m,n,r){const t=new Float32Array(n*n*4);for(let z=0;z<t.length;z++)t[z]=r.getFloat();return new b(m,{wrapMode:10497,pixelFormat:6408,dataType:5126,
samplingMode:9728,width:n,height:n},t)};return d}(l)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions","./WGLBrush"],function(u,G,F,C){return function(y){function v(){return y.apply(this,arguments)||this}u._inheritsLoose(v,y);var p=v.prototype;p.prepareState=function({context:k},b,a){a=a&&-1!==a.indexOf("id");k.setBlendingEnabled(!a);k.setBlendFunctionSeparate(1,771,1,771);k.setColorMask(!0,
!0,!0,!0);k.setStencilWriteMask(0);k.setStencilTestEnabled(!0);k.setStencilFunction(514,b.stencilRef,255)};p.draw=function(k,b,a){var f=this.getGeometryType();b.commit(k);f=b.getGeometry(f);G.isNone(f)||(k.timeline.begin(this.name),k.attributeView.bindTextures(k.context),f.forEachCommand(c=>this.drawGeometry(k,b,c,a)))};p._setSharedUniforms=function(k,b,a){const {displayLevel:f,pixelRatio:c,state:h}=b;k.setUniform1f("u_pixelRatio",c);k.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs,!1,!0);k.setUniformMatrix3fv("u_displayViewMat3",
h.displayViewMat3,!1,!0);k.setUniform1f("u_currentZoom",Math.round(f*F.MIN_MAX_ZOOM_PRECISION_FACTOR));k.setUniform1i("u_attributeTextureSize",b.attributeView.size);k.setUniform1i("u_attributeData0",F.TEXTURE_BINDING_ATTRIBUTE_DATA_0);k.setUniform1i("u_attributeData1",F.TEXTURE_BINDING_ATTRIBUTE_DATA_1);k.setUniform1i("u_attributeData2",F.TEXTURE_BINDING_ATTRIBUTE_DATA_2);k.setUniform1i("u_attributeData3",F.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};p._setSizeVVUniforms=function(k,b,a,f){k.vvSizeMinMaxValue&&
b.setUniform4fv("u_vvSizeMinMaxValue",a.vvSizeMinMaxValue);k.vvSizeScaleStops&&b.setUniform1f("u_vvSizeScaleStopsValue",a.vvSizeScaleStopsValue);k.vvSizeFieldStops&&(f=a.getSizeVVFieldStops(f.key.level),b.setUniform1fv("u_vvSizeFieldStopsValues",f.values),b.setUniform1fv("u_vvSizeFieldStopsSizes",f.sizes));k.vvSizeUnitValue&&b.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",a.vvSizeUnitValueToPixelsRatio)};p._setColorAndOpacityVVUniforms=function(k,b,a){k.vvColor&&(b.setUniform1fv("u_vvColorValues",
a.vvColorValues),b.setUniform4fv("u_vvColors",a.vvColors));k.vvOpacity&&(b.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),b.setUniform1fv("u_vvOpacities",a.vvOpacities))};p._setRotationVVUniforms=function(k,b,a){k.vvRotation&&b.setUniform1f("u_vvRotationType","geographic"===a.vvMaterialParameters.vvRotationType?0:1)};return v}(C)})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error",
"../enums","../mesh/templates/meshUtils"],function(u,G,F,C,y){function v(d,g){const m=C.WGLVVFlag.SIZE_FIELD_STOPS|C.WGLVVFlag.SIZE_MINMAX_VALUE|C.WGLVVFlag.SIZE_SCALE_STOPS|C.WGLVVFlag.SIZE_UNIT_VALUE;d=(d&(C.WGLVVTarget.FIELD_TARGETS_OUTLINE|C.WGLVVTarget.MINMAX_TARGETS_OUTLINE|C.WGLVVTarget.SCALE_TARGETS_OUTLINE|C.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return g.isOutline||g.isOutlinedFill?m&d:m&~d}let p=function(){function d(m){this._data=0;this._data=m}d.load=function(m){const n=this.shared;n.data=
m;return n};var g=d.prototype;g.setBit=function(m,n){m=1<<m;this._data=n?this._data|m:this._data&~m};g.bit=function(m){return(this._data&1<<m)>>m};g.setBits=function(m,n,r){for(let t=n,z=0;t<r;t++,z++)this.setBit(t,0!==(m&1<<z))};g.bits=function(m,n){let r=0;for(let t=m,z=0;t<n;t++,z++)r|=this.bit(t)<<z;return r};g.hasVV=function(){return!1};g.setVV=function(m,n){};g.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}};g.getVariationHash=function(){return this._data&
~(7&this.textureBinding)};G._createClass(d,[{key:"data",get:function(){return this._data},set:function(m){this._data=m}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(m){this.setBits(m,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(m){this.setBit(20,m)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(m){this.setBit(11,m)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(m){this.setBit(12,m)}},{key:"textureBinding",
get:function(){return this.bits(0,8)},set:function(m){this.setBits(m,0,8)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case C.WGLGeometryType.FILL:return"fill";case C.WGLGeometryType.MARKER:return"marker";case C.WGLGeometryType.LINE:return"line";case C.WGLGeometryType.TEXT:return"text";case C.WGLGeometryType.LABEL:return"label";default:throw new F(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return d}();p.shared=new p(0);const k=d=>function(g){function m(){return g.apply(this,
arguments)||this}G._inheritsLoose(m,g);var n=m.prototype;n.hasVV=function(){return g.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};n.setVV=function(r,t){g.prototype.setVV.call(this,r,t);r&=v(r,t);this.vvSizeMinMaxValue=!!(r&C.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(r&C.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(r&C.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(r&C.WGLVVFlag.SIZE_SCALE_STOPS)};G._createClass(m,
[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(r){this.setBit(16,r)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(r){this.setBit(17,r)}},{key:"vvSizeFieldStops",get:function(){return 0!==this.bit(18)},set:function(r){this.setBit(18,r)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(r){this.setBit(19,r)}}]);return m}(d),b=d=>function(g){function m(){return g.apply(this,arguments)||this}G._inheritsLoose(m,
g);var n=m.prototype;n.hasVV=function(){return g.prototype.hasVV.call(this)||this.vvRotation};n.setVV=function(r,t){g.prototype.setVV.call(this,r,t);this.vvRotation=!t.isOutline&&!!(r&C.WGLVVFlag.ROTATION)};G._createClass(m,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},set:function(r){this.setBit(15,r)}}]);return m}(d),a=d=>function(g){function m(){return g.apply(this,arguments)||this}G._inheritsLoose(m,g);var n=m.prototype;n.hasVV=function(){return g.prototype.hasVV.call(this)||this.vvColor};
n.setVV=function(r,t){g.prototype.setVV.call(this,r,t);this.vvColor=!t.isOutline&&!!(r&C.WGLVVFlag.COLOR)};G._createClass(m,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(r){this.setBit(13,r)}}]);return m}(d),f=d=>function(g){function m(){return g.apply(this,arguments)||this}G._inheritsLoose(m,g);var n=m.prototype;n.hasVV=function(){return g.prototype.hasVV.call(this)||this.vvOpacity};n.setVV=function(r,t){g.prototype.setVV.call(this,r,t);this.vvOpacity=!t.isOutline&&!!(r&C.WGLVVFlag.OPACITY)};
G._createClass(m,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(r){this.setBit(14,r)}}]);return m}(d);let c=function(d){function g(){return d.apply(this,arguments)||this}G._inheritsLoose(g,d);g.load=function(m){const n=this.shared;n.data=m;return n};g.from=function(m){const n=this.load(0);n.geometryType=C.WGLGeometryType.FILL;n.dotDensity="dot-density"===m.stride.fill;n.simple="simple"===m.stride.fill;n.outlinedFill=m.isOutlinedFill;n.dotDensity||n.setVV(m.vvFlags,m);return n.data};
g.prototype.getVariation=function(){return{...d.prototype.getVariation.call(this),dotDensity:this.dotDensity,outlinedFill:this.outlinedFill,simple:this.simple,vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};G._createClass(g,[{key:"dotDensity",get:function(){return!!this.bit(15)},set:function(m){this.setBit(15,m)}},{key:"simple",get:function(){return!!this.bit(22)},
set:function(m){this.setBit(22,m)}},{key:"outlinedFill",get:function(){return!!this.bit(21)},set:function(m){this.setBit(21,m)}}]);return g}(a(f(k(p))));c.shared=new c(0);let h=function(d){function g(){return d.apply(this,arguments)||this}G._inheritsLoose(g,d);g.load=function(m){const n=this.shared;n.data=m;return n};g.from=function(m){const n=this.load(0);n.geometryType=C.WGLGeometryType.MARKER;n.setVV(m.vvFlags,m);return n.data};g.prototype.getVariation=function(){return{...d.prototype.getVariation.call(this),
vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return g}(a(f(b(k(p)))));h.shared=new h(0);let l=function(d){function g(){return d.apply(this,arguments)||this}G._inheritsLoose(g,d);g.load=function(m){const n=this.shared;n.data=m;return n};g.from=function(m){const n=this.load(0);n.geometryType=C.WGLGeometryType.LINE;n.setVV(m.vvFlags,
m);return n.data};g.prototype.getVariation=function(){return{...d.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return g}(a(f(k(p))));l.shared=new l(0);let q=function(d){function g(){return d.apply(this,arguments)||this}G._inheritsLoose(g,d);g.load=function(m){const n=this.shared;n.data=m;return n};g.from=function(m){const n=
this.load(0);n.geometryType=C.WGLGeometryType.TEXT;n.setVV(m.vvFlags,m);return n.data};g.prototype.getVariation=function(){return{...d.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return g}(a(f(b(k(p)))));q.shared=new q(0);let e=function(d){function g(){return d.apply(this,arguments)||
this}G._inheritsLoose(g,d);g.load=function(m){const n=this.shared;n.data=m;return n};g.from=function(m){const n=this.load(0);n.geometryType=C.WGLGeometryType.LABEL;n.setVV(m.vvFlags,m);n.mapAligned=y.isMapAligned(m.placement);return n.data};g.prototype.getVariation=function(){return{...d.prototype.getVariation.call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return g}(k(p));e.shared=
new e(0);u.FillMaterialKey=c;u.LabelMaterialKey=e;u.LineMaterialKey=l;u.MarkerMaterialKey=h;u.MaterialKeyBase=p;u.TextMaterialKey=q;u.createMaterialKey=function(d,g){switch(d){case C.WGLGeometryType.FILL:return c.from(g);case C.WGLGeometryType.LINE:return l.from(g);case C.WGLGeometryType.MARKER:return h.from(g);case C.WGLGeometryType.TEXT:return q.from(g);case C.WGLGeometryType.LABEL:return e.from(g);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${d}`);}};u.getSizeFlagsMask=
v;u.hydrateMaterialKey=function(d){switch(p.load(d).geometryType){case C.WGLGeometryType.MARKER:return new h(d);case C.WGLGeometryType.FILL:return new c(d);case C.WGLGeometryType.LINE:return new l(d);case C.WGLGeometryType.TEXT:return new q(d);case C.WGLGeometryType.LABEL:return new e(d)}};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/meshUtils":function(){define(["exports"],function(u){u.isMapAligned=function(G){switch(G){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;
default:return!1}};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","../Utils","./WGLGeometryBrush","../materialKey/MaterialKey"],function(u,G,F,C,y){return function(v){function p(){return v.apply(this,arguments)||this}u._inheritsLoose(p,v);var k=p.prototype;k.dispose=function(){};k.getGeometryType=function(){return G.WGLGeometryType.LABEL};k.drawGeometry=function(b,
a,f,c){const {context:h,painter:l,state:q,rendererInfo:e}=b,d=y.LabelMaterialKey.load(f.materialKey),g=d.mapAligned?1:0;if(g||!(1<=Math.abs(a.key.level-Math.round(100*b.displayLevel)/100))){var {bufferLayouts:m,attributes:n}=F.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texAndSize",
count:4,type:5121},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_glyphData",count:4,type:5121},{location:7,name:"a_vertexOffset",count:2,type:5122},{location:8,name:"a_texCoords",count:2,type:5123}]});c=l.materialManager.getMaterialProgram(b,d,"materials/label",n,c);b.context.setStencilFunction(514,0,255);h.useProgram(c);this._setSharedUniforms(c,b,a);l.textureManager.bindTextures(h,c,d);var r=1===g?q.displayViewMat3:q.displayMat3;this._setSizeVVUniforms(d,
c,e,a);c.setUniform1f("u_mapRotation",Math.floor(q.rotation/360*254));c.setUniform1f("u_mapAligned",g);c.setUniformMatrix3fv("u_displayMat3",r);c.setUniform1f("u_opacity",1);c.setUniform2fv("u_screenSize",b.state.size);c.setUniform1f("u_isHalo",1);f.draw(h,m,n);c.setUniform1f("u_isHalo",0);f.draw(h,m,n);h.setStencilTestEnabled(!0);h.setBlendingEnabled(!0)}};return p}(C)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../enums","../Utils","./WGLGeometryBrush","../materialKey/MaterialKey"],function(u,G,F,C,y){return function(v){function p(){return v.apply(this,arguments)||this}u._inheritsLoose(p,v);var k=p.prototype;k.dispose=function(){};k.getGeometryType=function(){return G.WGLGeometryType.LINE};k.drawGeometry=function(b,a,f,c){const {context:h,painter:l,rendererInfo:q,displayLevel:e}=b,d=y.LineMaterialKey.load(f.materialKey),{bufferLayouts:g,attributes:m}=F.createProgramDescriptor(d.data,{geometry:[{location:0,
name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123},{location:8,name:"a_zoomRange",count:2,type:5123}]});c=l.materialManager.getMaterialProgram(b,
d,"materials/line",m,c);const n=1/b.pixelRatio;h.useProgram(c);this._setSharedUniforms(c,b,a);d.textureBinding&&l.textureManager.bindTextures(h,c,d);c.setUniform1f("u_zoomFactor",2**(e-a.key.level)/b.pixelRatio);c.setUniform1f("u_blur",0+n);c.setUniform1f("u_antialiasing",n);this._setSizeVVUniforms(d,c,q,a);this._setColorAndOpacityVVUniforms(d,c,q);h.setFaceCullingEnabled(!1);f.draw(h,g,m)};return p}(C)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../enums","../Utils","./WGLGeometryBrush","../materialKey/MaterialKey"],function(u,G,F,C,y){return function(v){function p(){return v.apply(this,arguments)||this}u._inheritsLoose(p,v);var k=p.prototype;k.dispose=function(){};k.getGeometryType=function(){return G.WGLGeometryType.MARKER};k.drawGeometry=function(b,a,f,c){const {context:h,painter:l,rendererInfo:q,state:e}=b,d=y.MarkerMaterialKey.load(f.materialKey),{bufferLayouts:g,attributes:m}=F.createProgramDescriptor(d.data,{geometry:[{location:0,
name:"a_pos",count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:2,type:5123},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121},{location:8,name:"a_zoomRange",count:2,type:5123}]});c=l.materialManager.getMaterialProgram(b,
d,"materials/icon",m,c);h.useProgram(c);d.textureBinding&&l.textureManager.bindTextures(h,c,d,!0);this._setSharedUniforms(c,b,a);c.setUniformMatrix3fv("u_displayMat3",d.vvRotation?e.displayViewMat3:e.displayMat3);this._setSizeVVUniforms(d,c,q,a);this._setColorAndOpacityVVUniforms(d,c,q);this._setRotationVVUniforms(d,c,q);f.draw(h,g,m)};return p}(C)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","../Utils",
"./WGLGeometryBrush","../materialKey/MaterialKey"],function(u,G,F,C,y){return function(v){function p(){return v.apply(this,arguments)||this}u._inheritsLoose(p,v);var k=p.prototype;k.dispose=function(){};k.getGeometryType=function(){return G.WGLGeometryType.TEXT};k.drawGeometry=function(b,a,f,c){const {context:h,painter:l,rendererInfo:q,state:e}=b,d=y.TextMaterialKey.load(f.materialKey),{bufferLayouts:g,attributes:m}=F.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},
{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:5121},{location:5,name:"a_aux",count:4,type:5120},{location:6,name:"a_zoomRange",count:2,type:5123},{location:7,name:"a_vertexOffset",count:2,type:5122},{location:8,name:"a_texCoords",count:2,type:5123}]});c=l.materialManager.getMaterialProgram(b,d,"materials/text",m,c);h.useProgram(c);this._setSharedUniforms(c,
b,a);l.textureManager.bindTextures(h,c,d);c.setUniformMatrix3fv("u_displayMat3",e.displayMat3);c.setUniformMatrix3fv("u_displayViewMat3",e.displayViewMat3);this._setSizeVVUniforms(d,c,q,a);this._setColorAndOpacityVVUniforms(d,c,q);this._setRotationVVUniforms(d,c,q);c.setUniform1f("u_isHalo",1);f.draw(h,g,m);c.setUniform1f("u_isHalo",0);f.draw(h,g,m)};return p}(C)})},"esri/views/2d/engine/webgl/brushes/raster/BrushRasterBitmap":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers",
"../../../RasterBitmap","../../VertexStream","../WGLBrush","../../../../../webgl/rasterUtils"],function(u,G,F,C,y){return function(v){function p(){var b=v.apply(this,arguments)||this;b._desc={lut:{vsPath:"raster/lut",fsPath:"raster/lut",attributes:new Map([["a_position",0],["a_texcoord",1]])},stretch:{vsPath:"raster/stretch",fsPath:"raster/stretch",attributes:new Map([["a_position",0],["a_texcoord",1]])},hillshade:{vsPath:"raster/hillshade",fsPath:"raster/hillshade",attributes:new Map([["a_position",
0],["a_texcoord",1]])}};b._rendererUniformInfos=new Map;return b}u._inheritsLoose(p,v);var k=p.prototype;k.dispose=function(){this._quad&&this._quad.dispose()};k.prepareState=function({context:b},a){b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(1,771,1,771);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0);b.setStencilFunction(514,a.stencilRef,255)};k.draw=function(b,a){var f;if(G.hasSource(a)&&!a.suspended){b.timeline.begin(this.name);var c=!(null!=(f=b.context.capabilities.textureFloat)&&
f.textureFloatLinear);a.updateTexture(b);f=this.getShaderVariations(a,c);f=b.painter.materialManager.getProgram(b,this._desc[a.symbolizerParameters.type],f);this.drawWithProgram(b.context,f,a);b.timeline.end(this.name)}};k.drawWithProgram=function(b,a,f,c=1,h=[0,0],l=!1){this._quad||(this._quad=new F(b,[0,0,1,0,0,1,1,1]));const {symbolizerParameters:q,transformGrid:e,width:d,height:g,opacity:m}=f;var n=q.type;b.useProgram(a);const r=this.getShaderVariations(f);n=this.getUniformInfos(n,b,a,r);const {names:t,
textures:z}=f.getTextures();y.setTextures(b,a,t,z);b=y.getBasicGridUniforms(c,h);l=y.getCommonUniforms(e,[d,g],[f.source.width,f.source.height],m,l);y.setUniforms(a,n,{u_coordScale:f.coordScale,u_dvsMat3:f.transforms.dvs,...b,...l});if(q.colormap){const {colormap:w,colormapOffset:B}=q;f=y.getColormapUniforms(w,B);y.setUniforms(a,n,f)}"stretch"===q.type?(f=y.getStretchUniforms(q),y.setUniforms(a,n,f)):"hillshade"===q.type&&(f=y.getShadedReliefUniforms(q),y.setUniforms(a,n,f));this._quad.draw()};k.getUniformInfos=
function(b,a,f,c){b=0<c.length?b+"-"+c.join("-"):b;if(this._rendererUniformInfos.has(b))return this._rendererUniformInfos.get(b);a=y.getUniformLocationInfos(a,f);this._rendererUniformInfos.set(b,a);return a};k.getShaderVariations=function(b,a=!1){const f=[],{interpolation:c}=b,{type:h,colormap:l}=b.symbolizerParameters;"cubic"===c?f.push("bicubic"):"bilinear"===c&&"stretch"===h&&null!=l?(f.push("bilinear"),f.push("nnedge")):a&&"bilinear"===c&&f.push("bilinear");b.isRendereredSource?f.push("noop"):
l&&f.push("applyColormap");b.transformGrid&&f.push("applyProjection");return f};return p}(C)})},"esri/views/2d/engine/RasterBitmap":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/mat3 ../../../chunks/mat3f32 ../../../chunks/vec2f32 ../../../layers/support/rasterFunctions/pixelUtils ./DisplayObject ../../webgl/rasterUtils".split(" "),function(u,G,F,C,y,v,p,k,b){const a={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],
factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,stretchType:"none",type:"stretch"};k=function(c){function h(q=null,e=null,d=null){var g=c.call(this)||this;g._textureInvalidated=!0;g._colormapTextureInvalidated=!0;g._supportsBilinearTexture=!0;g.stencilRef=0;g.coordScale=[1,1];g._symbolizerParameters=null;g.height=null;g.isRendereredSource=!1;g.pixelRatio=1;g.resolution=0;g.rotation=0;g._source=null;g.rawPixelData=null;g._suspended=!1;
g._bandIds=null;g._interpolation=null;g._transformGrid=null;g.width=null;g.x=0;g.y=0;g.source=q;g.transformGrid=e;g.interpolation=d;return g}G._inheritsLoose(h,c);var l=h.prototype;l.destroy=function(){const q=this.getTextures();null==q?void 0:q.textures.forEach(e=>e.dispose());this._colormapTexture=this._transformGridTexture=this._rasterTexture=null};l.invalidateTexture=function(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRender())};l._createTransforms=function(){return{dvs:y.create()}};
l.setTransform=function(q){const e=C.identity(this.transforms.dvs),[d,g]=q.toScreenNoRotation([0,0],[this.x,this.y]);var m=this.resolution/this.pixelRatio/q.resolution;const n=m*this.width;m*=this.height;const r=Math.PI*this.rotation/180;C.translate(e,e,v.fromValues(d,g));C.translate(e,e,v.fromValues(n/2,m/2));C.rotate(e,e,-r);C.translate(e,e,v.fromValues(-n/2,-m/2));C.scaleByVec2(e,e,v.fromValues(n,m));C.multiply(this.transforms.dvs,q.displayViewMat3,e)};l.getTextures=function(){if(!this._rasterTexture)return null;
const q=[],e=[];this._transformGridTexture&&(e.push(this._transformGridTexture),q.push("u_transformGrid"));this._rasterTexture&&(e.push(this._rasterTexture),q.push("u_image"));this._colormapTexture&&(e.push(this._colormapTexture),q.push("u_colormap"));return{names:q,textures:e}};l.onAttach=function(){this.invalidateTexture()};l.onDetach=function(){this.invalidateTexture()};l.updateTexture=function({context:q}){if(this.stage){var e=this._isValidSource(this.source);e&&this._colormapTextureInvalidated&&
(this._colormapTextureInvalidated=!1,this._updateColormapTexture(q));this._textureInvalidated&&(this._textureInvalidated=!1,this._createOrDestroyRasterTexture(q),this._rasterTexture&&(e?this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=b.createTransformTexture(q,this.transformGrid)):this._rasterTexture.setData(null)),this.suspended||(this.ready(),this.requestRender()))}else{var d,g;null==(e=this._rasterTexture)?void 0:e.dispose();null==(d=this._transformGridTexture)?void 0:
d.dispose();null==(g=this._colormapTexture)?void 0:g.dispose();this._colormapTexture=this._transformGridTexture=this._rasterTextureBandIds=this._rasterTexture=null}};l._createOrDestroyRasterTexture=function(q){var e,d;const g=F.isSome(this.source)?p.extractBands(this.source,this.bandIds):null;if(this._isValidSource(g)){var m=!this._isBandIdschanged(this.bandIds);if(this._rasterTexture){if(m)return;this._rasterTexture.dispose();this._rasterTexture=this._rasterTextureBandIds=null}this._supportsBilinearTexture=
null==(e=q.capabilities.textureFloat)?void 0:e.textureFloatLinear;e=this._getTextureSamplingMethod(this.interpolation);m=this.isRendereredSource||!(null!=(d=q.capabilities.textureFloat)&&d.textureFloat);this._rasterTexture=b.createRasterTexture(q,g,e,m);this._rasterTextureBandIds=this.bandIds?[...this.bandIds]:null}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=this._rasterTextureBandIds=null)};l._isBandIdschanged=function(q){const e=this._rasterTextureBandIds;return!(null==
e&&null==q||e&&q&&e.join("")===q.join(""))};l._isValidSource=function(q){var e;return F.isSome(q)&&0<(null==(e=q.pixels)?void 0:e.length)};l._getTextureSamplingMethod=function(q){const {type:e,colormap:d}=this.symbolizerParameters,g="lut"===e||"stretch"===e&&F.isSome(d);return!this._supportsBilinearTexture||g||"bilinear"!==q&&"cubic"!==q?"nearest":"bilinear"};l._updateColormapTexture=function(q){const e=this._colormap,d=this.symbolizerParameters.colormap;if(!d)this._colormapTexture&&(this._colormapTexture.dispose(),
this._colormapTexture=null),this._colormap=null;else if(!e)this._colormapTexture=b.createColormapTexture(q,d),this._colormap=d;else if(d.length!==e.length||d.some((g,m)=>g!==e[m]))this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=b.createColormapTexture(q,d),this._colormap=d};G._createClass(h,[{key:"symbolizerParameters",get:function(){return this._symbolizerParameters||a},set:function(q){this._symbolizerParameters!==q&&(this._symbolizerParameters=
q,this._colormapTextureInvalidated=!0)}},{key:"source",get:function(){return this._source},set:function(q){this._source!==q&&(this._source=q,this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTextureBandIds=this._rasterTexture=null),this.invalidateTexture())}},{key:"suspended",get:function(){return this._suspended},set:function(q){this._suspended&&!q&&this.stage&&(this.ready(),this.requestRender());this._suspended=q}},{key:"bandIds",get:function(){return this._bandIds},set:function(q){this._bandIds=
q;this._isBandIdschanged(q)&&this.invalidateTexture()}},{key:"interpolation",get:function(){return this._interpolation||"nearest"},set:function(q){this._interpolation=q;this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===this._getTextureSamplingMethod(q)?9729:9728)}},{key:"transformGrid",get:function(){return this._transformGrid},set:function(q){this._transformGrid=q;this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null)}}]);return h}(k.DisplayObject);
let f=function(c){function h(){return c.apply(this,arguments)||this}G._inheritsLoose(h,c);G._createClass(h,[{key:"source",get:function(){return this._source}}]);return h}(k);u.RasterBitmap=k;u.RasterBitmapWithSource=f;u.hasSource=function(c){return F.isSome(c.source)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../../../core/maybe","../PixelBlock"],function(u,G,F){function C(e){return G.isSome(e)&&"esri.layers.support.PixelBlock"===
e.declaredClass&&e.pixels&&0<e.pixels.length}function y(e,d){e=Math.min(Math.max(e,-100),100);d=Math.min(Math.max(d,-100),100);let g,m;const n=new Uint8Array(256);for(g=0;256>g;g++)0<e&&100>e?m=(200*g-25500+510*d)/(2*(100-e))+128:0>=e&&-100<e?m=(200*g-25500+510*d)*(100+e)/2E4+128:100===e?(m=200*g-25500+256*(100-e)+510*d,m=0<m?255:0):-100===e&&(m=128),n[g]=255<m?255:0>m?0:m;return n}function v(e,d,g,m,n,r,t,z){return{xmin:n<=g*e?0:n<g*e+e?n-g*e:e,ymin:r<=m*d?0:r<m*d+d?r-m*d:d,xmax:n+t<=g*e?0:n+t<g*
e+e?n+t-g*e:e,ymax:r+z<=m*d?0:r+z<m*d+d?r+z-m*d:d}}function p(e,d,g,m,n,r){const {width:t,height:z}=g.block,{x:w,y:B}=g.offset,{width:A,height:x}=g.mosaic;g=v(t,z,m,n,w,B,A,x);let E=0;var D=0;if(r){var K=r.hasGCSSShiftTransform?360:r.halfWorldWidth,H=t*r.resolutionX,I=r.startX+m*H;H=I+H;I<K&&H>K?D=r.rightPadding:I>=K&&(E=r.leftMargin-r.rightPadding,D=0)}g.xmax-=D;if("number"===typeof d)for(r=g.ymin;r<g.ymax;r++)for(D=(n*z+r-B)*A+(m*t-w)+E,K=g.xmin;K<g.xmax;K++)e[D+K]=d;else for(r=g.ymin;r<g.ymax;r++)for(D=
(n*z+r-B)*A+(m*t-w)+E,K=r*t,I=g.xmin;I<g.xmax;I++)e[D+I]=d[K+I]}function k(e,d,g={}){const {clipOffset:m,clipSize:n,alignmentInfo:r,blockWidths:t}=g;if(t)return b(e,d,{blockWidths:t});var z=e.filter(M=>C(M))[0];if(G.isNone(z))return null;g=n?n.width:d.width;const w=n?n.height:d.height;var B=z.width,A=z.height;const x=d.width/B,E=d.height/A;d={offset:m||{x:0,y:0},mosaic:n||d,block:{width:B,height:A}};B=z.pixelType;A=F.getPixelArrayConstructor(B);var D=z.pixels.length;z=[];for(var K=0;K<D;K++){var H=
new A(g*w);for(let M=0;M<E;M++)for(let O=0;O<x;O++){var I=e[M*x+O];C(I)&&(I=I.pixels[K],p(H,I,d,O,M,r))}z.push(H)}let J;if(e.some(M=>G.isNone(M)||M.mask&&0<M.mask.length))for(J=new Uint8Array(g*w),A=0;A<E;A++)for(D=0;D<x;D++)H=e[A*x+D],(K=G.isSome(H)?H.mask:null)?p(J,K,d,D,A,r):H?p(J,1,d,D,A,r):p(J,0,d,D,A,r);e=new F({width:g,height:w,pixels:z,pixelType:B,mask:J});e.updateStatistics();return e}function b(e,d,g){const m=e.find(D=>G.isSome(D));if(!G.isSome(m))return null;var n=e.some(D=>G.isSome(D)?
!!D.mask:!0);const {width:r,height:t}=d;d=n?new Uint8Array(r*t):null;({blockWidths:g}=g);const z=[],w=m.getPlaneCount(),B=F.getPixelArrayConstructor(m.pixelType);if(n)for(let D=0,K=0;D<e.length;K+=g[D],D++)if(n=e[D],C(n)){var A=n.mask;for(var x=0;x<t;x++)for(var E=0;E<g[D];E++)d[x*r+E+K]=null==A?255:A[x*n.width+E]}for(n=0;n<w;n++){A=new B(r*t);for(let D=0,K=0;D<e.length;K+=g[D],D++)if(x=e[D],C(x)&&(E=x.pixels[n],null!=E))for(let H=0;H<t;H++)for(let I=0;I<g[D];I++)A[H*r+I+K]=E[H*x.width+I];z.push(A)}e=
new F({width:r,height:t,mask:d,pixels:z,pixelType:m.pixelType});e.updateStatistics();return e}function a(e){if(!C(e))return null;const d=e.clone(),{width:g,height:m,pixels:n,mask:r}=e;var t=n[0];e=d.pixels[0];for(let B=2;B<m-1;B++){const A=new Map;for(var z=B-2;z<B+2;z++)for(var w=0;4>w;w++){const x=z*g+w;h(A,t[x],r?r[x]:1)}e[B*g]=f(A);e[B*g+1]=e[B*g+2]=e[B*g];for(z=3;z<g-1;z++)w=(B-2)*g+z+1,h(A,t[w],r?r[w]:1),w=(B-1)*g+z+1,h(A,t[w],r?r[w]:1),w=B*g+z+1,h(A,t[w],r?r[w]:1),w=(B+1)*g+z+1,h(A,t[w],r?
r[w]:1),w=(B-2)*g+z-3,c(A,t[w],r?r[w]:1),w=(B-1)*g+z-3,c(A,t[w],r?r[w]:1),w=B*g+z-3,c(A,t[w],r?r[w]:1),w=(B+1)*g+z-3,c(A,t[w],r?r[w]:1),e[B*g+z]=f(A);e[B*g+z+1]=e[B*g+z]}for(t=0;t<g;t++)e[t]=e[g+t]=e[2*g+t],e[(m-1)*g+t]=e[(m-2)*g+t];d.updateStatistics();return d}function f(e){if(0===e.size)return 0;let d=0,g=-1,m=0;const n=e.keys();let r=n.next();for(;!r.done;)m=e.get(r.value),m>d&&(g=r.value,d=m),r=n.next();return g}function c(e,d,g){0!==g&&(g=e.get(d),1===g?e.delete(d):e.set(d,g-1))}function h(e,
d,g){0!==g&&e.set(d,e.has(d)?e.get(d)+1:1)}function l(e,d,g){let {x:m,y:n}=d;const {width:r,height:t}=g;if(0===m&&0===n&&t===e.height&&r===e.width)return e;const {width:z,height:w}=e;d=Math.max(0,n);const B=Math.max(0,m),A=Math.min(m+r,z),x=Math.min(n+t,w);if(0>A||0>x||!C(e))return null;m=Math.max(0,-m);n=Math.max(0,-n);const {pixels:E,mask:D}=e;var K=r*t,H=E.length;const I=[];for(var J=0;J<H;J++){var M=E[J],O=F.createEmptyBand(e.pixelType,K);for(let L=d;L<x;L++){const S=L*z;let Q=(L+n-d)*r+m;for(let P=
B;P<A;P++)O[Q++]=M[S+P]}I.push(O)}K=new Uint8Array(K);for(H=d;H<x;H++)for(J=H*z,M=(H+n-d)*r+m,O=B;O<A;O++)K[M++]=D?D[J+O]:1;e=new F({width:g.width,height:g.height,pixelType:e.pixelType,pixels:I,mask:K});e.updateStatistics();return e}function q(e,d=!0){if(!C(e))return null;const {pixels:g,width:m,height:n,mask:r,pixelType:t}=e;e=[];const z=Math.round(m/2),w=Math.round(n/2),B=n-1,A=m-1;for(var x=0;x<g.length;x++){var E=g[x],D=F.createEmptyBand(t,z*w),K=0;for(var H=0;H<n;H+=2)for(var I=0;I<m;I+=2){var J=
E[H*m+I];if(d){var M=I===A?J:E[H*m+I+1];const O=H===B?J:E[H*m+I+m],L=I===A?O:H===B?M:E[H*m+I+m+1];D[K++]=(J+M+O+L)/4}else D[K++]=J}e.push(D)}x=null;if(r)for(x=new Uint8Array(z*w),E=0,D=0;D<n;D+=2)for(K=0;K<m;K+=2)H=r[D*m+K],d?(I=K===A?H:r[D*m+K+1],J=D===B?H:r[D*m+K+m],M=K===A?J:D===B?I:r[D*m+K+m+1],x[E++]=H*I*J*M?1:0):x[E++]=H;return new F({width:z,height:w,pixelType:t,pixels:e,mask:x})}u.approximateTransform=function(e,d,g,m,n="nearest"){if(!C(e))return null;"majority"===n&&(e=a(e));const {pixels:r,
mask:t,pixelType:z}=e,w=e.width;var B=e.height;e=F.getPixelArrayConstructor(z);var A=r.length;const {width:x,height:E}=d;d=m.cols;var D=m.rows;const K=Math.ceil(x/d-.1/d),H=Math.ceil(E/D-.1/D);m=!1;for(var I=0;I<g.length;I+=3)-1===g[I]&&-1===g[I+1]&&-1===g[I+2]&&(m=!0);let J,M,O,L,S,Q;const P=K*d;I=P*H*D;const R=new Float32Array(I),N=new Float32Array(I);I=0;let W,X;const T="majority"===n?0:.5;for(let Z=0;Z<H;Z++)for(let ca=0;ca<K;ca++){J=12*(Z*K+ca);n=g[J];M=g[J+1];O=g[J+2];L=g[J+3];S=g[J+4];Q=g[J+
5];for(var U=0;U<D;U++){I=(Z*D+U)*P+ca*d;X=(U+.5)/D;for(var V=0;V<U;V++)W=(V+.5)/d,R[I+V]=Math.round((n*W+M*X+O)*w-T),N[I+V]=Math.round((L*W+S*X+Q)*B-T)}J+=6;n=g[J];M=g[J+1];O=g[J+2];L=g[J+3];S=g[J+4];Q=g[J+5];for(U=0;U<D;U++)for(I=(Z*D+U)*P+ca*d,X=(U+.5)/D,V=U;V<d;V++)W=(V+.5)/d,R[I+V]=Math.round((n*W+M*X+O)*w-T),N[I+V]=Math.round((L*W+S*X+Q)*B-T)}g=(Z,ca)=>{for(let ea=0;ea<E;ea++){J=ea*P;for(let fa=0;fa<x;fa++)Z[ea*x+fa]=0>R[J]||0>N[J]?0:ca[R[J]+N[J]*w],J++}};B=[];for(D=0;D<A;D++)d=new e(x*E),g(d,
r[D]),B.push(d);e=new F({width:x,height:E,pixelType:z,pixels:B});if(t)e.mask=new Uint8Array(x*E),g(e.mask,t);else if(m)for(e.mask=new Uint8Array(x*E),A=0;A<x*E;A++)e.mask[A]=0>R[A]||0>N[A]?0:1;e.updateStatistics();return e};u.clip=l;u.colorize=function(e,d){if(!C(e)||!d&&(d.indexedColormap||d.indexed2DColormap))return e;const g=e.clone();var m=g.pixels;let n=g.mask;const r=g.width*g.height;if(1!==m.length)return e;const {indexedColormap:t,indexed2DColormap:z,offset:w,alphaSpecified:B}=d;d=t.length-
1;e=0;m=m[0];const A=new Uint8Array(m.length),x=new Uint8Array(m.length),E=new Uint8Array(m.length);let D=0;if(t)if(n)for(e=0;e<r;e++)n[e]&&(D=4*(m[e]-w),D<w||D>d?n[e]=0:(A[e]=t[D],x[e]=t[D+1],E[e]=t[D+2],n[e]=t[D+3]));else{n=new Uint8Array(r);for(e=0;e<r;e++)D=4*(m[e]-w),D<w||D>d?n[e]=0:(A[e]=t[D],x[e]=t[D+1],E[e]=t[D+2],n[e]=t[D+3]);g.mask=n}else if(n)for(e=0;e<r;e++)n[e]&&(d=z[m[e]],A[e]=d[0],x[e]=d[1],E[e]=d[2],n[e]=d[3]);else{n=new Uint8Array(r);for(e=0;e<r;e++)d=z[m[e]],A[e]=d[0],x[e]=d[1],
E[e]=d[2],n[e]=d[3];g.mask=n}g.pixels=[A,x,E];g.statistics=null;g.pixelType="u8";g.maskIsAlpha=B;return g};u.createColormapLUT=function(e){if(e){var d=e.colormap;if(d&&0!==d.length){d=d.sort((B,A)=>B[0]-A[0]);var g=0;0>d[0][0]&&(g=d[0][0]);var m=Math.max(256,d[d.length-1][0]-g+1),n=new Uint8Array(4*m),r=[],t=0,z=0,w=5===d[0].length;if(65536<m)return d.forEach(B=>{r[B[0]-g]=w?B.slice(1):B.slice(1).concat([255])}),{indexed2DColormap:r,offset:g,alphaSpecified:w};if(e.fillUnspecified)for(e=d[z],t=e[0]-
g;t<m;t++)n[4*t]=e[1],n[4*t+1]=e[2],n[4*t+2]=e[3],n[4*t+3]=w?e[4]:255,t===e[0]-g&&(e=z===d.length-1?e:d[++z]);else for(t=0;t<d.length;t++)e=d[t],z=4*(e[0]-g),n[z]=e[1],n[z+1]=e[2],n[z+2]=e[3],n[z+3]=w?e[4]:255;return{indexedColormap:n,offset:g,alphaSpecified:w}}}};u.createContrastBrightnessLUT=y;u.createHistogramEqualizationLUT=function(e,d=256){d=Math.min(d,256);const {size:g,counts:m}=e;e=new Uint8Array(g);var n=m.reduce((B,A)=>B+A/d,0);let r=0;var t=0;let z=0,w=n;for(let B=0;B<g;B++)if(z+=m[B],
!(B<g-1&&z+m[B+1]<w)){for(;r<d-1&&w<z;)r++,w+=n;for(;t<=B;t++)e[t]=r;t=B+1}for(n=t;n<g;n++)e[n]=d-1;return e};u.createStretchLUT=function(e){const {minCutOff:d,maxCutOff:g,gamma:m,pixelType:n}=e,r=e.outMin||0,t=e.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(n))return null;const z=d.length;let w;let B=0;"s8"===n?B=-127:"s16"===n&&(B=-32767);let A=256;-1<["u16","s16"].indexOf(n)&&(A=65536);const x=[],E=t-r;for(w=0;w<z;w++)x[w]=g[w]-d[w];var D=m&&m.length>=z;const K=[];if(D)for(w=0;w<z;w++)K[w]=
1<m[w]?2<m[w]?6.5+(m[w]-2)**2.5:6.5+100*(2-m[w])**4:1;let H;const I=[];let J,M,O;if(D)for(w=0;w<z;w++){O=[];for(D=0;D<A;D++)J=D+B,H=(J-d[w])/x[w],M=1,1<m[w]&&(M-=(1/E)**(H*K[w])),O[D]=J<g[w]&&J>d[w]?Math.floor(M*E*H**(1/m[w]))+r:J>=g[w]?t:r;I[w]=O}else for(w=0;w<z;w++){O=[];for(D=0;D<A;D++)J=D+B,O[D]=J<=d[w]?r:J>=g[w]?t:Math.floor((J-d[w])/x[w]*E)+r;I[w]=O}if(null!=e.contrastOffset)for(e=y(e.contrastOffset,e.brightnessOffset),w=0;w<z;w++)for(O=I[w],D=0;D<A;D++)O[D]=e[O[D]];return{lut:I,offset:B}};
u.estimateStatisticsFromHistograms=function(e){const d=[];for(let r=0;r<e.length;r++){const {min:t,max:z,size:w,counts:B}=e[r];let A=0;var g=0;for(var m=0;m<w;m++)A+=B[m],g+=m*B[m];g/=A;m=0;for(var n=0;n<w;n++)m+=B[n]*(n-g)**2;n=(z-t)/w;d.push({min:t,max:z,avg:(g+.5)*n+t,stddev:Math.sqrt(m/(A-1))*n})}return d};u.estimateStatisticsHistograms=function(e){if(!C(e))return null;e.statistics||e.updateStatistics();const {pixels:d,mask:g,pixelType:m,statistics:n}=e;e=e.width*e.height;const r=d.length;let t,
z;let w;var B;const A=[],x=[];for(w=0;w<r;w++){var E=new Uint32Array(256);var D=d[w];if("u8"===m)if(t=-.5,z=255.5,g)for(B=0;B<e;B++)g[B]&&E[D[B]]++;else for(B=0;B<e;B++)E[D[B]]++;else{t=n[w].minValue;z=n[w].maxValue;var K=(z-t)/256;var H=new Uint32Array(257);if(g)for(B=0;B<e;B++)g[B]&&H[Math.floor((D[B]-t)/K)]++;else for(B=0;B<e;B++)H[Math.floor((D[B]-t)/K)]++;for(B=0;255>B;B++)E[B]=H[B];E[255]=H[255]+H[256]}A.push({min:t,max:z,size:256,counts:E});for(B=D=H=K=0;256>B;B++)K+=E[B],H+=B*E[B];H/=K;for(B=
0;256>B;B++)D+=E[B]*(B-H)**2;E=Math.sqrt(D/(K-1));K=(z-t)/256;B=(H+.5)*K+t;E*=K;x.push({min:t,max:z,avg:B,stddev:E})}return{statistics:x,histograms:A}};u.extractBands=function(e,d){if(null==d||!d.length||!C(e))return e;const g=e.pixels.length;return d&&d.some(m=>m>=g)||1===g&&1===d.length&&0===d[0]||g===d.length&&!d.some((m,n)=>m!==n)?e:new F({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:d.map(m=>e.pixels[m]),statistics:e.statistics&&
d.map(m=>e.statistics[m])})};u.getClipBounds=v;u.isValidPixelBlock=C;u.lookupPixels=function(e,d){if(!C(e))return null;const {pixels:g,mask:m}=e,n=e.width*e.height,r=g.length;let t=d.lut;({offset:d}=d);let z,w;t&&1===t[0].length&&(t=g.map(()=>t));const B=[];let A,x,E;if(d)if(null==m)for(z=0;z<r;z++){A=g[z];x=t[z];E=new Uint8Array(n);for(w=0;w<n;w++)E[w]=x[A[w]-d];B.push(E)}else for(z=0;z<r;z++){A=g[z];x=t[z];E=new Uint8Array(n);for(w=0;w<n;w++)m[w]&&(E[w]=x[A[w]-d]);B.push(E)}else if(null==m)for(z=
0;z<r;z++){A=g[z];x=t[z];E=new Uint8Array(n);for(w=0;w<n;w++)E[w]=x[A[w]];B.push(E)}else for(z=0;z<r;z++){A=g[z];x=t[z];E=new Uint8Array(n);for(w=0;w<n;w++)m[w]&&(E[w]=x[A[w]]);B.push(E)}e=new F({width:e.width,height:e.height,pixels:B,mask:m,pixelType:"u8"});e.updateStatistics();return e};u.mosaic=k;u.mosaicPixelData=function(e,d){if(!e||0===e.length)return null;var g=e.filter(x=>x.pixelBlock)[0];if(!g||G.isNone(g.pixelBlock))return null;var m=(g.extent.xmax-g.extent.xmin)/g.pixelBlock.width;const n=
(g.extent.ymax-g.extent.ymin)/g.pixelBlock.height,r=.01*Math.min(m,n),t=e.sort((x,E)=>Math.abs(x.extent.ymax-E.extent.ymax)>r?E.extent.ymax-x.extent.ymax:Math.abs(x.extent.xmin-E.extent.xmin)>r?x.extent.xmin-E.extent.xmin:0);var z=Math.min.apply(null,t.map(x=>x.extent.xmin));const w=Math.min.apply(null,t.map(x=>x.extent.ymin)),B=Math.max.apply(null,t.map(x=>x.extent.xmax)),A=Math.max.apply(null,t.map(x=>x.extent.ymax));e={x:Math.round((d.xmin-z)/m),y:Math.round((A-d.ymax)/n)};z={width:Math.round((B-
z)/m),height:Math.round((A-w)/n)};m={width:Math.round((d.xmax-d.xmin)/m),height:Math.round((d.ymax-d.ymin)/n)};if(Math.round(z.width/g.pixelBlock.width)*Math.round(z.height/g.pixelBlock.height)!==t.length||0>e.x||0>e.y||z.width<m.width||z.height<m.height)return null;g=t.map(x=>x.pixelBlock);g=k(g,z,{clipOffset:e,clipSize:m});return{extent:d,pixelBlock:g}};u.remapColor=function(e,d){if(!C(e))return null;e=e.clone();var {pixels:g}=e;const m=e.width*e.height,n=d.length,r=Math.floor(n/2),t=d[Math.floor(r)];
g=g[0];let z,w,B,A,x,E,D=!1;const K=new Uint8Array(m),H=new Uint8Array(m),I=new Uint8Array(m);let J=e.mask;const M=4===d[0].mappedColor.length;J||(J=new Uint8Array(m),J.fill(M?255:1),e.mask=J);for(x=0;x<m;x++)if(J[x]){z=g[x];D=!1;E=r;w=t;B=0;for(A=n-1;1<A-B;){if(z===w.value){D=!0;break}z>w.value?B=E:A=E;E=Math.floor((B+A)/2);w=d[Math.floor(E)]}D||(z===d[B].value?(w=d[B],D=!0):z===d[A].value?(w=d[A],D=!0):z<d[B].value?(D=!1,w=null):z>d[B].value&&(z<d[A].value?(w=d[B],D=!0):A===n-1?(D=!1,w=null):(w=
d[A],D=!0)));D?(K[x]=w.mappedColor[0],H[x]=w.mappedColor[1],I[x]=w.mappedColor[2],J[x]=w.mappedColor[3]):K[x]=H[x]=I[x]=J[x]=0}e.pixels=[K,H,I];e.mask=J;e.pixelType="u8";e.maskIsAlpha=M;return e};u.resampleByMajority=a;u.setValidBoundary=function(e,d,g){if(!C(e))return null;const {width:m,height:n}=e,r=d.x;d=d.y;const t=g.width+r;g=g.height+d;if(0>r||0>d||t>m||g>n||0===r&&0===d&&t===m&&g===n)return e;e.mask||(e.mask=new Uint8Array(m*n));const z=e.mask;for(let w=0;w<n;w++){const B=w*m;for(let A=0;A<
m;A++)z[B+A]=w<d||w>=g||A<r||A>=t?0:1}e.updateStatistics();return e};u.split=function(e,d,g){if(!C(e))return null;const {width:m,height:n}=d;let {width:r,height:t}=e;const z=new Map,w={x:0,y:0};g=null==g?1:1+g;for(let B=0;B<g;B++){const A=Math.ceil(r/m),x=Math.ceil(t/n);for(let E=0;E<x;E++){w.y=E*n;for(let D=0;D<A;D++){w.x=D*m;const K=l(e,w,d);z.set(`${B}/${E}/${D}`,K)}}B<g-1&&(e=q(e));r=Math.round(r/2);t=Math.round(t/2)}return z};u.stretch=function(e,d){if(!C(e))return null;e=e.clone();const {pixels:g,
mask:m}=e,{minCutOff:n,maxCutOff:r,gamma:t}=d,z=d.outMin||0;d=d.outMax||255;const w=e.width*e.height,B=g.length;let A;let x,E,D;const K=d-z,H=[];for(A=0;A<B;A++)H[A]=r[A]-n[A];var I=t&&t.length>=B;const J=[];if(I)for(A=0;A<B;A++)J[A]=1<t[A]?2<t[A]?6.5+(t[A]-2)**2.5:6.5+100*(2-t[A])**4:1;if(I)if(null!=m)for(I=0;I<w;I++){if(m[I])for(A=0;A<B;A++)x=g[A][I],D=(x-n[A])/H[A],E=1,1<t[A]&&(E-=(1/K)**(D*J[A])),g[A][I]=x<r[A]&&x>n[A]?Math.floor(E*K*D**(1/t[A]))+z:x>=r[A]?d:z}else for(I=0;I<w;I++)for(A=0;A<B;A++)x=
g[A][I],D=(x-n[A])/H[A],E=1,1<t[A]&&(E-=(1/K)**(D*J[A])),g[A][I]=x<r[A]&&x>n[A]?Math.floor(E*K*D**(1/t[A]))+z:x>=r[A]?d:z;else if(null!=m)for(I=0;I<w;I++){if(m[I])for(A=0;A<B;A++)x=g[A][I],g[A][I]=x<r[A]&&x>n[A]?Math.floor((x-n[A])/H[A]*K)+z:x>=r[A]?d:z}else for(I=0;I<w;I++)for(A=0;A<B;A++)x=g[A][I],g[A][I]=x<r[A]&&x>n[A]?Math.floor((x-n[A])/H[A]*K)+z:x>=r[A]?d:z;e.pixelType="u8";e.updateStatistics();return e};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f){var c;const h=p.getLogger("esri.layers.support.PixelBlock");F=c=function(l){function q(d){d=l.call(this,d)||this;d.width=null;d.height=null;d.pixelType="f32";d.validPixelCount=null;d.mask=null;d.maskIsAlpha=!1;d.pixels=null;d.statistics=null;return d}u._inheritsLoose(q,l);q.createEmptyBand=function(d,g){return new (c.getPixelArrayConstructor(d))(g)};q.getPixelArrayConstructor=function(d){let g;switch(d){case "u1":case "u2":case "u4":case "u8":g=Uint8Array;break;case "u16":g=
Uint16Array;break;case "u32":g=Uint32Array;break;case "s8":g=Int8Array;break;case "s16":g=Int16Array;break;case "s32":g=Int32Array;break;case "u32":g=Uint32Array;break;case "f32":g=Float32Array;break;case "f64":g=Float64Array;break;case "c64":case "c128":case "unknown":g=Float32Array}return g};var e=q.prototype;e.castPixelType=function(d){if(!d)return"f32";d=d.toLowerCase();-1<["u1","u2","u4"].indexOf(d)?d="u8":-1==="unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").indexOf(d)&&(d="f32");return d};
e.getPlaneCount=function(){return this.pixels&&this.pixels.length};e.addData=function(d){if(!d.pixels||d.pixels.length!==this.width*this.height)throw new C("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(d.pixels);this.statistics.push(d.statistics||{minValue:null,maxValue:null})};e.getAsRGBA=function(){const d=new ArrayBuffer(this.width*
this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(d);break;default:this._fillFrom8Bit(d)}return new Uint8ClampedArray(d)};e.getAsRGBAFloat=function(){const d=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(d);return d};e.updateStatistics=function(){this.statistics=this.pixels.map(m=>this._calculateBandStatistics(m,this.mask));const d=this.mask;let g=0;if(d)for(let m=0;m<d.length;m++)d[m]&&g++;else g=
this.width*this.height;this.validPixelCount=g};e.clamp=function(d){if(d&&"f64"!==d&&"f32"!==d){switch(d){case "u8":var g=[0,255];break;case "u16":g=[0,65535];break;case "u32":g=[0,4294967295];break;case "s8":g=[-128,127];break;case "s16":g=[-32768,32767];break;case "s32":g=[-2147483648,2147483647];break;default:g=[-3.4*1E39,3.4*1E39]}var [m,n]=g;g=this.pixels;var r=this.width*this.height,t=g.length,z=[];for(let x=0;x<t;x++){var w=c.createEmptyBand(d,r);var B=g[x];for(let E=0;E<r;E++){var A=B[E];w[E]=
A>n?n:A<m?m:A}z.push(w)}this.pixels=z;this.pixelType=d}};e.extractBands=function(d){if(k.isNone(d)||0===d.length||null==this.pixels||0===this.pixels.length)return this;var g=this.pixels.length;const m=d.some(n=>n>=this.pixels.length);g=g===d.length&&!d.some((n,r)=>n!==r);return m||g?this:new c({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:d.map(n=>this.pixels[n]),statistics:this.statistics&&d.map(n=>
this.statistics[n])})};e.clone=function(){const d=new c({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});this.mask&&(d.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));let g;const m=c.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){d.pixels=[];const n=this.pixels[0].slice;for(g=0;g<this.pixels.length;g++)d.pixels[g]=n?this.pixels[g].slice(0,this.pixels[g].length):
new m(this.pixels[g])}if(this.statistics)for(d.statistics=[],g=0;g<this.statistics.length;g++)d.statistics[g]=v.clone(this.statistics[g]);return d};e._fillFrom8Bit=function(d){const {mask:g,maskIsAlpha:m,pixels:n}=this;if(d&&n&&n.length){var r,t;var z=r=t=n[0];3<=n.length?(r=n[1],t=n[2]):2===n.length&&(r=n[1]);var w=new Uint32Array(d),B=this.width*this.height;if(z.length!==B)h.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(g&&g.length===B)if(m)for(d=0;d<B;d++)g[d]&&
(w[d]=g[d]<<24|t[d]<<16|r[d]<<8|z[d]);else for(d=0;d<B;d++)g[d]&&(w[d]=-16777216|t[d]<<16|r[d]<<8|z[d]);else for(d=0;d<B;d++)w[d]=-16777216|t[d]<<16|r[d]<<8|z[d]}else h.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};e._fillFromNon8Bit=function(d){const {pixels:g,mask:m,statistics:n}=this;if(d&&g&&g.length){var r=this.pixelType,t=1,z=0;t=1;n&&0<n.length?(z=n.map(E=>E.minValue).reduce((E,D)=>Math.min(E,D)),t=n.map(E=>E.maxValue-E.minValue).reduce((E,D)=>Math.max(E,
D)),t=255/t):(t=255,"s8"===r?(z=-128,t=127):"u16"===r?t=65535:"s16"===r?(z=-32768,t=32767):"u32"===r?t=4294967295:"s32"===r?(z=-2147483648,t=2147483647):"f32"===r?(z=-3.4*1E39,t=3.4*1E39):"f64"===r&&(z=-Number.MAX_VALUE,t=Number.MAX_VALUE),t=255/(t-z));d=new Uint32Array(d);r=this.width*this.height;var w,B,A;var x=w=B=g[0];if(x.length!==r)return h.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=g.length)if(w=g[1],3<=g.length&&(B=g[2]),m&&m.length===r)for(A=0;A<r;A++)m[A]&&
(d[A]=-16777216|(B[A]-z)*t<<16|(w[A]-z)*t<<8|(x[A]-z)*t);else for(A=0;A<r;A++)d[A]=-16777216|(B[A]-z)*t<<16|(w[A]-z)*t<<8|(x[A]-z)*t;else if(m&&m.length===r)for(A=0;A<r;A++)w=(x[A]-z)*t,m[A]&&(d[A]=-16777216|w<<16|w<<8|w);else for(A=0;A<r;A++)w=(x[A]-z)*t,d[A]=-16777216|w<<16|w<<8|w}else h.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};e._fillFrom32Bit=function(d){const {pixels:g,mask:m}=this;if(!d||!g||!g.length)return h.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");
let n,r,t,z;n=r=t=g[0];3<=g.length?(r=g[1],t=g[2]):2===g.length&&(r=g[1]);const w=this.width*this.height;if(n.length!==w)return h.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let B=0;if(m&&m.length===w)for(z=0;z<w;z++)d[B++]=n[z],d[B++]=r[z],d[B++]=t[z],d[B++]=m[z]&1;else for(z=0;z<w;z++)d[B++]=n[z],d[B++]=r[z],d[B++]=t[z],d[B++]=1};e._calculateBandStatistics=function(d,g){let m=Infinity,n=-Infinity;const r=d.length;let t,z=0;if(g)for(t=0;t<r;t++)g[t]&&(z=d[t],
m=z<m?z:m,n=z>n?z:n);else for(t=0;t<r;t++)z=d[t],m=z<m?z:m,n=z>n?z:n;return{minValue:m,maxValue:n}};return q}(y.JSONSupport);G.__decorate([b.property({json:{write:!0}})],F.prototype,"width",void 0);G.__decorate([b.property({json:{write:!0}})],F.prototype,"height",void 0);G.__decorate([b.property({json:{write:!0}})],F.prototype,"pixelType",void 0);G.__decorate([a.cast("pixelType")],F.prototype,"castPixelType",null);G.__decorate([b.property({json:{write:!0}})],F.prototype,"validPixelCount",void 0);
G.__decorate([b.property({json:{write:!0}})],F.prototype,"mask",void 0);G.__decorate([b.property({json:{write:!0}})],F.prototype,"maskIsAlpha",void 0);G.__decorate([b.property({json:{write:!0}})],F.prototype,"pixels",void 0);G.__decorate([b.property({json:{write:!0}})],F.prototype,"statistics",void 0);return F=c=G.__decorate([f.subclass("esri.layers.support.PixelBlock")],F)})},"esri/views/webgl/rasterUtils":function(){define(["exports","./FramebufferObject","./Texture"],function(u,G,F){u.createColormapTexture=
function(C,y){return new F(C,{width:y.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1},y)};u.createFrameBuffer=function(C,y,v,p){p=new F(C,{width:y,height:v,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:9728,dataType:p?5121:5126,wrapMode:33071,flipped:!1});return new G(C,{colorTarget:0,depthStencilTarget:3,width:y,height:v},p)};u.createRasterTexture=function(C,y,v="nearest",p=!1){var k;const b=(p=!(p&&"u8"===
y.pixelType))?5126:5121,a=null==y.pixels||0===y.pixels.length?null:p?y.getAsRGBAFloat():y.getAsRGBA(),f=null==(k=C.capabilities.textureFloat)?void 0:k.textureFloatLinear;return new F(C,{width:y.width,height:y.height,target:3553,pixelFormat:6408,internalFormat:"webgl2"===C.webglVersion&&p?34836:6408,samplingMode:!f||"bilinear"!==v&&"cubic"!==v?9728:9729,dataType:b,wrapMode:33071,flipped:!1},a)};u.createTransformTexture=function(C,y){var v=4*y.size[0],p=y.size[1];const k={width:v,height:p,target:3553,
pixelFormat:6408,internalFormat:"webgl2"===C.webglVersion?34836:6408,dataType:5126,samplingMode:9728,wrapMode:33071,flipped:!1};v=new Float32Array(v*p*4);p=0;for(let b=0;b<y.coefficients.length;b++)v[p++]=y.coefficients[b],2===b%3&&(v[p++]=1);return new F(C,k,v)};u.getBasicGridUniforms=function(C,y){return{u_scale:C,u_offset:y}};u.getColormapUniforms=function(C,y){return{u_colormapOffset:y||0,u_colormapMaxIndex:C?C.length/4-1:null}};u.getCommonUniforms=function(C,y,v,p=1,k=!0,b=!1){return{u_flipY:k,
u_isFloatTexture:b,u_applyTransform:C?!0:!1,u_opacity:p,u_transformSpacing:C?C.spacing:null,u_transformGridSize:C?C.size:null,u_targetImageSize:y,u_srcImageSize:v}};u.getShadedReliefUniforms=function(C){return{u_hillshadeType:C.hillshadeType,u_sinZcosAs:C.sinZcosAs,u_sinZsinAs:C.sinZsinAs,u_cosZs:C.cosZs,u_weights:C.weights,u_factor:C.factor,u_minValue:C.minValue,u_maxValue:C.maxValue}};u.getStretchUniforms=function(C){return{u_bandCount:C.bandCount,u_minOutput:C.outMin,u_maxOutput:C.outMax,u_minCutOff:C.minCutOff,
u_maxCutOff:C.maxCutOff,u_factor:C.factor,u_useGamma:C.useGamma,u_gamma:C.gamma,u_gammaCorrection:C.gammaCorrection}};u.getUniformLocationInfos=function(C,y){C=C.gl;y=y.glName;const v=C.getProgramParameter(y,C.ACTIVE_UNIFORMS),p=new Map;let k;for(let b=0;b<v;b++)(k=C.getActiveUniform(y,b))&&p.set(k.name,{location:C.getUniformLocation(y,k.name),info:k});return p};u.setTextures=function(C,y,v,p){v.length===p.length&&(p.some(k=>null==k)||v.some(k=>null==k)||v.forEach((k,b)=>{y.setUniform1i(k,b);C.bindTexture(p[b],
b)}))};u.setUniforms=function(C,y,v){Object.keys(v).forEach(p=>{var k=y.get(p)||y.get(p+"[0]");if(k){var b=v[p];if(null!==k&&null!=b)switch({info:k}=k,k.type){case 5126:1<k.size?C.setUniform1fv(p,b):C.setUniform1f(p,b);break;case 35664:C.setUniform2fv(p,b);break;case 35665:C.setUniform3fv(p,b);break;case 35666:C.setUniform4fv(p,b);break;case 35675:C.setUniformMatrix3fv(p,b);break;case 35676:C.setUniformMatrix4fv(p,b);break;case 5124:1<k.size?C.setUniform1iv(p,b):C.setUniform1i(p,b);break;case 35670:C.setUniform1i(p,
b?1:0);break;case 35667:case 35671:C.setUniform2iv(p,b);break;case 35668:case 35672:C.setUniform3iv(p,b);break;case 35669:case 35673:C.setUniform4iv(p,b)}}})};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/raster/BrushVectorField":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","../WGLBrush"],function(u,G,F){const C=new Float32Array([.27058823529411763,.4588235294117647,.7098039215686275,1,.396078431372549,
.5372549019607843,.7215686274509804,1,.5176470588235295,.6196078431372549,.7294117647058823,1,.6352941176470588,.7058823529411765,.7411764705882353,1,.7529411764705882,.8,.7450980392156863,1,.8705882352941177,.8901960784313725,.7490196078431373,1,1,1,.7490196078431373,1,1,.8627450980392157,.6313725490196078,1,.9803921568627451,.7254901960784313,.5176470588235295,1,.9607843137254902,.596078431372549,.4117647058823529,1,.9294117647058824,.4588235294117647,.3176470588235294,1,.9098039215686274,.08235294117647059,
.08235294117647059,1]),y={beaufort_ft:C,beaufort_m:C,beaufort_km:C,beaufort_mi:C,beaufort_kn:new Float32Array([.1568627450980392,.5725490196078431,.7803921568627451,1,.34901960784313724,.6352941176470588,.7294117647058823,1,.5058823529411764,.7019607843137254,.6705882352941176,1,.6274509803921569,.7607843137254902,.6078431372549019,1,.7490196078431373,.8313725490196079,.5411764705882353,1,.8549019607843137,.9019607843137255,.4666666666666667,1,.9803921568627451,.9803921568627451,.39215686274509803,
1,.9882352941176471,.8352941176470589,.3254901960784314,1,.9882352941176471,.7019607843137254,.4,1,.9803921568627451,.5529411764705883,.20392156862745098,1,.9686274509803922,.43137254901960786,.16470588235294117,1,.9411764705882353,.2784313725490196,.11372549019607843,1]),classified_arrow:new Float32Array([.2196078431372549,.6588235294117647,0,1,.5450980392156862,1.2117647058823529,0,1,1,1,0,1,1,.5019607843137255,0,1,1,0,0,1]),ocean_current_m:new Float32Array([.3058823529411765,.10196078431372549,
.6,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),ocean_current_kn:new Float32Array([0,0,0,1,0,.1450980392156863,.39215686274509803,1,.3058823529411765,.10196078431372549,.6,1,.592156862745098,0,.39215686274509803,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.6941176470588235,.3058823529411765,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,
1,.6941176470588235,.7019607843137254,.20392156862745098,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),single_arrow:new Float32Array([0,92/255,230/255,1]),wind_speed:new Float32Array([0,0,0,1])};return function(v){function p(){var b=v.apply(this,arguments)||this;b._desc={magdir:{vsPath:"raster/magdir",fsPath:"raster/magdir",attributes:new Map([["a_pos",0],["a_offset",1],["a_vv",2]])},scalar:{vsPath:"raster/scalar",fsPath:"raster/scalar",attributes:new Map([["a_pos",0],["a_offset",1],
["a_vv",2]])}};return b}u._inheritsLoose(p,v);var k=p.prototype;k.dispose=function(){};k.prepareState=function({context:b},a){b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(1,771,1,771);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0);b.setStencilOp(7680,7680,7681);b.setStencilFunction(514,a.stencilRef,255)};k.draw=function(b,a){if(!G.isNone(a.source)&&0!==a.source.validPixelCount){var {timeline:f}=b;f.begin(this.name);a.updateVectorFieldVAO(b);if("scalar"===b.renderPass){var c=
a.vaoData.scalar;c&&this._drawScalars(b,a,c.vao,c.elementCount)}else(c=a.vaoData.magdir)&&this._drawTriangles(b,a,c.vao,c.elementCount);f.end(this.name)}};k._drawTriangles=function(b,a,f,c){const {context:h,painter:l}=b,{symbolizerParameters:q}=a;var e=q.dataRange?["dataRange"]:[];"geographic"===q.rotationType&&e.push("rotationGeographic");e=l.materialManager.getProgram(b,this._desc.magdir,e);h.useProgram(e);const {coordScale:d,opacity:g,transforms:m}=a;e.setUniform2fv("u_coordScale",d);e.setUniform1f("u_opacity",
g);e.setUniformMatrix3fv("u_dvsMat3",m.dvs);const {style:n,dataRange:r,rotation:t,symbolPercentRange:z}=q;e.setUniform4fv("u_colors",y[n]||y.single_arrow);e.setUniform2fv("u_dataRange",r);e.setUniform1f("u_rotation",t);e.setUniform2fv("u_symbolPercentRange",z);b=this._getSymbolSize(b,a);e.setUniform2fv("u_symbolSize",b);h.bindVAO(f);h.drawElements(4,c,5125,0)};k._drawScalars=function(b,a,f,c){const {context:h,painter:l}=b,{symbolizerParameters:q}=a;var e=[];"wind_speed"===q.style?e.push("innerCircle"):
q.dataRange&&e.push("dataRange");"geographic"===q.rotationType&&e.push("rotationGeographic");e=l.materialManager.getProgram(b,this._desc.scalar,e);h.useProgram(e);const {coordScale:d,opacity:g,transforms:m}=a;e.setUniform2fv("u_coordScale",d);e.setUniform1f("u_opacity",g);e.setUniformMatrix3fv("u_dvsMat3",m.dvs);const {dataRange:n,symbolPercentRange:r}=q;e.setUniform2fv("u_dataRange",n);e.setUniform2fv("u_symbolPercentRange",r);b=this._getSymbolSize(b,a);e.setUniform2fv("u_symbolSize",b);h.bindVAO(f);
h.drawElements(4,c,5125,0)};k._getSymbolSize=function(b,a){b=2**(b.displayLevel-a.key.level);const {symbolTileSize:f}=a.symbolizerParameters;return[f/(Math.round((a.width-a.offset[0])/f)*f)/b,f/(Math.round((a.height-a.offset[1])/f)*f)/b]};return p}(F)})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterialManager":function(){define("../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../webgl/Program ../../../../../chunks/_rollupPluginBabelHelpers ../../../../webgl/enums ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ./Programs".split(" "),
function(u,G,F,C,y,v,p,k){return function(){function b(){this._programByKey=new Map}var a=b.prototype;a.dispose=function(){this._programByKey.forEach(f=>f.dispose());this._programByKey.clear()};a.getMaterialProgram=function(f,c,h){const l=c.key<<3|this._getMaterialOptionsValue(c.type,h);if(this._programByKey.has(l))return this._programByKey.get(l);var q=this._getProgramTemplate(c.type);({shaders:q}=q);const {vertexShader:e,fragmentShader:d}=q(h);h=c.getShaderHeader();q=c.getShaderMain();h=e.replace("#pragma header",
h).replace("#pragma main",q);f=new F.Program(f,h,d,c.getAttributeLocations());this._programByKey.set(l,f);return f};a._getMaterialOptionsValue=function(f,c){switch(f){case 0:return(c.pattern?1:0)<<1|(c.id?1:0);case 1:return(c.pattern?1:0)<<1|(c.id?1:0);case 2:return c.id?1:0;case 3:return(c.sdf?1:0)<<2|(c.pattern?1:0)<<1|(c.id?1:0);case 4:return(c.sdf?1:0)<<1|(c.id?1:0);case 5:return c.id?1:0;case 6:return c.id?1:0;default:return 0}};a._getProgramTemplate=function(f){switch(f){case 0:return k.background;
case 5:return k.circle;case 1:return k.fill;case 4:return k.icon;case 3:return k.line;case 2:return k.outline;case 6:return k.text;default:return null}};return b}()})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define("exports ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../webgl/checkWebGLError ../../../../webgl/enums ../../../../../chunks/builtins ../../../../webgl/programUtils ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ./sources/resolver".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c){u.background={shaders:h=>({vertexShader:b.glslifyDefineMap({ID:h.id,PATTERN:h.pattern})+c.resolveIncludes("background/background.vert"),fragmentShader:b.glslifyDefineMap({ID:h.id,PATTERN:h.pattern})+c.resolveIncludes("background/background.frag")})};u.circle={shaders:h=>({vertexShader:b.glslifyDefineMap({ID:h.id})+c.resolveIncludes("circle/circle.vert"),fragmentShader:b.glslifyDefineMap({ID:h.id})+c.resolveIncludes("circle/circle.frag")})};u.fill={shaders:h=>({vertexShader:b.glslifyDefineMap({ID:h.id,
PATTERN:h.pattern})+c.resolveIncludes("fill/fill.vert"),fragmentShader:b.glslifyDefineMap({ID:h.id,PATTERN:h.pattern})+c.resolveIncludes("fill/fill.frag")})};u.icon={shaders:h=>({vertexShader:b.glslifyDefineMap({ID:h.id,SDF:h.sdf})+c.resolveIncludes("icon/icon.vert"),fragmentShader:b.glslifyDefineMap({ID:h.id,SDF:h.sdf})+c.resolveIncludes("icon/icon.frag")})};u.line={shaders:h=>({vertexShader:b.glslifyDefineMap({ID:h.id,PATTERN:h.pattern,SDF:h.sdf})+c.resolveIncludes("line/line.vert"),fragmentShader:b.glslifyDefineMap({ID:h.id,
PATTERN:h.pattern,SDF:h.sdf})+c.resolveIncludes("line/line.frag")})};u.outline={shaders:h=>({vertexShader:b.glslifyDefineMap({ID:h.id})+c.resolveIncludes("outline/outline.vert"),fragmentShader:b.glslifyDefineMap({ID:h.id})+c.resolveIncludes("outline/outline.frag")})};u.text={shaders:h=>({vertexShader:b.glslifyDefineMap({ID:h.id})+c.resolveIncludes("text/text.vert"),fragmentShader:b.glslifyDefineMap({ID:h.id})+c.resolveIncludes("text/text.frag")})};Object.defineProperty(u,"__esModule",{value:!0})})},
"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define("exports ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/ShaderCompiler ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ./shaderRepository".split(" "),function(u,G,F,C,y,v,p,k,b,a,f,
c){const h=new b(function(l){let q=c;l.split("/").forEach(e=>{q&&(q=q[e])});return q});u.resolveIncludes=function(l){return h.resolveIncludes(l)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform lowp sampler2D u_texture;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d u_opacity * color;\n#else\ngl_FragColor \x3d u_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\nuniform mediump vec4 u_tlbr;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\n#endif\nvoid main() {\ngl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\nv_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d u_tlbr / u_mosaicSize.xyxy;\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float dist \x3d length(v_offset);\nmediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\nlowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\ngl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_stroke_color \x3d stroke_color * stroke_opacity;\nv_stroke_width \x3d stroke_width;\nv_radius \x3d radius;\nv_blur \x3d max(blur, u_antialiasingWidth / (radius + stroke_width));\nmediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\nv_offset \x3d offset;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d v_color[3] * color;\n#else\ngl_FragColor \x3d v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\n#include \x3cutil/util.glsl\x3e\nuniform mediump vec2 u_mosaicSize;\nuniform mediump float u_patternFactor;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\nfloat patternWidth \x3d nextPOT(tlbr.z - tlbr.x);\nfloat patternHeight \x3d nextPOT(tlbr.w - tlbr.y);\nfloat scaleX \x3d 1.0 / (patternWidth * u_patternFactor);\nfloat scaleY \x3d 1.0 / (patternHeight * u_patternFactor);\nmat3 patterMat \x3d mat3(scaleX, 0.0,    0.0,\n0.0,    -scaleY, 0.0,\n0.0,    0.0,    1.0);\nv_tileTextureCoord \x3d (patterMat * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d tlbr / u_mosaicSize.xyxy;\n#endif\nvec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump flaot v_halo_width;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\nconst float softEdgeRatio \x3d 0.248062016;\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * softEdgeRatio * size;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nif (v_halo_width \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d u_outlineColor;\nconst float outlineLimitRatio \x3d (16.0 / 86.0);\nfloat clampedOutlineSize \x3d softEdgeRatio * min(v_halo_width, outlineLimitRatio * max(v_size.x, v_size.y));\noutlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\ngl_FragColor \x3d v_opacity * mixColors(fillPixelColor, outlinePixelColor);\n}\nelse {\ngl_FragColor \x3d v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump float v_halo_width;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nv_color \x3d color;\nv_opacity \x3d opacity;\n#ifdef SDF\nv_halo_width \x3d halo_width;\n#endif\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_opacity *\x3d interpolatedOpacity;\nmediump float a_angle         \x3d a_levelInfo[1];\nmediump float a_minLevel      \x3d a_levelInfo[2];\nmediump float a_maxLevel      \x3d a_levelInfo[3];\nmediump vec2 a_tex            \x3d a_texAngleRange.xy;\nmediump float delta_z \x3d 0.0;\nmediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_opacity, 0.0);\nvec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\nv_size \x3d abs(offset);\n#ifdef SDF\noffset \x3d (120.0 / 86.0) * offset;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_tex \x3d a_tex.xy / u_mosaicSize;\n}"},
line:{"line.frag":"precision lowp float;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#if defined (PATTERN) || defined(SDF)\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\nuniform sampler2D u_texture;\nuniform mediump float u_antialiasing;\n#endif\n#ifdef SDF\n#include \x3cutil/encoding.glsl\x3e\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\nlowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\nmediump float relativeTexX \x3d mod(v_accumulatedDistance / (v_patternSize.x * v_widthRatio), 1.0);\nmediump float relativeTexY \x3d 0.5 + v_normal.y * v_lineHalfWidth / (v_patternSize.y * v_widthRatio);\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\ngl_FragColor \x3d alpha * v_color[3] * color;\n#elif defined(SDF)\nmediump float relativeTexX \x3d mod((v_accumulatedDistance * 0.5) / (v_patternSize.x * v_widthRatio), 1.0);\nmediump float relativeTexY \x3d  0.5 + 0.25 * v_normal.y;\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * v_lineHalfWidth;\ngl_FragColor \x3d alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n#else\ngl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_extrude_offset;\nattribute vec4 a_dir_normal;\nattribute vec2 a_accumulatedDistance;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump float u_zoomFactor;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\nconst mediump float tileCoordRatio \x3d 8.0;\n#if defined (SDF)\nconst mediump float sdfPatternHalfWidth \x3d 15.5;\n#endif\n#if defined (PATTERN) || defined(SDF)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_blur \x3d blur + u_antialiasing;\nv_normal \x3d a_dir_normal.zw * scale;\n#if defined (PATTERN) || defined(SDF)\nv_tlbr          \x3d tlbr / u_mosaicSize.xyxy;\nv_patternSize   \x3d vec2(tlbr.z - tlbr.x, tlbr.y - tlbr.w);\n#if defined (PATTERN)\nv_widthRatio \x3d width / v_patternSize.y;\n#else\nv_widthRatio \x3d width / sdfPatternHalfWidth / 2.0;\n#endif\n#endif\nv_lineHalfWidth \x3d (width + u_antialiasing) * 0.5;\nmediump vec2 dir \x3d a_dir_normal.xy * scale;\nmediump vec2 offset_ \x3d a_extrude_offset.zw * scale * offset;\nmediump vec2 dist \x3d v_lineHalfWidth * scale * a_extrude_offset.xy;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos + offset_ * tileCoordRatio / u_zoomFactor, 1.0) + u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n#if defined (PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d a_accumulatedDistance.x * u_zoomFactor / tileCoordRatio + dot(dir, dist + offset_);\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d abs(v_normal.y);\nlowp float alpha \x3d smoothstep(1.0, 0.0, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_normal \x3d a_xnormal;\nmediump vec2 dist \x3d u_outline_width * scale * a_offset;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nvarying lowp vec2 v_tex;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying lowp vec2 v_tex;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nconst float sdfPixel \x3d 3.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nif (u_halo \x3e 0.5)\n{\nv_color \x3d halo_color * opacity;\nhalo_width *\x3d sdfPixel;\nhalo_blur *\x3d sdfPixel;\n}\nelse\n{\nv_color \x3d color * opacity;\nhalo_width \x3d 0.0;\nhalo_blur \x3d 0.0;\n}\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_color *\x3d interpolatedOpacity;\nmediump float a_angle       \x3d a_levelInfo[1];\nmediump float a_minLevel    \x3d a_levelInfo[2];\nmediump float a_maxLevel    \x3d a_levelInfo[3];\nmediump vec2 a_tex          \x3d a_texAngleRange.xy;\nmediump float a_visMinAngle    \x3d a_texAngleRange.z;\nmediump float a_visMaxAngle    \x3d a_texAngleRange.w;\nmediump float delta_z \x3d 0.0;\nmediump float angle \x3d mod(a_angle + u_mapRotation, 256.0);\nif (a_visMinAngle \x3c a_visMaxAngle)\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n}\nelse\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n}\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_color[3], 0.0);\nv_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_edgeDistance \x3d edgePos - halo_width / size;\nv_edgeWidth \x3d (u_antialiasingWidth + halo_blur) / size;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}","util.glsl":"float nextPOT(in float x) {\nreturn pow(2.0, ceil(log2(abs(x))));\n}"}}})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define("exports ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/programUtils ../../../webgl/Texture ../../../webgl/VertexArrayObject ./shaders/BitBlitPrograms".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c){F=function(){function h(){this._initialized=!1}var l=h.prototype;l.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};l.render=function(q,e,d,g){q&&(this._initialized||this._initialize(q),q.setBlendFunctionSeparate(1,771,1,771),q.bindVAO(this._vertexArrayObject),q.useProgram(this._program),e.setSamplingMode(d),q.bindTexture(e,0),this._program.setUniform1i("u_tex",
0),this._program.setUniform1f("u_opacity",g),q.drawArrays(5,0,4),q.bindTexture(null,0),q.bindVAO())};l._initialize=function(q){if(this._initialized)return!0;const e=c.bitBlit.attributes,d=b.createProgram(q,c.bitBlit);if(!d)return!1;const g=new Int8Array(16);g[0]=-1;g[1]=-1;g[2]=0;g[3]=0;g[4]=1;g[5]=-1;g[6]=1;g[7]=0;g[8]=-1;g[9]=1;g[10]=0;g[11]=1;g[12]=1;g[13]=1;g[14]=1;g[15]=1;q=new f(q,e,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,
offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:G.createVertex(q,35044,g)});this._program=d;this._vertexArrayObject=q;return this._initialized=!0};return h}();u.BitBlitRenderer=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["exports","./sources/resolver"],function(u,G){G={shaders:{vertexShader:G.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:G.resolveIncludes("bitBlit/bitBlit.frag")},attributes:new Map([["a_pos",
0],["a_tex",1]])};u.bitBlit=G;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("../../../../core/maybe ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/ProgramCache ../../../webgl/Texture ../../../webgl/VertexArrayObject ./enums ./shaders/MaterialPrograms".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h){const l=d=>d===c.WGLDrawPhase.HITTEST||d===c.WGLDrawPhase.LABEL_ALPHA,q=({rendererInfo:d,drawPhase:g},m,n,r)=>{m=m.getVariationHash();r=r.join(".");g=(l(g)?1:0)|(g===c.WGLDrawPhase.HIGHLIGHT?2:0);return`${m}-${r}-${g}-${d.getVariationHash()}-${u.isSome(n)&&n.join(".")}`},e=(d,g,m,n)=>{n=n.reduce((r,t)=>({...r,[t]:d.context.driverTest[t]}),{});g={...g.getVariation(),...d.rendererInfo.getVariation(),highlight:d.drawPhase===c.WGLDrawPhase.HIGHLIGHT,id:l(d.drawPhase),
...n};if(u.isSome(m))for(const r of m)g[r]=!0;return g};return function(){function d(m){this._programByKey=new Map;this._programCache=new b(m)}var g=d.prototype;g.dispose=function(){this._programCache&&this._programCache.dispose()};g.getProgram=function(m,n,r=[],t=[]){const z=n.vsPath+"."+n.fsPath+JSON.stringify(r)+t.join(".");if(this._programByKey.has(z))return this._programByKey.get(z);t=t.reduce((x,E)=>({...x,[E]:m.context.driverTest[E]}),{});r={...r.map(x=>"string"===typeof x?{name:x,value:!0}:
x).reduce((x,E)=>({...x,[E.name]:E.value}),{}),...t};const {vsPath:w,fsPath:B,attributes:A}=n;n=this._programCache.getProgram(h.createProgramTemplate(w,B,A),r);if(!n)throw Error("Unable to get program for key: ${key}");this._programByKey.set(z,n);return n};g.getMaterialProgram=function(m,n,r,t,z,w=["ignoresSamplerPrecision"]){const B=q(m,n,z,w);if(this._programByKey.has(B))return this._programByKey.get(B);m=e(m,n,z,w);r=this._programCache.getProgram(h.createProgramTemplate(r,r,t),m);if(!r)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(B,r);return r};return d}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["exports","./sources/resolver","../../../../webgl/programUtils"],function(u,G,F){const C=y=>{const v={};for(const k in y){{let b=void 0;var p=k;b=""+p[0].toUpperCase();for(let a=1;a<p.length;a++){const f=p[a];f===f.toUpperCase()?(b+="_",b+=f):b+=f.toUpperCase()}p=b}v[p]=y[k]}return F.glslifyDefineMap(v)};u.createProgramTemplate=(y,v,p)=>{const k=y+y.substring(y.lastIndexOf("/")),
b=v+v.substring(v.lastIndexOf("/"));return{attributes:p,shaders:a=>({vertexShader:C(a)+G.resolveIncludes(`${k}.vert`),fragmentShader:C(a)+G.resolveIncludes(`${b}.frag`)})}};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TextureManager":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../config ../../../../request ../../../../core/BidiText ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../chunks/vec2 ../../../../chunks/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./Utils ./animatedFormats/apng ./animatedFormats/gif ./util/Result ./util/symbolUtils ../../../support/QueueProcessor".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e,d,g,m,n,r,t,z,w,B){function A(I,J){return x.apply(this,arguments)}function x(){x=u._asyncToGenerator(function*(I,J){I=n.getUrl(I);var M;if(I.includes(";base64,")){J=I.indexOf(";base64,")+8;J=I.substring(J);J=atob(J);I=new Uint8Array(J.length);for(M=0;M<J.length;M++)I[M]=J.charCodeAt(M);M=I.buffer}else try{const {data:O}=yield F(I,{responseType:"array-buffer",...J});M=O}catch(O){if(!k.isAbortError(O))return new y("mapview-invalid-resource",`Could not fetch requested resource at ${I}`)}return M});
return x.apply(this,arguments)}function E(I,J){J=Math.round(b.pt2px(J)*window.devicePixelRatio);return Math.min(I,J*(128<=J?2:4))}const D=f.create(),K=v.getLogger("esri.views.2d.engine.webgl.TextureManager");let H=function(){function I(J,M,O){this.mosaicType=J;this.page=M;this.sdf=O}I.fromMosaic=function(J,M){return new I(J,M.page,M.sdf)};return I}();return function(){function I(M,O){this.resourceManager=O;this._invalidFontsMap=new Map;this._sdfConverter=new g(126);this._bindingInfos=[];this._hashToBindingIndex=
new Map;this._ongoingRasterizations=new Map;this._imageRequestQueue=new B.QueueProcessor({concurrency:10,process:function(){var L=u._asyncToGenerator(function*(S,Q){k.throwIfAborted(Q);try{return yield F(S,{responseType:"image",signal:Q})}catch(P){if(!k.isAbortError(P))throw new y("mapview-invalid-resource",`Could not fetch requested resource at ${S}`,P);throw P;}});return function(S,Q){return L.apply(this,arguments)}}()});this._spriteMosaic=new m(M,2048,2048,500);this._glyphSource=new d(`${G.fontsUrl}/{fontstack}/{range}.pbf`);
this._glyphMosaic=new e(1024,1024,this._glyphSource);this._rasterizer=new c(O)}var J=I.prototype;J.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._sdfConverter.dispose();this._sdfConverter=this._glyphMosaic=this._spriteMosaic=null;this._hashToBindingIndex.clear();this._bindingInfos=this._hashToBindingIndex=null;this._ongoingRasterizations.clear();this._ongoingRasterizations=null;this._imageRequestQueue.clear();this._imageRequestQueue=null};
J.rasterizeItem=function(){var M=u._asyncToGenerator(function*(O,L,S,Q){if(p.isNone(O))return K.error(new y("mapview-null-resource","Unable to rasterize null resource",void 0)),null;switch(O.type){case "text":case "esriTS":return O=yield this._rasterizeText(O,S,Q),O.forEach(P=>this._setTextureBinding(l.MosaicType.GLYPH,P)),{glyphMosaicItems:O};default:if(n.is3D(O))return K.error(new y("mapview-invalid-type",`MapView does not support symbol type: ${O.type}`,O)),null;O=yield this._rasterizeSpriteSymbol(O,
L,Q);z.ok(O)&&O&&this._setTextureBinding(l.MosaicType.SPRITE,O);return{spriteMosaicItem:O}}});return function(O,L,S,Q){return M.apply(this,arguments)}}();J.bindTextures=function(M,O,L,S=!1){if(0!==L.textureBinding){var Q=this._bindingInfos[L.textureBinding-1];L=Q.page;S=S?9987:9729;switch(Q.mosaicType){case l.MosaicType.SPRITE:{Q=this.sprites.getWidth(L);const P=this.sprites.getHeight(L);Q=a.set(D,Q,P);this._spriteMosaic.bind(M,S,L,h.TEXTURE_BINDING_SPRITE_ATLAS);O.setUniform1i("u_texture",h.TEXTURE_BINDING_SPRITE_ATLAS);
O.setUniform2fv("u_mosaicSize",Q);break}case l.MosaicType.GLYPH:Q=a.set(D,this.glyphs.width,this.glyphs.height);this._glyphMosaic.bind(M,S,L,h.TEXTURE_BINDING_GLYPH_ATLAS);O.setUniform1i("u_texture",h.TEXTURE_BINDING_GLYPH_ATLAS);O.setUniform2fv("u_mosaicSize",Q);break;default:K.error("mapview-texture-manager",`Cannot handle unknown type ${Q.mosaicType}`)}}};J._hashMosaic=function(M,O){return 1|M<<1|(O.sdf?1:0)<<2|O.page<<3};J._setTextureBinding=function(M,O){const L=this._hashMosaic(M,O);this._hashToBindingIndex.has(L)||
(M=H.fromMosaic(M,O),this._hashToBindingIndex.set(L,this._bindingInfos.length+1),this._bindingInfos.push(M));O.textureBinding=this._hashToBindingIndex.get(L)};J._rasterizeText=function(){var M=u._asyncToGenerator(function*(O,L,S){let Q,P;Q="cim"in O?O.fontName:q.getFullyQualifiedFontName(O.font);P=O.text;O=this._invalidFontsMap.has(Q);L=L?L:n.charCodes(C.bidiText(P)[0]);try{return yield this._glyphMosaic.getGlyphItems(O?"arial-unicode-ms-regular":Q,L,S)}catch(R){return K.error(new y("mapview-invalid-resource",
`Couldn't find font ${Q}. Falling back to Arial Unicode MS Regular`,void 0)),this._invalidFontsMap.set(Q,!0),this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",L,S)}});return function(O,L,S){return M.apply(this,arguments)}}();J._rasterizeSpriteSymbol=function(){var M=u._asyncToGenerator(function*(O,L,S){if(n.isSimple(O))return null;L=w.keyFromSymbol(O);if(this._spriteMosaic.has(L))return this._spriteMosaic.getSpriteItem(L);if(n.isSVGResource(O)||n.isImageResource(O))return this._handleAsyncResource(L,
O,S);if(S=this._rasterizer.rasterizeJSONResource(O,1)){const {size:Q,image:P,sdf:R,simplePattern:N}=S;return this._addItemToMosaic(L,Q,{type:"static",data:P},n.shouldRepeat(O),R,N)}return new y("TextureManager","unrecognized or null rasterized image")});return function(O,L,S){return M.apply(this,arguments)}}();J._handleAsyncResource=function(){var M=u._asyncToGenerator(function*(O,L,S){if(this._ongoingRasterizations.has(O))return this._ongoingRasterizations.get(O);L=n.isSVGResource(L)?this._handleSVG(L,
O,S):this._handleImage(L,O,S);this._ongoingRasterizations.set(O,L);try{yield L,this._ongoingRasterizations.delete(O)}catch{this._ongoingRasterizations.delete(O)}return L});return function(O,L,S){return M.apply(this,arguments)}}();J._handleSVG=function(){var M=u._asyncToGenerator(function*(O,L,S){O=yield this._sdfConverter.draw(O.path,S);return this._addItemToMosaic(L,[126,126],{type:"static",data:new Uint32Array(O.buffer)},!1,!0,!0)});return function(O,L,S){return M.apply(this,arguments)}}();J._handleGIFOrPNG=
function(){var M=u._asyncToGenerator(function*(O,L,S){var Q=yield A(O,S);if(z.ok(Q)){var P=t.isGIF(Q);const R=r.isPNG(Q);if(!P&&!R)return new y("mapview-invalid-resource","Image data is neither GIF nor PNG!");let N;try{P&&t.isAnimatedGIF(Q)?N=yield t.default.create(Q,S):R&&r.isAnimatedPNG(Q)&&(N=yield r.default.create(Q,S))}catch(W){if(!k.isAbortError(W))return new y("mapview-invalid-resource","Could not fetch requested resource!")}if(N&&z.ok(N))return this._addItemToMosaic(L,[N.width,N.height],{type:"animated",
data:N},n.shouldRepeat(O),!1,!1);S=new Blob([Q],{type:P?"image/gif":"image/png"});if((S=yield this._imageFromBlob(S))&&S instanceof HTMLImageElement){Q=S.width;P=S.height;"esriPMS"===O.type&&(Q=Math.round(E(S.width,n.getPMSResourceSize(O))),P=Math.round(Q/S.width*S.height));const {size:W,sdf:X,image:T}=this._rasterizer.rasterizeImageResource(Q,P,S,"cim"in O?O.cim.colorSubstitutions:void 0);return this._addItemToMosaic(L,W,{type:"static",data:T},n.shouldRepeat(O),X,!1)}}return new y("mapview-invalid-resource",
"Could not handle resource!")});return function(O,L,S){return M.apply(this,arguments)}}();J._handleImage=function(){var M=u._asyncToGenerator(function*(O,L,S){if(n.isGIF(O)||n.isPNG(O))return this._handleGIFOrPNG(O,L,S);const Q=n.getUrl(O);try{let R;const N=this.resourceManager.getResource(Q);if(p.isSome(N))R=N;else{const {data:Z}=yield this._imageRequestQueue.push(Q,{...S});R=Z}if(n.isSVGImage(Q))if("width"in O&&"height"in O)R.width=b.pt2px(O.width),R.height=b.pt2px(O.height);else if("cim"in O){var P;
const Z=O.cim;R.width=b.pt2px(null!=(P=Z.width)?P:Z.scaleX*Z.size);R.height=b.pt2px(Z.size)}if(!R.width||!R.height)return null;let W=R.width,X=R.height;"esriPMS"===O.type&&(W=Math.round(E(R.width,n.getPMSResourceSize(O))),X=Math.round(W/R.width*R.height));const {size:T,sdf:U,image:V}=this._rasterizer.rasterizeImageResource(W,X,R,"cim"in O?O.cim.colorSubstitutions:void 0);return this._addItemToMosaic(L,T,{type:"static",data:V},n.shouldRepeat(O),U,!1)}catch(R){if(!k.isAbortError(R))return new y("mapview-invalid-resource",
`Could not fetch requested resource at ${Q}. ${R.message}`)}});return function(O,L,S){return M.apply(this,arguments)}}();J._imageFromBlob=function(){var M=u._asyncToGenerator(function*(O){O=window.URL.createObjectURL(O);try{const {data:L}=yield this._imageRequestQueue.push(O);window.URL.revokeObjectURL(O);return L}catch(L){window.URL.revokeObjectURL(O);if(!k.isAbortError(L))return new y("mapview-invalid-resource",`Could not fetch requested resource at ${O}`);throw L;}});return function(O){return M.apply(this,
arguments)}}();J._addItemToMosaic=function(M,O,L,S,Q,P){return this._spriteMosaic.addSpriteItem(M,O,L,S,Q,P)};u._createClass(I,[{key:"sprites",get:function(){return this._spriteMosaic}},{key:"glyphs",get:function(){return this._glyphMosaic}}]);return I}()})},"esri/core/BidiText":function(){define(["exports","./BidiEngine"],function(u,G){const F=new G;u.bidiText=function(C){if(!F.hasBidiChar(C))return[C,!1];let y;y="rtl"===F.checkContextual(C)?"IDNNN":"ICNNN";return[F.bidiTransform(C,y,"VLYSN"),!0]};
Object.defineProperty(u,"__esModule",{value:!0})})},"esri/core/BidiEngine":function(){define(["./bidiEngineTables"],function(u){function G(t,z,w,B,A){var x=t;void 0===z&&(z=A.defInFormat);void 0===w&&(w=A.defOutFormat);void 0===B&&(B=A.defSwap);if(z!==w){var E=z.substring(0,1),D=w.substring(0,1);var K=z.substring(1,4);var H=w.substring(1,4);"C"===K.charAt(0)&&(K=F(x),K="ltr"===K||"rtl"===K?K.toUpperCase():"L"===z.charAt(2)?"LTR":"RTL",z=E+K);"C"===H.charAt(0)&&(K=F(x),"rtl"===K?H="RTL":"ltr"===K?
(x=x.split(""),x.reverse(),K=F(x.join("")),H=K.toUpperCase()):H="L"===w.charAt(2)?"LTR":"RTL",w=D+H)}if(z===w)return t;D=z.substring(0,1);x=z.substring(1,4);E=w.substring(0,1);H=w.substring(1,4);A.inFormat=z;A.outFormat=w;A.swap=B;if("L"===D&&"VLTR"===w){if("LTR"===x)return A.dir=0,C(t,A);if("RTL"===x)return A.dir=1,C(t,A)}if("V"===D&&"V"===E)return A.dir="RTL"===x?1:0,v(t,A);if("L"===D&&"VRTL"===w)return A.dir="LTR"===x?0:1,t=C(t,A),v(t);if("VLTR"===z&&"LLTR"===w)return A.dir=0,C(t,A);if("V"===D&&
"L"===E&&x!==H)return t=v(t),"RTL"===x?G(t,"LLTR","VLTR",B,A):G(t,"LRTL","VRTL",B,A);if("VRTL"===z&&"LRTL"===w)return G(t,"LRTL","VRTL",B,A);"L"===D&&"L"===E&&(z=A.swap,A.swap=z.substr(0,1)+"N","RTL"===x?(A.dir=1,t=C(t,A),A.swap="N"+z.substr(1,2),A.dir=0,t=C(t,A)):(A.dir=0,t=C(t,A),A.swap="N"+z.substr(1,2),t=G(t,"VLTR","LRTL",A.swap,A)));return t}function F(t){return(t=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(t))?"z">=t[0]?"ltr":"rtl":""}function C(t,z){t=t.split("");
const w=[];y(t,w,z);if(0!==z.hiLevel&&z.swap.substr(0,1)!==z.swap.substr(1,2))for(let x=0;x<t.length;x++)if(1===w[x]){var B=x;b:{let E=void 0;var A=t[x];let D=0,K=u.SwapTable.length-1;for(;D<=K;)if(E=Math.floor((D+K)/2),A<u.SwapTable[E][0])K=E-1;else if(A>u.SwapTable[E][0])D=E+1;else{A=u.SwapTable[E][1];break b}}t[B]=A}b(2,t,w,z);b(1,t,w,z);g=w;return t.join("")}function y(t,z,w){const B=t.length;var A=w.dir?u.impTabRtl:u.impTabLtr,x=0,E=-1;const D=[],K=[];w.hiLevel=w.dir;w.lastArabic=!1;w.hasUbatAl=
!1;w.hasUbatB=!1;w.hasUbatS=!1;for(var H=0;H<B;H++){var I=H;{var J=t[H].charCodeAt(0);const M=u.PrimaryTable[J>>8];J=M<u.TBBASE?M:u.UnicodeTable[M-u.TBBASE][J&255]}D[I]=J}for(I=0;I<B;I++){H=a(t,D,K,I,w);K[I]=H;x=A[x][H];J=x&240;x&=15;H=A[x][5];z[I]=H;if(0<J){if(16===J)for(;E<I;E++)z[E]=1;E=-1}if(A[x][6])-1===E&&(E=I);else if(-1<E){for(;E<I;E++)z[E]=H;E=-1}D[I]===u.UBAT_B&&(z[I]=0);w.hiLevel|=H}if(w.hasUbatS)for(t=0;t<B;t++)if(D[t]===u.UBAT_S)for(z[t]=w.dir,A=t-1;0<=A;A--)if(D[A]===u.UBAT_WS)z[A]=
w.dir;else break}function v(t,z){t=t.split("");if(z){const w=[];y(t,w,z);g=w}t.reverse();e.reverse();return t.join("")}function p(t){for(let z=0;z<u.ArabicAlefBetIntervalsBegine.length;z++)if(t>=u.ArabicAlefBetIntervalsBegine[z]&&t<=u.ArabicAlefBetIntervalsEnd[z])return!0;return!1}function k(t,z,w,B){for(;z*w<B&&c(t[z]);)z+=w;return z*w<B&&p(t[z])?!0:!1}function b(t,z,w,B){if(!(B.hiLevel<t))if(1!==t||1!==B.dir||B.hasUbatB){B=z.length;for(var A=0,x,E,D;A<B;){if(w[A]>=t){for(x=A+1;x<B&&w[x]>=t;)x++;
for(E=x-1;A<E;A++,E--)D=z[A],z[A]=z[E],z[E]=D,D=e[A],e[A]=e[E],e[E]=D;A=x}A++}}else z.reverse(),e.reverse()}function a(t,z,w,B,A){return{UBAT_L:()=>{A.lastArabic=!1;return u.UBAT_L},UBAT_R:()=>{A.lastArabic=!1;return u.UBAT_R},UBAT_ON:()=>u.UBAT_ON,UBAT_AN:()=>u.UBAT_AN,UBAT_EN:()=>A.lastArabic?u.UBAT_AN:u.UBAT_EN,UBAT_AL:()=>{A.lastArabic=!0;A.hasUbatAl=!0;return u.UBAT_R},UBAT_WS:()=>u.UBAT_ON,UBAT_CS:()=>{let x,E;if(1>B||B+1>=z.length||(x=w[B-1])!==u.UBAT_EN&&x!==u.UBAT_AN||(E=z[B+1])!==u.UBAT_EN&&
E!==u.UBAT_AN)return u.UBAT_ON;A.lastArabic&&(E=u.UBAT_AN);return E===x?E:u.UBAT_ON},UBAT_ES:()=>(0<B?w[B-1]:u.UBAT_B)===u.UBAT_EN&&B+1<z.length&&z[B+1]===u.UBAT_EN?u.UBAT_EN:u.UBAT_ON,UBAT_ET:()=>{if(0<B&&w[B-1]===u.UBAT_EN)return u.UBAT_EN;if(A.lastArabic)return u.UBAT_ON;let x=B+1;const E=z.length;for(;x<E&&z[x]===u.UBAT_ET;)x++;return x<E&&z[x]===u.UBAT_EN?u.UBAT_EN:u.UBAT_ON},UBAT_NSM:()=>{if("VLTR"===A.inFormat){for(var x=z.length,E=B+1;E<x&&z[E]===u.UBAT_NSM;)E++;if(E<x&&(x=t[B].charCodeAt[0],
E=z[E],(1425<=x&&2303>=x||64286===x)&&(E===u.UBAT_R||E===u.UBAT_AL)))return u.UBAT_R}return 1>B||z[B-1]===u.UBAT_B?u.UBAT_ON:w[B-1]},UBAT_B:()=>{A.lastArabic=!0;A.hasUbatB=!0;return A.dir},UBAT_S:()=>{A.hasUbatS=!0;return u.UBAT_ON},UBAT_LRE:()=>{A.lastArabic=!1;return u.UBAT_ON},UBAT_RLE:()=>{A.lastArabic=!1;return u.UBAT_ON},UBAT_LRO:()=>{A.lastArabic=!1;return u.UBAT_ON},UBAT_RLO:()=>{A.lastArabic=!1;return u.UBAT_ON},UBAT_PDF:()=>{A.lastArabic=!1;return u.UBAT_ON},UBAT_BN:()=>u.UBAT_ON}[u.TYPES_NAMES[z[B]]]()}
function f(t,z){for(let w=0;w<u.BaseForm.length;w++)if(t===u.BaseForm[w])return z[w];return t}function c(t){return"\u064b"<=t&&"\u0655">=t?!0:!1}function h(t){return"L"===t?"LTR":"R"===t?"RTL":"C"===t?"CLR":"D"===t?"CRL":""}function l(t,z){for(let w=0;w<u.AlefTable.length;w++)if(t===u.AlefTable[w])return z[w];return t}function q(t,z,w,B){for(let A=0;A<t.length;A++)if(t[A]>z||!w&&t[A]===z)t[A]+=B}let e=[],d=[],g=[];const m={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",
outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},n=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,r=/[\u0591-\u06ff\ufb1d-\ufefc]/;return function(){function t(){this.inputFormat="ILYNN";this.outputFormat="VLNNN";this.sourceToTarget=[];this.targetToSource=[];this.levels=[]}var z=t.prototype;z.bidiTransform=function(w,B,A){this.sourceToTarget=[];this.targetToSource=[];if(!w)return"";var x=this.sourceToTarget,E=this.targetToSource,D=w.length;e=[];
g=[];for(var K=0;K<D;K++)x[K]=K,E[K]=K,e[K]=K;if(!this.checkParameters(B,A))return w;B=this.inputFormat;A=this.outputFormat;x=w;D=h(B.charAt(1));x=h(A.charAt(1));K="I"===B.charAt(0)?"L":B.charAt(0);E="I"===A.charAt(0)?"L":A.charAt(0);D=K+D;x=E+x;E=B.charAt(2)+A.charAt(2);m.defInFormat=D;m.defOutFormat=x;m.defSwap=E;w=G(w,D,x,E,m);x=!1;if("R"===A.charAt(1))x=!0;else if("C"===A.charAt(1)||"D"===A.charAt(1))x="rtl"===this.checkContextual(w);E=this.sourceToTarget=e;D=Array(E.length);for(K=0;K<E.length;K++)D[E[K]]=
K;d=this.targetToSource=E=D;if(B.charAt(3)===A.charAt(3))x=w;else if("S"===A.charAt(3))if(B=x,A=!0,0===w.length)x="";else{void 0===B&&(B=!0);void 0===A&&(A=!0);w=String(w);w=w.split("");D=0;x=1;E=w.length;B||(D=w.length-1,x=-1,E=1);var H=D;D=A;var I=0;K=[];for(var J=0;H*x<E;H+=x)if(p(w[H])||c(w[H])){var M;if(M="\u0644"===w[H])b:{for(var O=w,L=H+x,S=x,Q=E;L*S<Q&&c(O[L]);)L+=S;M=" ";if(L*S<Q)for(M=O[L],O=0;O<u.AlefTable.length;O++)if(u.AlefTable[O]===M){M=!0;break b}M=!1}if(M){w[H]=0===I?l(w[H+x],u.LamAlefInialTableFE):
l(w[H+x],u.LamAlefMedialTableFE);H+=x;I=w;M=H;O=x;for(L=E;M*O<L&&c(I[M]);)M+=O;M*O<L&&(I[M]=" ");D&&(K[J]=H,J++);I=0}else{M=w[H];if(1===I){O=H;if(k(w,H+x,x,E))b:for(L=w[H],S=0;S<u.BaseForm.length;S++){if(L===u.BaseForm[S]){L=u.MedialForm[S];break b}}else L=f(w[H],u.FinalForm);w[O]=L}else!0===k(w,H+x,x,E)?w[H]=f(w[H],u.InitialForm):w[H]=f(w[H],u.IsolatedForm);c(M)||(I=1);b:{for(O=0;O<u.StandAlonForm.length;O++)if(u.StandAlonForm[O]===M){M=!0;break b}M=!1}!0===M&&(I=0)}}else I=0;x=K;E="";for(D=0;D<
w.length;D++){if(K=A){b:{for(K=0;K<x.length;K++)if(x[K]===D)break b;K=-1}K=-1<K}K?(q(d,D,!B,-1),e.splice(D,1)):E+=w[D]}x=E}else if(B=w,A=x,w=!0,0===B.length)x="";else for(void 0===w&&(w=!0),void 0===A&&(A=!0),B=String(B),x="",E=B.split(""),D=0;D<B.length;D++)K=!1,"\ufe70"<=E[D]&&"\ufeff">E[D]?(J=B.charCodeAt(D),"\ufef5"<=E[D]&&"\ufefc">=E[D]?(A?(0<D&&w&&" "===E[D-1]?x=x.substring(0,x.length-1)+"\u0644":(x+="\u0644",K=!0),x+=u.AlefTable[(J-65269)/2]):(x+=u.AlefTable[(J-65269)/2],x+="\u0644",D+1<B.length&&
w&&" "===E[D+1]?D++:K=!0),K&&(q(d,D,!0,1),e.splice(D,0,e[D]))):x+=u.FETo06Table[J-65136]):x+=E[D];this.sourceToTarget=e;this.targetToSource=d;this.levels=g;return x};z._inputFormatSetter=function(w){if(!n.test(w))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=w};z._outputFormatSetter=function(w){if(!n.test(w))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=w};z.checkParameters=function(w,B){w?this._inputFormatSetter(w):
w=this.inputFormat;B?this._outputFormatSetter(B):B=this.outputFormat;return w===B?!1:!0};z.checkContextual=function(w){w=F(w);if("ltr"!==w&&"rtl"!==w){try{w=document.dir.toLowerCase()}catch(B){}"ltr"!==w&&"rtl"!==w&&(w="ltr")}return w};z.hasBidiChar=function(w){return r.test(w)};return t}()})},"esri/core/bidiEngineTables":function(){define(["exports"],function(u){u.AlefTable=["\u0622","\u0623","\u0625","\u0627"];u.ArabicAlefBetIntervalsBegine=["\u0621","\u0641"];u.ArabicAlefBetIntervalsEnd=["\u063a",
"\u064a"];u.BaseForm="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split("");u.FETo06Table="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split("");
u.FinalForm="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split("");u.InitialForm="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split("");
u.IsolatedForm="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split("");u.LamAlefInialTableFE=["\ufef5","\ufef7","\ufef9","\ufefb"];u.LamAlefMedialTableFE=["\ufef6","\ufef8","\ufefa","\ufefc"];u.MedialForm="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split("");
u.PrimaryTable=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107];u.StandAlonForm="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split("");u.SwapTable=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59",
"\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]];u.TBBASE=100;u.TYPES_NAMES="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" ");u.UBAT_AL=7;u.UBAT_AN=3;u.UBAT_B=5;u.UBAT_BN=18;u.UBAT_CS=9;u.UBAT_EN=2;u.UBAT_ES=10;u.UBAT_ET=11;u.UBAT_L=0;u.UBAT_LRE=13;u.UBAT_LRO=16;u.UBAT_NSM=12;u.UBAT_ON=
4;u.UBAT_PDF=15;u.UBAT_R=1;u.UBAT_RLE=14;u.UBAT_RLO=17;u.UBAT_S=6;u.UBAT_WS=8;u.UnicodeTable=[[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,
4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,12,1,12,12,1,12,12,1,12,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,11,11,7,9,7,4,4,12,12,12,12,12,12,12,12,12,12,12,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,3,3,3,3,3,3,3,3,3,3,11,3,3,7,7,7,12,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,3,4,12,12,12,12,12,12,7,7,12,12,4,12,12,12,12,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,12,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,12,12,12,12,12,12,12,12,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,18,18,18,18,18,4,4,4,4,4,18,18,18,18,18,18,2,0,4,4,2,2,2,2,2,2,10,10,4,4,4,0,2,2,2,2,2,2,2,2,2,2,10,10,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,
4,4,0,0,0,0,0,4,4,4,4,4,1,12,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,11,4,4,10,10,4,4,4,4,4,11,11,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,4,4,18],[4,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,11,11,4,4,4,11,11,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];u.impTabLtr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]];u.impTabRtl=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]];Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/Rasterizer":function(){define(["./CIMSymbolHelper","./Rect","./SDFHelper","./utils"],function(u,G,F,C){return function(){function y(p){this._resourceManager=p}var v=y.prototype;v.dispose=function(){this._rasterizationCanvas=
null};v.rasterizeJSONResource=function(p,k,b){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===p.type||"esriSFS"===p.type){const [d,g,m]=u.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,p.style,k);return{size:[g,m],image:new Uint32Array(d.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===p.type||"esriSLS"===p.type||"line"===p.type&&p.dashTemplate){if("simple-line"===p.type||"esriSLS"===p.type)switch(b=u.slsDashToTemplateArray(p.style,
p.cap),p.cap){case "butt":p="Butt";break;case "square":p="Square";break;default:p="Round"}else b=p.dashTemplate,p=p.cim.capStyle;const [d,g,m]=u.SymbolHelper.rasterizeSimpleLine(b,p);return{size:[g,m],image:new Uint32Array(d.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let a,f;"simple-marker"===p.type||"esriSMS"===p.type||"line-marker"===p.type?(p=u.CIMSymbolHelper.fromSimpleMarker(p),f=F.getSDFInfo(p)):p.cim&&"CIMHatchFill"===p.cim.type?(p=u.CIMSymbolHelper.fromCIMHatchFill(p.cim),a=new G(p.frame.xmin,
-p.frame.ymax,p.frame.xmax-p.frame.xmin,p.frame.ymax-p.frame.ymin)):p.cim.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===p.cim.markerPlacement.type?(p=u.CIMSymbolHelper.fromCIMInsidePolygon(p.cim),a=new G(p.frame.xmin,-p.frame.ymax,p.frame.xmax-p.frame.xmin,p.frame.ymax-p.frame.ymin)):(p=p.cim,f=F.getSDFInfo(p));if(f&&!b){const [d,g,m]=F.buildSDF(f);return d?{size:[g,m],image:new Uint32Array(d.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const [c,h,l,q,e]=u.CIMSymbolHelper.rasterize(this._rasterizationCanvas,
p,a,this._resourceManager,!b);return c?{size:[h,l],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!1,anchorX:q,anchorY:e}:null};v.rasterizeImageResource=function(p,k,b,a){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=p;this._rasterizationCanvas.height=k;var f=this._rasterizationCanvas.getContext("2d");b instanceof ImageData?f.putImageData(b,0,0):(b.setAttribute("width",`${p}px`),b.setAttribute("height",`${k}px`),f.drawImage(b,
0,0,p,k));b=f.getImageData(0,0,p,k);b=new Uint8Array(b.data);if(a)for(var c of a)if(c&&c.oldColor&&4===c.oldColor.length&&c.newColor&&4===c.newColor.length){const [h,l,q,e]=c.oldColor,[d,g,m,n]=c.newColor;if(h!==d||l!==g||q!==m||e!==n)for(a=0;a<b.length;a+=4)h===b[a]&&l===b[a+1]&&q===b[a+2]&&e===b[a+3]&&(b[a]=d,b[a+1]=g,b[a+2]=m,b[a+3]=n)}for(a=0;a<b.length;a+=4)c=b[a+3]/255,b[a]*=c,b[a+1]*=c,b[a+2]*=c;f=b;c=p;a=k;if(512<=c||512<=a){f=c/a;1<f?(c=512,a=Math.round(512/f)):(a=512,c=Math.round(512*f));
f=new Uint8Array(4*c*a);const h=new Uint8ClampedArray(f.buffer);C.resampleHermite(b,p,k,h,c,a,!1)}return{size:[c,a],image:new Uint32Array(f.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return y}()})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../Color ../../core/BidiText ../../core/floatRGBA ../../core/lang ../../core/Logger ../../core/mathUtils ../../core/maybe ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ./CIMPlacements ./CIMSymbolDrawHelper ./utils ../../views/2d/engine/vectorTiles/GeometryUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e,d){function g(Q,P){switch(P.type){case "CIMSymbolReference":return g(Q,P.symbol);case "CIMPointSymbol":Q.drawSymbol(P,{x:0,y:0});break;case "CIMLineSymbol":Q.drawSymbol(P,{paths:[[[0,0],[0,1]]]});break;case "CIMPolygonSymbol":Q.drawSymbol(P,{rings:[[[0,0],[0,1],[0,0]]]});break;case "CIMTextSymbol":Q.drawSymbol(P,{x:0,y:0});break;case "CIMVectorMarker":{const R=new c.Placement;Q.drawMarker(P,R)}}return Q.envelope()}function m(Q){if(!Q)return 0;switch(Q.type){case "CIMMarkerPlacementAlongLineSameSize":return Math.abs(Q.offset);
case "CIMMarkerPlacementAlongLineRandomSize":return Math.abs(Q.offset);case "CIMMarkerPlacementAtExtremities":return Math.abs(Q.offset);case "CIMMarkerPlacementAtMeasuredUnits":return Math.abs(Q.offset);case "CIMMarkerPlacementAtRatioPositions":return Math.abs(Q.offset);case "CIMMarkerPlacementInsidePolygon":return 0;case "CIMMarkerPlacementOnLine":return Math.abs(Q.offset);case "CIMMarkerPlacementOnVertices":return Math.abs(Q.offset);case "CIMMarkerPlacementPolygonCenter":return 0;default:return 0}}
function n(Q){if(!Q)return 0;switch(Q.type){case "CIMGeometricEffectArrow":return Math.abs(.5*Q.width);case "CIMGeometricEffectBuffer":return Math.abs(Q.size);case "CIMGeometricEffectExtension":return Math.abs(Q.length);case "CIMGeometricEffectJog":return Math.abs(.5*Q.length);case "CIMGeometricEffectMove":return Math.max(Math.abs(l.getValue(Q.offsetX)),Math.abs(l.getValue(Q.offsetY)));case "CIMGeometricEffectOffset":return Math.abs(Q.offset);case "CIMGeometricEffectOffsetTangent":return Math.abs(Q.offset);
case "CIMGeometricEffectRadial":return Math.abs(Q.length);case "CIMGeometricEffectRegularPolygon":return Math.abs(Q.radius);case "CIMGeometricEffectRotate":return 0;case "CIMGeometricEffectScale":return 0;case "CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(Q.fromWidth),Math.abs(Q.toWidth));case "CIMGeometricEffectWave":return Math.abs(Q.amplitude);default:return 0}}function r(Q){if(!Q)return 0;let P=0;for(const R of Q)P+=n(R);return P}const t=Math.PI,z=t/2,w=96/72,B=Math.PI/180,A=v.getLogger("esri.symbols.cim.CIMSymbolHelper");
v=function(){function Q(){}var P=Q.prototype;P.getSymbolInflateSize=function(R,N,W,X,T){R||(R=[0,0,0,0]);return N?this._getInflateSize(R,N,W,X,T):R};Q.SafeSize=function(R){const N=Math.max(Math.abs(R[0]),Math.abs(R[2]));R=Math.max(Math.abs(R[1]),Math.abs(R[3]));return Math.sqrt(N*N+R*R)};P._vectorMarkerBounds=function(R,N,W,X){let T=!0;const U=a.create();if(N&&N.markerGraphics)for(const V of N.markerGraphics)N=[0,0,0,0],V.geometry&&(f.getBoundsXY(U,V.geometry),N[0]=0,N[1]=0,N[2]=0,N[3]=0,this.getSymbolInflateSize(N,
V.symbol,W,0,X),U[0]+=N[0],U[1]+=N[1],U[2]+=N[2],U[3]+=N[3],T?(R[0]=U[0],R[1]=U[1],R[2]=U[2],R[3]=U[3],T=!1):(R[0]=Math.min(R[0],U[0]),R[1]=Math.min(R[1],U[1]),R[2]=Math.max(R[2],U[2]),R[3]=Math.max(R[3],U[3])));return R};P._getInflateSize=function(R,N,W,X,T){return void 0!==N.symbolLayers?(R=this._getLayersInflateSize(R,N.symbolLayers,W,X,T),N=r(N.effects),0<N&&(R[0]-=N,R[1]-=N,R[2]+=N,R[3]+=N),R):this._getTextInflatedSize(R,N,T)};P._getLayersInflateSize=function(R,N,W,X,T){let U=!0;if(!N)return R;
for(const ia of N)if(ia){var V=[0,0,0,0];switch(ia.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":N=ia;var Z=N.width;Z="Square"===N.capStyle||"Miter"===N.joinStyle?Z/1.4142135623730951:Z/2;V[0]=-Z;V[1]=-Z;V[2]=Z;V[3]=Z;break;case "CIMCharacterMarker":case "CIMVectorMarker":case "CIMPictureMarker":N=ia;if("CIMVectorMarker"===ia.type){if(Z=ia,V=this._vectorMarkerBounds(V,Z,W,T),Z.frame){var ca=(Z.frame.xmin+Z.frame.xmax)/2,ea=(Z.frame.ymin+Z.frame.ymax)/2;V[0]-=ca;V[1]-=
ea;V[2]-=ca;V[3]-=ea;Z=Z.size/(Z.frame.ymax-Z.frame.ymin);V[0]*=Z;V[1]*=Z;V[2]*=Z;V[3]*=Z}}else"CIMPictureMarker"===ia.type?(V=ia,ca=W.getResource(V.url),Z=1,k.isSome(ca)&&ca.height&&(Z=ca.width/ca.height),ca=N.size/2,V=N.size*Z*V.scaleX/2,V=[-V,-ca,V,ca]):(V=N.size/2,V=[-V,-V,V,V]);N.anchorPoint&&("Absolute"===N.anchorPointUnits?(Z=N.anchorPoint.x,ca=N.anchorPoint.y):(Z=N.anchorPoint.x*(V[2]-V[0]),ca=N.anchorPoint.y*(V[3]-V[1])),V[0]-=Z,V[1]-=ca,V[2]-=Z,V[3]-=ca);Z=l.getValue(N.rotation);N.rotateClockwise&&
(Z=-Z);X&&(Z-=X);Z&&(ca=B*Z,Z=Math.cos(ca),ca=Math.sin(ca),ea=a.create([q.C_INFINITY,q.C_INFINITY,-q.C_INFINITY,-q.C_INFINITY]),a.expandPointInPlace(ea,[V[0]*Z-V[1]*ca,V[0]*ca+V[1]*Z]),a.expandPointInPlace(ea,[V[0]*Z-V[3]*ca,V[0]*ca+V[3]*Z]),a.expandPointInPlace(ea,[V[2]*Z-V[1]*ca,V[2]*ca+V[1]*Z]),a.expandPointInPlace(ea,[V[2]*Z-V[3]*ca,V[2]*ca+V[3]*Z]),V=ea);Z=l.getValue(N.offsetX);ca=l.getValue(N.offsetY);if(X){var fa=B*X;ea=Math.cos(fa);fa=Math.sin(fa);const ja=Z*fa+ca*ea;Z=Z*ea-ca*fa;ca=ja}V[0]+=
Z;V[1]+=ca;V[2]+=Z;V[3]+=ca;N=m(N.markerPlacement);0<N&&(V[0]-=N,V[1]-=N,V[2]+=N,V[3]+=N)}N=r(ia.effects);0<N&&(V[0]-=N,V[1]-=N,V[2]+=N,V[3]+=N);U?(R[0]=V[0],R[1]=V[1],R[2]=V[2],R[3]=V[3],U=!1):(R[0]=Math.min(R[0],V[0]),R[1]=Math.min(R[1],V[1]),R[2]=Math.max(R[2],V[2]),R[3]=Math.max(R[3],V[3]))}return R};P._getTextInflatedSize=function(R,N,W){var X,T;const U=null!=(X=N.height)?X:10;R[0]=-U/2;R[1]=-U/2;R[2]=U/2;R[3]=U/2;if(!W)return R;W=W.get(N);if(!W)return R;const {text:V,mosaicItem:Z}=W;if(!Z||
0===Z.glyphMosaicItems.length)return R;W=h.lineGapType2LineHeight(N.lineGapType,null!=(T=N.lineGap)?T:0,U);T=F.bidiText(V)[1];N=d.shapeGlyphs(Z.glyphMosaicItems,T,{scale:U/e.GLYPH_SIZE,angle:l.getValue(N.angle),xOffset:l.getValue(N.offsetX),yOffset:l.getValue(N.offsetY),hAlign:h.horizontalAlignment2HAlign(N.horizontalAlignment),vAlign:h.verticalAlignment2VAlign(N.verticalAlignment),maxLineWidth:512,lineHeight:e.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(W||1,4)),decoration:N.font.decoration||"none",
isCIM:!0}).boundsT;R[0]=N.x-N.halfWidth;R[1]=-N.y-N.halfHeight;R[2]=N.x+N.halfWidth;R[3]=-N.y+N.halfHeight;return R};return Q}();let x=function(){function Q(){}Q.getEnvelope=function(P,R){R=new h.EnvDrawHelper(R);if(Array.isArray(P)){let N;for(const W of P)N?N.union(g(R,W)):N=g(R,W);return N}return g(R,P)};Q.getTextureAnchor=function(P,R){P=this.getEnvelope(P,R);if(!P)return[0,0,0];R=P.height*w+2;return[(P.x+.5*P.width)*w/(P.width*w+2),-(P.y+.5*P.height)*w/R,R]};Q.rasterize=function(P,R,N,W,X=!0){var T=
N||this.getEnvelope(R,W);if(!T)return[null,0,0,0,0];const U=(T.x+.5*T.width)*w,V=(T.y+.5*T.height)*w;P.width=T.width*w;P.height=T.height*w;N||(P.width+=2,P.height+=2);N=P.getContext("2d");T=h.Transformation.createScale(w,-w);T.translate(.5*P.width-U,.5*P.height+V);W=new h.CanvasDrawHelper(N,W,T);switch(R.type){case "CIMPointSymbol":W.drawSymbol(R,{type:"point",x:0,y:0});break;case "CIMVectorMarker":T=new c.Placement,W.drawMarker(R,T)}R=N.getImageData(0,0,P.width,P.height);R=new Uint8Array(R.data);
if(X)for(W=0;W<R.length;W+=4)X=R[W+3]/255,R[W]*=X,R[W+1]*=X,R[W+2]*=X;return[R,P.width,P.height,-U/P.width,-V/P.height]};Q.fromTextSymbol=function(P){const {angle:R,color:N,font:W,haloColor:X,haloSize:T,horizontalAlignment:U,kerning:V,text:Z,verticalAlignment:ca,xoffset:ea,yoffset:fa}=P;let ia,ja;if(W){var Y=W.family;var aa=W.style;var ba=W.weight;ia=W.size;ja=W.decoration}P=!1;Z&&(P=F.bidiText(Z)[1]);Y=Y||"Arial";b:{if(ba)switch(ba.toLowerCase()){case "bold":case "bolder":ba="bold";break b}ba=""}b:{if(aa)switch(aa.toLowerCase()){case "italic":case "oblique":aa=
"italic";break b}aa=""}ba=ba&&aa?`${ba}-${aa}`:`${ba}${aa}`;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:R,blockProgression:2,depth3D:1,extrapolateBaselines:!0,fontEffects:0,fontEncoding:1,fontFamilyName:Y,fontStyleName:ba,fontType:0,haloSize:T,
height:ia,hinting:1,horizontalAlignment:I(null!=U?U:"center"),kerning:V,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:l.getValue(ea),offsetY:l.getValue(fa),strikethrough:"line-through"===ja,underline:"underline"===ja,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:M(N)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:M(X)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:P?
1:0,verticalAlignment:J(null!=ca?ca:"baseline"),verticalGlyphOrientation:0,wordSpacing:100,billboardMode3D:2},textString:Z}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}};Q.fromPictureFillSymbol=function(P){const {height:R,outline:N,width:W,xoffset:X,xscale:T,yoffset:U,yscale:V}=P,Z=[],ca={type:"CIMPolygonSymbol",symbolLayers:Z};if(N){const {cap:fa,join:ia,miterLimit:ja,width:Y}=N;Z.push({type:"CIMSolidStroke",color:M(N.color),capStyle:K(fa),joinStyle:H(ia),miterLimit:ja,
width:Y})}let ea=P.url;"esriPFS"===P.type&&P.imageData&&(ea=P.imageData);P="angle"in P?P.angle:0;Z.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:"Picture",tintColor:null,url:ea,height:R*(V||1),width:W*(T||1),offsetX:l.getValue(X),offsetY:l.getValue(U),rotation:l.getValue(-P),colorSubstitutions:null});return ca};Q.fromSimpleFillSymbol=function(P){const {color:R,style:N,outline:W}=P;P=[];const X={type:"CIMPolygonSymbol",symbolLayers:P};var T=null;if(W){const {cap:V,join:Z,
style:ca}=W;"solid"!==ca&&"none"!==ca&&"esriSLSSolid"!==ca&&"esriSLSNull"!==ca&&(T=[{type:"CIMGeometricEffectDashes",dashTemplate:O(ca,V),lineDashEnding:"NoConstraint",scaleDash:!0}]);P.push({type:"CIMSolidStroke",color:M(W.color),capStyle:K(V),joinStyle:H(Z),miterLimit:W.miterLimit,width:W.width,effects:T})}if(N&&"solid"!==N&&"none"!==N&&"esriSFSSolid"!==N&&"esriSFSNull"!==N){T={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:M(R),capStyle:"Butt",joinStyle:"Miter",width:.75}]};let V=
0;var U=p.nextPowerOfTwo(Math.ceil(window.devicePixelRatio));U=S(N)?8*U:10*U;switch(N){case "vertical":case "esriSFSVertical":V=90;break;case "forward-diagonal":case "esriSFSForwardDiagonal":V=-45;break;case "backward-diagonal":case "esriSFSBackwardDiagonal":V=45;break;case "cross":case "esriSFSCross":V=0;break;case "diagonal-cross":case "esriSFSDiagonalCross":V=-45}P.push({type:"CIMHatchFill",lineSymbol:T,offsetX:0,offsetY:0,rotation:V,separation:U});"cross"===N||"esriSFSCross"===N?P.push({type:"CIMHatchFill",
lineSymbol:y.clone(T),offsetX:0,offsetY:0,rotation:90,separation:U}):("diagonal-cross"===N||"esriSFSDiagonalCross"===N)&&P.push({type:"CIMHatchFill",lineSymbol:y.clone(T),offsetX:0,offsetY:0,rotation:45,separation:U})}else!N||"solid"!==N&&"esriSFSSolid"!==N||P.push({type:"CIMSolidFill",enable:!0,color:M(R)});return X};Q.fromSimpleLineSymbol=function(P){const {cap:R,color:N,join:W,marker:X,miterLimit:T,style:U,width:V}=P;P=null;"solid"!==U&&"none"!==U&&"esriSLSSolid"!==U&&"esriSLSNull"!==U&&(P=[{type:"CIMGeometricEffectDashes",
dashTemplate:O(U,R),lineDashEnding:"NoConstraint",scaleDash:!0}]);const Z=[];if(X){let ca;switch(X.placement){case "begin-end":ca="Both";break;case "begin":ca="JustBegin";break;case "end":ca="JustEnd";break;default:ca="None"}const ea=Q.fromSimpleMarker(X,V,N).symbolLayers[0];ea.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:ca,offsetAlongLine:0};Z.push(ea)}"none"!==U&&"esriSLSNull"!==U&&Z.push({type:"CIMSolidStroke",color:M(N),capStyle:K(R),joinStyle:H(W),
miterLimit:T,width:V,effects:P});return{type:"CIMLineSymbol",symbolLayers:Z}};Q.fromPictureMarker=function(P){const {angle:R,height:N,width:W,xoffset:X,yoffset:T}=P;let U=P.url;"esriPMS"===P.type&&P.imageData&&(U=P.imageData);return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:"Picture",tintColor:null,url:U,size:N,width:W,offsetX:l.getValue(X),offsetY:l.getValue(T),rotation:l.getValue(-R)}]}};Q.fromSimpleMarker=function(P,R,N){var W,
{style:X}=P;N=null!=(W=P.color)?W:N;if("path"===X){R=[];"outline"in P&&P.outline&&(W=P.outline,R.push({type:"CIMSolidStroke",enable:!0,width:b.pt2px(Math.round(b.px2pt(W.width))),color:M(W.color)}));R.push({type:"CIMSolidFill",enable:!0,color:M(N),path:P.path});const [Z,ca]=L("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:l.getValue(-P.angle),size:l.getValue(P.size||6),offsetX:l.getValue(P.xoffset),offsetY:l.getValue(P.yoffset),frame:Z,markerGraphics:[{type:"CIMMarkerGraphic",
geometry:ca,symbol:{type:"CIMPolygonSymbol",symbolLayers:R}}]}]}}const [T,U]=L(X);let V;U&&T&&(W=[],"outline"in P&&P.outline?(X=P.outline,W.push({type:"CIMSolidStroke",enable:!0,width:b.pt2px(Math.round(b.px2pt(X.width))),color:M(X.color)})):!R||"line-marker"!==P.type||"cross"!==P.style&&"x"!==P.style||W.push({type:"CIMSolidStroke",enable:!0,width:R,color:M(N)}),W.push({type:"CIMSolidFill",enable:!0,color:M(N)}),N={type:"CIMPolygonSymbol",symbolLayers:W},V={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",
enable:!0,rotation:l.getValue(-P.angle),size:l.getValue(P.size||6*R),offsetX:l.getValue(P.xoffset),offsetY:l.getValue(P.yoffset),frame:T,markerGraphics:[{type:"CIMMarkerGraphic",geometry:U,symbol:N}]}]});return V};Q.fromCIMHatchFill=function(P){var R;const N=null!=(R=P.separation)?R:4;R=N/2;for(var W=this._getLineSymbolPeriod(P.lineSymbol)||4;4>W;)W*=2;W/=2;return{type:"CIMVectorMarker",frame:{xmin:-W,xmax:W,ymin:-R,ymax:R},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-W,0],[W,0]]]},
symbol:P.lineSymbol}],size:N}};Q._getLineSymbolPeriod=function(P){if(P){const R=this._getEffectsRepeat(P.effects);if(R)return R;if(P.symbolLayers)for(const N of P.symbolLayers)if((P=this._getEffectsRepeat(N.effects))||N&&(P=this._getPlacementRepeat(N.markerPlacement)))return P}return 0};Q._getEffectsRepeat=function(P){if(P)for(var R of P)if(R)switch(R.type){case "CIMGeometricEffectDashes":if((P=R.dashTemplate)&&P.length){R=0;for(const N of P)R+=N;P.length&1&&(R*=2);return R}break;case "CIMGeometricEffectWave":return R.period;
default:A.error(`unsupported geometric effect type ${R.type}`)}return 0};Q._getPlacementRepeat=function(P){if(P)switch(P.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((P=P.placementTemplate)&&P.length){let R=0;for(const N of P)R+=N;P.length&1&&(R*=2);return R}}return 0};Q.fromCIMInsidePolygon=function(P){var R=P.markerPlacement;const N={type:P.type,...P,markerPlacement:null,anchorPoint:null};let W,X;
!0===R.shiftOddRows?(P=R.stepX/2,W=R.stepY,X=2*R.stepY,R=[{x:-P,y:0},{x:P,y:0},{x:0,y:W},{x:0,y:-W}].map(T=>({type:"CIMMarkerGraphic",geometry:T,symbol:{type:"CIMPointSymbol",symbolLayers:[N]}}))):(P=R.stepX/2,W=R.stepY/2,X=R.stepY,R=[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMPointSymbol",symbolLayers:[N]}}]);return{type:"CIMVectorMarker",frame:{xmin:-P,xmax:P,ymin:-W,ymax:W},markerGraphics:R,size:X}};Q.getFillColor=function(P){if(!P)return null;switch(P.type){case "CIMPolygonSymbol":if(P.symbolLayers)for(const R of P.symbolLayers)if(P=
Q.getFillColor(R),null!=P)return P;break;case "CIMTextSymbol":return Q.getFillColor(P.symbol);case "CIMSolidFill":return P.color}};Q.getStrokeColor=function(P){if(P)switch(P.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(P.symbolLayers)for(const R of P.symbolLayers)if(P=Q.getStrokeColor(R),void 0!==P)return P;break;case "CIMTextSymbol":return Q.getStrokeColor(P.symbol);case "CIMSolidStroke":return P.color}};Q.getStrokeWidth=function(P){if(P)switch(P.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(P.symbolLayers)for(const R of P.symbolLayers)if(P=
Q.getStrokeWidth(R),void 0!==P)return P;break;case "CIMTextSymbol":return Q.getStrokeWidth(P.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return P.width}};Q.getSize=function(P){if(P)switch(P.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":{let R=0;if(P.symbolLayers)for(const N of P.symbolLayers)P=Q.getSize(N),P>R&&(R=P);return R}case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return P.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return P.size}};
Q.getMarkerScaleRatio=function(P){if(P)switch(P.type){case "CIMVectorMarker":if(!1!==P.scaleSymbolsProportionally&&P.frame)return P.size/(P.frame.ymax-P.frame.ymin)}return 1};return Q}(),E=function(){function Q(){}Q.rasterizeSimpleFill=function(P,R,N){"solid"!==R&&"none"!==R&&"esriSFSSolid"!==R&&"esriSFSNull"!==R||console.error("Unexpected: style does not require rasterization");N=p.nextPowerOfTwo(Math.ceil(N));var W=S(R)?8*N:16*N;const X=2*N;P.width=W;P.height=W;const T=P.getContext("2d");T.strokeStyle=
"#FFFFFF";T.lineWidth=N;T.beginPath();if("vertical"===R||"cross"===R||"esriSFSCross"===R||"esriSFSVertical"===R)T.moveTo(W/2,-X),T.lineTo(W/2,W+X);if("horizontal"===R||"cross"===R||"esriSFSCross"===R||"esriSFSHorizontal"===R)T.moveTo(-X,W/2),T.lineTo(W+X,W/2);if("forward-diagonal"===R||"diagonal-cross"===R||"esriSFSDiagonalCross"===R||"esriSFSForwardDiagonal"===R)T.moveTo(-X,-X),T.lineTo(W+X,W+X),T.moveTo(W-X,-X),T.lineTo(W+X,X),T.moveTo(-X,W-X),T.lineTo(X,W+X);if("backward-diagonal"===R||"diagonal-cross"===
R||"esriSFSBackwardDiagonal"===R||"esriSFSDiagonalCross"===R)T.moveTo(W+X,-X),T.lineTo(-X,W+X),T.moveTo(X,-X),T.lineTo(-X,X),T.moveTo(W+X,W-X),T.lineTo(W-X,W+X);T.stroke();R=T.getImageData(0,0,P.width,P.height);R=new Uint8Array(R.data);for(W=0;W<R.length;W+=4)N=R[W+3]/255,R[W]*=N,R[W+1]*=N,R[W+2]*=N;return[R,P.width,P.height]};Q.rasterizeSimpleLine=function(P,R){return this.rasterizeDash(P,R)};Q.rasterizeDash=function(P,R){var N="Butt"===R,W="Square"===R;R=!N&&!W;1===P.length%2&&(P=[...P,...P]);var X=
0;for(var T of P)X+=T;T=Math.round(15.5*X);X=new Float32Array(31*T);let U=0,V=0,Z=.5,ca=!0;for(var ea of P){U=V;for(V+=15.5*ea;Z<=V;){for(P=.5;31>P;){const fa=R?(P-15.5)*(P-15.5):Math.abs(P-15.5);X[(P-.5)*T+Z-.5]=ca?N?Math.max(Math.max(U+7.75-Z,fa),Math.max(Z-V+7.75,fa)):fa:R?Math.min((Z-U)*(Z-U)+fa,(Z-V)*(Z-V)+fa):W?Math.min(Math.max(Z-U,fa),Math.max(V-Z,fa)):Math.min(Math.max(Z-U+7.75,fa),Math.max(V+7.75-Z,fa));P++}Z++}ca=!ca}N=X.length;ea=new Uint8Array(4*N);for(W=0;W<N;++W)C.packFloatRGBA((R?
Math.sqrt(X[W]):X[W])/15.5,ea,4*W);return[ea,T,31]};return Q}(),D=function(){function Q(){}Q.findApplicableOverrides=function(P,R,N){if(R){if(P.primitiveName){let W=!1;for(const X of N)if(X.primitiveName===P.primitiveName){W=!0;break}if(!W)for(const X of R)X.primitiveName===P.primitiveName&&N.push(X)}switch(P.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(P.effects)for(const W of P.effects)Q.findApplicableOverrides(W,R,N);if(P.symbolLayers)for(const W of P.symbolLayers)Q.findApplicableOverrides(W,
R,N);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(P.effects)for(const W of P.effects)Q.findApplicableOverrides(W,R,N);P.markerPlacement&&Q.findApplicableOverrides(P.markerPlacement,R,N);if("CIMVectorMarker"===P.type){if(P.markerGraphics)for(const W of P.markerGraphics)Q.findApplicableOverrides(W,R,N),Q.findApplicableOverrides(W.symbol,
R,N)}else"CIMCharacterMarker"===P.type?Q.findApplicableOverrides(P.symbol,R,N):"CIMHatchFill"===P.type&&Q.findApplicableOverrides(P.lineSymbol,R,N)}}};Q.applyOverrides=function(P,R,N,W){if(R){if(P.primitiveName)for(const T of R)if(T.primitiveName===P.primitiveName){var X=(X=T.propertyName)?X.charAt(0).toLowerCase()+X.substr(1):X;W&&W.push({cim:P,nocapPropertyName:X,value:P[X]});T.expression&&(T.value=Q.toValue(T.propertyName,T.expression));if(N){let U=!1;for(const V of N)V.primitiveName===P.primitiveName&&
(U=!0);U||N.push(T)}P[X]=T.value}switch(P.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(P.effects)for(const T of P.effects)Q.applyOverrides(T,R,N,W);if(P.symbolLayers)for(const T of P.symbolLayers)Q.applyOverrides(T,R,N,W);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(P.effects)for(const T of P.effects)Q.applyOverrides(T,R,N,W);if("CIMVectorMarker"===P.type&&P.markerGraphics)for(const T of P.markerGraphics)Q.applyOverrides(T,R,N,W),Q.applyOverrides(T.symbol,
R,N,W)}}};Q.restoreOverrides=function(P){for(const R of P)R.cim[R.nocapPropertyName]=R.value};Q.buildOverrideKey=function(P){let R="";for(const N of P)void 0!==N.value&&(R+=`${N.primitiveName}${N.propertyName}${JSON.stringify(N.value)}`);return R};Q.toValue=function(P,R){return"DashTemplate"===P?R.split(" ").map(N=>Number(N)):"Color"===P?(P=(new G(R)).toRgba(),P[3]*=255,P):R};return Q}();const K=Q=>{if(!Q)return"Butt";switch(Q){case "butt":return"Butt";case "square":return"Square";case "round":return"Round"}},
H=Q=>{if(!Q)return"Miter";switch(Q){case "miter":return"Miter";case "round":return"Round";case "bevel":return"Bevel"}},I=Q=>{if(!Q)return"Center";switch(Q){case "left":return"Left";case "right":return"Right";case "center":return"Center";case "justify":return"Justify"}},J=Q=>{if(!Q)return"Center";switch(Q){case "baseline":return"Baseline";case "top":return"Top";case "middle":return"Center";case "bottom":return"Bottom"}},M=Q=>{if(!Q)return[0,0,0,0];const {r:P,g:R,b:N,a:W}=Q;return[P,R,N,255*W]},O=(Q,
P)=>{P="butt"===P;switch(Q){case "dash":case "esriSLSDash":return P?[4,3]:[3,4];case "dash-dot":case "esriSLSDashDot":return P?[4,3,1,3]:[3,4,0,4];case "dot":case "esriSLSDot":return P?[1,3]:[0,4];case "long-dash":case "esriSLSLongDash":return P?[8,3]:[7,4];case "long-dash-dot":case "esriSLSLongDashDot":return P?[8,3,1,3]:[7,4,0,4];case "long-dash-dot-dot":case "esriSLSDashDotDot":return P?[8,3,1,3,1,3]:[7,4,0,4,0,4];case "short-dash":case "esriSLSShortDash":return P?[4,1]:[3,2];case "short-dash-dot":case "esriSLSShortDashDot":return P?
[4,1,1,1]:[3,2,0,2];case "short-dash-dot-dot":case "esriSLSShortDashDotDot":return P?[4,1,1,1,1,1]:[3,2,0,2,0,2];case "short-dot":case "esriSLSShortDot":return P?[1,1]:[0,2];case "solid":case "esriSLSSolid":case "none":return A.error("Unexpected: style does not require rasterization"),[0,0];default:return A.error(`Tried to rasterize SLS, but found an unexpected style: ${Q}!`),[0,0]}},L=Q=>{if("circle"===Q||"esriSMSCircle"===Q){var P=Math.acos(.995);Q=Math.ceil(t/P/4);0===Q&&(Q=1);P=z/Q;Q*=4;var R=
[];R.push([50,0]);for(let N=1;N<Q;N++)R.push([50*Math.cos(N*P),-50*Math.sin(N*P)]);R.push([50,0]);P={rings:[R]};R={xmin:-50,ymin:-50,xmax:50,ymax:50}}else"cross"===Q||"esriSMSCross"===Q?(P={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,50],[0,50]]]},R={xmin:-50,ymin:-50,xmax:50,ymax:50}):"diamond"===Q||"esriSMSDiamond"===Q?(P={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},R={xmin:-50,ymin:-50,xmax:50,ymax:50}):"square"===Q||"esriSMSSquare"===Q?
(P={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},R={xmin:-50,ymin:-50,xmax:50,ymax:50}):"x"===Q||"esriSMSX"===Q?(P={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},R={xmin:-50,ymin:-50,xmax:50,ymax:50}):"triangle"===Q||"esriSMSTriangle"===Q?(Q=2/3*100,R=Q-100,P={rings:[[[-57.735026918962575,R],[0,Q],[57.735026918962575,R],[-57.735026918962575,R]]]},R={xmin:-57.735026918962575,ymin:R,xmax:57.735026918962575,ymax:Q}):"arrow"===
Q&&(P={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},R={xmin:-50,ymin:-50,xmax:50,ymax:50});return[R,P]},S=Q=>"vertical"===Q||"horizontal"===Q||"cross"===Q||"esriSFSCross"===Q||"esriSFSVertical"===Q||"esriSFSHorizontal"===Q;u.CIMSimbolInflatedSizeHelper=v;u.CIMSymbolHelper=x;u.OverrideHelper=D;u.SymbolHelper=E;u.slsDashToTemplateArray=O;u.symbolToCIM=function(Q){if(!Q||!Q.type)return null;let P;switch(Q.type){case "cim":return Q.data;case "web-style":return Q;case "simple-marker":P=
x.fromSimpleMarker(Q);break;case "picture-marker":P=x.fromPictureMarker(Q);break;case "simple-line":P=x.fromSimpleLineSymbol(Q);break;case "simple-fill":P=x.fromSimpleFillSymbol(Q);break;case "picture-fill":P=x.fromPictureFillSymbol(Q);break;case "text":P=x.fromTextSymbol(Q)}return{type:"CIMSymbolReference",symbol:P}};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/core/floatRGBA":function(){define(["exports","./mathUtils"],function(u,G){function F(k,b=0){let a=0;for(let f=0;4>f;f++)a+=
k[b+f]*v[f];return a}function C(k){return k-Math.floor(k)}const y=[1,256,65536,16777216],v=[1/256,1/65536,1/16777216,1/4294967296],p=F(new Uint8ClampedArray([255,255,255,255]));u.packFloatRGBA=function(k,b,a=0){k=G.clamp(k,0,p);for(let f=0;4>f;f++)b[a+f]=Math.floor(256*C(k*y[f]))};u.unpackFloatRGBA=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],function(u){let G=function(){function C(){this.setIdentity()}var y=C.prototype;y.getAngle=
function(){if(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)this.rz=Math.atan2(this.rz_s,this.rz_c);return this.rz};y.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};y.setTranslate=function(v,p){this.tx=v;this.ty=p};y.setTranslateZ=function(v){this.tz=v};y.setRotateCS=function(v,p){this.rz=void 0;this.rz_c=v;this.rz_s=p};y.setRotate=function(v){this.rz=v;this.rz_s=this.rz_c=void 0};y.setRotateY=function(v){this.ry=v};y.setScale=
function(v){this.s=v};y.setMeasure=function(v){this.m=v};return C}(),F=function(){function C(){}C.prototype.next=function(){return null};return C}();u.EmptyPlacementCursor=F;u.Placement=G;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/BidiText ../../core/Logger ../../core/maybe ../../core/ObjectPool ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/jsonUtils ./CIMEffects ./CIMOperators ./CIMPlacements ./CIMResourceManager ./Rect ./TextRasterizer ../../views/2d/engine/webgl/alignmentUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e,d,g,m){const n=Math.PI/180,r=C.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let t=function(){function K(I){this._t=I}K.createIdentity=function(){return new K([1,0,0,0,1,0])};var H=K.prototype;H.clone=function(){return new K(this._t.slice())};H.transform=function(I){const J=this._t;return[J[0]*I[0]+J[1]*I[1]+J[2],J[3]*I[0]+J[4]*I[1]+J[5]]};K.createScale=function(I,J){return new K([I,0,0,0,J,0])};H.scale=function(I,J){const M=this._t;M[0]*=I;M[1]*=I;M[2]*=
I;M[3]*=J;M[4]*=J;M[5]*=J;return this};H.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};K.createTranslate=function(I,J){return new K([0,0,I,0,0,J])};H.translate=function(I,J){const M=this._t;M[2]+=I;M[5]+=J;return this};K.createRotate=function(I){const J=Math.cos(I);I=Math.sin(I);return new K([J,-I,0,I,J,0])};H.rotate=function(I){return K.multiply(this,K.createRotate(I),this)};K.multiply=function(I,J,M){I=I._t;J=J._t;const O=I[1]*J[0]+I[4]*J[1],L=I[2]*J[0]+I[5]*
J[1]+J[2],S=I[0]*J[3]+I[3]*J[4],Q=I[1]*J[3]+I[4]*J[4],P=I[2]*J[3]+I[5]*J[4]+J[5],R=M._t;R[0]=I[0]*J[0]+I[3]*J[1];R[1]=O;R[2]=L;R[3]=S;R[4]=Q;R[5]=P;return M};H.invert=function(){const I=this._t;let J=I[0]*I[4]-I[1]*I[3];if(0===J)return new K([0,0,0,0,0,0]);J=1/J;return new K([I[4]*J,-I[1]*J,(I[1]*I[5]-I[2]*I[4])*J,-I[3]*J,I[0]*J,(I[2]*I[3]-I[0]*I[5])*J])};return K}();C=function(){function K(I,J){this._transfos=[];this._sizeTransfos=[];this._geomUnitsPerPoint=1;this._flippedYs=!1;this._placementPool=
new v(h.Placement,null,null,100);this._earlyReturn=!1;this._mapRotation=0;this._resourceManager=I||new l;this._transfos.push(J||t.createIdentity());this._sizeTransfos.push(J?J.scaleRatio():1)}var H=K.prototype;H.setTransform=function(I,J){this._transfos=[I||t.createIdentity()];this._sizeTransfos=[J?J:I?I.scaleRatio():1]};H.setGeomUnitsPerPoint=function(I){this._geomUnitsPerPoint=I};H.setFlippedYs=function(I){this._flippedYs=I};H.transformPt=function(I){return this._transfos[this._transfos.length-
1].transform(I)};H.transformSize=function(I){return I*this._sizeTransfos[this._sizeTransfos.length-1]};H.reverseTransformPt=function(I){return this._transfos[this._transfos.length-1].invert().transform(I)};H.reverseTransformSize=function(I){return I/this._sizeTransfos[this._sizeTransfos.length-1]};H.geomUnitsPerPoint=function(){return this.isEmbedded()?1:this._geomUnitsPerPoint};H.flippedYs=function(){return this.isEmbedded()?!1:this._flippedYs};H.isEmbedded=function(){return 1<this._transfos.length};
H.back=function(){return this._transfos[this._transfos.length-1]};H.push=function(I,J){J=J?I.scaleRatio():1;t.multiply(I,this.back(),I);this._transfos.push(I);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*J)};H.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};H.drawSymbol=function(I,J){if(I)switch(I.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(I,J);break;case "CIMTextSymbol":this.drawTextSymbol(I,
J)}};H.drawMultiLayerSymbol=function(I,J){if(I){var M=I.symbolLayers;if(M)if((I=I.effects)&&0<I.length){if(J=this.executeEffects(I,J))for(I=J.next();I;)this.drawSymbolLayers(M,I),I=J.next()}else this.drawSymbolLayers(M,J)}};H.executeEffects=function(I,J){J=new f.SimpleGeometryCursor(J);for(const M of I)(I=c.getEffectOperator(M))&&(J=I.execute(J,M,this.geomUnitsPerPoint(),this.flippedYs()));return J};H.drawSymbolLayers=function(I,J){let M=I.length;for(;M--;){const L=I[M];if(L&&!1!==L.enable){var O=
L.effects;if(O&&0<O.length){if(O=this.executeEffects(O,J)){let S=null;for(;(S=O.next())&&(this.drawSymbolLayer(L,S),!this._earlyReturn););}}else this.drawSymbolLayer(L,J);if(this._earlyReturn)break}}};H.drawSymbolLayer=function(I,J){switch(I.type){case "CIMSolidFill":this.drawSolidFill(J,I.color);break;case "CIMHatchFill":this.drawHatchFill(J,I);break;case "CIMPictureFill":this.drawPictureFill(J,I);break;case "CIMGradientFill":this.drawGradientFill(J,I);break;case "CIMSolidStroke":this.drawSolidStroke(J,
I.color,I.width,I.capStyle,I.joinStyle,I.miterLimit);break;case "CIMPictureStroke":this.drawPictureStroke(J,I);break;case "CIMGradientStroke":this.drawGradientStroke(J,I);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(I,J)}};H.drawHatchFill=function(I,J){const M=this._buildHatchPolyline(J,I,this.geomUnitsPerPoint());M&&(this.pushClipPath(I),this.drawMultiLayerSymbol(J.lineSymbol,M),this.popClipPath())};H.drawPictureFill=function(I,J){};H.drawGradientFill=
function(I,J){};H.drawPictureStroke=function(I,J){};H.drawGradientStroke=function(I,J){};H.drawMarkerLayer=function(I,J){var M=I.markerPlacement;if(M){const L=c.getPlacementOperator(M);if(L){var O="CIMMarkerPlacementInsidePolygon"===M.type;O&&this.pushClipPath(J);if(J=L.execute(J,M,this.geomUnitsPerPoint()))for(M=null;(M=J.next())&&(this.drawMarker(I,M),!this._earlyReturn););O&&this.popClipPath()}}else{M=this._placementPool.acquire();if(a.isPoint(J))M.tx=J.x,M.ty=J.y,this.drawMarker(I,M);else for(O of J.points)if(M.tx=
O[0],M.ty=O[1],this.drawMarker(I,M),this._earlyReturn)break;this._placementPool.release(M)}};H.drawMarker=function(I,J){switch(I.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(I,J);break;case "CIMVectorMarker":this.drawVectorMarker(I,J)}};H.drawPictureMarker=function(I,J){var M,O,L,S,Q;if(I){var P=this._resourceManager.getResource(I.url),R=null!=(M=I.size)?M:10;if(!(y.isNone(P)||0>=R)&&(M=P.width,P=P.height,M&&P)){P=M/P;M=null!=(O=I.scaleX)?O:1;O=t.createIdentity();
var N=I.anchorPoint;if(N){let W=N.x;N=N.y;"Absolute"!==I.anchorPointUnits&&(W*=R*P*M,N*=R);O.translate(-W,-N)}P=null!=(L=I.rotation)?L:0;I.rotateClockwise&&(P=-P);this._mapRotation&&(P+=this._mapRotation);P&&O.rotate(P*n);L=null!=(S=I.offsetX)?S:0;S=null!=(Q=I.offsetY)?Q:0;if(L||S)this._mapRotation&&(P=n*this._mapRotation,Q=Math.cos(P),P=Math.sin(P),M=L*P+S*Q,L=L*Q-S*P,S=M),O.translate(L,S);Q=this.geomUnitsPerPoint();1!==Q&&O.scale(Q,Q);(Q=J.getAngle())&&O.rotate(Q);O.translate(J.tx,J.ty);this.push(O,
!1);this.drawImage(I.url,R,I.scaleX);this.pop()}}};H.drawVectorMarker=function(I,J){var M,O,L,S;if(I){var Q=I.markerGraphics;if(Q){var P=null!=(M=I.size)?M:10,R=(M=I.frame)?M.ymax-M.ymin:0;R=P&&R?P/R:1;P=t.createIdentity();M&&P.translate(.5*-(M.xmax+M.xmin),.5*-(M.ymax+M.ymin));var N=I.anchorPoint;if(N){let W=N.x;N=N.y;"Absolute"!==I.anchorPointUnits?M&&(W*=M.xmax-M.xmin,N*=M.ymax-M.ymin):(W/=R,N/=R);P.translate(-W,-N)}1!==R&&P.scale(R,R);M=null!=(O=I.rotation)?O:0;I.rotateClockwise&&(M=-M);this._mapRotation&&
(M+=this._mapRotation);M&&P.rotate(M*n);O=null!=(L=I.offsetX)?L:0;L=null!=(S=I.offsetY)?S:0;if(O||L)this._mapRotation&&(M=n*this._mapRotation,S=Math.cos(M),M=Math.sin(M),R=O*M+L*S,O=O*S-L*M,L=R),P.translate(O,L);S=this.geomUnitsPerPoint();1!==S&&P.scale(S,S);(S=J.getAngle())&&P.rotate(S);P.translate(J.tx,J.ty);this.push(P,I.scaleSymbolsProportionally);for(const W of Q)if(W&&W.symbol&&W.geometry||r.error("Invalid marker graphic",W),this.drawSymbol(W.symbol,W.geometry),this._earlyReturn)break;this.pop()}}};
H.drawTextSymbol=function(I,J){var M,O,L,S;if(I&&a.isPoint(J)&&!(0>=(null!=(M=I.height)?M:10))){M=t.createIdentity();var Q=null!=(O=I.angle)?O:0;(Q=-Q)&&M.rotate(Q*n);O=null!=(L=I.offsetX)?L:0;L=null!=(S=I.offsetY)?S:0;(O||L)&&M.translate(O,L);S=this.geomUnitsPerPoint();1!==S&&M.scale(S,S);M.translate(J.x,J.y);this.push(M,!1);this.drawText(I);this.pop()}};H._buildHatchPolyline=function(I,J,M){var O=(void 0!==I.separation?I.separation:4)*M,L=void 0!==I.rotation?I.rotation:0;if(0===O)return null;0>
O&&(O=-O);for(var S=0,Q=.5*O;S>Q;)S-=O;for(;S<-Q;)S+=O;S=k.create();b.getBoundsXY(S,J);S[0]-=Q;S[1]-=Q;S[2]+=Q;S[3]+=Q;for(var P=[[S[0],S[1]],[S[0],S[3]],[S[2],S[3]],[S[2],S[1]]];180<L;)L-=180;for(;0>L;)L+=180;Q=Math.cos(L*n);var R=Math.sin(L*n);L=-O*R;J=O*Q;S=(void 0!==I.offsetX?I.offsetX*M:0)*R-(void 0!==I.offsetY?I.offsetY*M:0)*Q;let N;var W=I=Number.MAX_VALUE;N=M=-Number.MAX_VALUE;for(var X of P){var T=X[0];const U=X[1];P=Q*T+R*U;T=-R*T+Q*U;W=Math.min(W,P);I=Math.min(I,T);N=Math.max(N,P);M=Math.max(M,
T)}I=Math.floor(I/O)*O;X=Q*W-R*I-L*S/O;W=R*W+Q*I-J*S/O;P=Q*N-R*I-L*S/O;S=R*N+Q*I-J*S/O;O=1+Math.round((M-I)/O);Q=[];for(R=0;R<O;R++)X+=L,W+=J,P+=L,S+=J,Q.push([[X,W],[P,S]]);return{paths:Q}};return K}();let z=function(K){function H(J,M){J=K.call(this,J,M)||this;J.reset();return J}G._inheritsLoose(H,K);var I=H.prototype;I.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};I.envelope=function(){return new q(this._xmin,this._ymin,this._xmax-this._xmin,
this._ymax-this._ymin)};I.bounds=function(){return k.fromValues(this._xmin,this._ymin,this._xmax,this._ymax)};I.drawSolidFill=function(J){!J||0<this._clipCount||(a.isPolygon(J)?this._processPath(J.rings,0):a.isPolyline(J)?this._processPath(J.paths,0):a.isExtent(J)?(J=A(J))&&this._processPath(J.rings,0):console.error("drawSolidFill Unexpected geometry type!"))};I.drawSolidStroke=function(J,M,O){!J||0<this._clipCount||(M=.5*this.transformSize(O),a.isPolygon(J)?this._processPath(J.rings,M):a.isPolyline(J)?
this._processPath(J.paths,M):a.isExtent(J)?(J=A(J))&&this._processPath(J.rings,M):console.error("drawSolidStroke unexpected geometry type!"))};I.pushClipPath=function(J){this.drawSolidFill(J);++this._clipCount};I.popClipPath=function(){--this._clipCount};I.drawImage=function(J,M,O){let L=O*M,S=M;J=this._resourceManager.getResource(J);!M&&y.isSome(J)&&(L=O*J.width,S=J.height);this._merge(this.transformPt([-L/2,-S/2]),0);this._merge(this.transformPt([-L/2,S/2]),0);this._merge(this.transformPt([L/2,
-S/2]),0);this._merge(this.transformPt([L/2,S/2]),0)};I.drawText=function(J){this._textRasterizer||(this._textRasterizer=new e.TextRasterizer)};I._processPath=function(J,M){if(J)for(const O of J)if(J=O?O.length:0,1<J){this._merge(this.transformPt(O[0]),M);for(let L=1;L<J;++L)this._merge(this.transformPt(O[L]),M)}};I._merge=function(J,M){J[0]-M<this._xmin&&(this._xmin=J[0]-M);J[0]+M>this._xmax&&(this._xmax=J[0]+M);J[1]-M<this._ymin&&(this._ymin=J[1]-M);J[1]+M>this._ymax&&(this._ymax=J[1]+M)};return H}(C),
w=function(K){function H(){var J=K.apply(this,arguments)||this;J._searchPoint=[0,0];J._searchDistPoint=0;return J}G._inheritsLoose(H,K);var I=H.prototype;I.hitTest=function(J,M,O,L,S,Q){Q*=p.pt2px(1);this.setTransform();this.setGeomUnitsPerPoint(Q);this._searchPoint=[(J[0]+J[2])/2,(J[1]+J[3])/2];this._searchDistPoint=(J[2]-J[0])/2/Q;this._textInfo=L;this._mapRotation=M&&("CIMPointSymbol"===M.type&&"Map"!==M.angleAlignment||"CIMTextSymbol"===M.type)?S:0;this._earlyReturn=!1;this.drawSymbol(M,O);return this._earlyReturn};
I.drawSolidFill=function(J,M){this._hitTestFill(J)};I.drawHatchFill=function(J,M){this._hitTestFill(J)};I.drawPictureFill=function(J,M){this._hitTestFill(J)};I.drawGradientFill=function(J,M){this._hitTestFill(J)};I.drawSolidStroke=function(J,M,O,L,S,Q){this._hitTestStroke(J,O)};I.drawPictureStroke=function(J,M){this._hitTestStroke(J,M.width)};I.drawGradientStroke=function(J,M){this._hitTestStroke(J,M.width)};I.pushClipPath=function(J){};I.popClipPath=function(){};I.drawImage=function(J,M,O){J=this._resourceManager.getResource(J);
if(!y.isNone(J)&&0!==J.height&&0!==M){M*=this.geomUnitsPerPoint();O=J.width/J.height*O*M;J=this.reverseTransformPt(this._searchPoint);var L=this._searchDistPoint;Math.abs(J[0])<O/2+L&&Math.abs(J[1])<M/2+L&&(this._earlyReturn=!0)}};I.drawText=function(J){var M,O,L=this._textInfo;if(L&&(L=L.get(J))){var {text:S,mosaicItem:Q}=L;if(Q&&0!==Q.glyphMosaicItems.length){L=null!=(M=J.height)?M:10;M=D(J.lineGapType,null!=(O=J.lineGap)?O:0,L);O=F.bidiText(S)[1];J=m.shapeGlyphs(Q.glyphMosaicItems,O,{scale:L/g.GLYPH_SIZE,
angle:0,xOffset:0,yOffset:0,hAlign:x(J.horizontalAlignment),vAlign:E(J.verticalAlignment),maxLineWidth:512,lineHeight:g.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(M||1,4)),decoration:J.font.decoration||"none",isCIM:!0});M=this.reverseTransformPt(this._searchPoint);O=M[0];M=M[1];for(const P of J.glyphs)if(O>P.xTopLeft&&O<P.xBottomRight&&M>-P.yBottomRight&&M<-P.yTopLeft){this._earlyReturn=!0;break}}}};I._hitTestFill=function(J){let M=null;if(a.isExtent(J))M=[[[J.xmin,J.ymin],[J.xmin,J.ymax],[J.xmax,
J.ymax],[J.xmax,J.ymin],[J.xmin,J.ymin]]];else if(a.isPolygon(J))M=J.rings;else if(a.isPolyline(J))M=J.paths;else return;J=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(J,M)&&(this._earlyReturn=!0);const O=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(J,M,O)&&(this._earlyReturn=!0)};I._hitTestStroke=function(J,M){let O=null;if(a.isExtent(J))O=[[[J.xmin,J.ymin],[J.xmin,J.ymax],[J.xmax,J.ymax],[J.xmax,J.ymin],[J.xmin,J.ymin]]];else if(a.isPolygon(J))O=
J.rings;else if(a.isPolyline(J))O=J.paths;else return;J=this.reverseTransformPt(this._searchPoint);M*=this.geomUnitsPerPoint();const L=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(J,O,M/2+L)&&(this._earlyReturn=!0)};I._pointInPolygon=function(J,M){let O=0;for(const L of M){M=L.length;for(let S=1;S<M;++S){const Q=L[S-1],P=L[S];Q[1]>J[1]!==P[1]>J[1]&&(0<(P[0]-Q[0])*(J[1]-Q[1])-(P[1]-Q[1])*(J[0]-Q[0])?O++:O--)}}return 0!==O};I._nearLine=function(J,M,O){for(const S of M){M=
S.length;for(let Q=1;Q<M;++Q){var L=S[Q-1];const P=S[Q];let R=(P[0]-L[0])*(P[0]-L[0])+(P[1]-L[1])*(P[1]-L[1]);if(0!==R&&(R=Math.sqrt(R),Math.abs(((P[0]-L[0])*(J[1]-L[1])-(P[1]-L[1])*(J[0]-L[0]))/R)<O&&(L=((P[0]-L[0])*(J[0]-L[0])+(P[1]-L[1])*(J[1]-L[1]))/R,L>-O&&L<R+O)))return!0}}return!1};return H}(C),B=function(K){function H(J,M,O){M=K.call(this,M,O)||this;M._ctx=J;return M}G._inheritsLoose(H,K);var I=H.prototype;I.drawSolidFill=function(J,M){if(J){if(a.isPolygon(J))this._buildPath(J.rings,!0);else if(a.isPolyline(J))this._buildPath(J.paths,
!0);else if(a.isExtent(J))this._buildPath(A(J).rings,!0);else if(a.isMultipoint(J))console.log("CanvasDrawHelper.drawSolidFill - No implementation!");else return;J=this._ctx;J.fillStyle="string"===typeof M?M:"rgba("+Math.round(M[0])+","+Math.round(M[1])+","+Math.round(M[2])+","+M[3]/255+")";J.fill("evenodd")}};I.drawSolidStroke=function(J,M,O,L,S,Q){if(J&&M&&0!==O){if(a.isPolygon(J))this._buildPath(J.rings,!0);else if(a.isPolyline(J))this._buildPath(J.paths,!1);else if(a.isExtent(J))this._buildPath(A(J).rings,
!0);else{console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");return}J=this._ctx;J.strokeStyle="string"===typeof M?M:"rgba("+Math.round(M[0])+","+Math.round(M[1])+","+Math.round(M[2])+","+M[3]/255+")";J.lineWidth=this.transformSize(O)+.5;this._setCapStyle(L);this._setJoinStyle(S);J.miterLimit=Q;J.stroke()}};I.pushClipPath=function(J){this._ctx.save();if(a.isPolygon(J))this._buildPath(J.rings,!0);else if(a.isPolyline(J))this._buildPath(J.paths,!0);else if(a.isExtent(J))this._buildPath(A(J).rings,
!0);else return;this._ctx.clip("evenodd")};I.popClipPath=function(){this._ctx.restore()};I.drawImage=function(J,M,O){J=this._resourceManager.getResource(J);if(!y.isNone(J)){var L=this._ctx,S=L.canvas.width;L=L.canvas.height;var Q=J.width/J.height*O*M,P=O*M;M||(Q=O*J.width,P=O*J.height);this._ctx.drawImage(J,0,0,J.width,J.height,0,0,Math.min(this.transformSize(Q),S),Math.min(this.transformSize(P),L))}};I.drawText=function(J){this._textRasterizer||(this._textRasterizer=new e.TextRasterizer)};I._buildPath=
function(J,M){const O=this._ctx;O.beginPath();if(J)for(const L of J)if(J=L?L.length:0,1<J){let S=this.transformPt(L[0]);O.moveTo(S[0],S[1]);for(let Q=1;Q<J;++Q)S=this.transformPt(L[Q]),O.lineTo(S[0],S[1]);M&&O.closePath()}};I._setCapStyle=function(J){switch(J){case "Butt":this._ctx.lineCap="butt";break;case "Round":this._ctx.lineCap="round";break;case "Square":this._ctx.lineCap="square"}};I._setJoinStyle=function(J){switch(J){case "Bevel":this._ctx.lineJoin="bevel";break;case "Round":this._ctx.lineJoin=
"round";break;case "Miter":this._ctx.lineJoin="miter"}};return H}(C);const A=K=>K?{spatialReference:K.spatialReference,rings:[[[K.xmin,K.ymin],[K.xmin,K.ymax],[K.xmax,K.ymax],[K.xmax,K.ymin],[K.xmin,K.ymin]]]}:null,x=K=>{switch(K){case "Left":return d.HAlign.Left;case "Right":return d.HAlign.Right;case "Center":case "Justify":return d.HAlign.Center}},E=K=>{switch(K){case "Top":return d.VAlign.Top;case "Center":return d.VAlign.Center;case "Bottom":return d.VAlign.Bottom;case "Baseline":return d.VAlign.Baseline}},
D=(K,H,I)=>{switch(K){case "ExtraLeading":return 1+H/I;case "Multiple":return H;case "Exact":return H/I}};u.CIMSymbolDrawHelper=C;u.C_DEG_TO_RAD=n;u.CanvasDrawHelper=B;u.EnvDrawHelper=z;u.HittestDrawHelper=w;u.Transformation=t;u.horizontalAlignment2HAlign=x;u.lineGapType2LineHeight=D;u.verticalAlignment2VAlign=E;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/CIMEffects":function(){define(["exports","../../core/lang"],function(u,G){let F=function(){function C(y){this._geometry=
y}C.prototype.next=function(){const y=this._geometry;this._geometry=null;return y};return C}();u.SimpleGeometryCursor=F;u.clone=function(C){return G.clone(C)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectControlMeasureLine ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e,d,g,m,n,r,t){u.getEffectOperator=function(z){if(!z)return null;switch(z.type){case "CIMGeometricEffectAddControlPoints":return G.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return F.EffectArrow.local();case "CIMGeometricEffectBuffer":return C.EffectBuffer.local();case "CIMGeometricEffectControlMeasureLine":return y.EffectControlMeasureLine.local();case "CIMGeometricEffectCut":return v.EffectCut.local();case "CIMGeometricEffectDashes":return p.EffectDashes.local();
case "CIMGeometricEffectDonut":return k.EffectDonut.local();case "CIMGeometricEffectJog":return b.EffectJog.local();case "CIMGeometricEffectMove":return a.EffectMove.local();case "CIMGeometricEffectOffset":return f.EffectOffset.local();case "CIMGeometricEffectReverse":return c.EffectReverse.local();case "CIMGeometricEffectRotate":return h.EffectRotate.local();case "CIMGeometricEffectScale":return l.EffectScale.local();case "CIMGeometricEffectWave":return q.EffectWave.local()}return null};u.getPlacementOperator=
function(z){if(!z)return null;switch(z.type){case "CIMMarkerPlacementAlongLineSameSize":return e.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return d.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return g.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return m.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return n.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return r.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return t.PlacementPolygonCenter.local()}return null};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(u,G,F,C){let y=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(k,b,a){return new v(k,b,a)};return p}();y.instance=
null;let v=function(){function p(b,a,f){this._inputGeometries=b;this._angleTolerance=void 0!==a.angleTolerance?a.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var k=p.prototype;k.next=function(){for(var b=this._inputGeometries.next();b;){if(F.isPolygon(b))return this._isClosed=!0,b=G.clone(b),this._processMultipath(b.rings),b;if(F.isPolyline(b))return this._isClosed=!1,b=G.clone(b),this._processMultipath(b.paths),b;if(F.isExtent(b)){if(this._maxCosAngle)return b;
this._isClosed=!0;b=[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]];this._processPath(b);return{rings:[b]}}b=this._inputGeometries.next()}return null};k._processMultipath=function(b){if(b)for(const a of b)this._processPath(a)};k._processPath=function(b){if(b){let a=b.length,f=b[0],c,h,l,q,e,d;this._isClosed&&++a;for(let g=1;g<a;++g){let m;m=this._isClosed&&g===a-1?b[0]:b[g];const n=m[0]-f[0],r=m[1]-f[1],t=Math.sqrt(n*n+r*r);1<g&&0<t&&0<l&&(c*n+h*r)/t/l<=this._maxCosAngle&&
C.setId(f,1);1===g&&(q=n,e=r,d=t);0<t&&(f=m,c=n,h=r,l=t)}this._isClosed&&0<l&&0<d&&(c*q+h*e)/d/l<=this._maxCosAngle&&C.setId(b[0],1)}};return p}();u.EffectAddControlPoints=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(u,G,F,C){function y(l){if(l){var q=l.length;for(--q;0<q;--q)l[q][0]-=l[q-1][0],l[q][1]-=l[q-1][1]}}function v(l){if(l)for(const q of l)y(q)}
function p(l){if(l){const q=l.length;for(let e=1;e<q;++e)l[e][0]+=l[e-1][0],l[e][1]+=l[e-1][1]}}function k(l){if(l)for(const q of l)p(q)}function b(l){l&&(F.isPolygon(l)?k(l.rings):F.isPolyline(l)?k(l.paths):F.isMultipoint(l)&&p(l.points))}function a(l){l&&l.reverse()}function f(l){return{rings:[[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]]]}}let c=function(){function l(q,e,d,g){this.acceptPolygon=e;this.acceptPolyline=d;this.geomUnitsPerPoint=g;this.pathIndex=
this.pathCount=-1;this.iteratePath=!1;q&&(F.isPolygon(q)?e&&(this.multiPath=q.rings,this.isClosed=!0):F.isPolyline(q)?d&&(this.multiPath=q.paths,this.isClosed=!1):F.isExtent(q)&&e&&(this.multiPath=f(q).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new C.Placement}l.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const q=this.processPath(this.multiPath[this.pathIndex]);
if(q)return q}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return l}(),h=function(){function l(q,e,d,g){this.inputGeometries=q;this.acceptPolygon=e;this.acceptPolyline=d;this.geomUnitsPerPoint=g;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}l.prototype.next=function(){for(;;){if(!this.multiPath){for(var q=this.inputGeometries.next();q;)if(F.isPolygon(q)?this.acceptPolygon&&(this.multiPath=q.rings,this.isClosed=!0):F.isPolyline(q)?this.acceptPolyline&&(this.multiPath=q.paths,
this.isClosed=!1):F.isExtent(q)&&this.acceptPolygon&&(this.multiPath=f(q).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else q=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,q=this.processPath(this.multiPath[this.pathIndex]))return q;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return l}();u.PathGeometryCursor=h;u.PathTransformationCursor=
c;u.cloneAndDecodeGeometry=function(l){l=G.clone(l);b(l);return l};u.deltaDecodeGeometry=b;u.deltaEncodeGeometry=function(l){l&&(F.isPolygon(l)?v(l.rings):F.isPolyline(l)?v(l.paths):F.isMultipoint(l)&&y(l.points))};u.getCoord2D=function(l,q,e){return[l[0]+(q[0]-l[0])*e,l[1]+(q[1]-l[1])*e]};u.getId=function(l){return l[4]};u.isClosedPath=function(l){return l&&0!==l.length?l[0][0]===l[l.length-1][0]&&l[0][1]===l[l.length-1][1]:!1};u.reverseMultipath=function(l){if(l)for(const q of l)a(q)};u.reversePath=
a;u.setId=function(l,q){l[4]=q};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(u,G,F,C){let y=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(k,b,a){return new v(k,b,a)};return p}();y.instance=null;let v=function(p){function k(a,f,c){a=p.call(this,a,!1,!0)||this;
a._curveHelper=new C.CurveHelper;a._width=(void 0!==f.width?f.width:5)*c;a._arrowType=void 0!==f.geometricEffectArrowType?f.geometricEffectArrowType:"OpenEnded";a._offsetFlattenError=C.PIXEL_TOLERANCE*c;return a}G._inheritsLoose(k,p);var b=k.prototype;b.processPath=function(a){switch(this._arrowType){default:return this._constructSimpleArrow(a,!0);case "Block":return this._constructSimpleArrow(a,!1);case "Crossed":return this._constructCrossedArrow(a)}};b._constructSimpleArrow=function(a,f){var c=
this._curveHelper.calculatePathLength(a),h=this._width;c<2*h&&(h=c/2);c=this._curveHelper.getSubCurve(a,0,c-h);if(!c)return null;var l=h/2;if(this._curveHelper.isEmpty(c,!1))return null;h=this._constructOffset(c,-l);if(!h)return null;c=this._constructOffset(c,l);if(!c)return null;const q=this._constructArrowBasePoint(h,-l/2);if(!q)return null;l=this._constructArrowBasePoint(c,l/2);if(!l)return null;a=a[a.length-1];f||(this._makeControlPoint(c,!0),this._makeControlPoint(h,!0));const e=new C.PathHelper;
e.addPath(c,!0);e.lineTo(l);this._makeControlPoint(e.path());e.lineTo(a);this._makeControlPoint(e.path());e.lineTo(q);this._makeControlPoint(e.path());e.addPath(h,!1);return f?{paths:[e.path()]}:(e.close(),{rings:[e.path()]})};b._constructCrossedArrow=function(a){var f=this._curveHelper.calculatePathLength(a),c=this._width;f<3.732050807568877*c&&(c=f/3.732050807568877);var h=this._curveHelper.getSubCurve(a,0,f-2.732050807568877*c);if(!h)return null;var l=c/2;if(this._curveHelper.isEmpty(h,!1))return null;
const q=this._constructOffset(h,l);if(!q)return null;h=this._constructOffset(h,-l);if(!h)return null;f=this._curveHelper.getSubCurve(a,0,f-c);if(!f||this._curveHelper.isEmpty(f,!1))return null;c=this._constructOffset(f,l);if(!c)return null;var e=this._constructOffset(f,-l);if(!e)return null;f=c[c.length-1];c=this._constructArrowBasePoint(c,l/2);if(!c)return null;const d=e[e.length-1];l=this._constructArrowBasePoint(e,-l/2);if(!l)return null;a=a[a.length-1];this._makeControlPoint(q,!1);this._makeControlPoint(h,
!1);e=new C.PathHelper;e.addPath(q,!0);this._makeControlPoint(e.path());e.lineTo(d);e.lineTo(l);this._makeControlPoint(e.path());e.lineTo(a);this._makeControlPoint(e.path());e.lineTo(c);this._makeControlPoint(e.path());e.lineTo(f);this._makeControlPoint(e.path());e.addPath(h,!1);return{paths:[e.path()]}};b._constructOffset=function(a,f){return this._curveHelper.offset(a,f,"Rounded",4,this._offsetFlattenError)};b._constructArrowBasePoint=function(a,f){if(!a||2>a.length)return null;var c=a[a.length-
2];a=a[a.length-1];c=[a[0]-c[0],a[1]-c[1]];this._curveHelper.normalize(c);return[a[0]+c[1]*f,a[1]-c[0]*f]};b._makeControlPoint=function(a,f=!1){f?F.setId(a[0],1):F.setId(a[a.length-1],1)};return k}(F.PathGeometryCursor);u.EffectArrow=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/CurveHelper":function(){define(["exports"],function(u){let G=function(){function C(){this._path=[]}var y=C.prototype;y.path=function(){return this._path};y.addPath=function(v,p){p||v.reverse();Array.prototype.push.apply(this._path,
v);p||v.reverse()};C.mergePath=function(v,p){p&&Array.prototype.push.apply(v,p)};y.startPath=function(v){this._path.push(v)};y.lineTo=function(v){this._path.push(v)};y.close=function(){const v=this._path;1<v.length&&(v[0][0]!==v[v.length-1][0]||v[0][1]!==v[v.length-1][1])&&v.push([v[0][0],v[0][1]])};return C}(),F=function(){function C(v,p){}var y=C.prototype;y.normalize=function(v){const p=Math.sqrt(v[0]*v[0]+v[1]*v[1]);v[0]/=p;v[1]/=p};y.calculateLength=function(v,p){const k=p[0]-v[0];v=p[1]-v[1];
return Math.sqrt(k*k+v*v)};y.calculateSegLength=function(v,p){return this.calculateLength(v[p],v[p+1])};y.calculatePathLength=function(v){let p=0;const k=v?v.length:0;for(let b=0;b<k-1;++b)p+=this.calculateSegLength(v,b);return p};y.calculatePathArea=function(v){let p=0;const k=v?v.length:0;for(let b=0;b<k-1;++b)p+=(v[b+1][0]-v[b][0])*(v[b+1][1]+v[b][1]);return p/2};y.getCoord2D=function(v,p,k){return[v[0]+(p[0]-v[0])*k,v[1]+(p[1]-v[1])*k]};y.getSegCoord2D=function(v,p,k){return this.getCoord2D(v[p],
v[p+1],k)};y.getAngle=function(v,p,k){return Math.atan2(p[1]-v[1],p[0]-v[0])};y.getSegAngle=function(v,p,k){return this.getAngle(v[p],v[p+1],k)};y.getAngleCS=function(v,p,k){k=p[0]-v[0];v=p[1]-v[1];p=Math.sqrt(k*k+v*v);return 0<p?[k/p,v/p]:[1,0]};y.getSegAngleCS=function(v,p,k){return this.getAngleCS(v[p],v[p+1],k)};y.cut=function(v,p,k,b){k=0>=k?v[p]:this.getSegCoord2D(v,p,k);v=1<=b?v[p+1]:this.getSegCoord2D(v,p,b);return[k,v]};y.addSegment=function(v,p,k){k&&v.push(p[0]);v.push(p[1])};y.getSubCurve=
function(v,p,k){const b=[];return this.appendSubCurve(b,v,p,k)?b:null};y.appendSubCurve=function(v,p,k,b){const a=p?p.length-1:0;let f=0,c=!0,h=0;for(;h<a;){const q=this.calculateSegLength(p,h);if(0!==q){if(c){if(f+q>k){var l=(k-f)/q;let e=1,d=!1;f+q>=b&&(e=(b-f)/q,d=!0);(l=this.cut(p,h,l,e))&&this.addSegment(v,l,c);if(d)break;c=!1}}else{if(f+q>b){(p=this.cut(p,h,0,(b-f)/q))&&this.addSegment(v,p,c);break}this.addSegment(v,[p[h],p[h+1]],c)}f+=q}++h}return!0};y.getCIMPointAlong=function(v,p){const k=
v?v.length-1:0;let b=0,a=-1;for(;a<k;){++a;const f=this.calculateSegLength(v,a);if(0!==f){if(b+f>p)return this.getCoord2D(v[a],v[a+1],(p-b)/f);b+=f}}return null};y.isEmpty=function(v,p){if(!v||1>=v.length)return!0;const k=v?v.length-1:0;let b=-1;for(;b<k;)if(++b,v[b+1][0]!==v[b][0]||v[b+1][1]!==v[b][1]||p&&v[b+1][2]!==v[b][2])return!1;return!0};y.offset=function(v,p,k,b,a){if(!v||2>v.length)return null;var f=0,c=v[f++];for(a=f;f<v.length;){var h=v[f];if(h[0]!==c[0]||h[1]!==c[1])f!==a&&(v[a]=v[f]),
c=v[a++];f++}(f=v[0][0]===v[a-1][0]&&v[0][1]===v[a-1][1])&&--a;if(a<(f?3:2))return null;h=[];c=f?v[a-1]:null;let l=v[0];for(let g=0;g<a;g++){const m=g===a-1?f?v[0]:null:v[g+1];if(c)if(m){var q=[m[0]-l[0],m[1]-l[1]];this.normalize(q);c=[l[0]-c[0],l[1]-c[1]];this.normalize(c);var e=c[0]*q[1]-c[1]*q[0],d=c[0]*q[0]+c[1]*q[1];if(0<=e===0>=p)1>d&&(q=[q[0]-c[0],q[1]-c[1]],this.normalize(q),c=Math.sqrt((1+d)/2),c>1/b&&(c=-Math.abs(p)/c,h.push([l[0]-q[0]*c,l[1]-q[1]*c])));else switch(k){case "Mitered":if(d=
Math.sqrt((1+d)/2),0<d&&1/d<b){q=[q[0]-c[0],q[1]-c[1]];this.normalize(q);c=Math.abs(p)/d;h.push([l[0]-q[0]*c,l[1]-q[1]*c]);break}case "Bevelled":h.push([l[0]+c[1]*p,l[1]-c[0]*p]);h.push([l[0]+q[1]*p,l[1]-q[0]*p]);break;case "Rounded":if(1>d){h.push([l[0]+c[1]*p,l[1]-c[0]*p]);d=Math.floor(2.5*(1-d));if(0<d){let n=e=1/d;for(let r=1;r<d;r++,n+=e){const t=[c[1]*(1-n)+q[1]*n,-c[0]*(1-n)-q[0]*n];this.normalize(t);h.push([l[0]+t[0]*p,l[1]+t[1]*p])}}h.push([l[0]+q[1]*p,l[1]-q[0]*p])}break;default:0>e?(h.push([l[0]+
(c[1]+c[0])*p,l[1]+(c[1]-c[0])*p]),h.push([l[0]+(q[1]-q[0])*p,l[1]-(q[0]+q[1])*p])):(d=Math.sqrt((1+Math.abs(d))/2),q=[q[0]-c[0],q[1]-c[1]],this.normalize(q),c=p/d,h.push([l[0]-q[0]*c,l[1]-q[1]*c]))}}else q=[l[0]-c[0],l[1]-c[1]],this.normalize(q),h.push([l[0]+q[1]*p,l[1]-q[0]*p]);else q=[m[0]-l[0],m[1]-l[1]],this.normalize(q),h.push([l[0]+q[1]*p,l[1]-q[0]*p]);c=l;l=m}if(h.length<(f?3:2))return null;f&&h.push([h[0][0],h[0][1]]);return h};return C}();u.CurveHelper=F;u.PIXEL_TOLERANCE=.03;u.PathHelper=
G;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(u,G,F){let C=function(){function v(){}v.local=function(){null===v.instance&&(v.instance=new v);return v.instance};v.prototype.execute=function(p,k,b){return new y(p,k,b)};return v}();C.instance=null;let y=function(){function v(p,k,b){this._inputGeometries=p;this._curveHelper=new F.CurveHelper;this._size=(void 0!==
k.size?k.size:1)*b;this._offsetFlattenError=F.PIXEL_TOLERANCE*b}v.prototype.next=function(){let p=this._inputGeometries.next();for(;p;){if(G.isExtent(p))if(0<this._size){var k=this._curveHelper.offset([[p.xmin,p.ymin],[p.xmin,p.ymax],[p.xmax,p.ymax],[p.xmax,p.ymin],[p.xmin,p.ymin]],this._size,"Rounded",4,this._offsetFlattenError);if(k)return{rings:[k]}}else if(0>this._size){if(0<Math.min(p.xmax-p.xmin,p.ymax-p.ymin)+2*this._size)return{xmin:p.xmin-this._size,xmax:p.xmax+this._size,ymin:p.ymin-this._size,
ymax:p.ymax+this._size}}else return p;if(G.isPolygon(p)){if(0===this._size)return p;k=[];for(const a of p.rings){var b=this._curveHelper.offset(a,this._size,"Rounded",4,this._offsetFlattenError);b&&k.push(b)}if(k.length)return{rings:k}}if(G.isPolyline(p)&&0<this._size){k=[];for(const a of p.paths)if(a&&1<a.length){b=this._curveHelper.offset(a,this._size,"Rounded",4,this._offsetFlattenError);const f=this._curveHelper.offset(a,-this._size,"Rounded",4,this._offsetFlattenError);if(b&&f){for(let c=f.length-
1;0<=c;c--)b.push(f[c]);b.push([b[0][0],b[0][1]]);k.push(b)}}if(k.length)return{rings:k}}G.isPoint(p);p=this._inputGeometries.next()}return null};return v}();u.EffectBuffer=C;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectControlMeasureLine":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor"],function(u,G,F){let C=function(){function v(){}v.local=function(){null===v.instance&&(v.instance=new v);return v.instance};v.prototype.execute=
function(p,k,b){return new y(p,k,b)};return v}();C.instance=null;let y=function(){function v(k,b,a){var f;this._default_point_size=20;this._inputGeometries=k;this._geomUnitsPerPoint=a;this._rule=null!=(f=b.rule)?f:"FullGeometry";this._default_size=this._default_point_size*a}var p=v.prototype;p.next=function(){let k;for(;k=this._inputGeometries.next();){let b;G.isPoint(k)?b=this._processGeom([[[k.x,k.y]]]):G.isMultipoint(k)?b=this._processGeom([k.points]):G.isPolyline(k)?b=this._processGeom(k.paths):
G.isPolygon(k)&&(b=this._processGeom(k.rings));if(b&&b.length)return{paths:b}}return null};p._clone=function(k){return[k[0],k[1]]};p._mid=function(k,b){return[(k[0]+b[0])/2,(k[1]+b[1])/2]};p._mix=function(k,b,a,f){return[k[0]*b+a[0]*f,k[1]*b+a[1]*f]};p._add=function(k,b){return[k[0]+b[0],k[1]+b[1]]};p._add2=function(k,b,a){return[k[0]+b,k[1]+a]};p._sub=function(k,b){return[k[0]-b[0],k[1]-b[1]]};p._dist=function(k,b){return Math.sqrt((k[0]-b[0])*(k[0]-b[0])+(k[1]-b[1])*(k[1]-b[1]))};p._norm=function(k){return Math.sqrt(k[0]*
k[0]+k[1]*k[1])};p._normalize=function(k,b=1){b/=this._norm(k);k[0]*=b;k[1]*=b};p._leftPerpendicular=function(k){const b=-k[0];k[0]=k[1];k[1]=b};p._leftPerp=function(k){return[k[1],-k[0]]};p._rightPerpendicular=function(k){const b=k[0];k[0]=-k[1];k[1]=b};p._rightPerp=function(k){return[-k[1],k[0]]};p._dotProduct=function(k,b){return k[0]*b[0]+k[1]*b[1]};p._crossProduct=function(k,b){return-(k[0]*b[1]-k[1]*b[0])};p._rotateDirect=function(k,b,a){a=-a;const f=k[0]*a+k[1]*b;k[0]=k[0]*b-k[1]*a;k[1]=f};
p._makeCtrlPt=function(k){k=[k[0],k[1]];F.setId(k,1);return k};p._addAngledTicks=function(k,b,a,f){const c=this._sub(a,b);this._normalize(c);var h=this._crossProduct(c,this._sub(f,b));f=0<h?this._rightPerp(c):this._leftPerp(c);h=Math.abs(h)/2;const l=[];l.push([b[0]+(f[0]-c[0])*h,b[1]+(f[1]-c[1])*h]);l.push(b);l.push(a);l.push([a[0]+(f[0]+c[0])*h,a[1]+(f[1]+c[1])*h]);k.push(l)};p._addBezier2=function(k,b,a,f,c){if(0===c--)k.push(f);else{var h=this._mid(b,a);a=this._mid(a,f);var l=this._mid(h,a);this._addBezier2(k,
b,h,l,c);this._addBezier2(k,l,a,f,c)}};p._addBezier3=function(k,b,a,f,c,h){if(0===h--)k.push(c);else{var l=this._mid(b,a),q=this._mid(a,f);f=this._mid(f,c);a=this._mid(l,q);q=this._mid(q,f);var e=this._mid(a,q);this._addBezier3(k,b,l,a,e,h);this._addBezier3(k,e,q,f,c,h)}};p._add90DegArc=function(k,b,a,f,c){f=null!=c?c:0<this._crossProduct(this._sub(a,b),this._sub(f,b));c=this._mid(b,a);const h=this._sub(c,b);f?this._leftPerpendicular(h):this._rightPerpendicular(h);c[0]+=h[0];c[1]+=h[1];this._addBezier3(k,
b,this._mix(b,.33333,c,.66667),this._mix(a,.33333,c,.66667),a,4)};p._addArrow=function(k,b,a){var f=b[0],c=b[1],h=b[b.length-1],l=this._sub(f,c);this._normalize(l);const q=this._crossProduct(l,this._sub(h,c));c=.5*q;var e=this._leftPerp(l);const d=[h[0]-e[0]*q,h[1]-e[1]*q];var g=b.length-1;h=[];h.push(a?[-e[0],-e[1]]:e);var m=[-l[0],-l[1]];for(a=1;a<g-1;a++){l=this._sub(b[a+1],b[a]);this._normalize(l);var n=this._dotProduct(l,m);e=this._crossProduct(l,m);n=Math.sqrt((1+n)/2);m=this._sub(l,m);this._normalize(m);
m[0]/=n;m[1]/=n;h.push(0>e?[-m[0],-m[1]]:m);m=l}h.push(this._rightPerp(m));for(g=h.length-1;0<g;g--)k.push([b[g][0]+h[g][0]*c,b[g][1]+h[g][1]*c]);k.push([d[0]+h[0][0]*c,d[1]+h[0][1]*c]);k.push([d[0]+h[0][0]*q,d[1]+h[0][1]*q]);k.push(f);k.push([d[0]-h[0][0]*q,d[1]-h[0][1]*q]);k.push([d[0]-h[0][0]*c,d[1]-h[0][1]*c]);for(f=1;f<h.length;f++)k.push([b[f][0]-h[f][0]*c,b[f][1]-h[f][1]*c])};p._cp2=function(k,b,a){return 2<=k.length?k[1]:this._add2(k[0],b*this._default_size,-a*this._default_size)};p._cp3=
function(k,b,a,f){if(3<=k.length)return k[2];a=this._mix(k[0],1-a,b,a);k=this._sub(b,k[0]);this._normalize(k);this._rightPerpendicular(k);return[a[0]+k[0]*f*this._default_size,a[1]+k[1]*f*this._default_size]};p._arrowPath=function(k){if(2<k.length)return k;const b=k[0];k=this._cp2(k,-4,0);const a=this._sub(b,k);this._normalize(a);const f=this._rightPerp(a);return[b,k,[b[0]+(f[0]-a[0])*this._default_size,b[1]+(f[1]-a[1])*this._default_size]]};p._arrowLastSeg=function(k){var b=k[0];const a=this._cp2(k,
-4,0);if(3<=k.length)b=k[k.length-1];else{k=this._sub(b,a);this._normalize(k);const f=this._rightPerp(k);b=[b[0]+(f[0]-k[0])*this._default_size,b[1]+(f[1]-k[1])*this._default_size]}return[a,b]};p._processGeom=function(k){if(!k)return null;const b=[];for(const a of k){if(!a||0===a.length)continue;const f=a.length;let c=a[0];switch(this._rule){case "PerpendicularFromFirstSegment":{const h=this._cp2(a,0,-1),l=this._cp3(a,h,.5,4),q=[];q.push(l);q.push(this._mid(c,h));b.push(q);break}case "ReversedFirstSegment":{const h=
this._cp2(a,0,-1);b.push([h,c]);break}case "PerpendicularToSecondSegment":{const h=this._cp2(a,-4,1),l=this._cp3(a,h,.882353,-1.94),q=[];q.push(this._mid(h,l));q.push(c);b.push(q);break}case "SecondSegmentWithTicks":{const h=this._cp2(a,-4,1),l=this._cp3(a,h,.882353,-1.94),q=this._sub(l,h);let e;e=0<this._crossProduct(q,this._sub(c,h))?this._rightPerp(e):this._leftPerp(q);const d=[];d.push([h[0]+(e[0]-q[0])/3,h[1]+(e[1]-q[1])/3]);d.push(h);d.push(l);d.push([l[0]+(e[0]+q[0])/3,l[1]+(e[1]+q[1])/3]);
b.push(d);break}case "DoublePerpendicular":{const h=this._cp2(a,0,-1),l=this._cp3(a,h,.5,3),q=this._mid(c,h),e=this._sub(q,l);this._normalize(e);const d=this._crossProduct(e,this._sub(c,l));this._leftPerpendicular(e);const g=[];g.push(c);g.push([l[0]+e[0]*d,l[1]+e[1]*d]);b.push(g);const m=[];m.push([l[0]-e[0]*d,l[1]-e[1]*d]);m.push(h);b.push(m);break}case "OppositeToFirstSegment":{const h=this._cp2(a,0,-1),l=this._cp3(a,h,.5,3),q=this._mid(c,h),e=this._sub(q,l);this._normalize(e);const d=this._crossProduct(e,
this._sub(c,l));this._leftPerpendicular(e);const g=[];g.push([l[0]+e[0]*d,l[1]+e[1]*d]);g.push([l[0]-e[0]*d,l[1]-e[1]*d]);b.push(g);break}case "TriplePerpendicular":{const h=this._cp2(a,0,-1),l=this._cp3(a,h,.5,4),q=this._mid(c,h),e=this._sub(q,l);this._normalize(e);const d=this._crossProduct(e,this._sub(c,l));this._leftPerpendicular(e);const g=[];g.push([l[0]+e[0]*d*.8,l[1]+e[1]*d*.8]);g.push([q[0]+.8*(c[0]-q[0]),q[1]+.8*(c[1]-q[1])]);b.push(g);b.push([l,q]);const m=[];m.push([l[0]-e[0]*d*.8,l[1]-
e[1]*d*.8]);m.push([q[0]+.8*(h[0]-q[0]),q[1]+.8*(h[1]-q[1])]);b.push(m);break}case "HalfCircleFirstSegment":{const h=this._cp2(a,0,-1),l=this._cp3(a,h,.5,4),q=this._mid(c,h);let e=this._sub(h,c);const d=Math.cos(Math.PI/18),g=Math.sin(Math.PI/18),m=Math.sqrt((1+d)/2),n=Math.sqrt((1-d)/2),r=[];let t;0<this._crossProduct(e,this._sub(l,c))?(r.push(c),e=this._sub(c,q),t=h):(r.push(h),e=this._sub(h,q),t=c);this._rotateDirect(e,m,n);e[0]/=m;e[1]/=m;for(let z=1;18>=z;z++)r.push(this._add(q,e)),this._rotateDirect(e,
d,g);r.push(t);b.push(r);break}case "HalfCircleSecondSegment":{const h=this._cp2(a,0,-1),l=this._cp3(a,h,1,-1);let q=this._sub(c,h);this._normalize(q);const e=this._crossProduct(q,this._sub(l,h))/2;this._leftPerpendicular(q);const d=[h[0]+q[0]*e,h[1]+q[1]*e];q=this._sub(h,d);const g=Math.cos(Math.PI/18);let m=Math.sin(Math.PI/18);0<e&&(m=-m);const n=[h];for(let r=1;18>=r;r++)this._rotateDirect(q,g,m),n.push(this._add(d,q));b.push(n);break}case "HalfCircleExtended":{const h=this._cp2(a,0,-2),l=this._cp3(a,
h,1,-1);let q;if(4<=f)q=a[3];else{const n=this._sub(c,h);q=this._add(l,n)}const e=this._dist(h,l)/2/.75,d=this._sub(h,c);this._normalize(d,e);const g=this._sub(l,q);this._normalize(g,e);b.push([q,l]);const m=[this._clone(l)];this._addBezier3(m,l,this._add(l,g),this._add(h,d),h,4);m.push(c);b.push(m);break}case "OpenCircle":{const h=this._cp2(a,-2,0),l=this._sub(h,c),q=Math.cos(Math.PI/18),e=-Math.sin(Math.PI/18),d=[h];for(let g=1;33>=g;g++)this._rotateDirect(l,q,e),d.push(this._add(c,l));b.push(d);
break}case "CoverageEdgesWithTicks":{const h=this._cp2(a,0,-1);let l;if(3<=f)l=a[2];else{const m=this._sub(h,c),n=this._leftPerp(m);l=[c[0]+n[0]-.25*m[0],c[1]+n[1]-.25*m[1]]}let q;if(4<=f)q=a[3];else{const m=this._mid(c,h),n=this._sub(c,h);this._normalize(n);this._leftPerpendicular(n);const r=this._crossProduct(n,this._sub(l,m));this._rightPerpendicular(n);q=[l[0]+n[0]*r*2,l[1]+n[1]*r*2]}const e=this._sub(h,c);let d,g;d=0<this._crossProduct(e,this._sub(l,c))?this._rightPerp(e):this._leftPerp(e);g=
[];g.push(l);g.push(c);g.push([c[0]+(d[0]-e[0])/3,c[1]+(d[1]-e[1])/3]);b.push(g);d=0<this._crossProduct(e,this._sub(q,h))?this._rightPerp(d):this._leftPerp(e);g=[];g.push([h[0]+(d[0]+e[0])/3,h[1]+(d[1]+e[1])/3]);g.push(h);g.push(q);b.push(g);break}case "GapExtentWithDoubleTicks":{const h=this._cp2(a,0,2),l=this._cp3(a,h,0,1);let q;if(4<=f)q=a[3];else{const e=this._sub(h,c);q=this._add(l,e)}this._addAngledTicks(b,c,h,this._mid(l,q));this._addAngledTicks(b,l,q,this._mid(c,h));break}case "GapExtentMidline":{const h=
this._cp2(a,2,0),l=this._cp3(a,h,0,1);let q;if(4<=f)q=a[3];else{const d=this._sub(h,c);q=this._add(l,d)}const e=[];e.push(this._mid(c,l));e.push(this._mid(h,q));b.push(e);break}case "Chevron":{const h=this._cp2(a,-1,-1);let l;if(3<=f)l=a[2];else{const q=this._sub(h,c);this._leftPerpendicular(q);l=this._add(c,q)}b.push([h,this._makeCtrlPt(c),l]);break}case "PerpendicularWithArc":{const h=this._cp2(a,0,-2),l=this._cp3(a,h,.5,-1);let q=this._sub(h,c);const e=this._norm(q);q[0]/=e;q[1]/=e;const d=this._crossProduct(q,
this._sub(l,c));let g=this._dotProduct(q,this._sub(l,c));g<.05*e?g=.05*e:g>.95*e&&(g=.95*e);const m=[c[0]+q[0]*g,c[1]+q[1]*g];this._leftPerpendicular(q);let n=[];n.push([m[0]-q[0]*d,m[1]-q[1]*d]);n.push([m[0]+q[0]*d,m[1]+q[1]*d]);b.push(n);const r=[h[0]+q[0]*d,h[1]+q[1]*d];q=this._sub(h,r);const t=Math.cos(Math.PI/18);let z=Math.sin(Math.PI/18);0>d&&(z=-z);n=[c,h];for(let w=1;9>=w;w++)this._rotateDirect(q,t,z),n.push(this._add(r,q));b.push(n);break}case "ClosedHalfCircle":{const h=this._cp2(a,2,0),
l=this._mid(c,h),q=this._sub(h,l),e=Math.cos(Math.PI/18),d=Math.sin(Math.PI/18),g=[c,h];for(let m=1;18>=m;m++)this._rotateDirect(q,e,d),g.push(this._add(l,q));b.push(g);break}case "TripleParallelExtended":{const h=this._cp2(a,0,-2),l=this._cp3(a,h,1,-2),q=this._mid(c,h),e=this._sub(l,h);this._normalize(e);const d=Math.abs(this._crossProduct(e,this._sub(q,h)))/2,g=this._dist(h,l),m=[h,c];m.push([c[0]+e[0]*g*.5,c[1]+e[1]*g*.5]);b.push(m);const n=[];n.push([q[0]-e[0]*d,q[1]-e[1]*d]);n.push([q[0]+e[0]*
g*.375,q[1]+e[1]*g*.375]);F.setId(n[n.length-1],1);n.push([q[0]+e[0]*g*.75,q[1]+e[1]*g*.75]);b.push(n);b.push([h,l]);break}case "ParallelWithTicks":{const h=this._cp2(a,3,0),l=this._cp3(a,h,.5,-1),q=this._sub(l,h);this._normalize(q);const e=this._crossProduct(q,this._sub(l,c));this._leftPerpendicular(q);this._addAngledTicks(b,c,h,l);this._addAngledTicks(b,this._mix(c,1,q,e),this._mix(h,1,q,e),this._mid(c,h));break}case "Parallel":{const h=this._cp2(a,3,0),l=this._cp3(a,h,.5,-1),q=this._sub(h,c);this._normalize(q);
const e=this._leftPerp(q),d=this._crossProduct(q,this._sub(l,c));let g=[c,h];b.push(g);g=[];g.push([c[0]+e[0]*d,c[1]+e[1]*d]);g.push([h[0]+e[0]*d,h[1]+e[1]*d]);b.push(g);break}case "PerpendicularToFirstSegment":{const h=this._cp2(a,3,0),l=this._cp3(a,h,.5,-1),q=this._mid(c,h),e=this._sub(h,c);this._normalize(e);const d=this._crossProduct(e,this._sub(l,c));this._leftPerpendicular(e);const g=[];g.push([q[0]-e[0]*d*.25,q[1]-e[1]*d*.25]);g.push([q[0]+e[0]*d*1.25,q[1]+e[1]*d*1.25]);b.push(g);break}case "ParallelOffset":{const h=
this._cp2(a,3,0),l=this._cp3(a,h,.5,-1),q=this._sub(h,c);this._normalize(q);const e=this._crossProduct(q,this._sub(l,c));this._leftPerpendicular(q);const d=[];d.push([c[0]-q[0]*e,c[1]-q[1]*e]);d.push([h[0]-q[0]*e,h[1]-q[1]*e]);b.push(d);const g=[];g.push([c[0]+q[0]*e,c[1]+q[1]*e]);g.push([h[0]+q[0]*e,h[1]+q[1]*e]);b.push(g);break}case "OffsetOpposite":{const h=this._cp2(a,3,0),l=this._cp3(a,h,.5,-1),q=this._sub(h,c);this._normalize(q);const e=this._crossProduct(q,this._sub(l,c));this._leftPerpendicular(q);
const d=[];d.push([c[0]-q[0]*e,c[1]-q[1]*e]);d.push([h[0]-q[0]*e,h[1]-q[1]*e]);b.push(d);break}case "OffsetSame":{const h=this._cp2(a,3,0),l=this._cp3(a,h,.5,-1),q=this._sub(h,c);this._normalize(q);const e=this._crossProduct(q,this._sub(l,c));this._leftPerpendicular(q);const d=[];d.push([c[0]+q[0]*e,c[1]+q[1]*e]);d.push([h[0]+q[0]*e,h[1]+q[1]*e]);b.push(d);break}case "CircleWithArc":{let h=this._cp2(a,3,0);const l=this._cp3(a,h,.5,-1);let q,e;if(4<=f)q=a[3],e=0<this._crossProduct(this._sub(q,h),this._sub(l,
h));else{q=h;e=0<this._crossProduct(this._sub(q,c),this._sub(l,c));const r=24*this._geomUnitsPerPoint,t=this._sub(q,c);this._normalize(t,r);const z=Math.sqrt(2)/2;this._rotateDirect(t,z,e?z:-z);h=this._add(c,t)}const d=this._sub(h,c),g=Math.cos(Math.PI/18),m=Math.sin(Math.PI/18),n=[h];for(let r=1;36>=r;r++)this._rotateDirect(d,g,m),n.push(this._add(c,d));this._add90DegArc(n,h,q,l,e);F.setId(n[n.length-8],1);b.push(n);break}case "DoubleJog":{let h=this._cp2(a,-3,1),l;l=3<=f?a[2]:this._add(c,this._sub(c,
h));let q;if(4<=f)q=a[3];else{const w=c;c=h;q=l;const B=this._dist(c,w),A=this._dist(q,w);let x=30*this._geomUnitsPerPoint;.5*B<x&&(x=.5*B);.5*A<x&&(x=.5*A);h=this._mix(c,x/B,w,(B-x)/B);l=this._mix(q,x/A,w,(A-x)/A)}const e=this._mid(c,h),d=this._mid(q,l),g=this._dist(c,h),m=this._dist(l,q);let n=Math.min(g,m)/8;n=Math.min(n,24*this._geomUnitsPerPoint);const r=Math.cos(Math.PI/4);let t=this._sub(c,h);this._normalize(t,n);0<this._crossProduct(t,this._sub(q,h))?this._rotateDirect(t,r,-r):this._rotateDirect(t,
r,r);let z=[];z.push(h);z.push(this._add(e,t));z.push(this._sub(e,t));z.push(c);b.push(z);t=this._sub(q,l);this._normalize(t,n);0>this._crossProduct(t,this._sub(c,l))?this._rotateDirect(t,r,r):this._rotateDirect(t,r,-r);z=[];z.push(l);z.push(this._add(d,t));z.push(this._sub(d,t));z.push(q);b.push(z);break}case "PerpendicularOffset":{const h=this._cp2(a,-4,1),l=this._cp3(a,h,.882353,-1.94),q=this._sub(l,h);0<this._crossProduct(q,this._sub(c,h))?this._rightPerpendicular(q):this._leftPerpendicular(q);
const e=[q[0]/8,q[1]/8],d=this._sub(this._mid(h,l),e);b.push([d,c]);break}case "LineExcludingLastSegment":{const h=this._arrowPath(a),l=[];let q=h.length-2;for(;q--;)l.push(h[q]);b.push(l);break}case "MultivertexArrow":{const h=this._arrowPath(a),l=[];this._addArrow(l,h,!1);b.push(l);break}case "CrossedArrow":{const h=this._arrowPath(a),l=[];this._addArrow(l,h,!0);b.push(l);break}case "ChevronArrow":{const [h,l]=this._arrowLastSeg(a),q=10*this._geomUnitsPerPoint,e=this._sub(c,h);this._normalize(e);
const d=this._crossProduct(e,this._sub(l,h)),g=this._leftPerp(e),m=[l[0]-g[0]*d*2,l[1]-g[1]*d*2],n=[];n.push([l[0]+e[0]*q,l[1]+e[1]*q]);n.push(c);n.push([m[0]+e[0]*q,m[1]+e[1]*q]);b.push(n);break}case "ChevronArrowOffset":{const [h,l]=this._arrowLastSeg(a),q=this._sub(c,h);this._normalize(q);const e=this._crossProduct(q,this._sub(l,h));this._leftPerpendicular(q);const d=[l[0]-q[0]*e,l[1]-q[1]*e],g=[];g.push([d[0]+q[0]*e*.5,d[1]+q[1]*e*.5]);g.push(this._mid(d,c));g.push([d[0]-q[0]*e*.5,d[1]-q[1]*e*
.5]);b.push(g);break}case "PartialFirstSegment":{const [h,l]=this._arrowLastSeg(a),q=this._sub(c,h);this._normalize(q);const e=this._crossProduct(q,this._sub(l,h));this._leftPerpendicular(q);b.push([h,[l[0]-q[0]*e,l[1]-q[1]*e]]);break}case "Arch":{const h=this._cp2(a,0,-1),l=this._cp3(a,h,.5,1),q=this._sub(c,h),e=this._mix(l,1,q,.55),d=this._mix(l,1,q,-.55),g=[c];this._addBezier2(g,c,e,l,4);this._addBezier2(g,l,d,h,4);b.push(g);break}case "CurvedParallelTicks":{const h=this._cp2(a,-4,1),l=this._cp3(a,
h,.882353,-1.94),q=this._sub(l,h);0<this._crossProduct(q,this._sub(c,h))?this._rightPerpendicular(q):this._leftPerpendicular(q);const e=[q[0]/8,q[1]/8],d=this._sub(this._mid(h,l),e),g=this._sub(this._mix(h,.75,l,.25),e),m=this._sub(this._mix(h,.25,l,.75),e),n=[h];this._addBezier2(n,h,g,d,3);this._addBezier2(n,d,m,l,3);b.push(n);for(let r=0;8>r;r++){const t=n[2*r+1],z=[this._clone(t)];z.push(this._add(t,[q[0]/4,q[1]/4]));b.push(z)}break}case "Arc90Degrees":{const h=this._cp2(a,0,-1),l=this._cp3(a,
h,.5,1),q=[h];this._add90DegArc(q,h,c,l);b.push(q);break}default:b.push(a)}}return b};return v}();u.EffectControlMeasureLine=C;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(u,G,F,C){let y=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(k,b,a){return new v(k,b,a)};
return p}();y.instance=null;let v=function(p){function k(b,a,f){b=p.call(this,b,!0,!0)||this;b._curveHelper=new C.CurveHelper;b._beginCut=(void 0!==a.beginCut?a.beginCut:1)*f;b._endCut=(void 0!==a.endCut?a.endCut:1)*f;b._middleCut=(void 0!==a.middleCut?a.middleCut:0)*f;b._invert=void 0!==a.invert?a.invert:!1;0>b._beginCut&&(b._beginCut=0);0>b._endCut&&(b._endCut=0);0>b._middleCut&&(b._middleCut=0);return b}G._inheritsLoose(k,p);k.prototype.processPath=function(b){var a=this._beginCut;const f=this._endCut,
c=this._middleCut,h=this._curveHelper.calculatePathLength(b),l=[];if(!this._invert)0===a&&0===f&&0===c?l.push(b):a+f+c>=h||(0===c?(b=this._curveHelper.getSubCurve(b,a,h-f))&&l.push(b):((a=this._curveHelper.getSubCurve(b,a,.5*(h-c)))&&l.push(a),(a=this._curveHelper.getSubCurve(b,.5*(h+c),h-f))&&l.push(a)));else if(0!==a||0!==f||0!==c)a+f+c>=h?l.push(b):((a=this._curveHelper.getSubCurve(b,0,a))&&l.push(a),(a=this._curveHelper.getSubCurve(b,.5*(h-c),.5*(h+c)))&&l.push(a),(a=this._curveHelper.getSubCurve(b,
h-f,f))&&l.push(a));return 0===l.length?null:{paths:l}};return k}(F.PathGeometryCursor);u.EffectCut=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDashes":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../GeometryWalker"],function(u,G,F,C,y){let v=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(b,a,f){return new p(b,a,f)};
return k}();v.instance=null;let p=function(k){function b(a,f,c){var h,l;a=k.call(this,a,!0,!0)||this;a._walker=new y.GeometryWalker;a._walker.updateTolerance(c);a._endings=f.lineDashEnding;a._customDashPos=-(null!=(h=f.offsetAlongLine)?h:0)*c;a._offsetAtEnd=(null!=(l=f.customEndingOffset)?l:0)*c;a._pattern=new y.DashPattern;a._pattern.init(f.dashTemplate,!0);a._pattern.scale(c);return a}G._inheritsLoose(b,k);b.prototype.processPath=function(a){if(0===this._pattern.length())return this.iteratePath=
!1,{paths:[a]};if(!this.iteratePath){var f=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case "FullPattern":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case "FullGap":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case "NoConstraint":this.isClosed||(f=!1);break;case "Custom":this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var c=this._walker.calculatePathLength(a);if(this._pattern.isEmpty()||c<.1*this._pattern.length()||
!this._walker.init(a,this._pattern,f))return{paths:[a]}}if(this.iteratePath)a=this._pattern.nextValue();else{switch(this._endings){default:f=.5*this._pattern.firstValue();break;case "HalfGap":f=.5*-this._pattern.lastValue();break;case "FullGap":f=-this._pattern.lastValue();break;case "FullPattern":f=0;break;case "NoConstraint":case "Custom":f=-this._customDashPos}a=f/this._pattern.length();a-=Math.floor(a);f=a*this._pattern.length();this._pattern.reset();a=this._pattern.nextValue();for(c=!1;f>=a;)f-=
a,a=this._pattern.nextValue(),c=!c;a-=f;c?(this._walker.nextPosition(a),a=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(a),a=this._pattern.nextValue(),this._walker.nextPosition(a),a=this._pattern.nextValue())}(f=this._walker.nextCurve(a))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),C.PathHelper.mergePath(f,this._firstCurve),this._firstCurve=null)):(a=this._pattern.nextValue(),!this._walker.nextPosition(a)||this._walker.isPathEnd()?
(this.iteratePath=!1,this._firstCurve&&(f=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,f=this._firstCurve,this._firstCurve=null);return{paths:[f]}};return b}(F.PathGeometryCursor);u.EffectDashes=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(u,G,F,C){let y=function(){function k(){this._values=[];this._currentValue=
this._length=this.ctrlPtGap=this.extPtGap=0}var b=k.prototype;b.isEmpty=function(){return 0===this._values.length};b.size=function(){return this._values.length};b.init=function(a,f,c=!0){this._setEmpty();if(!a||0===a.length)return!1;for(let h=0;h<a.length;h++){let l=Math.abs(a[h]);c&&1E-7>l&&(l=1E-7);this._values.push(l);this._length+=l}f&&a.length&1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};b.scale=function(a){const f=this._values?
this._values.length:0;for(let c=0;c<f;++c)this._values[c]*=a;this._length*=a;this.extPtGap*=a;this.ctrlPtGap*=a};b.addValue=function(a){this._length+=a;this._values.push(a)};b.firstValue=function(){return this._values[0]};b.lastValue=function(){return this._values[this._values.length-1]};b.nextValue=function(){this._currentValue++;this._currentValue===this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};b.reset=function(){this._currentValue=-1};b.length=function(){return this._length};
b._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return k}(),v=function(){function k(){this.reset()}var b=k.prototype;b.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};b.isValid=function(){return-1!==this.segment};b.copyTo=function(a){a.segment=this.segment;a.segmentLength=this.segmentLength;a.abscissa=this.abscissa;a.isPathEnd=this.isPathEnd;a.isPartEnd=this.isPartEnd};return k}(),
p=function(k){function b(f=0,c=!1){f=k.call(this,f,c)||this;f._tolerance=C.PIXEL_TOLERANCE;f._currentPosition=new v;return f}G._inheritsLoose(b,k);var a=b.prototype;a.updateTolerance=function(f){this._tolerance=C.PIXEL_TOLERANCE*f};a.init=function(f,c,h=!0){h?(this._patternLength=c.length(),this._partExtPtGap=c.extPtGap,this._partCtrlPtGap=c.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=f;this._seg=-1;return this.setPosAtNextPart()};
a.curPositionIsValid=function(){return this._currentPosition.isValid()};a.nextPosition=function(f,c=0){const h=new v;if(!this._nextPosition(f,h,null,c))return!1;h.copyTo(this._currentPosition);return!0};a.curPointAndAngle=function(f){f.pt=this._getPoint(this._currentPosition);const [c,h]=this._getAngle(this._currentPosition);f.ca=c;f.sa=h};a.nextPointAndAngle=function(f,c,h=0){const l=new v;if(!this._nextPosition(f,l,null,h))return!1;l.copyTo(this._currentPosition);c.pt=this._getPoint(l);const [q,
e]=this._getAngle(l);c.ca=q;c.sa=e;return!0};a.nextCurve=function(f){if(0===f)return null;const c=[],h=new v;if(!this._nextPosition(f,h,c,1))return null;h.copyTo(this._currentPosition);return c};a.isPathEnd=function(){return this._currentPosition.isPathEnd};a.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};a._nextPosition=function(f,c,h,l){if(this._currentPosition.isPathEnd)return!1;var q=this._currentPosition.abscissa;
0<this._currentPosition.segmentLength&&(q/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(c);c.abscissa+f*this._partLengthRatio>c.segmentLength+this._tolerance;)if(h&&(0===h.length&&(0===q?(q=this._path[c.segment],h.push([q[0],q[1]])):h.push(this.getSegCoord2D(this._path,c.segment,q))),q=this._path[c.segment+1],h.push([q[0],q[1]])),q=0,f-=(c.segmentLength-c.abscissa)/this._partLengthRatio,this._partSegCount)c.segment=this.nextSegment(),c.segmentLength=this.calculateSegLength(this._path,
c.segment),c.abscissa=0,this._partSegCount--;else{if(!this.setPosAtNextPart()){if(0===l)return!1;c.segmentLength=this.calculateSegLength(this._path,c.segment);c.isPartEnd=!0;1===l?(c.abscissa=c.segmentLength,c.isPathEnd=!0):c.abscissa=c.segmentLength+f;return!0}this._currentPosition.copyTo(c)}c.abscissa+=f*this._partLengthRatio;h&&(0===h.length&&(0===q?(f=this._path[c.segment],h.push([f[0],f[1]])):h.push(this.getSegCoord2D(this._path,c.segment,q))),f=c.abscissa/c.segmentLength,1===f?(f=this._path[c.segment+
1],h.push([f[0],f[1]])):h.push(this.getSegCoord2D(this._path,c.segment,f)));!this._partSegCount&&Math.abs(c.abscissa-c.segmentLength)<this._tolerance&&(c.isPathEnd=this._partIsLast,c.isPartEnd=!0);return!0};a._getPoint=function(f){if(-1===f.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,f.segment,0>=f.segmentLength?0:f.abscissa/f.segmentLength)};a._getAngle=function(f){if(-1===f.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,f.segment,0>=f.segmentLength?
0:f.abscissa/f.segmentLength)};a.setPosAtNextPart=function(){for(;this._partSegCount;)this.hasNextSegment()&&this.nextSegment(),this._partSegCount--;if(!this.hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this.hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this.nextSegment()),this._partSegCount++,1===F.getId(this._path[this.getEndPointIndex()])){this._partIsLast=!this.hasNextSegment();break}for(var f=this._partSegCount;f;)this.previousSegment(),
--f;this._currentPosition.segment=this.nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;f=this.getStartPointIndex();this._ctrlPtBegin=1===F.getId(this._path[f]);f=f+this._partSegCount+1;f>=this._path.length&&(f=0);this._ctrlPtEnd=1===F.getId(this._path[f]);if(0<this._patternLength){f=this._ctrlPtBegin?this._partCtrlPtGap:
this._partExtPtGap;const c=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let h=Math.round((this._partLength-(f+c))/this._patternLength);0>=h&&(h=0<f+c?0:1);this._partLengthRatio=this._partLength/(f+c+h*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};a.hasNextSegment=function(){return this._seg<this._path.length-2};a.previousSegment=function(){return--this._seg};a.nextSegment=function(){return++this._seg};a.getStartPointIndex=
function(){return this._seg};a.getEndPointIndex=function(){return this._seg+1};return b}(C.CurveHelper);u.DashPattern=y;u.GeometryWalker=p;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDonut":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(u,G,F){let C=function(){function v(){}v.local=function(){null===v.instance&&(v.instance=new v);return v.instance};v.prototype.execute=function(p,k,b){return new y(p,k,b)};return v}();
C.instance=null;let y=function(){function v(p,k,b){this._inputGeometries=p;this._curveHelper=new F.CurveHelper;this._width=(void 0!==k.width?k.width:2)*b;switch(k.method){default:this._method="Mitered";break;case "Bevelled":this._method="Bevelled";break;case "Rounded":case "TrueBuffer":this._method="Rounded";break;case "Square":this._method="Square"}this._option=k.option;this._offsetFlattenError=F.PIXEL_TOLERANCE*b}v.prototype.next=function(){for(var p=this._inputGeometries.next();p;){if(G.isExtent(p)&&
0<this._width){if(0>Math.min(p.xmax-p.xmin,p.ymax-p.ymin)-2*this._width)return p;var k=[];k.push([[p.xmin,p.ymin],[p.xmin,p.ymax],[p.xmax,p.ymax],[p.xmax,p.ymin],[p.xmin,p.ymin]]);k.push([[p.xmin+this._width,p.ymin+this._width],[p.xmax-this._width,p.ymin+this._width],[p.xmax-this._width,p.ymax-this._width],[p.xmin+this._width,p.ymax-this._width],[p.xmin+this._width,p.ymin+this._width]]);return{rings:k}}if(G.isPolygon(p)&&0<this._width){k=[];for(const b of p.rings){p=this._curveHelper.calculatePathLength(b);
const a=this._curveHelper.offset(b,this._width,this._method,4,this._offsetFlattenError);a&&(0>p&&a.reverse(),k.push(a))}if(k.length)return{rings:k}}p=this._inputGeometries.next()}return null};return v}();u.EffectDonut=C;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(u,G,F,C){let y=function(){function p(){}p.local=function(){null===p.instance&&
(p.instance=new p);return p.instance};p.prototype.execute=function(k,b,a){return new v(k,b,a)};return p}();y.instance=null;let v=function(p){function k(b,a,f){b=p.call(this,b,!1,!0)||this;b._curveHelper=new C.CurveHelper;b._length=(void 0!==a.length?a.length:20)*f;b._angle=void 0!==a.angle?a.angle:225;b._position=void 0!==a.position?a.position:50;0>b._length&&(b._length=-b._length);20>b._position&&(b._position=20);80<b._position&&(b._position=80);b._mirror=!1;return b}G._inheritsLoose(k,p);k.prototype.processPath=
function(b){if(this._curveHelper.isEmpty(b,!1))return null;const a=b[0];b=b[b.length-1];this._curveHelper.normalize([b[0]-a[0],b[1]-a[1]]);const f=[a[0]+(b[0]-a[0])*this._position/100,a[1]+(b[1]-a[1])*this._position/100],c=Math.cos((90-this._angle)/180*Math.PI);let h=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(h=-h);this._mirror=!this._mirror;return{paths:[[a,[f[0]-this._length/2*c,f[1]-this._length/2*h],[f[0]+this._length/2*c,f[1]+this._length/2*h],b]]}};return k}(F.PathGeometryCursor);
u.EffectJog=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(u,G,F){let C=function(){function v(){}v.local=function(){null===v.instance&&(v.instance=new v);return v.instance};v.prototype.execute=function(p,k,b){return new y(p,k,b)};return v}();C.instance=null;let y=function(){function v(k,b,a){this._inputGeometries=k;this._offsetX=void 0!==b.offsetX?b.offsetX*
a:0;this._offsetY=void 0!==b.offsetY?-b.offsetY*a:0}var p=v.prototype;p.next=function(){for(var k=this._inputGeometries.next();k;){if(F.isExtent(k))return{xmin:k.xmin+this._offsetX,xmax:k.xmax+this._offsetX,ymin:k.ymin+this._offsetY,ymax:k.ymax+this._offsetY};if(F.isPolygon(k))return k=G.clone(k),this._moveMultipath(k.rings,this._offsetX,this._offsetY),k;if(F.isPolyline(k))return k=G.clone(k),this._moveMultipath(k.paths,this._offsetX,this._offsetY),k;if(F.isMultipoint(k))return k=G.clone(k),this._movePath(k.points,
this._offsetX,this._offsetY),k;if(F.isPoint(k))return{x:k.x+this._offsetX,y:k.y+this._offsetY};k=this._inputGeometries.next()}return null};p._moveMultipath=function(k,b,a){if(k)for(const f of k)this._movePath(f,b,a)};p._movePath=function(k,b,a){if(k)for(const f of k)f[0]+=b,f[1]+=a};return v}();u.EffectMove=C;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectOffset":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(u,G,
F){let C=function(){function v(){}v.local=function(){null===v.instance&&(v.instance=new v);return v.instance};v.prototype.execute=function(p,k,b,a){return new y(p,k,b,a)};return v}();C.instance=null;let y=function(){function v(p,k,b,a){var f;this._inputGeometries=p;this._curveHelper=new F.CurveHelper;this._offset=(null!=(f=k.offset)?f:1)*b;a||(this._offset=-this._offset);this._method=k.method;this._option=k.option;this._offsetFlattenError=F.PIXEL_TOLERANCE*b}v.prototype.next=function(){for(var p=
this._inputGeometries.next();p;){if(0===this._offset)return p;if(G.isExtent(p)){if("Rounded"===this._method&&0<this._offset){var k=this._curveHelper.offset([[p.xmin,p.ymin],[p.xmin,p.ymax],[p.xmax,p.ymax],[p.xmax,p.ymin],[p.xmin,p.ymin]],this._offset,this._method,4,this._offsetFlattenError);return k?{rings:[k]}:null}if(0<Math.min(p.xmax-p.xmin,p.ymax-p.ymin)+2*this._offset)return{xmin:p.xmin-this._offset,xmax:p.xmax+this._offset,ymin:p.ymin-this._offset,ymax:p.ymax+this._offset}}if(G.isPolygon(p)){var b=
[];for(k of p.rings){const a=this._curveHelper.offset(k,this._offset,this._method,4,this._offsetFlattenError);a&&b.push(a)}if(b.length)return{rings:b}}if(G.isPolyline(p)){b=[];for(const a of p.paths)(p=this._curveHelper.offset(a,this._offset,this._method,4,this._offsetFlattenError))&&b.push(p);if(b.length)return{paths:b}}p=this._inputGeometries.next()}return null};return v}();u.EffectOffset=C;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports",
"../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(u,G,F,C){let y=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(k,b,a){return new v(k,b,a)};return p}();y.instance=null;let v=function(){function p(k,b,a){this._inputGeometries=k;this._reverse=void 0!==b.reverse?b.reverse:!0}p.prototype.next=function(){for(var k=this._inputGeometries.next();k;){if(!this._reverse)return k;if(F.isPolyline(k))return k=
G.clone(k),C.reverseMultipath(k.paths),k;k=this._inputGeometries.next()}return null};return p}();u.EffectReverse=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(u,G,F,C,y){let v=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};
k.prototype.execute=function(b,a,f){return new p(b,a,f)};return k}();v.instance=null;let p=function(){function k(a,f,c){this._inputGeometries=a;this._rotateAngle=void 0!==f.angle?-f.angle*Math.PI/180:0}var b=k.prototype;b.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._rotateAngle)return a;var f=F.create();C.getBoundsXY(f,a);const c=(f[2]+f[0])/2;f=(f[3]+f[1])/2;if(y.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},
this._rotateMultipath(a.rings,c,f),a;if(y.isPolygon(a))return a=G.clone(a),this._rotateMultipath(a.rings,c,f),a;if(y.isPolyline(a))return a=G.clone(a),this._rotateMultipath(a.paths,c,f),a;if(y.isMultipoint(a))return a=G.clone(a),this._rotatePath(a.points,c,f),a;if(y.isPoint(a))return a;a=this._inputGeometries.next()}return null};b._rotateMultipath=function(a,f,c){if(a)for(const h of a)this._rotatePath(h,f,c)};b._rotatePath=function(a,f,c){if(a){const h=Math.cos(this._rotateAngle),l=Math.sin(this._rotateAngle);
for(const q of a){a=q[0]-f;const e=q[1]-c;q[0]=f+a*h-e*l;q[1]=c+a*l+e*h}}};return k}();u.EffectRotate=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(u,G,F,C,y){let v=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=
function(b,a,f){return new p(b,a,f)};return k}();v.instance=null;let p=function(){function k(a,f,c){this._inputGeometries=a;this._xFactor=void 0!==f.xScaleFactor?f.xScaleFactor:1.15;this._yFactor=void 0!==f.yScaleFactor?f.yScaleFactor:1.15}var b=k.prototype;b.next=function(){for(var a=this._inputGeometries.next();a;){if(1===this._xFactor&&1===this._yFactor)return a;var f=F.create();C.getBoundsXY(f,a);const c=(f[2]+f[0])/2;f=(f[3]+f[1])/2;if(y.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,
a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._scaleMultipath(a.rings,c,f),a;if(y.isPolygon(a))return a=G.clone(a),this._scaleMultipath(a.rings,c,f),a;if(y.isPolyline(a))return a=G.clone(a),this._scaleMultipath(a.paths,c,f),a;if(y.isMultipoint(a))return a=G.clone(a),this._scalePath(a.points,c,f),a;if(y.isPoint(a))return a;a=this._inputGeometries.next()}return null};b._scaleMultipath=function(a,f,c){if(a)for(const h of a)this._scalePath(h,f,c)};b._scalePath=function(a,f,c){if(a)for(const h of a)a=
(h[1]-c)*this._yFactor,h[0]=f+(h[0]-f)*this._xFactor,h[1]=c+a};return k}();u.EffectScale=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../GeometryWalker"],function(u,G,F,C){let y=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(k,b,a){return new v(k,b,a)};return p}();y.instance=null;let v=
function(){function p(b,a,f){this._inputGeometries=b;this._height=(void 0!==a.amplitude?a.amplitude:2)*f;this._period=(void 0!==a.period?a.period:3)*f;this._style=a.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new C.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=new C.GeometryWalker;this._walker.updateTolerance(f)}var k=p.prototype;k.next=function(){for(var b=
this._inputGeometries.next();b;){if(0===this._height||0===this._period)return b;if(G.isPolyline(b)){const a=this._processGeom(b.paths);if(a.length)return{paths:a}}if(G.isPolygon(b)&&(b=this._processGeom(b.rings),b.length))return{rings:b};b=this._inputGeometries.next()}return null};k._processGeom=function(b){const a=[];for(const f of b)if(this._walker.init(f,this._pattern))switch(this._style){default:a.push(this._constructCurve(f,!1));break;case "Square":a.push(this._constructSquare(f));break;case "Triangle":a.push(this._constructTriangle(f));
break;case "Random":a.push(this._constructCurve(f,!0))}else a.push(f);return a};k._constructCurve=function(b,a){const f=new F.PathHelper;var c=this._walker.calculatePathLength(b),h=Math.round(c/this._period);0===h&&(h=1);const l=this._period/16,q=1/(16*h+1);c=2*Math.PI*c/(c/h);h=2*Math.PI*Math.random();const e=2*Math.PI*Math.random(),d=2*Math.PI*Math.random(),g=.75-Math.random()/2,m=.75-Math.random()/2,n={};this._walker.curPointAndAngle(n);f.startPath(n.pt);let r=0;for(;;)if(this._walker.nextPointAndAngle(l,
n)){const t=r;r+=q;let z;if(a){const w=this._height/2*(1+.3*Math.sin(g*c*t+h));z=w*Math.sin(c*t+e);z+=w*Math.sin(m*c*t+d);z/=2}else z=.5*this._height*Math.sin(.5*c*t);f.lineTo([n.pt[0]-z*n.sa,n.pt[1]+z*n.ca])}else{f.lineTo(b[b.length-1]);break}return f.path()};k._constructSquare=function(b){const a=new F.PathHelper;b=this._walker.calculatePathLength(b);Math.round(b/this._period);for(b=!0;;){let f=!1;if(this._walker.curPositionIsValid()){const c={};this._walker.curPointAndAngle(c);const h={};if(this._walker.nextPointAndAngle(this._period,
h)){const l={};this._walker.nextPointAndAngle(this._period,l)&&(b?(a.startPath(c.pt),b=!1):a.lineTo(c.pt),a.lineTo([c.pt[0]-this._height/2*c.sa,c.pt[1]+this._height/2*c.ca]),a.lineTo([h.pt[0]-this._height/2*h.sa,h.pt[1]+this._height/2*h.ca]),a.lineTo([h.pt[0]+this._height/2*h.sa,h.pt[1]-this._height/2*h.ca]),a.lineTo([l.pt[0]+this._height/2*l.sa,l.pt[1]-this._height/2*l.ca]),f=!0)}}if(!f){a.lineTo(this._walker.getPathEnd());break}}return a.path()};k._constructTriangle=function(b){const a=new F.PathHelper;
b=this._walker.calculatePathLength(b);Math.round(b/this._period);for(b=!0;;){let f=!1;if(this._walker.curPositionIsValid()){const c={};this._walker.curPointAndAngle(c);const h={};if(this._walker.nextPointAndAngle(this._period/2,h)){const l={};this._walker.nextPointAndAngle(this._period,l)&&(this._walker.nextPosition(this._period/2)&&(b?(a.startPath(c.pt),b=!1):a.lineTo(c.pt),a.lineTo([h.pt[0]-this._height/2*h.sa,h.pt[1]+this._height/2*h.ca]),a.lineTo([l.pt[0]+this._height/2*l.sa,l.pt[1]-this._height/
2*l.ca])),f=!0)}}if(!f){a.lineTo(this._walker.getPathEnd());break}}return a.path()};return p}();u.EffectWave=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../enums","../GeometryWalker"],function(u,G,F,C,y){let v=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(b,a,f){return new p(b,
a,f)};return k}();v.instance=null;let p=function(k){function b(f,c,h){var l,q,e,d;f=k.call(this,f,!0,!0)||this;f._geometryWalker=new y.GeometryWalker;f._geometryWalker.updateTolerance(h);f._angleToLine=null!=(l=c.angleToLine)?l:!0;f._offset=(null!=(q=c.offset)?q:0)*h;f._originalEndings=c.endings;f._offsetAtEnd=(null!=(e=c.customEndingOffset)?e:0)*h;f._position=-(null!=(d=c.offsetAlongLine)?d:0)*h;f._pattern=new y.DashPattern;f._pattern.init(c.placementTemplate,!1);f._pattern.scale(h);f._endings=f._originalEndings;
return f}G._inheritsLoose(b,k);var a=b.prototype;a.processPath=function(f){if(this._pattern.isEmpty())return null;if(this.iteratePath)var c=this._pattern.nextValue();else{this._endings=this._originalEndings===C.PlacementEndings.WithFullGap&&this.isClosed?C.PlacementEndings.WithMarkers:this._originalEndings;this._pattern.extPtGap=0;let h=!0;switch(this._endings){case C.PlacementEndings.NoConstraint:c=-this._position;c=this._adjustPosition(c);h=!1;break;default:c=-this._pattern.lastValue()/2;break;
case C.PlacementEndings.WithFullGap:c=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case C.PlacementEndings.WithMarkers:c=0;break;case C.PlacementEndings.Custom:c=-this._position,c=this._adjustPosition(c),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(f,this._pattern,h))return null;this._pattern.reset();for(f=0;c>f;)c-=f,f=this._pattern.nextValue();c=f-=c;this.iteratePath=!0}f={};if(!this._geometryWalker.nextPointAndAngle(c,f)||this._endings===
C.PlacementEndings.WithFullGap&&this._geometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===C.PlacementEndings.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(f.pt[0]-this._offset*f.sa,f.pt[1]+this._offset*f.ca);this._angleToLine&&this.internalPlacement.setRotateCS(f.ca,f.sa);return this.internalPlacement};a._adjustPosition=function(f){f/=this._pattern.length();f-=Math.floor(f);return f*this._pattern.length()};
return b}(F.PathTransformationCursor);u.PlacementAlongLineSameSize=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/enums":function(){define(["exports"],function(u){u.PlacementEndings=void 0;var G=u.PlacementEndings||(u.PlacementEndings={});G.NoConstraint="NoConstraint";G.WithMarkers="WithMarkers";G.WithFullGap="WithFullGap";G.WithHalfGap="WithHalfGap";G.Custom="Custom";Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(u,G,F,C){let y=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(k,b,a){return new v(k,b,a)};return p}();y.instance=null;let v=function(p){function k(a,f,c){a=p.call(this,a,!1,!0)||this;a._curveHelper=new C.CurveHelper;a._angleToLine=void 0!==f.angleToLine?f.angleToLine:!0;a._offset=void 0!==f.offset?f.offset*c:0;a._type=f.extremityPlacement;
a._position=void 0!==f.offsetAlongLine?f.offsetAlongLine*c:0;a._beginProcessed=!1;return a}G._inheritsLoose(k,p);var b=k.prototype;b.processPath=function(a){let f;switch(this._type){default:this._beginProcessed?(f=this._atExtremities(a,this._position,!1),this.iteratePath=this._beginProcessed=!1):(f=this._atExtremities(a,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case "JustBegin":f=this._atExtremities(a,this._position,!0);break;case "JustEnd":f=this._atExtremities(a,this._position,
!1);case "None":}return f};b._atExtremities=function(a,f,c){var h=a.length;if(2>h)return null;var l=c?1:h-2;const q=c?h:-1,e=c?1:-1;let d=0;c=c?a[0]:a[h-1];for(h=l;h!==q;h+=e){l=c;c=a[h];const g=this._curveHelper.calculateLength(l,c);if(d+g>f){a=(f-d)/g;const [m,n]=this._curveHelper.getAngleCS(l,c,a);a=F.getCoord2D(l,c,a);this.internalPlacement.setTranslate(a[0]-this._offset*n,a[1]+this._offset*m);this._angleToLine&&this.internalPlacement.setRotateCS(-m,-n);return this.internalPlacement}d+=g}return null};
return k}(F.PathTransformationCursor);u.PlacementAtExtremities=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker"],function(u,G,F,C){let y=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(k,b,a){return new v(k,b,a)};return p}();y.instance=null;let v=function(p){function k(b,
a,f){b=p.call(this,b,!0,!0)||this;b._walker=new C.GeometryWalker;b._walker.updateTolerance(f);b._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;b._offset=void 0!==a.offset?a.offset*f:0;b._beginGap=void 0!==a.beginPosition?a.beginPosition*f:0;b._endGap=void 0!==a.endPosition?a.endPosition*f:0;b._flipFirst=void 0!==a.flipFirst?a.flipFirst:!0;b._pattern=new C.DashPattern;b._pattern.init(a.positionArray,!1,!1);b._subPathLen=0;b._posCount=b._pattern.size();b._isFirst=!0;b._prevPos=0;return b}G._inheritsLoose(k,
p);k.prototype.processPath=function(b){if(this._pattern.isEmpty())return null;if(this.iteratePath){b=this._pattern.nextValue()*this._subPathLen;var a=this._beginGap+b;b=a-this._prevPos;this._prevPos=a}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(b)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(b,this._pattern,!1))return null;this._pattern.reset();b=this._pattern.nextValue()*
this._subPathLen;a=this._beginGap+b;b=a-this._prevPos;this._prevPos=a;this.iteratePath=!0}a={};if(!this._walker.nextPointAndAngle(b,a,1))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]-this._offset*a.sa,a.pt[1]+this._offset*a.ca);b=this._isFirst&&this._flipFirst;let f;this._angleToLine?(f=a.ca,a=a.sa):(f=1,a=0);b&&(f=-f,a=-a);this.internalPlacement.setRotateCS(f,a);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};
return k}(F.PathTransformationCursor);u.PlacementAtRatioPositions=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../CIMPlacements"],function(u,G){let F=function(){function y(){}y.local=function(){null===y.instance&&(y.instance=new y);return y.instance};y.prototype.execute=function(v,p,k){return new C(v,p,k)};return y}();F.instance=null;let C=function(){function y(p,k,b){this._currentY=this._currentX=this._yMax=
this._yMin=this._xMax=this._xMin=0;this._stepX=(void 0!==k.stepX?Math.abs(k.stepX):16)*b;this._stepY=(void 0!==k.stepY?Math.abs(k.stepY):16)*b;if(0!==this._stepX&&0!==this._stepY&&p&&void 0!==p.rings&&p.rings){this._gridType=void 0!==k.gridType?k.gridType:"Fixed";if("Random"===this._gridType)this._randomness=void 0!==k.randomness?k.randomness/100:1,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._offsetY=this._offsetX=this._sinAngle=0;else{this._randomness=0;this._gridAngle=void 0!==
k.gridAngle?k.gridAngle:0;this._shiftOddRows=void 0!==k.shiftOddRows?k.shiftOddRows:!1;this._offsetX=void 0!==k.offsetX?k.offsetX*b:0;this._offsetY=void 0!==k.offsetY?k.offsetY*b:0;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<
-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=new G.Placement;this._calculateMinMax(p);this._geometry=p}}var v=y.prototype;v.next=function(){return this._geometry?this._nextInside():null};v._calculateMinMax=function(p){this._yMax=this._yMin=this._xMax=this._xMin=0;let k,b,a,f,c;b=a=Number.MAX_VALUE;f=c=-Number.MAX_VALUE;for(const l of p.rings){const q=l?l.length:0;
for(let e=0;e<q;++e){var h=l[e][0]-this._graphicOriginX-this._offsetX;k=l[e][1]-this._graphicOriginY-this._offsetY;p=this._cosAngle*h-this._sinAngle*k;h=this._sinAngle*h+this._cosAngle*k;b=Math.min(b,p);f=Math.max(f,p);a=Math.min(a,h);c=Math.max(c,h)}}b+=this._graphicOriginX;f+=this._graphicOriginX;a+=this._graphicOriginY;c+=this._graphicOriginY;this._xMin=Math.round(b/this._stepX);this._xMax=Math.round(f/this._stepX);this._yMin=Math.round(a/this._stepY);this._yMax=Math.round(c/this._stepY);this._currentX=
this._xMax+1;this._currentY=this._yMin-1};v._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var p=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(p+=.5*this._stepX);const k=this._currentY*this._stepY+this._offsetY;this._currentX++;let b;"Random"===this._gridType?(b=this._graphicOriginX+p+this._stepX*this._randomness*
(.5-Math.random())*2/3,p=this._graphicOriginY+k+this._stepY*this._randomness*(.5-Math.random())*2/3):(b=this._graphicOriginX+this._cosAngle*p+this._sinAngle*k,p=this._graphicOriginY-this._sinAngle*p+this._cosAngle*k);this._internalPlacement.setTranslate(b,p);return this._internalPlacement}};return y}();u.PlacementInsidePolygon=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"../CIMCursor","../CurveHelper"],function(u,G,F,C){let y=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(k,b,a){return new v(k,b,a)};return p}();y.instance=null;let v=function(p){function k(a,f,c){a=p.call(this,a,!0,!0)||this;a._curveHelper=new C.CurveHelper;a._angleToLine=void 0!==f.angleToLine?f.angleToLine:!0;a._offset=void 0!==f.offset?f.offset*c:0;a._relativeTo=f.relativeTo;a._position=void 0!==f.startPointOffset?
f.startPointOffset*c:0;a._epsilon=.001*c;return a}G._inheritsLoose(k,p);var b=k.prototype;b.processPath=function(a){var f=this._position;if("SegmentMidpoint"===this._relativeTo){this.iteratePath||(this._segmentCount=a.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var c=this._curSegment;this._curSegment++;f=a[c-1];c=a[c];const h=this._curveHelper.calculateLength(f,c);if(h<this._epsilon)continue;a=.5+this._position/h;const [l,q]=this._curveHelper.getAngleCS(f,
c,a);a=F.getCoord2D(f,c,a);this.internalPlacement.setTranslate(a[0]-this._offset*q,a[1]+this._offset*l);this._angleToLine&&this.internalPlacement.setRotateCS(l,q);return this.internalPlacement}this.iteratePath=!1;return null}"LineEnd"===this._relativeTo&&F.reversePath(a);f=this.onLine(a,f);"LineEnd"===this._relativeTo&&F.reversePath(a);return f};b.onLine=function(a,f){let c,h=!1;switch(this._relativeTo){default:c=this._curveHelper.calculatePathLength(a)/2+f;break;case "LineBeginning":c=f;break;case "LineEnd":c=
f,h=!0}const l=a.length;let q=0,e=a[0];for(let d=1;d<l;++d){f=e;e=a[d];const g=this._curveHelper.calculateLength(f,e);if(q+g>c){a=(c-q)/g;const [m,n]=this._curveHelper.getAngleCS(f,e,a);a=F.getCoord2D(f,e,a);f=h?this._offset:-this._offset;this.internalPlacement.setTranslate(a[0]-f*n,a[1]+f*m);this._angleToLine&&(h?this.internalPlacement.setRotateCS(-m,-n):this.internalPlacement.setRotateCS(m,n));return this.internalPlacement}q+=g}return null};return k}(F.PathTransformationCursor);u.PlacementOnLine=
y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(u,G,F,C){function y(k,b){const a=Math.PI;for(;Math.abs(b-k)>a+2E-15;)b=b-k>a?b-2*a:b+2*a;return(k+b)/2}let v=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(b,a,f){return new p(b,a,f)};return k}();v.instance=
null;let p=function(k){function b(f,c,h){f=k.call(this,f,!0,!0)||this;f._curveHelper=new C.CurveHelper;f._angleToLine=void 0!==c.angleToLine?c.angleToLine:!0;f._offset=void 0!==c.offset?c.offset*h:0;f._endPoints=void 0!==c.placeOnEndPoints?c.placeOnEndPoints:!0;f._controlPoints=void 0!==c.placeOnControlPoints?c.placeOnControlPoints:!0;f._regularVertices=void 0!==c.placeOnRegularVertices?c.placeOnRegularVertices:!0;f._tags=[];f._tagIterator=0;return f}G._inheritsLoose(b,k);var a=b.prototype;a.processPath=
function(f){this.iteratePath||(this._preparePath(f),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;f=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(f[2]);let c=f[0],h=f[1];if(0!==this._offset){const l=Math.cos(f[2]);c-=this._offset*Math.sin(f[2]);h+=this._offset*l}this.internalPlacement.setTranslate(c,h);this._tagIterator++;return this.internalPlacement};a._preparePath=function(f){this._tagIterator=
this._tags.length=0;const c=F.isClosedPath(f),h=f.length-1;let l=0,q=0,e=0,d=0,g=0,m,n;for(;l<h;){l++;m=f[l-1];n=f[l];const r=F.getId(m),t=F.getId(n);if(this._angleToLine||0!==this._offset)d=this._curveHelper.getAngle(m,n,0);1===l?c?(q=d,e=r):(this._endPoints||this._controlPoints&&1===r)&&this._tags.push([m[0],m[1],d]):1===r?this._controlPoints&&this._tags.push([m[0],m[1],y(g,d)]):this._regularVertices&&this._tags.push([m[0],m[1],y(g,d)]);if(this._angleToLine||0!==this._offset)g=this._curveHelper.getAngle(m,
n,1);l===h&&(c?1===t||1===e?this._controlPoints&&this._tags.push([n[0],n[1],y(g,q)]):this._regularVertices&&this._tags.push([n[0],n[1],y(g,q)]):(this._endPoints||this._controlPoints&&1===t)&&this._tags.push([n[0],n[1],g]))}this._tagIterator=0};return b}(F.PathTransformationCursor);u.PlacementOnVertices=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define(["exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils",
"../CIMPlacements"],function(u,G,F,C){let y=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(k,b,a){return new v(k,b,a)};return p}();y.instance=null;let v=function(){function p(b,a,f){this._geometry=b;this._offsetX=void 0!==a.offsetX?a.offsetX*f:0;this._offsetY=void 0!==a.offsetY?a.offsetY*f:0;this._method=void 0!==a.method?a.method:"OnPolygon";this._internalPlacement=new C.Placement}var k=p.prototype;k.next=function(){const b=
this._geometry;this._geometry=null;return b&&void 0!==b.rings?this._polygonCenter(b):null};k._polygonCenter=function(b){switch(this._method){default:case "CenterOfMass":case "BoundingBoxCenter":{const a=G.create();F.getBoundsXY(a,b);this._internalPlacement.setTranslate((a[2]+a[0])/2+this._offsetX,(a[3]+a[1])/2-this._offsetY)}}return this._internalPlacement};return p}();u.PlacementPolygonCenter=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],
function(u){return function(){function G(F=0,C=0,y=0,v=0){this.x=F;this.y=C;this.width=y;this.height=v}G.prototype.union=function(F){this.x=Math.min(this.x,F.x);this.y=Math.min(this.y,F.y);this.width=Math.max(this.width,F.width);this.height=Math.max(this.height,F.height)};u._createClass(G,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return G}()})},"esri/symbols/cim/TextRasterizer":function(){define(["exports","../../core/screenUtils"],function(u,G){let F=function(){function y(){}
var v=y.prototype;v.rasterizeText=function(p,k){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var b=this._textRasterizationCanvas,a=b.getContext("2d");this.setFontProperties(a,k);this.parameters=k;this.textLines=p.split(/\r?\n/);this.lineHeight=this.computeLineHeight();p=this.computeTextWidth(a,k);const {decoration:f,weight:c}=k.font;this.lineThroughWidthOffset=f&&"line-through"===f?.1*this.lineHeight:0;var h=this.lineHeight*this.textLines.length;
b.width=p+2*this.lineThroughWidthOffset;b.height=h;this.renderedLineHeight=Math.round(this.lineHeight*k.pixelRatio);this.renderedHaloSize=k.halo.size*k.pixelRatio;this.renderedWidth=p*k.pixelRatio;this.renderedHeight=h*k.pixelRatio;this.lineThroughWidthOffset*=k.pixelRatio;b=k.color;this.fillStyle=`rgba(${b.slice(0,3).toString()},${b[3]})`;this.haloStyle=`rgb(${k.halo.color.slice(0,3).toString()})`;b=this.renderedLineHeight;p=this.renderedHaloSize;this.setFontProperties(a,k);h=a.textAlign;var l=this.renderedWidth;
h=("center"===h?.5*l:"right"===h?l:0)+p;l=this.lineThroughWidthOffset;let q=0;0<p&&this.renderHalo(a,h,p,l,q,k);q+=p;l+=h;for(var e of this.textLines)a.globalCompositeOperation="destination-out",a.fillStyle="rgb(0, 0, 0)",a.fillText(e,l,q),a.globalCompositeOperation="source-over",a.fillStyle=this.fillStyle,a.fillText(e,l,q),f&&"none"!==f&&this.renderDecoration(a,l,q,f,c),q+=b;e=this.renderedWidth+2*this.lineThroughWidthOffset;b=this.renderedHeight;a=a.getImageData(0,0,e,b);a=new Uint8Array(a.data);
if(k.premultiplyColors)for(p=0;p<a.length;p+=4)k=a[p+3]/255,a[p]*=k,a[p+1]*=k,a[p+2]*=k;return{size:[e,b],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};v.renderHalo=function(p,k,b,a,f,c){const h=this.renderedWidth,l=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=h;this._haloRasterizationCanvas.height=l;const q=this._haloRasterizationCanvas,e=q.getContext("2d");e.clearRect(0,
0,h,l);this.setFontProperties(e,c);const {decoration:d,weight:g}=c.font;e.fillStyle=this.haloStyle;e.strokeStyle=this.haloStyle;c=3>this.renderedHaloSize;e.lineJoin=c?"miter":"round";c?this.renderHaloEmulated(e,k,b,d,g):this.renderHaloNative(e,k,b,d,g);p.globalAlpha=this.parameters.halo.color[3];p.drawImage(q,0,0,h,l,a,f,h,l);p.globalAlpha=1};v.renderHaloEmulated=function(p,k,b,a,f){const c=this.renderedLineHeight,h=this.renderedHaloSize;for(const l of this.textLines){for(const [q,e]of C)p.fillText(l,
k+h*q,b+h*e);a&&"none"!==a&&this.renderDecoration(p,k,b,a,f);b+=c}};v.renderHaloNative=function(p,k,b,a,f){const c=this.renderedLineHeight,h=this.renderedHaloSize;for(const l of this.textLines){const q=2*h;for(let e=0;5>e;e++)p.lineWidth=(.6+.1*e)*q,p.strokeText(l,k,b),a&&"none"!==a&&this.renderDecoration(p,k,b,a,f);b+=c}};v.setFontProperties=function(p,k){var b=k.font;b=`${b.style} ${b.weight} ${G.pt2px(k.size*k.pixelRatio)}px ${b.family}, sans-serif`;p.font=b;p.textBaseline="top";switch(k.horizontalAlignment){case "left":k=
"left";break;case "right":k="right";break;case "center":k="center";break;default:k="left"}p.textAlign=k};v.computeTextSize=function(p,k){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const b=this._textRasterizationCanvas;var a=b.getContext("2d");this.setFontProperties(a,k);this.parameters=k;this.textLines=p.split(/\r?\n/);this.lineHeight=this.computeLineHeight();p=this.computeTextWidth(a,k);a=this.lineHeight*this.textLines.length;b.width=p;b.height=
a;return[p*k.pixelRatio,a*k.pixelRatio]};v.computeTextWidth=function(p,k){let b=0;for(const a of this.textLines)b=Math.max(b,p.measureText(a).width);k=k.font;if("italic"===k.style||"oblique"===k.style||"string"===typeof k.weight&&("bold"===k.weight||"bolder"===k.weight)||"number"===typeof k.weight&&600<k.weight)b+=.3*p.measureText("w").width;b+=2*this.parameters.halo.size;return Math.round(b)};v.computeLineHeight=function(){let p=1.275*this.parameters.size;const k=this.parameters.font.decoration;
k&&"underline"===k&&(p*=1.3);return Math.round(p+2*this.parameters.halo.size)};v.renderDecoration=function(p,k,b,a,f){const c=.9*this.lineHeight;f="bold"===f?.06:"bolder"===f?.09:.04;switch(p.textAlign){case "center":k-=this.renderedWidth/2;break;case "right":k-=this.renderedWidth}const h=p.textBaseline;if("underline"===a)switch(h){case "top":b+=c;break;case "middle":b+=c/2}else if("line-through"===a)switch(h){case "top":b+=c/1.5;break;case "middle":b+=c/3}p.save();p.beginPath();p.strokeStyle=p.fillStyle;
p.lineWidth=Math.ceil(c*f);p.moveTo(k-this.lineThroughWidthOffset,b);p.lineTo(k+this.renderedWidth+2*this.lineThroughWidthOffset,b);p.stroke();p.restore()};return y}();const C=[];for(let y=0;360>y;y+=22.5)C.push([Math.cos(Math.PI*y/180),Math.sin(Math.PI*y/180)]);u.TextRasterizer=F;u.default=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(u){u.HAlign=void 0;(function(G){G[G.Left=-1]="Left";G[G.Center=0]="Center";
G[G.Right=1]="Right"})(u.HAlign||(u.HAlign={}));u.VAlign=void 0;(function(G){G[G.Top=1]="Top";G[G.Center=0]="Center";G[G.Bottom=-1]="Bottom";G[G.Baseline=2]="Baseline"})(u.VAlign||(u.VAlign={}));u.getAlignmentFromPlacement=function(G){switch(G){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[u.HAlign.Right,u.VAlign.Bottom];case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[u.HAlign.Center,u.VAlign.Bottom];
case "above-right":case "esriServerPointLabelPlacementAboveRight":return[u.HAlign.Left,u.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[u.HAlign.Right,u.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[u.HAlign.Center,u.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[u.HAlign.Left,u.VAlign.Center];case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[u.HAlign.Right,
u.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[u.HAlign.Center,u.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[u.HAlign.Left,u.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[u.HAlign.Center,u.VAlign.Center];default:return console.debug(`Found invalid placement type ${G}`),[u.HAlign.Center,u.VAlign.Center]}};u.getJustification=
function(G){switch(G){case "left":return u.HAlign.Left;case "right":return u.HAlign.Right;case "center":case "justify":return u.HAlign.Center}};u.getXAnchorDirection=function(G){switch(G){case "left":return u.HAlign.Left;case "right":return u.HAlign.Right;case "center":case "justify":return u.HAlign.Center}};u.getXDirection=function(G){switch(G){case u.HAlign.Right:return-1;case u.HAlign.Center:return 0;case u.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${G}`),
0}};u.getYAnchorDirection=function(G){switch(G){case "top":return u.VAlign.Top;case "middle":return u.VAlign.Center;case "baseline":return u.VAlign.Baseline;case "bottom":return u.VAlign.Bottom}};u.getYDirection=function(G){switch(G){case u.VAlign.Top:return 1;case u.VAlign.Center:return 0;case u.VAlign.Bottom:case u.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${G}`),0}};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),
function(u,G,F,C,y,v,p,k,b,a){const f=Math.PI/180;let c=function(){function e(g,m,n,r){this._rotationT=C.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const t=n.rect,z=new Float32Array(8);g*=r;m*=r;const w=n.code?t.width*r:n.metrics.width,B=n.code?t.height*r:n.metrics.height;z[0]=g;z[1]=m;z[2]=g+w;z[3]=m;z[4]=g;z[5]=m+B;z[6]=g+w;z[7]=m+B;this._data=z;this._setTextureCoords(t);this._scale=r;this._mosaic=n;this.x=g;this.y=m;this.maxOffset=Math.max(g+w,m+B)}var d=
e.prototype;d.setTransform=function(g){this._T=g;this._offsets=null};d._setOffsets=function(g){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const m=this._offsets,n=new Float32Array(8),r=F.multiply(C.create(),this._rotationT,this._T);C.transformMany(n,g,r);m.upperLeft=k.i1616to32(8*n[0],8*n[1]);m.upperRight=k.i1616to32(8*n[2],8*n[3]);m.lowerLeft=k.i1616to32(8*n[4],8*n[5]);m.lowerRight=k.i1616to32(8*n[6],8*n[7])};d._setTextureCoords=function({x:g,y:m,width:n,height:r}){this._texcoords=
{upperLeft:k.i1616to32(g,m),upperRight:k.i1616to32(g+n,m),lowerLeft:k.i1616to32(g,m+r),lowerRight:k.i1616to32(g+n,m+r)}};G._createClass(e,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(g){this._angle=g;F.identity(this._rotationT);F.rotate(this._rotationT,this._rotationT,-g);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},
{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},
{key:"bounds",get:function(){if(!this._bounds){const {height:t,width:z}=this._mosaic.metrics;var g=z*this._scale,m=Math.abs(t)*this._scale,n=new Float32Array(8);n[0]=this.x;n[1]=this.y;n[2]=this.x+g;n[3]=this.y;n[4]=this.x;n[5]=this.y+m;n[6]=this.x+g;n[7]=this.y+m;g=F.multiply(C.create(),this._rotationT,this._T);C.transformMany(n,n,g);m=g=Infinity;let w=0;var r=0;for(let B=0;4>B;B++){const A=n[2*B],x=n[2*B+1];g=Math.min(g,A);m=Math.min(m,x);w=Math.max(w,A);r=Math.max(r,x)}n=w-g;r-=m;this._bounds=
new a(g+n/2,m+r/2,n,r)}return this._bounds}}]);return e}();const h=(e,d)=>({code:0,page:0,sdf:!0,rect:new b(0,0,11,8),textureBinding:d,metrics:{advance:0,height:4,width:e,left:0,top:0}});let l=function(){function e(g,m,n){this._rotation=0;this._decorate(g,m,n);this.glyphs=g;this.bounds=this._createBounds(g);this.isMultiline=1<m.length;this._hasRotation=0!==n.angle;this._T=this._createGlyphTransform(this.bounds,n);for(const r of g)r.setTransform(this._T)}var d=e.prototype;d.setRotation=function(g){if(0!==
g||0!==this._rotation){this._rotation=g;var m=this._T;g=F.fromRotation(C.create(),g);F.multiply(m,g,m);for(const n of this.glyphs)n.setTransform(this._T)}};d._decorate=function(g,m,n){if(n.decoration&&"none"!==n.decoration&&g.length){var r=n.scale;n="underline"===n.decoration?30:20;var t=g[0].textureBinding;for(const z of m)g.push(new c(z.startX*r,z.startY*r+n*r,h((z.width+z.glyphWidthEnd)*r,t),1))}};d._createBounds=function(g){let m=Infinity,n=Infinity,r=0;var t=0;for(const z of g)m=Math.min(m,z.xTopLeft),
n=Math.min(n,z.yTopLeft),r=Math.max(r,z.xTopLeft+z.width),t=Math.max(t,z.yBottomRight);g=r-m;t-=n;return new a(m+g/2,n+t/2,g,t)};d._createGlyphTransform=function(g,m){const n=f*m.angle,r=C.create(),t=v.create();F.translate(r,r,y.set(t,m.xOffset,-m.yOffset));m.isCIM?F.rotate(r,r,n):(F.translate(r,r,y.set(t,g.x,g.y)),F.rotate(r,r,n),F.translate(r,r,y.set(t,-g.x,-g.y)));return r};G._createClass(e,[{key:"boundsT",get:function(){var g=this.bounds;const m=y.set(v.create(),g.x,g.y);y.transformMat2d(m,m,
this._T);return this._hasRotation?(g=Math.max(g.width,g.height),new a(m[0],m[1],g,g)):new a(m[0],m[1],g.width,g.height)}}]);return e}(),q=function(e,d,g,m,n,r){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(d,g));this.end=Math.max(0,Math.max(d,g));this.end<e.length&&(this.glyphWidthEnd=e[this.end].metrics.width);this.width=m;this.yMin=n;this.yMax=r};u.ShapedGlyph=c;u.ShapingInfo=l;u.shapeGlyphs=function(e,d,g){const m=g.scale,n=[];{var r=[];var t=1/g.scale*g.maxLineWidth;
var z=d?e.length-1:0;var w=d?-1:e.length;d=d?-1:1;var B=z,A=0,x=0;let H=B,I=H,J=0,M=Infinity,O=0;for(;B!==w;){const {code:L,metrics:S}=e[B];var E=Math.abs(S.top);10!==L&&32!==L&&(M=Math.min(M,E),O=Math.max(O,E+S.height));10===L?(B!==z&&(r.push(new q(e,H,B-d,A,M,O)),M=Infinity,O=0),A=0,H=B+d,I=B+d,x=0):32===L?(I=B+d,x=0,J=S.advance,A+=S.advance):(A>t&&(I!==H?(E=I-2*d,A-=J,r.push(new q(e,H,E,A-x,M,O)),M=Infinity,O=0,H=I,A=x):(r.push(new q(e,H,B-d,A,M,O)),M=Infinity,O=0,I=H=B,A=0)),A+=S.advance,x+=S.advance);
B+=d}t=new q(e,H,B-d,A,M,O);0<=t.start&&t.end<e.length&&r.push(t)}for(t=0;t<r.length;t++);t=z=r[0].yMin;z=r[r.length-1].yMax+g.lineHeight*(r.length-1)+("underline"===g.decoration?4:0)-z;const {vAlign:D,hAlign:K}=g;w=D===p.VAlign.Baseline?1:0;t=(1-w)*-t+z/2*(w?0:D-1)+-26*(w?1:0);for(z=0;z<r.length;z++){const {start:H,end:I,width:J}=r[z];w=J/2*(K+1)*-1-3;d=z*g.lineHeight+t-3;r[z].startX=w;r[z].startY=d;for(B=H;B<=I;B++)A=e[B],10!==A.code&&(x=new c(w+A.metrics.left,d-A.metrics.top,A,m),w+=A.metrics.advance,
n.push(x))}return new l(n,r,g)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/Rect":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(u){return function(){function G(F=0,C=0,y=0,v=0){this.x=F;this.y=C;this.width=y;this.height=v}G.prototype.union=function(F){this.x=Math.min(this.x,F.x);this.y=Math.min(this.y,F.y);this.width=Math.max(this.width,F.width);this.height=Math.max(this.height,F.height)};u._createClass(G,[{key:"isEmpty",get:function(){return 0>=
this.width||0>=this.height}}]);return G}()})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec2f32"],function(u,G){return function(){function F(y,v,p,k){this.center=G.fromValues(y,v);this.centerT=G.create();this.halfWidth=p/2;this.halfHeight=k/2;this.width=p;this.height=k}var C=F.prototype;C.clone=function(){return new F(this.x,this.y,this.width,this.height)};C.serialize=function(y){y.writeF32(this.center[0]);
y.writeF32(this.center[1]);y.push(this.width);y.push(this.height);return y};C.findCollisionDelta=function(y,v=4){return Math.log2(Math.min((y.halfWidth+this.halfWidth+v)/Math.abs(y.centerT[0]-this.centerT[0]),(y.halfHeight+this.halfHeight+v)/Math.abs(y.centerT[1]-this.centerT[1])))};C.extend=function(y){const v=Math.min(this.xmin,y.xmin),p=Math.min(this.ymin,y.ymin),k=Math.max(this.xmax,y.xmax)-v;y=Math.max(this.ymax,y.ymax)-p;this.width=k;this.height=y;this.halfWidth=k/2;this.halfHeight=y/2;this.x=
v+k/2;this.y=p+y/2};F.deserialize=function(y){const v=y.readF32(),p=y.readF32(),k=y.readInt32();y=y.readInt32();return new F(v,p,k,y)};u._createClass(F,[{key:"x",get:function(){return this.center[0]},set:function(y){this.center[0]=y}},{key:"y",get:function(){return this.center[1]},set:function(y){this.center[1]=y}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},
{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return F}()})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["exports"],function(u){function G(k,b){k%=b;return 0<=k?k:k+b}const F=Number.POSITIVE_INFINITY,C=Math.PI,y=128/C,v=256/
360,p=1/Math.LN2;u.C_256_TO_RAD=C/128;u.C_2PI=2*C;u.C_DEG_TO_256=v;u.C_DEG_TO_RAD=C/180;u.C_INFINITY=F;u.C_PI=C;u.C_PI_BY_2=C/2;u.C_RAD_TO_256=y;u.C_SQRT2=1.414213562;u.C_SQRT2_INV=1/1.414213562;u.between=function(k,b,a){return k>=b&&k<=a||k>=a&&k<=b};u.degToByte=function(k){return G(k*v,256)};u.interpolate=function(k,b,a){return k*(1-a)+b*a};u.log2=function(k){return Math.log(k)*p};u.positiveMod=G;u.radToByte=function(k){return G(k*y,256)};u.sqr=function(k){return k*k};Object.defineProperty(u,"__esModule",
{value:!0})})},"esri/symbols/cim/SDFHelper":function(){define(["exports","../../core/floatRGBA","../../geometry/support/jsonUtils","./Rect"],function(u,G,F,C){function y(p){if(!p)return null;switch(p.type){case "CIMPointSymbol":var k=p.symbolLayers;if(!k||1!==k.length)break;return y(k[0]);case "CIMVectorMarker":p=p.markerGraphics;if(!p||1!==p.length)break;var b=p[0];if(!b)break;p=b.geometry;if(!p)break;b=b.symbol;if(!b||"CIMPolygonSymbol"!==b.type&&"CIMLineSymbol"!==b.type||null!=(k=b.symbolLayers)&&
k.some(a=>!!a.effects))break;return{geom:p,asFill:"CIMPolygonSymbol"===b.type};case "sdf":return{geom:p.geom,asFill:p.asFill}}return null}function v(p){let k=Infinity,b=-Infinity,a=Infinity,f=-Infinity;for(const c of p)for(const h of c)h[0]<k&&(k=h[0]),h[0]>b&&(b=h[0]),h[1]<a&&(a=h[1]),h[1]>f&&(f=h[1]);return[k,a,b,f]}u.buildSDF=function(p){var k=p.geom;var b=k?k.rings?k.rings:k.paths?k.paths:void 0!==k.xmin&&void 0!==k.ymin&&void 0!==k.xmax&&void 0!==k.ymax?[[[k.xmin,k.ymin],[k.xmin,k.ymax],[k.xmax,
k.ymax],[k.xmax,k.ymin],[k.xmin,k.ymin]]]:null:null;k=Infinity;var a=-Infinity;var f=Infinity,c=-Infinity;for(var h of b)for(var l of h)l[0]<k&&(k=l[0]),l[0]>a&&(a=l[0]),l[1]<f&&(f=l[1]),l[1]>c&&(c=l[1]);a=new C(k,f,a-k,c-f);f=64/Math.max(a.width,a.height);h=Math.round(a.width*f)+62;l=Math.round(a.height*f)+62;k=[];for(var q of b)if(q&&1<q.length){b=[];for(var e of q){let [A,x]=e;A-=a.x;x-=a.y;A*=f;x*=f;A+=30.5;x+=30.5;p.asFill?b.push([A,x]):b.push([Math.round(A),Math.round(x)])}p.asFill&&(c=b.length-
1,b[0][0]===b[c][0]&&b[0][1]===b[c][1]||b.push(b[0]));k.push(b)}var d;q=h*l;e=Array(q);for(b=0;b<q;++b)e[b]=962;for(d of k)for(b=d.length,a=1;a<b;++a){f=d[a-1];c=d[a];var g=void 0,m=void 0;f[0]<c[0]?(g=f[0],m=c[0]):(g=c[0],m=f[0]);var n=void 0,r=void 0;f[1]<c[1]?(n=f[1],r=c[1]):(n=c[1],r=f[1]);var t=Math.floor(g)-31;m=Math.floor(m)+31;n=Math.floor(n)-31;r=Math.floor(r)+31;0>t&&(t=0);m>h&&(m=h);0>n&&(n=0);r>l&&(r=l);g=c[0]-f[0];const A=c[1]-f[1],x=g*g+A*A;for(;t<m;t++)for(let E=n;E<r;E++){var z=(t-
f[0])*g+(E-f[1])*A,w=void 0;0>z?(w=f[0],z=f[1]):z>x?(w=c[0],z=c[1]):(z/=x,w=f[0]+z*g,z=f[1]+z*A);w=(t-w)*(t-w)+(E-z)*(E-z);z=(l-E-1)*h+t;w<e[z]&&(e[z]=w)}}for(d=0;d<q;++d)e[d]=Math.sqrt(e[d]);d=e;if(p.asFill)for(var B of k)for(p=B.length,k=1;k<p;++k)for(q=B[k-1],e=B[k],q[0]<e[0]?(b=q[0],a=e[0]):(b=e[0],a=q[0]),q[1]<e[1]?(c=q[1],f=e[1]):(c=e[1],f=q[1]),b=Math.floor(b),a=Math.floor(a)+1,c=Math.floor(c),f=Math.floor(f)+1,31>b&&(b=31),a>h-31&&(a=h-31),31>c&&(c=31),f>l-31&&(f=l-31);c<f;++c)if(q[1]>c!==
e[1]>c){m=(l-c-1)*h;for(n=b;n<a;++n)n<(e[0]-q[0])*(c-q[1])/(e[1]-q[1])+q[0]&&(d[m+n]=-d[m+n]);for(n=31;n<b;++n)d[m+n]=-d[m+n]}B=d.length;p=new Uint8Array(4*B);for(k=0;k<B;++k)G.packFloatRGBA(.5-d[k]/62,p,4*k);B=p;return[B,h,l]};u.getExtent=function(p){return p?p.rings?v(p.rings):p.paths?v(p.paths):F.isExtent(p)?[p.xmin,p.ymin,p.xmax,p.ymax]:null:null};u.getSDFInfo=y;u.getSDFMetrics=function(p,k,b,a,f){const [c,h,l,q]=p;if(l<c||q<h)return[0,0,0];var e=l-c,d=q-h;p=64/Math.max(e,d);e=Math.round(e*p);
d=Math.round(d*p)+62;let g=1;k&&(g=d/p/(k.ymax-k.ymin));let m=0,n=0;a&&(f?k&&b&&0<k.ymax-k.ymin&&(m=a.x/((k.xmax-k.xmin)/(k.ymax-k.ymin)*b),n=a.y/b):(m=a.x,n=a.y));m=.5*(k.xmax+k.xmin)+m*(k.xmax-k.xmin);n=.5*(k.ymax+k.ymin)+n*(k.ymax-k.ymin);m=(m-c)*p+31;n=(n-h)*p+31;return[g,m/(e+62)-.5,-(n/d-.5)]};u.getSDFSymbol=function(p){p=p.markerGraphics;if(!p||1!==p.length)return null;p=p[0];if(!p)return null;p=p.symbol;return!p||"CIMPolygonSymbol"!==p.type&&"CIMLineSymbol"!==p.type?null:p};Object.defineProperty(u,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["exports"],function(u){function G(F){F=F.toLowerCase().split(" ").join("-");switch(F){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return F}}u.getFontDecorationTop=function(F){switch(F){case "underline":return-26;case "line-through":return-18}return NaN};u.getFullyQualifiedFontName=
function(F){a:{if(F.weight)switch(F.weight.toLowerCase()){case "bold":case "bolder":var C="-bold";break a}C=""}a:{if(F.style)switch(F.style.toLowerCase()){case "italic":case "oblique":var y="-italic";break a}y=""}C+=y;return G(F.family)+(0<C.length?C:"-regular")};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/promiseUtils ./Rect ./RectangleBinPack ../../../webgl/Texture".split(" "),
function(u,G,F,C,y,v){function p(b){const a=new Set;for(const f of b)a.add(Math.floor(f/256));return a}function k(b,a,f){b.has(a)||b.set(a,f().then(()=>{b.delete(a)}).catch(c=>{b.delete(a);F.throwIfNotAbortError(c)}));return b.get(a)}return function(){function b(f,c,h){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=f;this.height=c;this._glyphSource=h;this._binPack=new y(f-4,c-4);this._glyphData.push(new Uint8Array(f*
c));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}var a=b.prototype;a.dispose=function(){this._binPack=null;for(const f of this._textures)f&&f.dispose();this._textures.length=0;this._glyphData.length=0};a._initDecorationGlyph=function(){var f=[117,149,181,207,207,181,149,117];const c=[];for(let h=0;h<f.length;h++){const l=f[h];for(let q=0;11>q;q++)c.push(l)}f={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(c)};this._recordGlyph(f)};a.getGlyphItems=
function(){var f=u._asyncToGenerator(function*(c,h,l){const q=this._getGlyphCache(c);yield this._fetchRanges(c,h,l);return h.map(e=>this._getMosaicItem(q,c,e))});return function(c,h,l){return f.apply(this,arguments)}}();a.bind=function(f,c,h,l){const q=this._getTexture(f,h);q.setSamplingMode(c);this._dirties[h]&&(q.setData(this._glyphData[h]),this._dirties[h]=!1);f.bindTexture(q,l)};a._getGlyphCache=function(f){this._glyphCache[f]||(this._glyphCache[f]={});return this._glyphCache[f]};a._getTexture=
function(f,c){this._textures[c]||(this._textures[c]=new v(f,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[c]};a._invalidate=function(){this._dirties[this._currentPage]=!0};a._fetchRanges=function(){var f=u._asyncToGenerator(function*(c,h,l){const q=[];p(h).forEach(e=>{q.push(this._fetchRange(c,e,l))});yield Promise.all(q)});return function(c,h,l){return f.apply(this,arguments)}}();a._fetchRange=function(){var f=
u._asyncToGenerator(function*(c,h,l){return 256<h?null:k(this._rangePromises,c+h,()=>this._glyphSource.getRange(c,h,l))});return function(c,h,l){return f.apply(this,arguments)}}();a._getMosaicItem=function(f,c,h){if(!f[h]){c=this._glyphSource.getGlyph(c,h);if(!c||!c.metrics)return{rect:new C(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:h,sdf:!0};const l=this._recordGlyph(c);f[h]={rect:l,page:this._currentPage,metrics:c.metrics,code:h,sdf:!0};this._invalidate()}return f[h]};
a._recordGlyph=function(f){var c=f.metrics;if(0===c.width)c=new C(0,0,0,0);else{const h=c.width+6,l=c.height+6;c=this._binPack.allocate(h,l);c.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new y(this.width-4,this.height-4),c=this._binPack.allocate(h,l));const q=this._glyphData[this._currentPage];
f=f.bitmap;let e,d;if(f)for(let g=0;g<l;g++){e=h*g;d=this.width*(c.y+g)+c.x;for(let m=0;m<h;m++)q[d+m]=f[e+m]}G("esri-glyph-debug")&&this._showDebugPage(q)}return c};a._showDebugPage=function(f){const c=document.createElement("canvas"),h=c.getContext("2d"),l=new ImageData(this.width,this.height),q=l.data;c.width=this.width;c.height=this.height;c.style.border="1px solid black";for(let e=0;e<f.length;++e)q[4*e]=f[e],q[4*e+1]=0,q[4*e+2]=0,q[4*e+3]=255;h.putImageData(l,0,0);document.body.appendChild(c)};
return b}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./Rect"],function(u,G){return function(){function F(y,v){this._height=this._width=0;this._free=[];this._width=y;this._height=v;this._free.push(new G(0,0,y,v))}var C=F.prototype;C.allocate=function(y,v){if(y>this._width||v>this._height)return new G;let p=null,k=-1;for(let b=0;b<this._free.length;++b){const a=this._free[b];y<=a.width&&v<=a.height&&(null===p||a.y<=p.y&&a.x<=
p.x)&&(p=a,k=b)}if(null===p)return new G;this._free.splice(k,1);p.width<p.height?(p.width>y&&this._free.push(new G(p.x+y,p.y,p.width-y,v)),p.height>v&&this._free.push(new G(p.x,p.y+v,p.width,p.height-v))):(p.width>y&&this._free.push(new G(p.x+y,p.y,p.width-y,p.height)),p.height>v&&this._free.push(new G(p.x,p.y+v,y,p.height-v)));return new G(p.x,p.y,y,v)};C.release=function(y){for(let v=0;v<this._free.length;++v){const p=this._free[v];if(p.y===y.y&&p.height===y.height&&p.x+p.width===y.x)p.width+=y.width;
else if(p.x===y.x&&p.width===y.width&&p.y+p.height===y.y)p.height+=y.height;else if(y.y===p.y&&y.height===p.height&&y.x+y.width===p.x)p.x=y.x,p.width+=y.width;else if(y.x===p.x&&y.width===p.width&&y.y+y.height===p.y)p.y=y.y,p.height+=y.height;else continue;this._free.splice(v,1);this.release(y)}this._free.push(y)};u._createClass(F,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);return F}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define(["../../../../request",
"../../../../core/pbf"],function(u,G){let F=function(){function y(p){this._metrics=[];for(this._bitmaps=[];p.next();)switch(p.tag()){case 1:{const k=p.getMessage();for(;k.next();)switch(k.tag()){case 3:{const b=k.getMessage();let a,f,c,h,l,q,e;for(;b.next();)switch(b.tag()){case 1:a=b.getUInt32();break;case 2:f=b.getBytes();break;case 3:c=b.getUInt32();break;case 4:h=b.getUInt32();break;case 5:l=b.getSInt32();break;case 6:q=b.getSInt32();break;case 7:e=b.getUInt32();break;default:b.skip()}b.release();
a&&(this._metrics[a]={width:c,height:h,left:l,top:q,advance:e},this._bitmaps[a]=f);break}default:k.skip()}k.release();break}default:p.skip()}}var v=y.prototype;v.getMetrics=function(p){return this._metrics[p]};v.getBitmap=function(p){return this._bitmaps[p]};return y}(),C=function(){function y(){this._ranges=[]}var v=y.prototype;v.getRange=function(p){return this._ranges[p]};v.addRange=function(p,k){this._ranges[p]=k};return y}();return function(){function y(p){this._glyphInfo={};this._baseURL=p}
var v=y.prototype;v.getRange=function(p,k,b){const a=this._getFontStack(p);if(a.getRange(k))return Promise.resolve();const f=256*k,c=f+255;p=this._baseURL.replace("{fontstack}",p).replace("{range}",f+"-"+c);return u(p,{responseType:"array-buffer",...b}).then(h=>{a.addRange(k,new F(new G(new Uint8Array(h.data),new DataView(h.data))))})};v.getGlyph=function(p,k){if(p=this._getFontStack(p)){var b=Math.floor(k/256);if(!(256<b)&&(p=p.getRange(b)))return{metrics:p.getMetrics(k),bitmap:p.getBitmap(k)}}};
v._getFontStack=function(p){let k=this._glyphInfo[p];k||(k=this._glyphInfo[p]=new C);return k};return y}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["../../../../core/floatRGBA","../../../../core/promiseUtils"],function(u,G){return function(){function F(y){this.size=y;const v=document.createElement("canvas");v.width=v.height=y;this._context=v.getContext("2d");this._gridOuter=new Float64Array(y*y);this._gridInner=new Float64Array(y*y);this._f=new Float64Array(y);this._d=new Float64Array(y);
this._z=new Float64Array(y+1);this._v=new Int16Array(y)}var C=F.prototype;C.dispose=function(){this._context=this._gridOuter=this._gridInner=this._f=this._d=this._z=this._v=null;this._svg&&(document.body.removeChild(this._svg),this._svg=null)};C.draw=function(y,v,p=31){this._initSVG();const k=this.createSVGString(y);return new Promise((b,a)=>{const f=new Image;f.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(k);f.onload=()=>{f.onload=null;this._context.clearRect(0,0,this.size,this.size);
this._context.drawImage(f,0,0,this.size,this.size);var h=this._context.getImageData(0,0,this.size,this.size);const l=new Uint8Array(this.size*this.size*4);for(let q=0;q<this.size*this.size;q++){const e=h.data[4*q+3]/255;this._gridOuter[q]=1===e?0:0===e?1E20:Math.max(0,.5-e)**2;this._gridInner[q]=1===e?1E20:0===e?0:Math.max(0,e-.5)**2}this._edt(this._gridOuter,this.size,this.size);this._edt(this._gridInner,this.size,this.size);for(h=0;h<this.size*this.size;h++)u.packFloatRGBA(.5-(this._gridOuter[h]-
this._gridInner[h])/(2*p),l,4*h);b(l)};const c=v&&v.signal;if(c)G.onAbort(c,()=>a(G.createAbortError()))})};C._initSVG=function(){if(!this._svg){const y=document.createElementNS("http://www.w3.org/2000/svg","svg");y.setAttribute("style","position: absolute;");y.setAttribute("width","0");y.setAttribute("height","0");y.setAttribute("aria-hidden","true");y.setAttribute("role","presentation");document.body.appendChild(y);this._svg=y}};C.createSVGString=function(y){this._initSVG();const v=document.createElementNS("http://www.w3.org/2000/svg",
"path");v.setAttribute("d",y);this._svg.appendChild(v);y=v.getBBox();var p=y.width/y.height;const k=this.size/2;let b,a,f;1<p?(a=b=k/y.width,f=this.size/4,p=k-1/p*k/2):(b=a=k/y.height,f=k-k*p/2,p=this.size/4);v.setAttribute("style",`transform: matrix(${b}, 0, 0, ${a}, ${-y.x*b+f}, ${-y.y*a+p})`);y=`<svg style="fill:red;" height="${this.size}" width="${this.size}" xmlns="http://www.w3.org/2000/svg">${this._svg.innerHTML}</svg>`;this._svg.removeChild(v);return y};C._edt=function(y,v,p){const k=this._f,
b=this._d,a=this._v,f=this._z;for(var c=0;c<v;c++){for(var h=0;h<p;h++)k[h]=y[h*v+c];this._edt1d(k,b,a,f,p);for(h=0;h<p;h++)y[h*v+c]=b[h]}for(c=0;c<p;c++){for(h=0;h<v;h++)k[h]=y[c*v+h];this._edt1d(k,b,a,f,v);for(h=0;h<v;h++)y[c*v+h]=Math.sqrt(b[h])}};C._edt1d=function(y,v,p,k,b){p[0]=0;k[0]=-1E20;k[1]=1E20;for(let a=1,f=0;a<b;a++){let c=(y[a]+a*a-(y[p[f]]+p[f]*p[f]))/(2*a-2*p[f]);for(;c<=k[f];)f--,c=(y[a]+a*a-(y[p[f]]+p[f]*p[f]))/(2*a-2*p[f]);f++;p[f]=a;k[f]=c;k[f+1]=1E20}for(let a=0,f=0;a<b;a++){for(;k[f+
1]<a;)f++;v[a]=(a-p[f])*(a-p[f])+y[p[f]]}};return F}()})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/maybe ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/Texture ../../../webgl/VertexArrayObject ./definitions ./GeometryUtils ./Rect ./RectangleBinPack".split(" "),function(u,
G,F,C,y,v,p,k,b,a,f,c,h,l,q){function e(d){return d&&"static"===d.type}return function(){function d(m,n,r,t=0){this._mosaicPages=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=n||0>=r)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=n;this._pageHeight=r;this._requestRender=m;0<t&&(this._maxItemSize=t);this.pixelRatio=window.devicePixelRatio||
1;this._binPack=new q(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}var g=d.prototype;g.getWidth=function(m){return m>=this._mosaicPages.length?-1:this._mosaicPages[m].size[0]};g.getHeight=function(m){return m>=this._mosaicPages.length?-1:this._mosaicPages[m].size[1]};g.getPageTexture=function(m){return m<this._mosaicPages.length?
this._mosaicPages[m].texture:null};g.has=function(m){return this._mosaicRects.has(m)};g.getSpriteItem=function(m){return this._mosaicRects.get(m)};g.addSpriteItem=function(m,n,r,t,z,w){if(this._mosaicRects.has(m))return this._mosaicRects.get(m);let B,A,x;e(r)?[B,A,x]=this._allocateImage(n[0],n[1]):(B=new l(0,0,n[0],n[1]),A=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:r,size:n,dirty:!0,texture:void 0}));if(0>=B.width||0>=B.height)return null;w={rect:B,width:n[0],height:n[1],sdf:z,simplePattern:w,
pixelRatio:1,page:A};this._mosaicRects.set(m,w);e(r)&&this._copy({rect:B,spriteSize:n,spriteData:r.data,page:A,pageSize:x,repeat:t,sdf:z});return w};g.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};g.processNextItem=function(){const m=this._spriteCopyQueue.pop();m&&this._copy(m)};g.getSpriteItems=function(m){const n={};for(const r of m)n[r]=this.getSpriteItem(r);return n};g.getMosaicItemPosition=function(m){const n=(m=this.getSpriteItem(m))&&m.rect;if(!n)return null;n.width=
m.width;n.height=m.height;const r=c.SPRITE_PADDING,t=this._mosaicPages[m.page];return{size:[m.width,m.height],tl:[(n.x+r)/t[0],(n.y+r)/t[1]],br:[(n.x+r+m.width)/t[0],(n.y+r+m.height)/t[1]],page:m.page}};g.bind=function(m,n,r=0,t=0){r=this._mosaicPages[r];var z=r.mosaicsData,w=r.texture;w||(w=r.size,w=e(z)?new a(m,{pixelFormat:6408,dataType:5121,width:w[0],height:w[1]},new Uint8Array(z.data.buffer)):new a(m,{pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:w[0],height:w[1]},null),
r.texture=w);w.setSamplingMode(n);e(z)?(m.bindTexture(w,t),r.dirty&&(w.setData(new Uint8Array(z.data.buffer)),w.generateMipmap())):(n=z.data,z=n.bindFrame(m,w,t),F.isSome(this._requestRender)&&z&&0<n.frameCount&&this._requestRender.requestRender(),n.bindFrame(m,w,t));r.dirty=!1};d._copyBits=function(m,n,r,t,z,w,B,A,x,E,D){let K=t*n+r;B=A*w+B;if(D)for(B-=w,D=-1;D<=E;D++,K=((D+E)%E+t)*n+r,B+=w)for(A=-1;A<=x;A++)z[B+A]=m[K+(A+x)%x];else for(r=0;r<E;r++){for(t=0;t<x;t++)z[B+t]=m[K+t];K+=n;B+=w}};g._copy=
function(m){if(!(m.page>=this._mosaicPages.length)){var n=this._mosaicPages[m.page],r=n.mosaicsData;if(!e(n.mosaicsData))throw new G("mapview-invalid-resource","unsuitable data type!");var t=m.spriteData;(r=r.data)&&t||console.error("Source or target images are uninitialized!");d._copyBits(t,m.spriteSize[0],0,0,r,m.pageSize[0],m.rect.x+c.SPRITE_PADDING,m.rect.y+c.SPRITE_PADDING,m.spriteSize[0],m.spriteSize[1],m.repeat);n.dirty=!0}};g._allocateImage=function(m,n){m+=2*c.SPRITE_PADDING;n+=2*c.SPRITE_PADDING;
var r=Math.max(m,n);if(this._maxItemSize&&this._maxItemSize<r){r=2**Math.ceil(h.log2(m));const t=2**Math.ceil(h.log2(n));m=new l(0,0,m,n);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(r*t)},size:[r,t],dirty:!0,texture:void 0});return[m,this._mosaicPages.length-1,[r,t]]}r=this._binPack.allocate(m,n);return 0>=r.width?(r=this._mosaicPages[this._currentPage],!r.dirty&&e(r.mosaicsData)&&(r.mosaicsData.data=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",
data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new q(this._pageWidth,this._pageHeight),this._allocateImage(m,n)):[r,this._currentPage,[this._pageWidth,this._pageHeight]]};g.dispose=function(){this._binPack=null;for(const n of this._mosaicPages){var m=n.texture;m&&m.dispose();m=n.mosaicsData;e(m)||m.data.pause()}this._mosaicPages=null;this._mosaicRects.clear()};u._createClass(d,[{key:"itemCount",get:function(){return this._mosaicRects.size}}]);
return d}()})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../../../../../core/promiseUtils"],function(u,G,F,C){function y(m,n=0,r=m.length-n){let t=-1;for(let z=n,w=n+r;z<w;z++)t=t>>>8^h[(t^m[z])&255];return t^-1}function v(m){const n=m.constructor===Uint8Array?m:new Uint8Array(m);return d.some((r,t)=>r!==n[t])?!1:!0}function p(m,n){const r=new Uint8Array(n);if(d.some((K,H)=>K!==r[H]))return q;
let t=!1;k(r,K=>!(t="acTL"===K));if(!t)return e;const z=[],w=[];let B=null,A=null,x=0;k(r,(K,H,I,J)=>{const M=new DataView(H.buffer);switch(K){case "IHDR":B=H.subarray(I+8,I+8+J);m.width=M.getUint32(I+8);m.height=M.getUint32(I+12);break;case "acTL":m.numPlays=M.getUint32(I+8+4);break;case "fcTL":A&&(m.frames.push(A),x++);A=new g;A.width=M.getUint32(I+8+4);A.height=M.getUint32(I+8+8);A.left=M.getUint32(I+8+12);A.top=M.getUint32(I+8+16);K=M.getUint16(I+8+20);H=M.getUint16(I+8+22);0===H&&(H=100);A.delay=
1E3*K/H;10>=A.delay&&(A.delay=100);m.playTime+=A.delay;A.disposeOp=M.getUint8(I+8+24);A.blendOp=M.getUint8(I+8+25);A.dataParts=[];0===x&&2===A.disposeOp&&(A.disposeOp=1);break;case "fdAT":A&&A.dataParts.push(H.subarray(I+8+4,I+8+J));break;case "IDAT":A&&A.dataParts.push(H.subarray(I+8,I+8+J));break;case "IEND":w.push(a(H,I,12+J));break;default:z.push(a(H,I,12+J))}});if(0===m.frames.length)return e;m.frameCount=m.frames.length;const E=new Blob(z),D=new Blob(w);m.frames.forEach(K=>{let H=[];H.push(d);
B.set(c(K.width),0);B.set(c(K.height),4);H.push(f("IHDR",B));H.push(E);K.dataParts.forEach(I=>H.push(f("IDAT",I)));H.push(D);K.data=new Blob(H,{type:"image/png"});delete K.dataParts;H=null});return m}function k(m,n){const r=new DataView(m.buffer);let t=8;let z,w;do{z=r.getUint32(t);var B=t+4;B=Array.prototype.slice.call(m.subarray(B,B+4));B=String.fromCharCode.apply(String,B);w=n(B,m,t,z);t+=12+z}while(!1!==w&&"IEND"!==B&&t<m.length)}function b(m){const n=new Uint8Array(m.length);for(let r=0;r<m.length;r++)n[r]=
m.charCodeAt(r);return n}function a(m,n,r){const t=new Uint8Array(r);t.set(m.subarray(n,n+r));return t}function f(m,n){const r=m.length+n.length,t=new Uint8Array(r+8),z=new DataView(t.buffer);z.setUint32(0,n.length);t.set(b(m),4);t.set(n,8);m=y(t,4,r);z.setUint32(r+4,m);return t}function c(m){return new Uint8Array([m>>>24&255,m>>>16&255,m>>>8&255,m&255])}const h=new Uint32Array(256);for(var l=0;256>l;l++){let m=l;for(let n=0;8>n;n++)m=0!==(m&1)?3988292384^m>>>1:m>>>1;h[l]=m}const q=new F("Not a PNG"),
e=new F("Not an animated PNG"),d=new Uint8Array([137,80,78,71,13,10,26,10]);l=function(){function m(){this.playTime=this.numPlays=this.height=this.width=0;this.frames=[];this.playing=this.paused=!1;this.playSpeed=1;this.currentFrameNumber=0;this._lastUsedFrame=-1}m.create=function(){var r=G._asyncToGenerator(function*(t,z){const w=new m;try{yield w._load(t,z)}catch(B){if(!C.isAbortError(B))return new F("invalid-resource",`Could not load PNG: ${B.message}`)}return w});return function(t,z){return r.apply(this,
arguments)}}();var n=m.prototype;n.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};n.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};n.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};n.bindFrame=function(r,t,z){r.bindTexture(t,z);r=this.frameChanged();if(!r)return!1;z=this.currentFrame;const w=z.frameData,B=t.descriptor;(z.left||z.top||z.width!==B.width||z.height!==B.height)&&t.setData(null);t.updateData(0,z.left,
z.top,z.width,z.height,w);this.updateUsedFrame();return r};n.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};n.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};n._load=function(){var r=G._asyncToGenerator(function*(t,z){try{const w=p(this,t);if(w!==this)return w;this._resizeCanvas=document.createElement("canvas");this._resizeCanvas.width=this.width;this._resizeCanvas.height=this.height;yield Promise.all(this.frames.map(B=>B.createImage(this._resizeCanvas)))}catch(w){if(!C.isAbortError(w))return new F("invalid-resource",
"Could not parse PNG")}this.play()});return function(t,z){return r.apply(this,arguments)}}();n._play=function(){if(0===this.playSpeed)this.pause();else{if(0>this.playSpeed){--this.currentFrameNumber;0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1);var r=this.currentFrameNumber;--r;0>r&&(r=this.frames.length-1);r=-this.frames[r].delay/this.playSpeed}else this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,r=1*this.frames[this.currentFrameNumber].delay/this.playSpeed;
var t=this.frames[this.currentFrameNumber];this.currentFrame={frameData:t.imageData,top:t.top,left:t.left,width:t.width,height:t.height};this.timerID=window.setTimeout(()=>this._play(),r)}};return m}();let g=function(){function m(){this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageData=this.data=null}m.prototype.createImage=function(){var n=G._asyncToGenerator(function*(r){if(null===this.imageData)return new Promise((t,z)=>{const w=URL.createObjectURL(this.data),
B=document.createElement("img");B.onload=()=>{URL.revokeObjectURL(w);{r.width=B.width;r.height=B.height;var A=r.getContext("2d");A.drawImage(B,0,0,B.width,B.height);A=A.getImageData(0,0,B.width,B.height);A=new Uint8Array(A.data);let x;for(let E=0;E<A.length;E+=4)x=A[E+3]/255,A[E]*=x,A[E+1]*=x,A[E+2]*=x;A=new ImageData(new Uint8ClampedArray(A.buffer),B.width,B.height)}this.imageData=A;t()};B.onerror=()=>{URL.revokeObjectURL(w);this.imageData=null;z(Error("Image creation error"))};B.src=w})});return function(r){return n.apply(this,
arguments)}}();return m}();u.default=l;u.getPNGSize=function(m){m=new Uint8Array(m);let n,r;k(m,(t,z,w)=>{z=new DataView(z.buffer);"IHDR"===t&&(n=z.getUint32(w+8),r=z.getUint32(w+12))});return[n,r]};u.isAnimatedPNG=function(m){m=new Uint8Array(m);if(!v(m))return!1;let n=!1;k(m,r=>!(n="acTL"===r));return n};u.isPNG=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error",
"../../../../../core/promiseUtils"],function(u,G,F,C){function y(k){if(!k||0===k.byteLength)return!1;k=k.constructor===Uint8Array?k:new Uint8Array(k);return 71===k[0]&&73===k[1]&&70===k[2]&&56===k[3]}let v=function(){function k(){this.playing=this.paused=!1;this.waitTillDone=!0;this.firstFrameOnly=this.loading=!1;this.frames=[];this.comment="";this.frameCount=this.currentFrameNumber=this.length=0;this.playSpeed=1;this.lastFrame=null;this.playOnLoad=!0;this.complete=!1;this.interlaceOffsets=[0,4,2,
1];this.interlaceSteps=[8,8,4,2];this._lastUsedFrame=-1}k.create=function(){var a=G._asyncToGenerator(function*(f,c){const h=new k;try{yield h._load(f,c)}catch(l){if(!C.isAbortError(l))return new F("invalid-resource",`Could not load PNG: ${l.message}`)}return h});return function(f,c){return a.apply(this,arguments)}}();var b=k.prototype;b.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};b.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};b.togglePlay=
function(){this.paused||!this.playing?this.play():this.pause()};b.bindFrame=function(a,f,c){a.bindTexture(f,c);if(a=this.frameChanged())c=this.currentFrame,f.updateData(0,0,0,c.width,c.height,c.frameData),this.updateUsedFrame();return a};b.seekFrame=function(a){clearTimeout(this.timerID);this.currentFrameNumber=a%this.frames.length;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};b.seek=function(a){clearTimeout(this.timerID);0>a&&(a=0);a=1E3*a%this.length;let f=0;for(;a>this.frames[f].time+
this.frames[f].delay&&f<this.frames.length;)f+=1;this.currentFrameNumber=f;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};b.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};b.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};b._load=function(){var a=G._asyncToGenerator(function*(f,c){try{this.loading=!0,yield this._parse(f,c),this.loading=!1,this.play()}catch(h){if(!C.isAbortError(h))return new F("invalid-resource","Could not parse gif!")}});
return function(f,c){return a.apply(this,arguments)}}();b._parse=function(a,f){const c=new p(a);c.pos+=6;this.width=c.data[c.pos++]+(c.data[c.pos++]<<8);this.height=c.data[c.pos++]+(c.data[c.pos++]<<8);a=c.data[c.pos++];this.globalColourCount=1<<(a&7)+1;c.pos++;c.pos++;a&128&&(this.globalColourTable=this._parseColourTable(this.globalColourCount,c));return new Promise((h,l)=>{setTimeout(()=>this._parseBlock(c,h,l,f),0)})};b._parseBlock=function(){var a=G._asyncToGenerator(function*(f,c,h,l){if(l&&
l.signal&&C.isAborted(l.signal))h(C.createAbortError());else{var q=f.data[f.pos++];if(44===q){if(this._parseImg(f),this.firstFrameOnly){this._finishedLoading();c();return}}else{if(59===q){this._finishedLoading();c();return}this._parseExt(f)}if("function"===typeof this.onprogress)this.onprogress({bytesRead:f.pos,totalBytes:f.data.length,frame:this.frames.length});setTimeout(()=>this._parseBlock(f,c,h,l),0)}});return function(f,c,h,l){return a.apply(this,arguments)}}();b._parseColourTable=function(a,
f){const c=[];for(let h=0;h<a;h++)c.push([f.data[f.pos++],f.data[f.pos++],f.data[f.pos++]]);return c};b._parseImg=function(a){const f=l=>{const q=this.pixelBufSize/l;this.interlacedBufSize!==this.pixelBufSize&&(this.deinterlaceBuf=new Uint8Array(this.pixelBufSize),this.interlacedBufSize=this.pixelBufSize);let e=0;for(let d=0;4>d;d++)for(let g=this.interlaceOffsets[d];g<q;g+=this.interlaceSteps[d])this.deinterlaceBuf.set(this.pixelBuf.subarray(e,e+l),g*l),e+=l},c={};this.frames.push(c);c.disposalMethod=
this.disposalMethod;c.time=this.length;c.delay=10*this.delayTime;this.length+=c.delay;c.transparencyIndex=this.transparencyGiven?this.transparencyIndex:void 0;c.leftPos=a.data[a.pos++]+(a.data[a.pos++]<<8);c.topPos=a.data[a.pos++]+(a.data[a.pos++]<<8);c.width=a.data[a.pos++]+(a.data[a.pos++]<<8);c.height=a.data[a.pos++]+(a.data[a.pos++]<<8);const h=a.data[a.pos++];c.localColourTableFlag=h&128?!0:!1;c.localColourTableFlag&&(c.localColourTable=this._parseColourTable(1<<(h&7)+1,a));this.pixelBufSize!==
c.width*c.height&&(this.pixelBuf=new Uint8Array(c.width*c.height),this.pixelBufSize=c.width*c.height);this._lzwDecode(a.data[a.pos++],a.readSubBlocksB());h&64?(c.interlaced=!0,f(c.width)):c.interlaced=!1;this._processFrame(c)};b._lzwDecode=function(a,f){let c,h,l,q,e;let d,g;l=h=0;let m=[];const n=1<<a,r=n+1;q=a+1;for(g=!1;!g;){var t=e;for(c=e=0;c<q;c++)f[l>>3]&1<<(l&7)&&(e|=1<<c),l++;if(e===n){m=[];q=a+1;for(c=0;c<n;c++)m[c]=[c];m[n]=[];m[r]=null}else{if(e===r){g=!0;break}e>=m.length?m.push(m[t].concat(m[t][0])):
t!==n&&m.push(m[t].concat(m[e][0]));t=m[e];d=t.length;for(c=0;c<d;c++)this.pixelBuf[h++]=t[c];m.length===1<<q&&12>q&&q++}}};b._processFrame=function(a){a.image=document.createElement("canvas");a.image.width=this.width;a.image.height=this.height;a.ctx=a.image.getContext("2d");const f=a.localColourTableFlag?a.localColourTable:this.globalColourTable;null===this.lastFrame&&(this.lastFrame=a);const c=2===this.lastFrame.disposalMethod||3===this.lastFrame.disposalMethod?!0:!1;c||a.ctx.drawImage(this.lastFrame.image,
0,0,this.width,this.height);const h=a.ctx.getImageData(a.leftPos,a.topPos,a.width,a.height),l=a.transparencyIndex,q=h.data,e=a.interlaced?this.deinterlaceBuf:this.pixelBuf,d=e.length;let g=0,m,n;for(let r=0;r<d;r++)m=e[r],n=f[m],l!==m?(q[g++]=n[0],q[g++]=n[1],q[g++]=n[2],q[g++]=255):(c&&(q[g+3]=0),g+=4);a.ctx.putImageData(h,a.leftPos,a.topPos);this.lastFrame=a};b._parseExt=function(a){const f=a.data[a.pos++];249===f?this._parseGCExt(a):254===f?this.comment+=a.readSubBlocks():255===f?this._parseAppExt(a):
(1===f&&(a.pos+=13),a.readSubBlocks())};b._parseAppExt=function(a){a.pos+=1;"NETSCAPE"===a.getString(8)?a.pos+=8:(a.pos+=3,a.readSubBlocks())};b._parseGCExt=function(a){a.pos++;const f=a.data[a.pos++];this.disposalMethod=(f&28)>>2;this.transparencyGiven=f&1?!0:!1;this.delayTime=a.data[a.pos++]+(a.data[a.pos++]<<8);this.transparencyIndex=a.data[a.pos++];a.pos++};b._finishedLoading=function(){this.loading=!1;this.frameCount=this.frames.length;this.lastFrame=null;this.complete=!0;this.deinterlaceBuf=
this.pixelBufSize=this.deinterlaceBuf=this.pixelBuf=this.waitTillDone=this.transparencyIndex=this.delayTime=this.transparencyGiven=this.disposalMethod=void 0;this.currentFrameNumber=0;0<this.frames.length&&this._setCurrentFrame(0);this.playOnLoad&&this.play()};b._play=function(){if(0===this.playSpeed)this.pause();else{if(0>this.playSpeed){--this.currentFrameNumber;0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1);var a=this.currentFrameNumber;--a;0>a&&(a=this.frames.length-
1);a=-this.frames[a].delay/this.playSpeed}else this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,a=1*this.frames[this.currentFrameNumber].delay/this.playSpeed;this._setCurrentFrame(this.currentFrameNumber);this.timerID=window.setTimeout(()=>this._play(),a)}};b._setCurrentFrame=function(a){this.currentFrame={frameData:this.frames[a].image,top:0,left:0,width:this.width,height:this.height}};return k}(),p=function(){function k(a){this.pos=0;this.data=new Uint8ClampedArray(a);this.len=
this.data.length}var b=k.prototype;b.getString=function(a){let f="";for(;a--;)f+=String.fromCharCode(this.data[this.pos++]);return f};b.readSubBlocks=function(){let a,f,c="";do for(f=a=this.data[this.pos++];f--;)c+=String.fromCharCode(this.data[this.pos++]);while(0!==a&&this.pos<this.len);return c};b.readSubBlocksB=function(){let a,f;const c=[];do for(f=a=this.data[this.pos++];f--;)c.push(this.data[this.pos++]);while(0!==a&&this.pos<this.len);return c};return k}();u.default=v;u.getGIFSize=function(k){var b=
new Uint8ClampedArray(k);let a=6;k=b[a++]+(b[a++]<<8);b=b[a++]+(b[a++]<<8);return[k,b]};u.isAnimatedGIF=function(k){if(!k||0===k.byteLength)return!1;k=new Uint8Array(k);if(!y(k))return!1;let b=0;for(let a=0,f=k.length-9;a<f&&(0!==k[a]||33!==k[a+1]||249!==k[a+2]||4!==k[a+3]||0!==k[a+8]||44!==k[a+9]&&33!==k[a+9]||(b++,!(1<b)));++a);return 1<b};u.isGIF=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],
function(u,G){u.ok=function(F,C){return F&&"name"in F?(C&&C.error(new G(F.name,F.message,F.details)),!1):!0};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["exports"],function(u){u.keyFromSymbol=function(G){switch(G.type){case "esriSMS":return`${G.style}.${G.path}`;case "esriSLS":return`${G.style}.${G.cap}`;case "esriSFS":return`${G.style}`;case "esriPFS":case "esriPMS":return G.imageData?`${G.imageData}${G.width}${G.height}`:`${G.url}${G.width}${G.height}`;
default:return"mosaicHash"in G?G.mosaicHash:JSON.stringify(G)}};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(u,G,F,C,y,v){v=function(p){function k(){var a=p.apply(this,arguments)||this;a.defines=[];a._desc={vsPath:"fx/integrate",fsPath:"fx/integrate",attributes:new Map([["a_position",
0]])};return a}G._inheritsLoose(k,p);var b=k.prototype;b.dispose=function(){this._quad&&this._quad.dispose()};b.bind=function(){};b.unbind=function(){};b.draw=function(a,f){if(f.size){var {context:c,renderingOptions:h}=a;this._quad||(this._quad=new y(c,[0,0,1,0,0,1,1,1]));var l=c.getBoundFramebufferObject(),{x:q,y:e,width:d,height:g}=c.getViewport();f.bindTextures(c);var m=f.getBlock(C.ATTRIBUTE_DATA_ANIMATION);if(!F.isNone(m)){var n=m.getFBO(c);m=m.getFBO(c,1);c.setViewport(0,0,f.size,f.size);this._computeDelta(a,
m,h.labelsAnimationTime);this._updateAnimationState(a,m,n);c.bindFramebuffer(l);c.setViewport(q,e,d,g)}}};b._computeDelta=function(a,f,c){const {context:h,painter:l,displayLevel:q}=a,e=l.materialManager.getProgram(a,this._desc,["delta"]);h.bindFramebuffer(f);h.setClearColor(0,0,0,0);h.clear(h.gl.COLOR_BUFFER_BIT);h.useProgram(e);e.setUniform1i("u_maskTexture",C.TEXTURE_BINDING_ATTRIBUTE_DATA_0);e.setUniform1i("u_sourceTexture",C.TEXTURE_BINDING_ATTRIBUTE_DATA_1);e.setUniform1f("u_timeDelta",a.deltaTime);
e.setUniform1f("u_animationTime",c);e.setUniform1f("u_zoomLevel",Math.round(10*q));this._quad.draw()};b._updateAnimationState=function(a,f,c){const {context:h,painter:l}=a;a=l.materialManager.getProgram(a,this._desc,["update"]);h.bindTexture(f.colorTexture,1);h.useProgram(a);a.setUniform1i("u_sourceTexture",1);h.bindFramebuffer(c);h.setClearColor(0,0,0,0);h.clear(h.gl.COLOR_BUFFER_BIT);this._quad.draw()};return k}(v.Effect);u.AnimationEffect=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["exports"],
function(u){u.Effect=function(){this.name=this.constructor.name};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/BlendEffect":function(){define("exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../webgl/checkWebGLError ../../../../webgl/enums ../../../../../chunks/builtins ../../../../webgl/ProgramCache ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../enums ../VertexStream ../shaders/BlendPrograms".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e,d){const g=F.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect");F=function(){function m(){this._size=[0,0]}var n=m.prototype;n.dispose=function(r){this._backBufferTexture&&(this._backBufferTexture.dispose(),this._backBufferTexture=null);this._programCache&&(this._programCache.dispose(),this._programCache=null);this._quad&&(this._quad.dispose(),this._quad=null)};n.draw=function(r,t,z,w,B){const {context:A,drawPhase:x}=r;this._setupShader(A);
w&&"normal"!==w&&x!==q.WGLDrawPhase.LABEL?this._drawBlended(r,t,z,w,B):(r=this._programCache.getProgram(d.blend,"normal"))?(A.useProgram(r),t.setSamplingMode(z),A.bindTexture(t,0),r.setUniform1i("u_layerTexture",0),r.setUniform1f("u_opacity",B),A.setBlendingEnabled(!0),A.setBlendFunction(1,771),t=this._quad,t.draw(),t.unbind()):g.error(new G("mapview-BlendEffect",'Error creating shader program for blend mode "normal"'))};n._drawBlended=function(r,t,z,w,B){const {context:A,state:x,pixelRatio:E,inFadeTransition:D}=
r;var {size:K}=x,H=A.getBoundFramebufferObject();let I;C.isSome(H)?(K=H.descriptor,I=K.width,K=K.height):(I=Math.round(E*K[0]),K=Math.round(E*K[1]));this._createOrResizeTexture(r,I,K);r=this._backBufferTexture;H.copyToTexture(0,0,I,K,0,0,r);A.setStencilTestEnabled(!1);A.setStencilWriteMask(0);A.setBlendingEnabled(!0);A.setDepthTestEnabled(!1);A.setDepthWriteEnabled(!1);(H=this._programCache.getProgram(d.blend,w))?(A.useProgram(H),r.setSamplingMode(z),A.bindTexture(r,0),H.setUniform1i("u_backbufferTexture",
0),t.setSamplingMode(z),A.bindTexture(t,1),H.setUniform1i("u_layerTexture",1),H.setUniform1f("u_opacity",B),H.setUniform1f("u_inFadeOpacity",D?1:0),A.setBlendFunction(1,0),t=this._quad,t.draw(),t.unbind(),A.setBlendFunction(1,771)):g.error(new G("mapview-BlendEffect",`Error creating shader program for blend mode ${w}`))};n._setupShader=function(r){this._programCache||(this._programCache=new c(r),this._quad||(this._quad=new e(r,[-1,-1,1,-1,-1,1,1,1])))};n._createOrResizeTexture=function(r,t,z){({context:r}=
r);if(null===this._backBufferTexture||t!==this._size[0]||z!==this._size[1])this._backBufferTexture?this._backBufferTexture.resize(t,z):this._backBufferTexture=new h(r,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:t,height:z}),this._size[0]=t,this._size[1]=z};return m}();u.BlendEffect=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BlendPrograms":function(){define(["exports","./sources/resolver"],
function(u,G){const F={attributes:new Map([["a_pos",0],["a_tex",1]]),shaders:C=>({vertexShader:`#define ${C.replace("-","_").toUpperCase()}\n`+G.resolveIncludes("blend/blend.vert"),fragmentShader:`#define ${C.replace("-","_").toUpperCase()}\n`+G.resolveIncludes("blend/blend.frag")})};u.blend=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/FeatureEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./Effect"],function(u,G,
F){F=function(C){function y(p){var k=C.call(this)||this;k.name=k.constructor.name;k.defines=[p];return k}G._inheritsLoose(y,C);var v=y.prototype;v.dispose=function(){};v.bind=function({context:p,painter:k}){this._prev=p.getBoundFramebufferObject();const {width:b,height:a}=p.getViewport();k=k.getFbos(b,a).effect0;p.bindFramebuffer(k);p.setColorMask(!0,!0,!0,!0);p.setClearColor(0,0,0,0);p.clear(p.gl.COLOR_BUFFER_BIT)};v.unbind=function(){};v.draw=function(p,k){const {context:b,painter:a}=p;k=a.getPostProcessingEffects(k);
const f=b.getBoundFramebufferObject();for(const {postProcessingEffect:c,effect:h}of k)c.draw(p,f,h);b.bindFramebuffer(this._prev);b.setStencilTestEnabled(!1);a.blitTexture(b,f.colorTexture,9728);b.setStencilTestEnabled(!0)};return y}(F.Effect);u.FeatureEffect=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../BitBlitRenderer ./Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),
function(u,G,F,C,y,v,p){return function(k){function b(){var f=k.apply(this,arguments)||this;f.defines=["highlight"];f._hlRenderer=new v;f._hlGradient=new y;f._width=void 0;f._height=void 0;f._hlSurfaces=new p;f._adjustedWidth=void 0;f._adjustedHeight=void 0;f._blitRenderer=new F.BitBlitRenderer;return f}u._inheritsLoose(b,k);var a=b.prototype;a.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._hlGradient&&this._hlGradient.destroy();
this._boundFBO=null};a.bind=function(f){const {context:c,painter:h}=f,{width:l,height:q}=c.getViewport(),e=h.getFbos(l,q).effect0;this.setup(f,l,q);c.bindFramebuffer(e);c.setColorMask(!0,!0,!0,!0);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT)};a.unbind=function(){};a.setup=function({context:f},c,h){this._width=c;this._height=h;const l=c%4,q=h%4;c+=2>l?-l:4-l;h+=2>q?-q:4-q;this._adjustedWidth=c;this._adjustedHeight=h;this._boundFBO=f.getBoundFramebufferObject();c=Math.round(1*c);h=Math.round(1*
h);this._hlRenderer.setup(f,c,h);this._hlSurfaces.setup(f,c,h)};a.draw=function({context:f}){const c=f.getBoundFramebufferObject();f.setViewport(0,0,1*this._adjustedWidth,1*this._adjustedHeight);f.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);f.setStencilTestEnabled(!1);f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(f,c.colorTexture,9728,1);f.setStencilTestEnabled(!1);f.setBlendingEnabled(!1);f.setColorMask(!1,!1,!1,!0);f.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);
f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(f,this._hlSurfaces.sharedBlur1Tex);f.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(f,this._hlSurfaces.sharedBlur2Tex);f.bindFramebuffer(this._boundFBO);f.setBlendingEnabled(!0);f.setColorMask(!0,!0,!0,!0);f.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(f,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);
this._boundFBO=null};a.setHighlightOptions=function(f){this._hlGradient.setHighlightOptions(f)};return b}(C.Effect)})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("../../../../../../core/Logger ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../definitions ./parameters".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c){function h(e,d){d.fillColor[0]=e.color.r/255;d.fillColor[1]=e.color.g/255;d.fillColor[2]=e.color.b/255;d.fillColor[3]=e.color.a;e.haloColor?(d.outlineColor[0]=e.haloColor.r/255,d.outlineColor[1]=e.haloColor.g/255,d.outlineColor[2]=e.haloColor.b/255,d.outlineColor[3]=e.haloColor.a):(d.outlineColor[0]=d.fillColor[0],d.outlineColor[1]=d.fillColor[1],d.outlineColor[2]=d.fillColor[2],d.outlineColor[3]=d.fillColor[3]);d.fillColor[3]*=e.fillOpacity;d.outlineColor[3]*=e.haloOpacity;
d.fillColor[0]*=d.fillColor[3];d.fillColor[1]*=d.fillColor[3];d.fillColor[2]*=d.fillColor[3];d.outlineColor[0]*=d.outlineColor[3];d.outlineColor[1]*=d.outlineColor[3];d.outlineColor[2]*=d.outlineColor[3];d.outlineWidth=c.HIGHLIGHT_SIZING.outlineWidth;d.outerHaloWidth=c.HIGHLIGHT_SIZING.outerHaloWidth;d.innerHaloWidth=c.HIGHLIGHT_SIZING.innerHaloWidth;d.outlinePosition=c.HIGHLIGHT_SIZING.outlinePosition}const l=u.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),q=[0,0,0,
0];return function(){function e(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:c.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:c.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:c.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:c.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*c.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}var d=e.prototype;d.setHighlightOptions=function(g){function m(x,E,D){A[0]=
(1-D)*x[0]+D*E[0];A[1]=(1-D)*x[1]+D*E[1];A[2]=(1-D)*x[2]+D*E[2];A[3]=(1-D)*x[3]+D*E[3]}const n=this._convertedHighlightOptions;h(g,n);g=n.outlinePosition-n.outlineWidth/2-n.outerHaloWidth;const r=n.outlinePosition-n.outlineWidth/2,t=n.outlinePosition+n.outlineWidth/2,z=n.outlinePosition+n.outlineWidth/2+n.innerHaloWidth;var w=Math.sqrt(Math.PI/2)*c.SIGMA,B=Math.abs(g)>w?Math.round(10*(Math.abs(g)-w))/10:0;w=Math.abs(z)>w?Math.round(10*(Math.abs(z)-w))/10:0;B&&!w?l.error("The outer rim of the highlight is "+
B+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!B&&w?l.error("The inner rim of the highlight is "+w+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):B&&w&&l.error("The highlight is "+Math.max(B,w)+"px away from the edge of the feature; consider reducing some width values.");const A=[void 0,void 0,void 0,
void 0];({texelData:w}=this);for(let x=0;x<c.SHADE_TEXTURE_SIZE;++x)B=g+x/(c.SHADE_TEXTURE_SIZE-1)*(z-g),B<g?(A[4*x]=0,A[4*x+1]=0,A[4*x+2]=0,A[4*x+3]=0):B<r?m(q,n.outlineColor,(B-g)/(r-g)):B<t?[A[0],A[1],A[2],A[3]]=n.outlineColor:B<z?m(n.outlineColor,n.fillColor,(B-t)/(z-t)):[A[4*x],A[4*x+1],A[4*x+2],A[4*x+3]]=n.fillColor,w[4*x]=255*A[0],w[4*x+1]=255*A[1],w[4*x+2]=255*A[2],w[4*x+3]=255*A[3];this.minMaxDistance[0]=g;this.minMaxDistance[1]=z;this.shadeTexChanged=!0};d.applyHighlightOptions=function(g,
m){this.shadeTex||(this.shadeTex=new b(g,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:c.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,c.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);g.bindTexture(this.shadeTex,f.TEXTURE_BINDING_HIGHLIGHT_1);m.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};d.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return e}()})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["exports"],
function(u){u.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];u.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0};u.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u.SHADE_TEXTURE_SIZE=256;u.SIGMA=1;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/programUtils ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../definitions ./parameters ../../shaders/HighlightPrograms".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h){return function(){function l(){this._height=this._width=void 0;this._resources=null}var q=l.prototype;q.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};q.preBlur=function(e,d){e.bindTexture(d,f.TEXTURE_BINDING_HIGHLIGHT_0);e.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",
[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",c.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);e.bindVAO(this._resources.quadVAO);e.drawArrays(5,0,4);e.bindVAO()};q.finalBlur=function(e,d){e.bindTexture(d,f.TEXTURE_BINDING_HIGHLIGHT_0);e.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",c.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
e.bindVAO(this._resources.quadVAO);e.drawArrays(5,0,4);e.bindVAO()};q.renderHighlight=function(e,d,g){e.bindTexture(d,f.TEXTURE_BINDING_HIGHLIGHT_0);e.useProgram(this._resources.highlightProgram);g.applyHighlightOptions(e,this._resources.highlightProgram);e.bindVAO(this._resources.quadVAO);e.setBlendingEnabled(!0);e.setBlendFunction(1,771);e.drawArrays(5,0,4);e.bindVAO()};q._initialize=function(e,d,g){this._width=d;this._height=g;d=u.createVertex(e,35044,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,
1,1,1,1,1])).buffer);g=new a(e,new Map([["a_position",0],["a_texcoord",1]]),{geometry:[{name:"a_position",count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:d});const m=k.createProgram(e,h.highlight);e=k.createProgram(e,h.blur);m.setUniform1i("u_texture",f.TEXTURE_BINDING_HIGHLIGHT_0);m.setUniform1i("u_shade",f.TEXTURE_BINDING_HIGHLIGHT_1);m.setUniform1f("u_sigma",c.SIGMA);e.setUniform1i("u_texture",f.TEXTURE_BINDING_HIGHLIGHT_0);
e.setUniform1f("u_sigma",c.SIGMA);this._resources={quadGeometry:d,quadVAO:g,highlightProgram:m,blurProgram:e}};q.setup=function(e,d,g){this._resources?(this._width=d,this._height=g):this._initialize(e,d,g)};return l}()})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["exports","./sources/resolver"],function(u,G){const F={shaders:{vertexShader:G.resolveIncludes("highlight/textured.vert"),fragmentShader:G.resolveIncludes("highlight/highlight.frag")},attributes:new Map([["a_position",
0],["a_texcoord",1]])};G={shaders:{vertexShader:G.resolveIncludes("highlight/textured.vert"),fragmentShader:G.resolveIncludes("highlight/blur.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};u.blur=G;u.highlight=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject".split(" "),
function(u,G,F,C,y,v,p,k,b){function a(f,c,h){c=new k(f,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:c,height:h,samplingMode:9729});f=new F(f,{colorTarget:0,depthStencilTarget:2},c);return[c,f]}return function(){function f(){this._height=this._width=void 0;this._resources=null}var c=f.prototype;c.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),
this._resources=null)};c._initialize=function(h,l,q){this._width=l;this._height=q;const [e,d]=a(h,l,q),[g,m]=a(h,l,q);this._resources={sharedBlur1Tex:e,sharedBlur1Fbo:d,sharedBlur2Tex:g,sharedBlur2Fbo:m}};c.setup=function(h,l,q){!this._resources||this._width===l&&this._height===q||this.dispose();this._resources||this._initialize(h,l,q)};u._createClass(f,[{key:"sharedBlur1Tex",get:function(){return this._resources.sharedBlur1Tex}},{key:"sharedBlur1Fbo",get:function(){return this._resources.sharedBlur1Fbo}},
{key:"sharedBlur2Tex",get:function(){return this._resources.sharedBlur2Tex}},{key:"sharedBlur2Fbo",get:function(){return this._resources.sharedBlur2Fbo}}]);return f}()})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions","./Effect"],function(u,G,F,C,y){y=function(v){function p(){var b=v.apply(this,arguments)||this;b.name=b.constructor.name;b.defines=["id"];b._lastSize=0;return b}
G._inheritsLoose(p,v);var k=p.prototype;k.dispose=function(){F.isSome(this._fbo)&&this._fbo.dispose()};k.bind=function({context:b,painter:a}){const {width:f,height:c}=b.getViewport();this._boundFBO=b.getBoundFramebufferObject();a=a.getFbos(f,c).effect0;b.bindFramebuffer(a);b.setColorMask(!0,!0,!0,!0);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};k.unbind=function({context:b}){b.bindFramebuffer(this._boundFBO);this._boundFBO=null};k.draw=function({context:b,state:a,pixelRatio:f},c,h=C.HITTEST_SEARCH_SIZE){const l=
b.getBoundFramebufferObject(),q=a.size[1]*f,e=Math.round(h*f),d=e/2,g=e/2;this._ensureBuffer(e);c.forEach((m,n)=>{var r=new Map;l.readPixels(Math.floor(n.x*f-e/2),Math.floor(q-n.y*f-e/2),e,e,6408,5121,this._buf);for(let w=0;w<this._buf32.length;w++){const B=this._buf32[w];if(4294967295!==B&&0!==B){var t=w%e,z=e-Math.floor(w/e);t=(d-t)*(d-t)+(g-z)*(g-z);z=r.has(B)?r.get(B):4294967295;r.set(B,Math.min(t,z))}}r=Array.from(r).sort((w,B)=>w[1]-B[1]).map(w=>w[0]);m.resolve(r);c.delete(n)})};k._ensureBuffer=
function(b){this._lastSize!==b&&(this._lastSize=b,this._buf=new Uint8Array(4*b*b),this._buf32=new Uint32Array(this._buf.buffer))};return p}(y.Effect);u.HittestEffect=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/EffectManager":function(){define("exports ./Bloom ./Blur ./Colorize ./DropShadow ./Opacity".split(" "),function(u,G,F,C,y,v){const p={colorize:()=>new C.Colorize,blur:()=>new F.Blur,bloom:()=>new G.Bloom,opacity:()=>new v.Opacity,
"drop-shadow":()=>new y.DropShadow};let k=function(){function b(f){this._requestRender=f;this._effectMap=new Map}var a=b.prototype;a.dispose=function(){this._requestRender&&(this._requestRender=null);this._effectMap.forEach(f=>f.dispose());this._effectMap.clear()};a.getPostProcessingEffects=function(f){if(!f||0===f.length)return[];const c=[];for(const h of f){a:switch(f=h.type,f){case "bloom":case "blur":case "opacity":case "drop-shadow":break a;default:f="colorize"}let l=this._effectMap.get(f);l||
(l=p[f](),this._effectMap.set(f,l));c.push({postProcessingEffect:l,effect:h})}return c};return b}();u.EffectManager=k;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/Bloom":function(){define("exports ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../VertexStream".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f){const c=[1,0],h=[0,1],l=[1,.8,.6,.4,.2],q=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];G=function(){function e(){this._compositeFBO=this._intensityFBO=null;this._mipsFBOs=Array(5);this._nMips=5;this._kernelSizeArray=[3,5,7,9,11];this._size=[0,0];this._programDesc={luminosityHighPass:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/luminosityHighPass",attributes:new Map([["a_position",0]])},gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/gaussianBlur",
attributes:new Map([["a_position",0]])},composite:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/composite",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",0]])}}}var d=e.prototype;d.dispose=function(){this._quad&&(this._quad.dispose(),this._quad=null);this._intensityFBO&&(this._intensityFBO.dispose(),this._intensityFBO=null);this._compositeFBO&&(this._compositeFBO.dispose(),this._compositeFBO=null);
if(this._mipsFBOs){for(let g=0;g<this._nMips;g++)this._mipsFBOs[g]&&(this._mipsFBOs[g].horizontal.dispose(),this._mipsFBOs[g].vertical.dispose());this._mipsFBOs=null}};d.draw=function(g,m,n){const {width:r,height:t}=m,{context:z,painter:w}=g,{materialManager:B}=w;var A=z.gl;const x=this._programDesc,{strength:E,radius:D,threshold:K}=n;this._quad||(this._quad=new f(z,[-1,-1,1,-1,-1,1,1,1]));this._createOrResizeResources(g,r,t);z.setStencilTestEnabled(!1);z.setBlendingEnabled(!0);z.setBlendFunction(1,
771);z.setStencilWriteMask(0);n=this._quad;n.bind();z.bindFramebuffer(this._intensityFBO);var H=B.getProgram(g,x.luminosityHighPass);z.useProgram(H);z.bindTexture(m.colorTexture,0);H.setUniform1i("u_texture",0);H.setUniform3fv("u_defaultColor",[0,0,0]);H.setUniform1f("u_defaultOpacity",0);H.setUniform1f("u_luminosityThreshold",K);H.setUniform1f("u_smoothWidth",.01);H=[Math.round(r/2),Math.round(t/2)];z.setViewport(0,0,H[0],H[1]);z.setClearColor(0,0,0,0);z.clear(A.COLOR_BUFFER_BIT);n.draw();z.setBlendingEnabled(!1);
A=this._intensityFBO.colorTexture;for(let I=0;I<this._nMips;I++){const J=B.getProgram(g,x.gaussianBlur,[{name:"radius",value:this._kernelSizeArray[I]}]);z.useProgram(J);z.bindTexture(A,I+1);J.setUniform1i("u_colorTexture",I+1);J.setUniform2fv("u_texSize",H);J.setUniform2fv("u_direction",c);z.setViewport(0,0,H[0],H[1]);const M=this._mipsFBOs[I];z.bindFramebuffer(M.horizontal);n.draw();A=M.horizontal.colorTexture;z.bindFramebuffer(M.vertical);z.bindTexture(A,I+1);J.setUniform2fv("u_direction",h);n.draw();
A=M.vertical.colorTexture;H[0]=Math.round(H[0]/2);H[1]=Math.round(H[1]/2)}z.setViewport(0,0,r,t);H=B.getProgram(g,x.composite,[{name:"nummips",value:5}]);z.bindFramebuffer(this._compositeFBO);z.useProgram(H);H.setUniform1f("u_bloomStrength",E);H.setUniform1f("u_bloomRadius",D);H.setUniform1fv("u_bloomFactors",l);H.setUniform3fv("u_bloomTintColors",q);z.bindTexture(this._mipsFBOs[0].vertical.colorTexture,1);H.setUniform1i("u_blurTexture1",1);z.bindTexture(this._mipsFBOs[1].vertical.colorTexture,2);
H.setUniform1i("u_blurTexture2",2);z.bindTexture(this._mipsFBOs[2].vertical.colorTexture,3);H.setUniform1i("u_blurTexture3",3);z.bindTexture(this._mipsFBOs[3].vertical.colorTexture,4);H.setUniform1i("u_blurTexture4",4);z.bindTexture(this._mipsFBOs[4].vertical.colorTexture,5);H.setUniform1i("u_blurTexture5",5);n.draw();z.bindFramebuffer(m);z.setBlendingEnabled(!0);g=B.getProgram(g,x.blit);z.useProgram(g);z.bindTexture(this._compositeFBO.colorTexture,6);g.setUniform1i("u_texture",6);z.setBlendFunction(1,
1);n.draw();n.unbind();z.setBlendFunction(1,771);z.setStencilTestEnabled(!0)};d._createOrResizeResources=function(g,m,n){({context:g}=g);if(!this._compositeFBO||this._size[0]!==m||this._size[1]!==n){this._size[0]=m;this._size[1]=n;var r=[Math.round(m/2),Math.round(n/2)];this._compositeFBO?this._compositeFBO.resize(m,n):this._compositeFBO=new F(g,{colorTarget:0,depthStencilTarget:0,width:m,height:n});this._intensityFBO?this._intensityFBO.resize(r[0],r[1]):this._intensityFBO=new F(g,{colorTarget:0,
depthStencilTarget:0,width:r[0],height:r[1]},{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:r[0],height:r[1]});for(m=0;m<this._nMips;m++)this._mipsFBOs[m]?(this._mipsFBOs[m].horizontal.resize(r[0],r[1]),this._mipsFBOs[m].vertical.resize(r[0],r[1])):this._mipsFBOs[m]={horizontal:new F(g,{colorTarget:0,depthStencilTarget:0,width:r[0],height:r[1]},{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,
flipped:!1,width:r[0],height:r[1]}),vertical:new F(g,{colorTarget:0,depthStencilTarget:0,width:r[0],height:r[1]},{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:r[0],height:r[1]})},r[0]=Math.round(r[0]/2),r[1]=Math.round(r[1]/2)}};return e}();u.Bloom=G;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/Blur":function(){define("exports ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../VertexStream".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f){const c=[1,0],h=[0,1];G=function(){function l(){this._blurFBO=null;this._size=[0,0];this._programDesc={gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",0]])},radialBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/radial-blur",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",0]])}}}var q=l.prototype;
q.dispose=function(){this._blurFBO&&(this._blurFBO.dispose(),this._blurFBO=null)};q.draw=function(e,d,g){const {context:m}=e,{type:n,radius:r}=g;0!==r&&(this._createOrResizeResources(e),this._quad||(this._quad=new f(m,[-1,-1,1,-1,-1,1,1,1])),g=this._quad,g.bind(),"blur"===n?this._gaussianBlur(e,d,r):this._radialBlur(e,d),g.unbind())};q._gaussianBlur=function(e,d,g){const {context:m,state:n,painter:r,pixelRatio:t}=e;var {size:z}=n;const {materialManager:w}=r,B=this._quad;z=[Math.round(t*z[0]),Math.round(t*
z[1])];const A=this._blurFBO;e=w.getProgram(e,this._programDesc.gaussianBlur,[{name:"radius",value:Math.ceil(g)}]);m.useProgram(e);m.setBlendingEnabled(!1);m.bindFramebuffer(A);m.bindTexture(d.colorTexture,4);e.setUniform1i("u_colorTexture",4);e.setUniform2fv("u_texSize",z);e.setUniform2fv("u_direction",c);e.setUniform1f("u_sigma",g);B.draw();m.bindFramebuffer(d);m.setStencilWriteMask(0);m.setStencilTestEnabled(!1);m.setDepthWriteEnabled(!1);m.setDepthTestEnabled(!1);m.bindTexture(A.colorTexture,
5);e.setUniform1i("u_colorTexture",5);e.setUniform2fv("u_direction",h);B.draw();m.setBlendingEnabled(!0);m.setBlendFunction(1,771);m.setStencilTestEnabled(!0)};q._radialBlur=function(e,d){const {context:g,painter:m}=e,{materialManager:n}=m,r=this._programDesc,t=this._quad,z=this._blurFBO;g.bindFramebuffer(z);const w=n.getProgram(e,r.radialBlur);g.useProgram(w);g.setBlendingEnabled(!1);g.bindTexture(d.colorTexture,4);w.setUniform1i("u_colorTexture",4);t.draw();g.bindFramebuffer(d);g.setStencilWriteMask(0);
g.setStencilTestEnabled(!1);g.setDepthWriteEnabled(!1);g.setDepthTestEnabled(!1);g.setBlendingEnabled(!0);e=n.getProgram(e,r.blit);g.useProgram(e);g.bindTexture(z.colorTexture,5);e.setUniform1i("u_texture",5);g.setBlendFunction(1,771);t.draw()};q._createOrResizeResources=function(e){const {context:d,state:g,pixelRatio:m}=e;var {size:n}=g;e=Math.round(m*n[0]);n=Math.round(m*n[1]);this._blurFBO&&this._size[0]===e&&this._size[1]===n||(this._size[0]=e,this._size[1]=n,this._blurFBO?this._blurFBO.resize(e,
n):this._blurFBO=new F(d,{colorTarget:0,depthStencilTarget:0,width:e,height:n},{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:e,height:n}))};return l}();u.Blur=G;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/Colorize":function(){define("exports ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../VertexStream".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f){G=function(){function c(){this._size=[0,0];this._programDesc={vsPath:"post-processing/pp",fsPath:"post-processing/filterEffect",attributes:new Map([["a_position",0]])}}var h=c.prototype;h.dispose=function(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null)};h.draw=function(l,q,e){const {width:d,height:g}=q;this._createOrResizeResources(l,d,g);const {context:m,painter:n}=l,{materialManager:r}=n,t=this._programDesc,z=this._quad;e=e.colorMatrix;
z.bind();const w=this._layerFBOTexture;m.bindFramebuffer(q);q.copyToTexture(0,0,d,g,0,0,w);m.setBlendingEnabled(!1);m.setStencilTestEnabled(!1);l=r.getProgram(l,t);m.useProgram(l);m.bindTexture(w,2);l.setUniformMatrix4fv("u_coefficients",e);l.setUniform1i("u_colorTexture",2);z.draw();m.setBlendingEnabled(!0);m.setBlendFunction(1,771);m.setStencilTestEnabled(!0);z.unbind()};h._createOrResizeResources=function(l,q,e){({context:l}=l);this._layerFBOTexture&&this._size[0]===q&&this._size[1]===e||(this._size[0]=
q,this._size[1]=e,this._layerFBOTexture?this._layerFBOTexture.resize(q,e):this._layerFBOTexture=new b(l,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:q,height:e}),this._quad||(this._quad=new f(l,[-1,-1,1,-1,-1,1,1,1])))};return c}();u.Colorize=G;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/DropShadow":function(){define("exports ../../../../../../core/screenUtils ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../VertexStream".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c){const h=[1,0],l=[0,1];F=function(){function q(){this._verticalBlurFBO=this._horizontalBlurFBO=null;this._size=[0,0];this._programDesc={blur:{vsPath:"post-processing/drop-shadow",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",0]])},composite:{vsPath:"post-processing/pp",fsPath:"post-processing/drop-shadow/composite",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",
0]])}}}var e=q.prototype;e.dispose=function(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null);this._horizontalBlurFBO&&(this._horizontalBlurFBO.dispose(),this._horizontalBlurFBO=null);this._verticalBlurFBO&&(this._verticalBlurFBO.dispose(),this._verticalBlurFBO=null)};e.draw=function(d,g,m){const {context:n,state:r,painter:t}=d,{materialManager:z}=t,w=this._programDesc,B=g.width,A=g.height,x=[Math.round(B/2),Math.round(A/2)],{blurRadius:E,offsetX:D,offsetY:K,color:H}=
m,I=[G.pt2px(D/2),G.pt2px(K/2)];this._createOrResizeResources(d,B,A,x);const J=this._horizontalBlurFBO;m=this._verticalBlurFBO;n.setStencilWriteMask(0);n.setStencilTestEnabled(!1);n.setDepthWriteEnabled(!1);n.setDepthTestEnabled(!1);const M=this._layerFBOTexture;g.copyToTexture(0,0,B,A,0,0,M);this._quad||(this._quad=new c(n,[-1,-1,1,-1,-1,1,1,1]));n.setViewport(0,0,x[0],x[1]);const O=this._quad;O.bind();n.setBlendingEnabled(!1);const L=z.getProgram(d,w.blur,[{name:"radius",value:Math.ceil(E)}]);n.useProgram(L);
n.bindFramebuffer(J);n.bindTexture(g.colorTexture,4);L.setUniformMatrix3fv("u_displayViewMat3",r.displayMat3);L.setUniform2fv("u_offset",I);L.setUniform1i("u_colorTexture",4);L.setUniform2fv("u_texSize",x);L.setUniform2fv("u_direction",h);L.setUniform1f("u_sigma",E);O.draw();n.bindFramebuffer(m);n.bindTexture(J.colorTexture,5);L.setUniformMatrix3fv("u_displayViewMat3",r.displayMat3);L.setUniform2fv("u_offset",[0,0]);L.setUniform1i("u_colorTexture",5);L.setUniform2fv("u_direction",l);O.draw();n.bindFramebuffer(g);
n.setViewport(0,0,B,A);d=z.getProgram(d,w.composite);n.useProgram(d);n.bindTexture(m.colorTexture,2);d.setUniform1i("u_blurTexture",2);n.bindTexture(M,3);d.setUniform1i("u_layerFBOTexture",3);d.setUniform4fv("u_shadowColor",[H[0]/255*H[3],H[1]/255*H[3],H[2]/255*H[3],H[3]]);O.draw();n.setBlendingEnabled(!0);n.setStencilTestEnabled(!0);n.setBlendFunction(1,771);O.unbind()};e._createOrResizeResources=function(d,g,m,n){({context:d}=d);this._horizontalBlurFBO&&this._size[0]===g&&this._size[1]===m||(this._size[0]=
g,this._size[1]=m,this._horizontalBlurFBO?this._horizontalBlurFBO.resize(n[0],n[1]):this._horizontalBlurFBO=new C(d,{colorTarget:0,depthStencilTarget:0,width:n[0],height:n[1]},{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:n[0],height:n[1]}),this._verticalBlurFBO?this._verticalBlurFBO.resize(n[0],n[1]):this._verticalBlurFBO=new C(d,{colorTarget:0,depthStencilTarget:0,width:n[0],height:n[1]},{target:3553,pixelFormat:6408,internalFormat:6408,
dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:n[0],height:n[1]}),this._layerFBOTexture?this._layerFBOTexture.resize(g,m):this._layerFBOTexture=new a(d,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:g,height:m}))};return q}();u.DropShadow=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/Opacity":function(){define("exports ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject".split(" "),
function(u,G,F,C,y,v,p,k,b,a){G=function(){function f(){this._size=[0,0]}var c=f.prototype;c.dispose=function(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null)};c.draw=function(h,l,q){const {width:e,height:d}=l;this._createOrResizeResources(h,e,d);const {context:g,painter:m}=h;({amount:h}=q);q=g.gl;const n=this._layerFBOTexture;g.bindFramebuffer(l);l.copyToTexture(0,0,e,d,0,0,n);g.setBlendingEnabled(!0);g.setStencilTestEnabled(!1);g.setDepthTestEnabled(!1);g.setClearColor(0,
0,0,0);g.clear(q.COLOR_BUFFER_BIT);m.blitTexture(g,n,9728,h)};c._createOrResizeResources=function(h,l,q){({context:h}=h);this._layerFBOTexture&&this._size[0]===l&&this._size[1]===q||(this._size[0]=l,this._size[1]=q,this._layerFBOTexture?this._layerFBOTexture.resize(l,q):this._layerFBOTexture=new b(h,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!1,width:l,height:q}))};return f}();u.Opacity=G;Object.defineProperty(u,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/painter/RenderPass":function(){define(["../../../../../core/arrayUtils","../../../../../core/maybe","../enums"],function(u,G,F){return function(){function C(v,p){var k;this.brushes=v;this.name=p.name;this.drawPhase=p.drawPhase||F.WGLDrawPhase.MAP;this._targetFn=p.target;this.effects=p.effects||[];this.enableDefaultDraw=null!=(k=p.enableDefaultDraw)?k:()=>!0}var y=C.prototype;y.render=function(v){const {context:p,profiler:k}=v,b=this._targetFn();var a=this.drawPhase&v.drawPhase;
k.recordPassStart(this.name);if(a){this.enableDefaultDraw()&&this._doRender(v,b);k.recordPassEnd();for(const f of this.effects){if(!f.enable())continue;a=f.apply;k.recordPassStart(this.name+"."+a.name);k.recordBrushStart(a.name);const c=f.args&&f.args(),{x:h,y:l,width:q,height:e}=p.getViewport(),d=p.getBoundFramebufferObject();a.bind(v,c);this._doRender(v,b,a.defines);a.draw(v,c);a.unbind(v,c);p.bindFramebuffer(d);p.setViewport(h,l,q,e);k.recordBrushEnd();k.recordPassEnd()}}};y._doRender=function(v,
p,k){if(!G.isNone(p))if(u.isArrayLike(p))for(const b of p){if(b.visible)for(const a of this.brushes)v.profiler.recordBrushStart(a.name),a.prepareState(v,b,k),a.draw(v,b,k),v.profiler.recordBrushEnd()}else for(const b of this.brushes)v.profiler.recordBrushStart(b.name),b.prepareState(v,p,k),b.draw(v,p,k),v.profiler.recordBrushEnd()};return C}()})},"esri/views/2d/engine/webgl/Profiler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),
function(u,G,F,C,y,v,p){const k=y("esri-2d-profiler");y=function(){function b(f,c){this._events=new C;this._entries=new Map;this._timings=new F(10);if(k){this._ext=p.createDisjointTimerQuery(f.gl,{});this._debugOutput=c;var h=f.gl;if(this.enableCommandLogging)for(const l in h)if("function"===typeof h[l]){const q=h[l],e=-1!==l.indexOf("draw");h[l]=(...d)=>{this._events.emit("command",{container:this._currentContainer,pass:this._currentPass,brush:this._currentBrush,method:l,args:d,isDrawCommand:e});
this._currentSummary&&(this._currentSummary.commands++,e&&this._currentSummary.drawCommands++);return q.apply(h,d)}}}}var a=b.prototype;a.recordContainerStart=function(f){k&&(this._currentContainer=f)};a.recordContainerEnd=function(){k&&(this._currentContainer=null)};a.recordPassStart=function(f){k&&(this._currentPass=f,this._initSummary())};a.recordPassEnd=function(){k&&(this._currentPass=null,this._emitSummary())};a.recordBrushStart=function(f){k&&(this._currentBrush=f)};a.recordBrushEnd=function(){k&&
(this._currentBrush=null)};a.recordStart=function(f){if(k&&v.isSome(this._ext)){if(this._entries.has(f)){const e=this._entries.get(f);var c=this._ext.resultAvailable(e.query),h=this._ext.disjoint();if(c&&!h){c=this._ext.getResult(e.query)/1E6;h=0;if(v.isSome(this._timings.enqueue(c))){h=this._timings.entries;const d=h.length;let g=0;for(var l of h)g+=l;h=g/d}l=c.toFixed(2);c=h?h.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed(`Frame report for ${f}, ${l} ms (${c} last 10 avg)\n${e.commandsLen} Commands (${e.drawCommands} draw)`),
console.log("RenderPass breakdown: "),console.table(e.summaries),console.log("Commands: ",e.commands),console.groupEnd()):console.log(`Frame report for ${f}, ${l} ms (${c} last 10 avg)`);this._debugOutput.innerHTML=`${l} (${c})`}for(const d of e.handles)d.remove();this._entries.delete(f)}const q={name:f,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(q.handles.push(this._events.on("command",e=>{q.commandsLen++;q.commands.push(e);
e.isDrawCommand&&q.drawCommands++})),q.handles.push(this._events.on("summary",e=>{q.summaries.push(e)})));this._ext.beginTimeElapsed(q.query);this._entries.set(f,q)}};a.recordEnd=function(f){k&&v.isSome(this._ext)&&this._entries.has(f)&&this._ext.endTimeElapsed()};a._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};a._emitSummary=function(){this.enableCommandLogging&&this._events.emit("summary",
this._currentSummary)};G._createClass(b,[{key:"enableCommandLogging",get:function(){return!("object"===typeof k&&k.disableCommands)}}]);return b}();u.Profiler=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(u,G){return function(){function F(y){this._start=this.size=0;this.maxSize=y;this._buffer=Array(y)}var C=F.prototype;C.enqueue=function(y){if(this.size===this.maxSize){const v=this._buffer[this._start];
this._buffer[this._start]=y;this._start=(this._start+1)%this.maxSize;return v}this._buffer[(this._start+this.size++)%this.maxSize]=y;return null};C.dequeue=function(){if(0===this.size)return null;const y=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return y};C.peek=function(){return 0===this.size?null:this._buffer[this._start]};C.find=function(y){if(0===this.size)return null;for(const v of this._buffer)if(G.isSome(v)&&y(v))return v;
return null};C.clear=function(y){let v=this.dequeue();for(;G.isSome(v);)y&&y(v),v=this.dequeue()};u._createClass(F,[{key:"entries",get:function(){return this._buffer}}]);return F}()})},"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["exports","./isWebGL2Context"],function(u,G){let F=function(C,y,v,p,k,b,a,f){this.createQuery=C;this.resultAvailable=y;this.getResult=v;this.disjoint=p;this.beginTimeElapsed=k;this.endTimeElapsed=b;this.createTimestamp=a;this.timestampBits=f};u.DisjointTimerQuery=
F;u.createDisjointTimerQuery=function(C,y){if(y.disjointTimerQuery)return null;let v=C.getExtension("EXT_disjoint_timer_query_webgl2");return v&&G(C)?new F(()=>C.createQuery(),p=>C.getQueryParameter(p,C.QUERY_RESULT_AVAILABLE),p=>C.getQueryParameter(p,C.QUERY_RESULT),()=>C.getParameter(v.GPU_DISJOINT_EXT),p=>C.beginQuery(v.TIME_ELAPSED_EXT,p),()=>C.endQuery(v.TIME_ELAPSED_EXT),p=>v.queryCounterEXT(p,v.TIMESTAMP_EXT),()=>C.getQuery(v.TIMESTAMP_EXT,v.QUERY_COUNTER_BITS_EXT)):(v=C.getExtension("EXT_disjoint_timer_query"))?
new F(()=>v.createQueryEXT(),p=>v.getQueryObjectEXT(p,v.QUERY_RESULT_AVAILABLE_EXT),p=>v.getQueryObjectEXT(p,v.QUERY_RESULT_EXT),()=>C.getParameter(v.GPU_DISJOINT_EXT),p=>v.beginQueryEXT(v.TIME_ELAPSED_EXT,p),()=>v.endQueryEXT(v.TIME_ELAPSED_EXT),p=>v.queryCounterEXT(p,v.TIMESTAMP_EXT),()=>v.getQueryEXT(v.TIMESTAMP_EXT,v.QUERY_COUNTER_BITS_EXT)):null};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["exports","./sources/resolver"],
function(u,G){G={shaders:{vertexShader:G.resolveIncludes("stencil/stencil.vert"),fragmentShader:G.resolveIncludes("stencil/stencil.frag")},attributes:new Map([["a_pos",0]])};u.stencil=G;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/webgl/RenderingContext":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ./checkWebGLError ./enums ./InstanceCounter ./renderState ./Texture ./WebGLDriverTest ./capabilities/isWebGL2Context ./capabilities/load".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f){function c(q,e,d,g){e?g!==e&&q.bindBuffer(d,e.glName):q.bindBuffer(d,null);return e}function h(q,e){switch(q){case 0:return 2*e;case 4:return e/3;case 5:return e-2;case 6:return e-2;default:return 0}}let l=function(){function q(d,g){this.gl=d;this.instanceCounter=new v.InstanceCounter;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};
this._colorMaskState={r:!0,g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=
1;this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680};this._clearColor={r:0,g:0,b:0,a:0};this._activeRenderbuffer=this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap=[];this._numOfTriangles=this._numOfDrawCalls=0;this.webglVersion=a(d)?"webgl2":"webgl";"webgl"===this.webglVersion&&this.gl.getExtension("OES_element_index_uint");this._capabilities=f.loadCapabilities(d,g);this._parameters=
this._loadParameters(g);d=this.gl.getParameter(this.gl.VIEWPORT);this._viewport={x:d[0],y:d[1],width:d[2],height:d[3]};this._stateTracker=new p.StateTracker({setBlending:m=>{m?(this.setBlendingEnabled(!0),this.setBlendEquationSeparate(m.opRgb,m.opAlpha),this.setBlendFunctionSeparate(m.srcRgb,m.dstRgb,m.srcAlpha,m.dstAlpha),m=m.color,this.setBlendColor(m.r,m.g,m.b,m.a)):this.setBlendingEnabled(!1)},setCulling:m=>{m?(this.setFaceCullingEnabled(!0),this.setCullFace(m.face),this.setFrontFace(m.mode)):
this.setFaceCullingEnabled(!1)},setPolygonOffset:m=>{m?(this.setPolygonOffsetFillEnabled(!0),this.setPolygonOffset(m.factor,m.units)):this.setPolygonOffsetFillEnabled(!1)},setDepthTest:m=>{m?(this.setDepthTestEnabled(!0),this.setDepthFunction(m.func)):this.setDepthTestEnabled(!1)},setStencilTest:m=>{if(m){this.setStencilTestEnabled(!0);const n=m.function;this.setStencilFunction(n.func,n.ref,n.mask);m=m.operation;this.setStencilOp(m.fail,m.zFail,m.zPass)}else this.setStencilTestEnabled(!1)},setDepthWrite:m=>
{m?(this.setDepthWriteEnabled(!0),this.setDepthRange(m.zNear,m.zFar)):this.setDepthWriteEnabled(!1)},setColorWrite:m=>{m?this.setColorMask(m.r,m.g,m.b,m.a):this.setColorMask(!1,!1,!1,!1)},setStencilWrite:m=>{m?this.setStencilWriteMask(m.mask):this.setStencilWriteMask(0)}});this.enforceState();this.driverTest=new b.WebGLDriverTest(this)}var e=q.prototype;e.dispose=function(){this.bindVAO(null);this.unbindBuffer(34962);this.unbindBuffer(34963);this._textureUnitMap.length=0;C.webglDebugEnabled()&&this.instanceCounter.printResourceCount()};
e.setPipelineState=function(d){this._stateTracker.setPipeline(d)};e.setBlendingEnabled=function(d){this._blendEnabled!==d&&(!0===d?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=d,this._stateTracker.invalidateBlending())};e.externalProgramUpdate=function(){var d;null==(d=this._activeShaderProgram)?void 0:d.stop();this._activeShaderProgram=null};e.externalTextureUnitUpdate=function(d,g){for(let m=0;m<d.length;++m)this._textureUnitMap[d[m]]=null;0<=g&&(this._activeTextureUnit=
g)};e.externalVertexArrayObjectUpdate=function(){const d=this.capabilities.vao;d&&(d.bindVertexArray(null),this._activeVertexArrayObject=null);this._activeIndexBuffer=this._activeVertexBuffer=null};e.externalVertexBufferUpdate=function(){this._activeVertexBuffer=null};e.externalIndexBufferUpdate=function(){this._activeIndexBuffer=null};e.setBlendColor=function(d,g,m,n){if(d!==this._blendColorState.r||g!==this._blendColorState.g||m!==this._blendColorState.b||n!==this._blendColorState.a)this.gl.blendColor(d,
g,m,n),this._blendColorState.r=d,this._blendColorState.g=g,this._blendColorState.b=m,this._blendColorState.a=n,this._stateTracker.invalidateBlending()};e.setBlendFunction=function(d,g){if(d!==this._blendFunctionState.srcRGB||g!==this._blendFunctionState.dstRGB)this.gl.blendFunc(d,g),this._blendFunctionState.srcRGB=d,this._blendFunctionState.srcAlpha=d,this._blendFunctionState.dstRGB=g,this._blendFunctionState.dstAlpha=g,this._stateTracker.invalidateBlending()};e.setBlendFunctionSeparate=function(d,
g,m,n){if(this._blendFunctionState.srcRGB!==d||this._blendFunctionState.srcAlpha!==m||this._blendFunctionState.dstRGB!==g||this._blendFunctionState.dstAlpha!==n)this.gl.blendFuncSeparate(d,g,m,n),this._blendFunctionState.srcRGB=d,this._blendFunctionState.srcAlpha=m,this._blendFunctionState.dstRGB=g,this._blendFunctionState.dstAlpha=n,this._stateTracker.invalidateBlending()};e.setBlendEquation=function(d){this._blendEquationState.mode!==d&&(this.gl.blendEquation(d),this._blendEquationState.mode=d,
this._blendEquationState.modeAlpha=d,this._stateTracker.invalidateBlending())};e.setBlendEquationSeparate=function(d,g){if(this._blendEquationState.mode!==d||this._blendEquationState.modeAlpha!==g)this.gl.blendEquationSeparate(d,g),this._blendEquationState.mode=d,this._blendEquationState.modeAlpha=g,this._stateTracker.invalidateBlending()};e.setColorMask=function(d,g,m,n){if(this._colorMaskState.r!==d||this._colorMaskState.g!==g||this._colorMaskState.b!==m||this._colorMaskState.a!==n)this.gl.colorMask(d,
g,m,n),this._colorMaskState.r=d,this._colorMaskState.g=g,this._colorMaskState.b=m,this._colorMaskState.a=n,this._stateTracker.invalidateColorWrite()};e.setClearColor=function(d,g,m,n){if(this._clearColor.r!==d||this._clearColor.g!==g||this._clearColor.b!==m||this._clearColor.a!==n)this.gl.clearColor(d,g,m,n),this._clearColor.r=d,this._clearColor.g=g,this._clearColor.b=m,this._clearColor.a=n};e.setFaceCullingEnabled=function(d){this._polygonCullingEnabled!==d&&(!0===d?this.gl.enable(this.gl.CULL_FACE):
this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=d,this._stateTracker.invalidateCulling())};e.setPolygonOffsetFillEnabled=function(d){this._polygonOffsetFillEnabled!==d&&(!0===d?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=d,this._stateTracker.invalidatePolygonOffset())};e.setPolygonOffset=function(d,g){if(this._polygonOffset[0]!==d||this._polygonOffset[1]!==g)this._polygonOffset[0]=d,this._polygonOffset[1]=g,
this.gl.polygonOffset(d,g),this._stateTracker.invalidatePolygonOffset()};e.setCullFace=function(d){this._cullFace!==d&&(this.gl.cullFace(d),this._cullFace=d,this._stateTracker.invalidateCulling())};e.setFrontFace=function(d){this._frontFace!==d&&(this.gl.frontFace(d),this._frontFace=d,this._stateTracker.invalidateCulling())};e.setScissorTestEnabled=function(d){this._scissorTestEnabled!==d&&(!0===d?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=
d)};e.setScissorRect=function(d,g,m,n){if(this._scissorRect.x!==d||this._scissorRect.y!==g||this._scissorRect.width!==m||this._scissorRect.height!==n)this.gl.scissor(d,g,m,n),this._scissorRect.x=d,this._scissorRect.y=g,this._scissorRect.width=m,this._scissorRect.height=n};e.setDepthTestEnabled=function(d){this._depthTestEnabled!==d&&(!0===d?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=d,this._stateTracker.invalidateDepthTest())};e.setClearDepth=function(d){this._clearDepth!==
d&&(this.gl.clearDepth(d),this._clearDepth=d)};e.setDepthFunction=function(d){this._depthFunction!==d&&(this.gl.depthFunc(d),this._depthFunction=d,this._stateTracker.invalidateDepthTest())};e.setDepthWriteEnabled=function(d){this._depthWriteEnabled!==d&&(this.gl.depthMask(d),this._depthWriteEnabled=d,this._stateTracker.invalidateDepthWrite())};e.setDepthRange=function(d,g){if(this._depthRange.zNear!==d||this._depthRange.zFar!==g)this.gl.depthRange(d,g),this._depthRange.zNear=d,this._depthRange.zFar=
g,this._stateTracker.invalidateDepthWrite()};e.setStencilTestEnabled=function(d){this._stencilTestEnabled!==d&&(!0===d?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=d,this._stateTracker.invalidateStencilTest())};e.setClearStencil=function(d){d!==this._clearStencil&&(this.gl.clearStencil(d),this._clearStencil=d)};e.setStencilFunction=function(d,g,m){if(this._stencilFunction.func!==d||this._stencilFunction.ref!==g||this._stencilFunction.mask!==m)this.gl.stencilFunc(d,
g,m),this._stencilFunction.face=1032,this._stencilFunction.func=d,this._stencilFunction.ref=g,this._stencilFunction.mask=m,this._stateTracker.invalidateStencilTest()};e.setStencilFunctionSeparate=function(d,g,m,n){if(this._stencilFunction.face!==d||this._stencilFunction.func!==g||this._stencilFunction.ref!==m||this._stencilFunction.mask!==n)this.gl.stencilFuncSeparate(d,g,m,n),this._stencilFunction.face=d,this._stencilFunction.func=g,this._stencilFunction.ref=m,this._stencilFunction.mask=n,this._stateTracker.invalidateStencilTest()};
e.setStencilWriteMask=function(d){this._stencilWriteMask!==d&&(this.gl.stencilMask(d),this._stencilWriteMask=d,this._stateTracker.invalidateStencilWrite())};e.setStencilOp=function(d,g,m){if(this._stencilOperation.fail!==d||this._stencilOperation.zFail!==g||this._stencilOperation.zPass!==m)this.gl.stencilOp(d,g,m),this._stencilOperation.face=1032,this._stencilOperation.fail=d,this._stencilOperation.zFail=g,this._stencilOperation.zPass=m,this._stateTracker.invalidateStencilTest()};e.setStencilOpSeparate=
function(d,g,m,n){if(this._stencilOperation.face!==d||this._stencilOperation.fail!==g||this._stencilOperation.zFail!==m||this._stencilOperation.zPass!==n)this.gl.stencilOpSeparate(d,g,m,n),this._stencilOperation.face=d,this._stencilOperation.face=d,this._stencilOperation.fail=g,this._stencilOperation.zFail=m,this._stencilOperation.zPass=n,this._stateTracker.invalidateStencilTest()};e.setActiveTexture=function(d,g=!1){const m=this._activeTextureUnit;0<=d&&(g||d!==this._activeTextureUnit)&&(this.gl.activeTexture(y.BASE_TEXTURE_UNIT+
d),this._activeTextureUnit=d);return m};e.clear=function(d){d&&this.gl.clear(d)};e.clearSafe=function(d,g=255){d&&(d&16384&&this.setColorMask(!0,!0,!0,!0),d&256&&this.setDepthWriteEnabled(!0),d&1024&&this.setStencilWriteMask(g),this.gl.clear(d))};e.drawArrays=function(d,g,m){C.webglDebugEnabled()&&(this._numOfDrawCalls++,this._numOfTriangles+=h(d,m));this.gl.drawArrays(d,g,m)};e.drawElements=function(d,g,m,n){C.webglDebugEnabled()&&(this._numOfDrawCalls++,this._numOfTriangles+=h(d,g));this.gl.drawElements(d,
g,m,n)};e.logIno=function(){C.webglDebugEnabled()&&console.log(`DrawCalls: ${this._numOfDrawCalls}, Triangles: ${this._numOfTriangles}`)};e.setViewport=function(d,g,m,n){m=Math.max(Math.round(m),1);n=Math.max(Math.round(n),1);const r=this._viewport;if(r.x!==d||r.y!==g||r.width!==m||r.height!==n)r.x=d,r.y=g,r.width=m,r.height=n,this.gl.viewport(d,g,m,n)};e.getViewport=function(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}};e.useProgram=function(d){var g,
m;this._activeShaderProgram!==d&&(null==(g=this._activeShaderProgram)?void 0:g.stop(),this._activeShaderProgram=d,this.gl.useProgram(null!=(m=null==d?void 0:d.glName)?m:null))};e.bindTexture=function(d,g,m=!1){(g>=this.parameters.maxTextureImageUnits||0>g)&&console.error("Input texture unit is out of range of available units!");const n=this._textureUnitMap[g];if(F.isNone(d)||null==d.glName)return F.isSome(n)&&(this.setActiveTexture(g,m),this.gl.bindTexture(n.descriptor.target,null)),this._textureUnitMap[g]=
null,n;if(!m&&n===d)return d.isDirty&&(this.setActiveTexture(g,m),d.applyChanges()),n;this.setActiveTexture(g,m);this.gl.bindTexture(d.descriptor.target,d.glName);d.applyChanges();this._textureUnitMap[g]=d;return n};e.unbindTextureAllUnits=function(d){for(let g=0;g<this.parameters.maxTextureImageUnits;g++)this._textureUnitMap[g]===d&&(this.bindTexture(null,g),this._textureUnitMap[g]=null)};e.bindFramebuffer=function(d,g=!1,m=3553){if(F.isNone(d))this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this._activeFramebuffer=
null;else if(g||this._activeFramebuffer!==d)d.initializeAndBind(m),this._activeFramebuffer=d};e.bindBuffer=function(d){d&&(34962===d.bufferType?this._activeVertexBuffer=c(this.gl,d,d.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=c(this.gl,d,d.bufferType,this._activeIndexBuffer))};e.bindRenderbuffer=function(d){const g=this.gl;d||(g.bindRenderbuffer(g.RENDERBUFFER,null),this._activeRenderbuffer=null);this._activeRenderbuffer!==d&&(g.bindRenderbuffer(g.RENDERBUFFER,d.glName),this._activeRenderbuffer=
d)};e.unbindBuffer=function(d){34962===d?this._activeVertexBuffer=c(this.gl,null,d,this._activeVertexBuffer):this._activeIndexBuffer=c(this.gl,null,d,this._activeIndexBuffer)};e.bindVAO=function(d=null){F.isNone(d)?this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null):this._activeVertexArrayObject!==d&&(d.bind(),this._activeVertexArrayObject=d)};e.getBoundFramebufferObject=function(){return this._activeFramebuffer};e.getBoundVAO=function(){return this._activeVertexArrayObject};
e.resetState=function(){this.useProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);this.unbindBuffer(34963);for(let d=0;d<this.parameters.maxTextureImageUnits;++d)this.bindTexture(null,d);this.setBlendingEnabled(!1);this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);
this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};e.enforceState=function(){var d,
g,m,n;const r=this.gl;var t=this.capabilities.vao;t&&t.bindVertexArray(null);for(let z=0;z<this.parameters.maxVertexAttributes;z++)r.disableVertexAttribArray(z);this._activeVertexBuffer?r.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):r.bindBuffer(34962,null);this._activeIndexBuffer?r.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):r.bindBuffer(34963,null);if(t&&this._activeVertexArrayObject){if(t=this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),
this._activeVertexArrayObject=null;this.bindVAO(t)}r.bindFramebuffer(r.FRAMEBUFFER,null!=(d=null==(g=this._activeFramebuffer)?void 0:g.glName)?d:null);r.useProgram(null!=(m=null==(n=this._activeShaderProgram)?void 0:n.glName)?m:null);r.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);r.bindRenderbuffer(r.RENDERBUFFER,this._activeRenderbuffer?this._activeRenderbuffer.glName:null);!0===this._blendEnabled?r.enable(this.gl.BLEND):r.disable(this.gl.BLEND);
r.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);r.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);r.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);r.clearDepth(this._clearDepth);r.clearStencil(this._clearStencil);r.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);
r.cullFace(this._cullFace);r.depthFunc(this._depthFunction);r.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST);r.depthMask(this._depthWriteEnabled);r.frontFace(this._frontFace);r.lineWidth(1);!0===this._polygonCullingEnabled?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE);r.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?r.enable(r.POLYGON_OFFSET_FILL):r.disable(r.POLYGON_OFFSET_FILL);
r.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?r.enable(r.SCISSOR_TEST):r.disable(r.SCISSOR_TEST);r.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask);r.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST);r.stencilMask(this._stencilWriteMask);
for(d=0;d<this.parameters.maxTextureImageUnits;d++)r.activeTexture(y.BASE_TEXTURE_UNIT+d),r.bindTexture(3553,null),r.bindTexture(34067,null),a(r)&&r.bindTexture(32879,null),g=this._textureUnitMap[d],F.isSome(g)&&r.bindTexture(g.descriptor.target,g.glName);r.activeTexture(y.BASE_TEXTURE_UNIT+this._activeTextureUnit);r.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height);C.webglDebugEnabled()&&(this._numOfTriangles=this._numOfDrawCalls=0)};e._loadParameters=function(d){var g;
const m=this.capabilities.textureFilterAnisotropic;d=null!=(g=d.maxAnisotropy)?g:Infinity;g={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:m?Math.min(this.gl.getParameter(m.MAX_TEXTURE_MAX_ANISOTROPY),d):1,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)};
k.TEXTURE_UNIT_FOR_UPDATES=g.maxTextureImageUnits-1;return g};G._createClass(q,[{key:"contextAttributes",get:function(){return this.gl.getContextAttributes()}},{key:"parameters",get:function(){return this._parameters}},{key:"capabilities",get:function(){return this._capabilities}}]);return q}();u.RenderingContext=l;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/webgl/InstanceCounter":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../support/AllocationTracer",
"./enums"],function(u,G,F,C){let y=function(){function v(){this._current=[];this._max=[];for(this._allocations=new F.AllocationTracer(!1);this._current.length<C.ResourceType.COUNT;)this._current.push(0),this._max.push(0)}var p=v.prototype;p.resetMax=function(){for(this._max.length=0;this._max.length<this._current.length;)this._max.push(0)};p.increment=function(k,b){const a=++this._current[k];this._max[k]=Math.max(a,this._max[k]);this._allocations.add(b)};p.decrement=function(k,b){--this._current[k];
this._allocations.remove(b)};p.printResourceCount=function(){if(0<this.total){console.log("Live objects:");for(let k=0;k<C.ResourceType.COUNT;++k){const b=this._current[k];0<b&&console.log(`${C.ResourceType[k]}: ${b}`)}}this._allocations.print()};G._createClass(v,[{key:"max",get:function(){return this._max}},{key:"current",get:function(){return this._current}},{key:"total",get:function(){return this.current.reduce((k,b)=>k+b,0)}}]);return v}();u.InstanceCounter=y;Object.defineProperty(u,"__esModule",
{value:!0})})},"esri/views/support/AllocationTracer":function(){define(["exports"],function(u){let G=function(){function F(y){this._allocations=new Map;y?Error.stackTraceLimit=Infinity:(this.add=()=>{},this.remove=()=>{})}var C=F.prototype;C.add=function(y){this._allocations.set(y,Error().stack)};C.remove=function(y){this._allocations.delete(y)};C.print=function(){if(0<this._allocations.size){console.log(`${this._allocations.size} live object allocations:`);const y=new Map;this._allocations.forEach(v=>
{var p;y.set(v,(null!=(p=y.get(v))?p:0)+1)});y.forEach((v,p)=>{p=p.split("\n");p.shift();p.shift();console.log(`${v}: ${p.shift()}`);p.forEach(k=>console.log("   ",k))})}};return F}();u.AllocationTracer=G;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/webgl/renderState":function(){define(["exports"],function(u){function G(H){return t.intern(H)}function F(H){return z.intern(H)}function C(H){return w.intern(H)}function y(H){return B.intern(H)}function v(H){return A.intern(H)}function p(H){return x.intern(H)}
function k(H){return E.intern(H)}function b(H){return D.intern(H)}function a(H){return"["+H.join(",")+"]"}function f(H){return H?a([H.srcRgb,H.srcAlpha,H.dstRgb,H.dstAlpha,H.opRgb,H.opAlpha,H.color.r,H.color.g,H.color.b,H.color.a]):null}function c(H){return H?a([H.face,H.mode]):null}function h(H){return H?a([H.factor,H.units]):null}function l(H){return H?a([H.func]):null}function q(H){return H?a([H.function.func,H.function.ref,H.function.mask,H.operation.fail,H.operation.zFail,H.operation.zPass]):
null}function e(H){return H?a([H.zNear,H.zFar]):null}function d(H){return H?a([H.r,H.g,H.b,H.a]):null}function g(H){return H?a([H.mask]):null}const m={face:1029,mode:2305},n={face:1028,mode:2305};var r=function(){function H(I,J){this.makeKey=I;this.makeRef=J;this.interns=new Map}H.prototype.intern=function(I){if(!I)return null;const J=this.makeKey(I),M=this.interns;M.has(J)||M.set(J,this.makeRef(I));return M.get(J)};return H}();const t=new r(f,H=>({__tag:"Blending",...H})),z=new r(c,H=>({__tag:"Culling",
...H})),w=new r(h,H=>({__tag:"PolygonOffset",...H})),B=new r(l,H=>({__tag:"DepthTest",...H})),A=new r(q,H=>({__tag:"StencilTest",...H})),x=new r(e,H=>({__tag:"DepthWrite",...H})),E=new r(d,H=>({__tag:"ColorWrite",...H})),D=new r(g,H=>({__tag:"StencilWrite",...H})),K=new r(function(H){return H?a([f(H.blending),c(H.culling),h(H.polygonOffset),l(H.depthTest),q(H.stencilTest),e(H.depthWrite),d(H.colorWrite),g(H.stencilWrite)]):null},H=>({blending:G(H.blending),culling:F(H.culling),polygonOffset:C(H.polygonOffset),
depthTest:y(H.depthTest),stencilTest:v(H.stencilTest),depthWrite:p(H.depthWrite),colorWrite:k(H.colorWrite),stencilWrite:b(H.stencilWrite)}));r=function(){function H(J){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=this._stencilTestInvalid=this._depthTestInvalid=this._polygonOffsetInvalid=this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=J}var I=H.prototype;I.setPipeline=function(J){if(this._pipelineInvalid||J!==this._pipeline)this.setBlending(J.blending),
this.setCulling(J.culling),this.setPolygonOffset(J.polygonOffset),this.setDepthTest(J.depthTest),this.setStencilTest(J.stencilTest),this.setDepthWrite(J.depthWrite),this.setColorWrite(J.colorWrite),this.setStencilWrite(J.stencilWrite),this._pipeline=J;this._pipelineInvalid=!1};I.invalidateBlending=function(){this._pipelineInvalid=this._blendingInvalid=!0};I.invalidateCulling=function(){this._pipelineInvalid=this._cullingInvalid=!0};I.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=
!0};I.invalidateDepthTest=function(){this._pipelineInvalid=this._depthTestInvalid=!0};I.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};I.invalidateDepthWrite=function(){this._pipelineInvalid=this._depthWriteInvalid=!0};I.invalidateColorWrite=function(){this._pipelineInvalid=this._colorWriteInvalid=!0};I.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};I.setBlending=function(J){this._blending=this.setSubState(J,this._blending,
this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=!1};I.setCulling=function(J){this._culling=this.setSubState(J,this._culling,this._cullingInvalid,this._stateSetters.setCulling);this._cullingInvalid=!1};I.setPolygonOffset=function(J){this._polygonOffset=this.setSubState(J,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};I.setDepthTest=function(J){this._depthTest=this.setSubState(J,this._depthTest,this._depthTestInvalid,
this._stateSetters.setDepthTest);this._depthTestInvalid=!1};I.setStencilTest=function(J){this._stencilTest=this.setSubState(J,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};I.setDepthWrite=function(J){this._depthWrite=this.setSubState(J,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};I.setColorWrite=function(J){this._colorWrite=this.setSubState(J,this._colorWrite,this._colorWriteInvalid,
this._stateSetters.setColorWrite);this._colorWriteInvalid=!1};I.setStencilWrite=function(J){this._stencilWrite=this.setSubState(J,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=!1};I.setSubState=function(J,M,O,L){if(O||J!==M)L(J),this._pipelineInvalid=!0;return J};return H}();u.StateTracker=r;u.backFaceCullingParams=m;u.cullingParams=H=>2===H?m:1===H?n:null;u.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};u.defaultDepthWriteParams={zNear:0,
zFar:1};u.frontFaceCullingParams=n;u.makeBlending=G;u.makeColorWrite=k;u.makeCulling=F;u.makeDepthTest=y;u.makeDepthWrite=p;u.makePipelineState=function(H){return K.intern(H)};u.makePolygonOffset=C;u.makeStencilTest=v;u.makeStencilWrite=b;u.separateBlendingParams=function(H,I,J,M,O=32774,L=32774,S=[0,0,0,0]){return{srcRgb:H,srcAlpha:I,dstRgb:J,dstAlpha:M,opRgb:O,opAlpha:L,color:{r:S[0],g:S[1],b:S[2],a:S[3]}}};u.simpleBlendingParams=function(H,I,J=32774,M=[0,0,0,0]){return{srcRgb:H,srcAlpha:H,dstRgb:I,
dstAlpha:I,opRgb:J,opAlpha:J,color:{r:M[0],g:M[1],b:M[2],a:M[3]}}};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/webgl/WebGLDriverTest":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ./testDoublePrecisionArithmetic ./testFloatBufferBlend ./testSamplerPrecision ./testSVGPremultipliedAlpha".split(" "),function(u,G,F,C,y,v,p){let k=function(){function b(a){this.context=a;this._floatBufferBlendWorking=y.testFloatBufferBlend(a);p.testSVGPremultipliedAlpha(a).then(f=>
this._svgAlwaysPremultipliesAlpha=!f)}G._createClass(b,[{key:"floatBufferBlendWorking",get:function(){if(F.isNone(this._floatBufferBlendWorking))throw Error("floatBufferBlendWorking test not yet available");return this._floatBufferBlendWorking}},{key:"svgAlwaysPremultipliesAlpha",get:function(){if(F.isNone(this._svgAlwaysPremultipliesAlpha))throw Error("svgAlwaysPremultipliesAlpha test not yet available");return this._svgAlwaysPremultipliesAlpha}},{key:"doublePrecisionRequiresObfuscation",get:function(){if(F.isNone(this._doublePrecisionRequiresObfuscation)){const a=
C.testDoublePrecisionArithmetic(this.context,!1),f=C.testDoublePrecisionArithmetic(this.context,!0);this._doublePrecisionRequiresObfuscation=0!==a&&(0===f||5<a/f)}return this._doublePrecisionRequiresObfuscation}},{key:"ignoresSamplerPrecision",get:function(){F.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=v.testSamplerPrecision(this.context));return this._ignoresSamplerPrecision}}]);return b}();u.WebGLDriverTest=k;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/webgl/testDoublePrecisionArithmetic":function(){define("exports ../../core/floatRGBA ../../chunks/vec3f64 ./BufferObject ./doublePrecisionUtils ./FramebufferObject ./Program ./VertexArrayObject".split(" "),
function(u,G,F,C,y,v,p,k){u.testDoublePrecisionArithmetic=function(b,a){var f=new v(b,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1});const c=C.createVertex(b,35044,new Uint16Array([0,0,1,0,0,1,1,1])),h=new k(b,new Map([["position",0]]),{geometry:[{name:"position",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:c}),l=F.fromValues(5633261.287538229,2626832.878767164,1434988.0495278358),q=F.fromValues(5633271.46742708,
2626873.6381334523,1434963.231608387);a=new p.Program(b,`\n\n  precision highp float;\n\n  attribute vec2 position;\n\n  uniform vec3 u_highA;\n  uniform vec3 u_lowA;\n  uniform vec3 u_highB;\n  uniform vec3 u_lowB;\n\n  varying vec4 v_color;\n\n  ${a?"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION":""}\n\n  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION\n\n  vec3 dpPlusFrc(vec3 a, vec3 b) {\n    return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n  }\n\n  vec3 dpMinusFrc(vec3 a, vec3 b) {\n    return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n  }\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = dpPlusFrc(hiA, hiB);\n    vec3 e = dpMinusFrc(t1, hiA);\n    vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n    return t1 + t2;\n  }\n\n  #else\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = hiA + hiB;\n    vec3 e = t1 - hiA;\n    vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n    return t1 + t2;\n  }\n\n  #endif\n\n  const float MAX_RGBA_FLOAT =\n    255.0 / 256.0 +\n    255.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n  const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n  vec4 float2rgba(const float value) {\n    // Make sure value is in the domain we can represent\n    float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n    // Decompose value in 32bit fixed point parts represented as\n    // uint8 rgba components. Decomposition uses the fractional part after multiplying\n    // by a power of 256 (this removes the bits that are represented in the previous\n    // component) and then converts the fractional part to 8bits.\n    vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n    // Convert uint8 values (from 0 to 255) to floating point representation for\n    // the shader\n    const float toU8AsFloat = 1.0 / 255.0;\n\n    return fixedPointU8 * toU8AsFloat;\n  }\n\n  void main() {\n    vec3 val = dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);\n\n    v_color = float2rgba(val.z / 25.0);\n\n    gl_Position = vec4(position * 2.0 - 1.0, 0.0, 1.0);\n  }\n  `,
"\n  precision highp float;\n\n  varying vec4 v_color;\n\n  void main() {\n    gl_FragColor \x3d v_color;\n  }\n  ",new Map([["position",0]]));var e=new Float32Array(6);y.encodeDoubleArray(l,e,3);var d=new Float32Array(6);y.encodeDoubleArray(q,d,3);b.useProgram(a);a.setUniform3f("u_highA",e[0],e[2],e[4]);a.setUniform3f("u_lowA",e[1],e[3],e[5]);a.setUniform3f("u_highB",d[0],d[2],d[4]);a.setUniform3f("u_lowB",d[1],d[3],d[5]);e=a;d=b.getBoundFramebufferObject();const {x:g,y:m,width:n,height:r}=b.getViewport();
b.bindFramebuffer(f);b.setViewport(0,0,1,1);b.bindVAO(h);b.drawArrays(5,0,4);a=new Uint8Array(4);f.readPixels(0,0,1,1,6408,5121,a);e.dispose();h.dispose(!1);c.dispose();f.dispose();b.setViewport(g,m,n,r);b.bindFramebuffer(d);b=(l[2]-q[2])/25;f=G.unpackFloatRGBA(a);return Math.abs(b-f)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/webgl/doublePrecisionUtils":function(){define(["exports"],function(u){function G(y,v,p){for(let k=0;k<p;++k)v[2*k]=y[k],v[2*k+1]=y[k]-v[2*k]}const F=new Float64Array(1),
C=new Float32Array(2);u.decodeDoubleArray=function(y,v,p){for(let k=0;k<p;++k)v[k]=y[2*k]+y[2*k+1]};u.encodeDouble=function(y,v){C[0]=y;C[1]=y-C[0];v[0]=C[0];v[1]=C[1]};u.encodeDoubleArray=G;u.encodeDoubleArraySplit=function(y,v,p,k){for(let b=0;b<k;++b)F[0]=y[b],G(F,C,1),v[b]=C[0],p[b]=C[1]};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/webgl/testFloatBufferBlend":function(){define("exports ../3d/webgl-engine/lib/OrderIndependentTransparency ./BufferObject ./FramebufferObject ./Program ./renderState ./VertexArrayObject".split(" "),
function(u,G,F,C,y,v,p){var k={exports:{}};(function(b){(function(a){a=a();void 0!==a&&(b.exports=a)})(function(){function a(n){if(null==g){g={};m={};for(var r in n)"number"==typeof n[r]&&(g[n[r]]=r,m[r]=n[r])}}function f(){if(null==g)throw"WebGLDebugUtils.init(ctx) not called";}function c(n){f();var r=g[n];return void 0!==r?"gl."+r:"/*UNKNOWN WebGL ENUM*/ 0x"+n.toString(16)}function h(n,r,t,z){n=d[n];if(void 0!==n&&(n=n[r],void 0!==n&&n[t])){if("object"===typeof n[t]&&void 0!==n[t].enumBitwiseOr){r=
n[t].enumBitwiseOr;t=0;n=[];for(var w=0;w<r.length;++w){var B=m[r[w]];0!==(z&B)&&(t|=B,n.push(c(B)))}return t===z?n.join(" | "):c(z)}return c(z)}return null===z?"null":void 0===z?"undefined":z.toString()}function l(n,r,t){n.__defineGetter__(t,function(){return r[t]});n.__defineSetter__(t,function(z){r[t]=z})}function q(n,r,t,z){function w(D,K){return function(){t&&t(K,arguments);var H=D[K].apply(D,arguments),I=z.getError();0!=I&&(B[I]=!0,r(I,K,arguments));return H}}z=z||n;a(n);r=r||function(D,K,H){for(var I=
"",J=H.length,M=0;M<J;++M)I+=(0==M?"":", ")+h(K,J,M,H[M]);D="WebGL error "+c(D)+" in "+K+"("+I+")";window.console&&window.console.error?window.console.error(D):window.console&&window.console.log&&window.console.log(D)};var B={},A={},x;for(x in n)if("function"==typeof n[x])if("getExtension"!=x)A[x]=w(n,x);else{var E=w(n,x);A[x]=function(){var D=E.apply(n,arguments);return q(D,r,t,z)}}else l(A,n,x);A.getError=function(){for(var D in B)if(B.hasOwnProperty(D)&&B[D])return B[D]=!1,D;return n.NO_ERROR};
return A}function e(n){var r=n.getParameter(n.MAX_VERTEX_ATTRIBS),t=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,t);for(var z=0;z<r;++z)n.disableVertexAttribArray(z),n.vertexAttribPointer(z,4,n.FLOAT,!1,0,0),n.vertexAttrib1f(z,0);n.deleteBuffer(t);r=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS);for(z=0;z<r;++z)n.activeTexture(n.TEXTURE0+z),n.bindTexture(n.TEXTURE_CUBE_MAP,null),n.bindTexture(n.TEXTURE_2D,null);n.activeTexture(n.TEXTURE0);n.useProgram(null);n.bindBuffer(n.ARRAY_BUFFER,null);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,
null);n.bindFramebuffer(n.FRAMEBUFFER,null);n.bindRenderbuffer(n.RENDERBUFFER,null);n.disable(n.BLEND);n.disable(n.CULL_FACE);n.disable(n.DEPTH_TEST);n.disable(n.DITHER);n.disable(n.SCISSOR_TEST);n.blendColor(0,0,0,0);n.blendEquation(n.FUNC_ADD);n.blendFunc(n.ONE,n.ZERO);n.clearColor(0,0,0,0);n.clearDepth(1);n.clearStencil(-1);n.colorMask(!0,!0,!0,!0);n.cullFace(n.BACK);n.depthFunc(n.LESS);n.depthMask(!0);n.depthRange(0,1);n.frontFace(n.CCW);n.hint(n.GENERATE_MIPMAP_HINT,n.DONT_CARE);n.lineWidth(1);
n.pixelStorei(n.PACK_ALIGNMENT,4);n.pixelStorei(n.UNPACK_ALIGNMENT,4);n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);n.UNPACK_COLORSPACE_CONVERSION_WEBGL&&n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.BROWSER_DEFAULT_WEBGL);n.polygonOffset(0,0);n.sampleCoverage(1,!1);n.scissor(0,0,n.canvas.width,n.canvas.height);n.stencilFunc(n.ALWAYS,0,4294967295);n.stencilMask(4294967295);n.stencilOp(n.KEEP,n.KEEP,n.KEEP);n.viewport(0,0,n.canvas.width,n.canvas.height);
for(n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT|n.STENCIL_BUFFER_BIT);n.getError(););}var d={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},
texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},
bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,
1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},g=null,m=null;return{init:a,mightBeEnum:function(n){f();return void 0!==g[n]},glEnumToString:c,glFunctionArgToString:h,glFunctionArgsToString:function(n,r){for(var t="",z=r.length,
w=0;w<z;++w)t+=(0==w?"":", ")+h(n,z,w,r[w]);return t},makeDebugContext:q,makeLostContextSimulatingCanvas:function(n){function r(P){return"function"==typeof P?P:function(R){P.handleEvent(R)}}function t(){for(var P=Object.keys(Q),R=0;R<P.length;++R)delete Q[P]}function z(){++O;I||M==O&&n.loseContext()}function w(P,R){var N=P[R];return function(){z();if(!I)return N.apply(P,arguments)}}function B(P){return{statusMessage:P,preventDefault:function(){L=!0}}}function A(P){for(var R in P)"function"==typeof P[R]?
K[R]=w(P,R):l(K,P,R);K.getError=function(){z();if(!I)for(var X;X=x.getError();)Q[X]=!0;for(X in Q)if(Q[X])return delete Q[X],X;return K.NO_ERROR};var N="createBuffer createFramebuffer createProgram createRenderbuffer createShader createTexture".split(" ");for(R=0;R<N.length;++R){var W=N[R];K[W]=function(X){return function(){z();if(I)return null;var T=X.apply(P,arguments);T.__webglDebugContextLostId__=H;J.push(T);return T}}(P[W])}N="getActiveAttrib getActiveUniform getBufferParameter getContextAttributes getAttachedShaders getFramebufferAttachmentParameter getParameter getProgramParameter getProgramInfoLog getRenderbufferParameter getShaderParameter getShaderInfoLog getShaderSource getTexParameter getUniform getUniformLocation getVertexAttrib".split(" ");
for(R=0;R<N.length;++R)W=N[R],K[W]=function(X){return function(){z();return I?null:X.apply(P,arguments)}}(K[W]);N="isBuffer isEnabled isFramebuffer isProgram isRenderbuffer isShader isTexture".split(" ");for(R=0;R<N.length;++R)W=N[R],K[W]=function(X){return function(){z();return I?!1:X.apply(P,arguments)}}(K[W]);K.checkFramebufferStatus=function(X){return function(){z();return I?K.FRAMEBUFFER_UNSUPPORTED:X.apply(P,arguments)}}(K.checkFramebufferStatus);K.getAttribLocation=function(X){return function(){z();
return I?-1:X.apply(P,arguments)}}(K.getAttribLocation);K.getVertexAttribOffset=function(X){return function(){z();return I?0:X.apply(P,arguments)}}(K.getVertexAttribOffset);K.isContextLost=function(){return I};return K}var x,E=[],D=[];var K={};var H=1,I=!1,J=[],M=0,O=0,L=!1,S=0,Q={};n.getContext=function(P){return function(){var R=P.apply(n,arguments);if(R instanceof WebGLRenderingContext){if(R!=x){if(x)throw"got different context";x=R;K=A(x)}return K}return R}}(n.getContext);(function(P){var R=P.addEventListener;
P.addEventListener=function(N,W,X){switch(N){case "webglcontextlost":E.push(r(W));break;case "webglcontextrestored":D.push(r(W));break;default:R.apply(P,arguments)}}})(n);n.loseContext=function(){if(!I){I=!0;M=0;for(++H;x.getError(););t();Q[x.CONTEXT_LOST_WEBGL]=!0;var P=B("context lost"),R=E.slice();setTimeout(function(){for(var N=0;N<R.length;++N)R[N](P);0<=S&&setTimeout(function(){n.restoreContext()},S)},0)}};n.restoreContext=function(){I&&D.length&&setTimeout(function(){if(!L)throw"can not restore. webglcontestlost listener did not call event.preventDefault";
for(var P=0;P<J.length;++P){var R=J[P];R instanceof WebGLBuffer?x.deleteBuffer(R):R instanceof WebGLFramebuffer?x.deleteFramebuffer(R):R instanceof WebGLProgram?x.deleteProgram(R):R instanceof WebGLRenderbuffer?x.deleteRenderbuffer(R):R instanceof WebGLShader?x.deleteShader(R):R instanceof WebGLTexture&&x.deleteTexture(R)}e(x);I=!1;O=0;L=!1;P=D.slice();R=B("context restored");for(var N=0;N<P.length;++N)P[N](R)},0)};n.loseContextInNCalls=function(P){if(I)throw"You can not ask a lost contet to be lost";
M=O+P};n.getNumCalls=function(){return O};n.setRestoreTimeout=function(P){S=P};return n},resetToInitialState:e}})})(k);u.testFloatBufferBlend=function(b){var a,f,c;if(!b.gl)return!1;if("webgl"===b.webglVersion){var h,l;return(null==(h=b.capabilities.textureFloat)?void 0:h.textureFloat)&&(null==(l=b.capabilities.colorBufferFloat)?void 0:l.textureFloat)}if(!((null==(a=b.capabilities.textureFloat)?0:a.textureFloat)&&(null==(f=b.capabilities.colorBufferFloat)?0:f.textureFloat)&&(null==(c=b.capabilities.colorBufferFloat)?
0:c.floatBlend)))return!1;a=new C(b,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5126,internalFormat:34836,samplingMode:9728,width:1,height:1});f=F.createVertex(b,35044,new Uint16Array([0,0,1,0,0,1,1,1]));c=new p(b,new Map([["a_pos",0]]),{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:f});h=new y.Program(b,"\n  precision highp float;\n  attribute vec2 a_pos;\n\n  void main() {\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ",
"\n   precision highp float;\n\n   void main() {\n    gl_FragColor \x3d vec4(0.5, 0.5, 0.5, 0.5);\n   }\n  ",new Map([["a_pos",0]]));b.useProgram(h);l=b.getBoundFramebufferObject();const {x:q,y:e,width:d,height:g}=b.getViewport();b.bindFramebuffer(a);b.setViewport(0,0,1,1);b.bindVAO(c);b.drawArrays(5,0,4);var m=v.makePipelineState({blending:G.blendingAlpha});b.setPipelineState(m);b.drawArrays(5,0,4);k.exports.init(b);m=b.gl.getError();b.setViewport(q,e,d,g);b.bindFramebuffer(l);h.dispose();c.dispose(!1);
f.dispose();a.dispose();return 1282===m?(console.warn("Device claims support for WebGL extension EXT_float_blend but does not support it. Using fall back."),!1):!0};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/OrderIndependentTransparency":function(){define(["exports","../../../webgl/renderState"],function(u,G){const F=G.separateBlendingParams(770,1,771,771),C=G.simpleBlendingParams(1,1),y=G.simpleBlendingParams(0,771),v={factor:-1,units:-2};u.OITBlending=function(p){return 2===
p?null:1===p?y:C};u.OITDepthTest=function(p){return 3===p||2===p?513:515};u.OITDepthWrite=function(p){return 2===p?G.defaultDepthWriteParams:null};u.OITPolygonOffset=v;u.OITPolygonOffsetLimit=5E5;u.blendingAlpha=y;u.blendingColor=C;u.blendingDefault=F;u.getOITPolygonOffset=function(p){return p?v:null};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/webgl/testSamplerPrecision":function(){define("exports ../../core/Logger ./BufferObject ./FramebufferObject ./Program ../../chunks/_rollupPluginBabelHelpers ./enums ./Texture ./VertexArrayObject".split(" "),
function(u,G,F,C,y,v,p,k,b){const a=G.getLogger("esri.views.WebGLDriverTest");u.testSamplerPrecision=f=>{var c=new C(f,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1});const h=new Uint8Array(4),l=F.createVertex(f,35044,new Uint16Array([0,0,1,0,0,1,1,1])),q=new b(f,new Map([["a_position",0]]),{geometry:[{name:"a_position",count:2,type:5122,offset:0,stride:4,normalized:!1}]},{geometry:l}),e=new y.Program(f,"\nprecision highp float;\nattribute vec2 a_pos;\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",new Map([["a_pos",0]]));var d=new k(f,{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([2,255,0,0]));e.setUniform1i("u_texture",0);f.bindTexture(d,0);d=f.getBoundFramebufferObject();f.bindFramebuffer(c);f.useProgram(e);const {x:g,y:m,width:n,height:r}=f.getViewport();f.setViewport(0,0,1,1);f.bindVAO(q);f.drawArrays(5,0,4);f.setViewport(g,
m,n,r);c.readPixels(0,0,1,1,6408,5121,h);e.dispose();q.dispose(!1);l.dispose();c.dispose();(c=255!==h[0]||255!==h[1]||255!==h[2]||255!==h[3])&&a.warn(`A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. [${h[0]}.${h[1]}.${h[2]}.${h[3]}]`);f.bindFramebuffer(d);
return c};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/webgl/testSVGPremultipliedAlpha":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ./BufferObject ./FramebufferObject ./Program ./Texture ./VertexArrayObject".split(" "),function(u,G,F,C,y,v,p){function k(){k=G._asyncToGenerator(function*(b){const a=new Image;a.src="data:image/svg+xml,%3C%3Fxml version\x3d'1.0' encoding\x3d'UTF-8'%3F%3E%3Csvg width\x3d'5' height\x3d'5' version\x3d'1.1' viewBox\x3d'0 0 5 5' xmlns\x3d'http://www.w3.org/2000/svg'%3E%3Crect width\x3d'5' height\x3d'5' fill\x3d'%23f00' fill-opacity\x3d'.5'/%3E%3C/svg%3E%0A";
a.width=5;a.height=5;yield a.decode();if(!b.gl)return!0;const f=new C(b,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),c=F.createVertex(b,35044,new Uint16Array([0,0,1,0,0,1,1,1])),h=new p(b,new Map([["a_pos",0]]),{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:c}),l=new y.Program(b,"\n  precision highp float;\n\n  attribute vec2 a_pos;\n  varying vec2 v_uv;\n\n  void main() {\n    v_uv \x3d a_pos;\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ",
"\n  precision highp float;\n\n  varying vec2 v_uv;\n  uniform sampler2D u_texture;\n\n  void main() {\n    gl_FragColor \x3d texture2D(u_texture, v_uv);\n  }\n  ",new Map([["a_pos",0]]));b.useProgram(l);const q=new v(b,{dataType:5121,pixelFormat:6408,preMultiplyAlpha:!1,wrapMode:33071,samplingMode:9729},a);b.bindTexture(q,0);l.setUniform1i("u_texture",0);const e=b.getBoundFramebufferObject(),{x:d,y:g,width:m,height:n}=b.getViewport();b.bindFramebuffer(f);b.setViewport(0,0,1,1);b.setClearColor(0,
0,0,0);b.setBlendingEnabled(!1);b.clearSafe(16384);b.bindVAO(h);b.drawArrays(5,0,4);const r=new Uint8Array(4);f.readPixels(0,0,1,1,6408,5121,r);l.dispose();h.dispose(!1);c.dispose();f.dispose();q.dispose();b.setViewport(d,g,m,n);b.bindFramebuffer(e);a.src="";return 255===r[0]});return k.apply(this,arguments)}u.testSVGPremultipliedAlpha=function(b){return k.apply(this,arguments)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/load":function(){define("exports ./DisjointTimerQuery ./DrawBuffers ./Instancing ./isWebGL2Context ./LoseContext ./VertexArrayObjects".split(" "),
function(u,G,F,C,y,v,p){function k(b,a,f,c,h){if(c&&y(b))return!0;if(a[f])return!1;for(const l of h)if(b.getExtension(l))return!0;return!1}u.loadCapabilities=function(b,a){const f=a.disabledExtensions||{},c=a.debugWebGLExtensions||{};let h,l,q,e,d,g,m,n,r,t,z,w,B=null,A=null,x=null,E=null;return{get drawBuffers(){z||(z=F.load(b,f));return z},get instancing(){h||(h=C.load(b));return h},get vao(){l||(l=p.load(b,f));return l},get compressedTextureETC(){if(!q)if(f.compressedTextureETC)q=null;else{var D=
b.getExtension("WEBGL_compressed_texture_etc");q=D?{COMPRESSED_R11_EAC:D.COMPRESSED_R11_EAC,COMPRESSED_SIGNED_R11_EAC:D.COMPRESSED_SIGNED_R11_EAC,COMPRESSED_RG11_EAC:D.COMPRESSED_RG11_EAC,COMPRESSED_SIGNED_RG11_EAC:D.COMPRESSED_SIGNED_RG11_EAC,COMPRESSED_RGB8_ETC2:D.COMPRESSED_RGB8_ETC2,COMPRESSED_SRGB8_ETC2:D.COMPRESSED_SRGB8_ETC2,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:D.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:D.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,
COMPRESSED_RGBA8_ETC2_EAC:D.COMPRESSED_RGBA8_ETC2_EAC,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:D.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC}:null}return q},get compressedTextureS3TC(){if(!e)if(f.compressedTextureS3TC)e=null;else{var D=b.getExtension("WEBGL_compressed_texture_s3tc");e=D?{COMPRESSED_RGB_S3TC_DXT1:D.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:D.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:D.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:D.COMPRESSED_RGBA_S3TC_DXT5_EXT}:
null}return e},get textureFilterAnisotropic(){if(!d)if(f.textureFilterAnisotropic)d=null;else{var D=b.getExtension("EXT_texture_filter_anisotropic")||b.getExtension("MOZ_EXT_texture_filter_anisotropic")||b.getExtension("WEBKIT_EXT_texture_filter_anisotropic");d=D?{MAX_TEXTURE_MAX_ANISOTROPY:D.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:D.TEXTURE_MAX_ANISOTROPY_EXT}:null}return d},get disjointTimerQuery(){g||(g=G.createDisjointTimerQuery(b,f));return g},get textureFloat(){if(!m)if(y(b))m=
{textureFloat:!0,textureFloatLinear:!f.textureFloatLinear&&!!b.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!f.textureHalfFloatLinear&&!!b.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:b.HALF_FLOAT};else if(b instanceof WebGLRenderingContext){const D=!f.textureHalfFloat&&b.getExtension("OES_texture_half_float");m={textureFloat:!f.textureFloat&&!!b.getExtension("OES_texture_float"),textureFloatLinear:!f.textureFloatLinear&&!!b.getExtension("OES_texture_float_linear"),
textureHalfFloat:!!D,textureHalfFloatLinear:!f.textureHalfFloatLinear&&!!b.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:D?D.HALF_FLOAT_OES:void 0}}else m=null;return m},get colorBufferFloat(){if(!n)if(y(b)){var D=!f.colorBufferFloat&&b.getExtension("EXT_color_buffer_half_float"),K=!f.colorBufferFloat&&b.getExtension("EXT_color_buffer_float"),H=!f.colorBufferFloat&&b.getExtension("EXT_float_blend");n=D||K||H?{textureFloat:!!K,textureHalfFloat:!!D,floatBlend:!!H,R16F:b.R16F,RG16F:b.RG16F,
RGBA16F:b.RGBA16F,R32F:b.R32F,RG32F:b.RG32F,RGBA32F:b.RGBA32F,R11F_G11F_B10F:b.R11F_G11F_B10F,RGB16F:b.RGB16F}:null}else b instanceof WebGLRenderingContext?(D=!f.colorBufferFloat&&b.getExtension("EXT_color_buffer_half_float"),K=!f.colorBufferFloat&&b.getExtension("WEBGL_color_buffer_float"),H=!f.colorBufferFloat&&b.getExtension("EXT_float_blend"),n=D||K||H?{textureFloat:!!K,textureHalfFloat:!!D,floatBlend:!!H,RGBA16F:D?D.RGBA16F_EXT:void 0,RGB16F:D?D.RGB16F_EXT:void 0,RGBA32F:K?K.RGBA32F_EXT:void 0}:
null):n=null;return n},get blendMinMax(){if(!r)if(y(b))r={MIN:b.MIN,MAX:b.MAX};else if(f.blendMinMax)r=null;else{{const D=b.getExtension("EXT_blend_minmax");r=D?{MIN:D.MIN_EXT,MAX:D.MAX_EXT}:null}}return r},get depthTexture(){null===B&&(B=k(b,f,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]));return B},get standardDerivatives(){null===A&&(A=k(b,f,"standardDerivatives",!0,["OES_standard_derivatives"]));return A},get shaderTextureLOD(){null===x&&(x=
k(b,f,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]));return x},get fragDepth(){null===E&&(E=k(b,f,"fragDepth",!0,["EXT_frag_depth"]));return E},get loseContext(){t||(t=v.load(b,c));return t},get textureNorm16(){if(!w)if(!y(b)||f.textureNorm16)w=null;else{var D=b.getExtension("EXT_texture_norm16");w=D?{R16:D.R16,RG16:D.RG16,RGB16:D.RGB16,RGBA16:D.RGBA16,R16_SNORM:D.R16_SNORM,RG16_SNORM:D.RG16_SNORM,RGB16_SNORM:D.RGB16_SNORM,RGBA16_SNORM:D.RGBA16_SNORM}:null}return w},enable(D){return this[D]}}};
Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/DrawBuffers":function(){define(["exports","./isWebGL2Context"],function(u,G){u.load=function(F,C){return C.disjointTimerQuery?null:G(F)?{drawBuffers:F.drawBuffers.bind(F),MAX_DRAW_BUFFERS:F.MAX_DRAW_BUFFERS,MAX_COLOR_ATTACHMENTS:F.MAX_COLOR_ATTACHMENTS}:C.drawBuffers?null:(F=F.getExtension("WEBGL_draw_buffers"))?{drawBuffers:F.drawBuffersWEBGL.bind(F),MAX_DRAW_BUFFERS:F.MAX_DRAW_BUFFERS_WEBGL,MAX_COLOR_ATTACHMENTS:F.MAX_COLOR_ATTACHMENTS_WEBGL}:
null};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/Instancing":function(){define(["exports","./isWebGL2Context"],function(u,G){u.load=function(F){return G(F)?{drawArraysInstanced:F.drawArraysInstanced.bind(F),drawElementsInstanced:F.drawElementsInstanced.bind(F),vertexAttribDivisor:F.vertexAttribDivisor.bind(F)}:(F=F.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:F.drawArraysInstancedANGLE.bind(F),drawElementsInstanced:F.drawElementsInstancedANGLE.bind(F),
vertexAttribDivisor:F.vertexAttribDivisorANGLE.bind(F)}:null};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/LoseContext":function(){define(["exports"],function(u){u.load=function(G,F){const C=F.loseContext&&G.getExtension("WEBGL_lose_context");return C?{loseRenderingContext:()=>C.loseContext()}:null};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["exports","./isWebGL2Context"],function(u,
G){u.load=function(F,C){return G(F)?{createVertexArray:F.createVertexArray.bind(F),deleteVertexArray:F.deleteVertexArray.bind(F),bindVertexArray:F.bindVertexArray.bind(F)}:C.vao?null:(F=F.getExtension("OES_vertex_array_object")||F.getExtension("MOZ_OES_vertex_array_object")||F.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:F.createVertexArrayOES.bind(F),deleteVertexArray:F.deleteVertexArrayOES.bind(F),bindVertexArray:F.bindVertexArrayOES.bind(F)}:null};Object.defineProperty(u,
"__esModule",{value:!0})})},"esri/views/2d/LabelManager":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Error ../../core/HandleOwner ../../core/Logger ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./engine/webgl/collisions/CollisionEngine".split(" "),function(u,G,F,C,y,v,p,k,b,a,f,c,h){const l=
v.getLogger("esri.views.2d.layers.labels.LabelManager");F=function(q){function e(g){g=q.call(this,g)||this;g._applyVisibilityPassThrottled=p.throttle(g._applyVisibilityPass,32,u._assertThisInitialized(g));g.lastUpdateId=-1;g.updateRequested=!1;g.view=null;return g}u._inheritsLoose(e,q);var d=e.prototype;d.initialize=function(){this.collisionEngine=new h.CollisionEngine};d.destroy=function(){this.collisionEngine=null;this._applyVisibilityPassThrottled.remove();this._applyVisibilityPassThrottled=null};
d.update=function(g){this._applyVisibilityPassThrottled(g)};d.viewChange=function(){this.requestUpdate()};d.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())};d.processUpdate=function(g){this._set("updateParameters",g);this.updateRequested&&(this.updateRequested=!1,this.update(g))};d._applyVisibilityPass=function(g){try{const m=this.view.featuresTilingScheme.getClosestInfoForScale(g.state.scale).level;this.collisionEngine.run(this.view.allLayerViews.items,
g,m)}catch(m){l.error(new C("mapview-labeling","Encountered an error during label decluttering",m))}};u._createClass(e,[{key:"updating",get:function(){return this.updateRequested}}]);return e}(y.HandleOwnerMixin(F));G.__decorate([k.property()],F.prototype,"updateRequested",void 0);G.__decorate([k.property({readOnly:!0})],F.prototype,"updateParameters",void 0);G.__decorate([k.property()],F.prototype,"updating",null);G.__decorate([k.property()],F.prototype,"view",void 0);return F=G.__decorate([c.subclass("esri.views.2d.layers.labels.LabelManager")],
F)})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("exports ../../../../../core/maybe ../../../../../core/screenUtils ../definitions ./CollisionGrid ./visualVariableSimpleUtils".split(" "),function(u,G,F,C,y,v){function p(f,c){const h=[];f.forEachTile(l=>h.push(l));h.sort((l,q)=>l.instanceId-q.instanceId);h.forEach(l=>{G.isSome(l.labelMetrics)&&l.isReady&&c(l,l.labelMetrics.getCursor())})}function k(f){return c=>F.pt2px(v.getSizeForValueSimple(c,f))}function b(f){for(const h of f){var c;
f=("featureReduction"in h&&"cluster"===(null==(c=h.featureReduction)?void 0:c.type)&&h.featureReduction).labelingInfo||[];f=[...h.labelingInfo||[],...f];if(h.labelsVisible&&f.length&&f.some(l=>"none"===l.deconflictionStrategy))return!0}return!1}let a=function(){function f(){}var c=f.prototype;c.run=function(h,l,q){const e=[];for(let n=h.length-1;0<=n;n--)a:{var d=e,g=h[n];if("feature"!==g.layer.type&&"csv"!==g.layer.type&&"geojson"!==g.layer.type&&"ogc-feature"!==g.layer.type&&"stream"!==g.layer.type&&
"subtype-group"!==g.layer.type&&"wfs"!==g.layer.type)break a;const r=g.layer.geometryType,t=!b("subtype-group"===g.layer.type?g.layer.sublayers.items:[g.layer]),z={};if("subtype-group"!==g.layer.type){if("heatmap"===g.layer.renderer.type)break a;b:{var m=g.layer.renderer;if(m="visualVariables"in m&&m.visualVariables)for(const w of m)if("size"===w.type){m=k(w);break b}m=null}z[0]=m}m=g.tileRenderer;G.isNone(m)||d.push({tileRenderer:m,vvEvaluators:z,deconflictionEnabled:t,geometryType:r,visible:g.layer.visible&&
!g.suspended})}this._transformMetrics(e,l);this._runCollision(e,l,q)};c._runCollision=function(h,l,q){const [e,d]=l.state.size;l=new y.CollisionBitsetGrid(e*l.pixelRatio,d*l.pixelRatio);for(const {tileRenderer:g,deconflictionEnabled:m,visible:n}of h){const r=g.featuresView.attributeView;m?n?(this._prepare(g),this._collideVisible(l,g,q),this._collideInvisible(l,g)):p(g,(t,z)=>{for(;z.nextId();)r.setLabelMinZoom(z.id,255)}):p(g,(t,z)=>{for(;z.nextId();)r.setLabelMinZoom(z.id,0)})}};c._isFiltered=function(h,
l,q){l=l.getFilterFlags(h);h=!q.hasFilter||!!(l&C.FILTER_FLAG_0);q=!G.isSome(q.featureEffect)||q.featureEffect.excludedLabelsVisible||!!(l&C.EFFECT_FLAG_0);return!(h&&q)};c._prepare=function(h){const l=h.featuresView.attributeView,q=new Set;p(h,(e,d)=>{for(;d.nextId();)q.has(d.id)||(q.add(d.id),this._isFiltered(d.id,l,h.layerView)?l.setLabelMinZoom(d.id,254):0!==l.getLabelMinZoom(d.id)?l.setLabelMinZoom(d.id,255):l.setLabelMinZoom(d.id,0))})};c._collideVisible=function(h,l,q){const e=l.featuresView.attributeView,
d=new Set;p(l,(g,m)=>{for(;m.nextId();)if(!d.has(m.id))if(g.key.level!==q)e.setLabelMinZoom(m.id,254);else if(0===e.getLabelMinZoom(m.id))switch(h.insertMetrics(m)){case y.HAS_COLLISION:e.setLabelMinZoom(m.id,254);d.add(m.id);break;case y.NONE:e.setLabelMinZoom(m.id,0),d.add(m.id)}})};c._collideInvisible=function(h,l){const q=l.featuresView.attributeView,e=new Set;p(l,(d,g)=>{for(;g.nextId();)if(!e.has(g.id)&&255===q.getLabelMinZoom(g.id))switch(h.insertMetrics(g)){case y.HAS_COLLISION:q.setLabelMinZoom(g.id,
255);e.add(g.id);break;case y.NONE:q.setLabelMinZoom(g.id,0),e.add(g.id)}})};c._transformMetrics=function(h,l){for(const {tileRenderer:q,geometryType:e,vvEvaluators:d}of h)p(q,(g,m)=>{const n=q.featuresView.attributeView;g=g.transforms.labelMat2d;g[4]=Math.round(g[4]);g[5]=Math.round(g[5]);const r=g[4],t=g[5],z="polyline"===e;for(;m.next();){const D=m.boundsCount,K=m.anchorX,H=m.anchorY;var w=m.size,B=d[0];if(G.isSome(B)){var A=n.getVVSize(m.id);B=B(A);w=isNaN(B)||null==B||Infinity===B?w:B}B=w/2*
m.directionX;w=w/2*m.directionY;for(A=0;A<D;A++){var x=K,E=m.anchorY;z?(x=x+m.boundsX(A)+B,E=E+m.boundsY(A)+w,l.state.rotation?(x=g[0]*x+g[2]*E+g[4],E=g[1]*x+g[3]*E+g[5]):(x+=r,E+=t),m.setBoundsComputedAnchorX(A,Math.floor(x)),m.setBoundsComputedAnchorY(A,Math.floor(E))):(l.state.rotation?(x=g[0]*K+g[2]*H+g[4],E=g[1]*K+g[3]*H+g[5]):(x+=r,E+=t),x=x+m.boundsX(A)+B,E=E+m.boundsY(A)+w,m.setBoundsComputedAnchorX(A,x),m.setBoundsComputedAnchorY(A,E))}}})};return f}();u.CollisionEngine=a;Object.defineProperty(u,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["exports","../../../../../core/mathUtils","../definitions","../../../layers/features/support/StaticBitSet"],function(u,G,F,C){let y=function(){function p(b,a){this.width=b;this.height=a;b=Math.ceil(b/1);a=Math.ceil(a/1);this._cols=b;this._rows=a;this._cells=C.StaticBitSet.create(b*a)}var k=p.prototype;k.insertMetrics=function(b){const a=this._hasCollision(b);0===a&&this._markMetrics(b);return a};k.getCellId=
function(b,a){return b+a*this._cols};k.has=function(b){return this._cells.has(b)};k.hasRange=function(b,a){return this._cells.hasRange(b,a)};k.set=function(b){this._cells.set(b)};k.setRange=function(b,a){this._cells.setRange(b,a)};k._hasCollision=function(b){const a=b.id;let f=0,c=0;b.save();do{const h=b.boundsCount;f+=h;for(let l=0;l<h;l++){const q=b.boundsComputedAnchorX(l),e=b.boundsComputedAnchorY(l),d=b.boundsWidth(l)+2,g=b.boundsHeight(l)+2;switch(this._collide(q,e,d,g)){case 2:return 2;case 1:c++}}}while(b.peekId()===
a&&b.next());b.restore();return f===c?1:0};k._collide=function(b,a,f,c){b-=f/2;a-=c/2;f=b+f;var h=a+c;if(0>f||0>h||b>this.width||a>this.height)return 1;c=G.clamp(Math.floor(b/1),0,this._cols);var l=G.clamp(Math.floor(a/1),0,this._rows);b=G.clamp(Math.ceil(f/1),0,this._cols);a=G.clamp(Math.ceil(h/1),0,this._rows);for(f=l;f<=a;f++)for(h=c;h<=b;h++)if(l=this.getCellId(h,f),this.has(l))return 2;return 0};k._mark=function(b,a,f,c){b-=f/2;a-=c/2;f=b+f;var h=a+c;c=G.clamp(Math.floor(b/1),0,this._cols);var l=
G.clamp(Math.floor(a/1),0,this._rows);b=G.clamp(Math.ceil(f/1),0,this._cols);a=G.clamp(Math.ceil(h/1),0,this._rows);for(f=l;f<=a;f++)for(h=c;h<=b;h++)l=this.getCellId(h,f),this.set(l);return!1};k._markMetrics=function(b){const a=b.id;do{const f=b.boundsCount;for(let c=0;c<f;c++){const h=b.boundsComputedAnchorX(c),l=b.boundsComputedAnchorY(c),q=b.boundsWidth(c)+2,e=b.boundsHeight(c)+2;this._mark(h,l,q,e)}}while(b.peekId()===a&&b.next())};return p}(),v=function(){function p(b,a=2){this._bucketSize=
b;this._rowsLength=F.TILE_SIZE/b;this._colsLength=F.TILE_SIZE/b;this._elementsPerBucket=a;this._grid=this._initGrid()}var k=p.prototype;k.checkOverlap=function(b,a){b=Math.floor(b/this._bucketSize);a=Math.floor(a/this._bucketSize);return 0>b||b>=this._rowsLength||0>a||a>=this._colsLength?!0:this._grid[a*this._colsLength+b]>=this._elementsPerBucket};k.markUsed=function(b,a){this._grid[Math.floor(a/this._bucketSize)*this._colsLength+Math.floor(b/this._bucketSize)]+=1};k.reset=function(){this._grid=
this._initGrid()};k._initGrid=function(){return new Uint8Array(this._rowsLength*this._colsLength)};return p}();u.CollisionBitsetGrid=y;u.CollisionGrid=v;u.HAS_COLLISION=2;u.NONE=0;u.OUTSIDE_EXTENT=1;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(u){let G=function(){function F(y,v){this._mask=0;this._buf=y;this._mask=v}F.fromBuffer=function(y,v){return new F(y,v)};F.create=function(y,v=4294967295){y=new Uint32Array(Math.ceil(y/
32));return new F(y,v)};var C=F.prototype;C._getIndex=function(y){return Math.floor(y/32)};C.has=function(y){y&=this._mask;return!!(this._buf[this._getIndex(y)]&1<<y%32)};C.hasRange=function(y,v){for(;y%32&&y!==v;){if(this.has(y))return!0;y++}for(;v%32&&y!==v;){if(this.has(y))return!0;v--}if(y===v)return!1;for(y/=32;y!==v/32;y++)if(this._buf[y])return!0;return!1};C.set=function(y){y&=this._mask;const v=this._getIndex(y);this._buf[v]|=1<<y%32};C.setRange=function(y,v){for(;y%32&&y!==v;)this.set(y++);
for(;v%32&&y!==v;)this.set(v--);if(y!==v)for(y/=32;y!==v/32;y++)this._buf[y]=4294967295};C.unset=function(y){y&=this._mask;const v=this._getIndex(y);this._buf[v]&=4294967295^1<<y%32};C.resize=function(y){const v=this._buf;y=new Uint32Array(Math.ceil(y/32));y.set(v);this._buf=y};C.or=function(y){for(let v=0;v<this._buf.length;v++)this._buf[v]|=y._buf[v];return this};C.and=function(y){for(let v=0;v<this._buf.length;v++)this._buf[v]&=y._buf[v];return this};C.xor=function(y){for(let v=0;v<this._buf.length;v++)this._buf[v]^=
y._buf[v];return this};C.ior=function(y){for(let v=0;v<this._buf.length;v++)this._buf[v]|=~y._buf[v];return this};C.iand=function(y){for(let v=0;v<this._buf.length;v++)this._buf[v]&=~y._buf[v];return this};C.ixor=function(y){for(let v=0;v<this._buf.length;v++)this._buf[v]^=~y._buf[v];return this};C.any=function(){for(let y=0;y<this._buf.length;y++)if(this._buf[y])return!0;return!1};C.copy=function(y){for(let v=0;v<this._buf.length;v++)this._buf[v]=y._buf[v];return this};C.clone=function(){return new F(this._buf.slice(),
this._mask)};C.clear=function(){for(let y=0;y<this._buf.length;y++)this._buf[y]=0};C.forEachSet=function(y){for(let v=0;v<this._buf.length;v++){let p=this._buf[v],k=32*v;if(p)for(;p;)p&1&&y(k),p>>>=1,k++}};C.countSet=function(){let y=0;this.forEachSet(v=>{y++});return y};return F}();u.StaticBitSet=G;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["exports","../../../../../core/mathUtils","../../../../../renderers/support/lengthUtils"],
function(u,G,F){function C(k,b){switch(b.transformationType){case "additive":var a=y(b.minSize,k);return k+=a||b.minDataValue;case "constant":return a=(a=b.stops)&&a.length&&a[0].size,null==a&&(a=b.minSize),k=y(a,k);case "clamped-linear":a=(k-b.minDataValue)/(b.maxDataValue-b.minDataValue);var f=y(b.minSize,k),c=y(b.maxSize,k);k=k<=b.minDataValue?f:k>=b.maxDataValue?c:f+a*(c-f);return k;case "proportional":return a=k/b.minDataValue,f=y(b.minSize,k),k=y(b.maxSize,k),k=G.clamp(a*f,f,k);case "stops":{const [h,
l,q]=v(k,b.cache.ipData);h===l?k=y(b.stops[h].size,k):(a=y(b.stops[h].size,k),k=y(b.stops[l].size,k),k=a+(k-a)*q)}return k;case "real-world-size":{a=F.meterIn[b.valueUnit];f=y(b.minSize,k);c=y(b.maxSize,k);({valueRepresentation:b}=b);let h=null;h="area"===b?2*Math.sqrt(k/p)/a:"radius"===b||"distance"===b?2*k/a:k/a;k=G.clamp(h,f,c)}return k;case "identity":return k;case "unknown":return null}}function y(k,b){return"number"===typeof k?k:C(b,k)}function v(k,b){if(b){var a=0,f=b.length-1;b.some((c,h)=>
{if(k<c)return f=h,!0;a=h;return!1});return[a,f,(k-b[a])/(b[f]-b[a])]}}const p=Math.PI;u.getSizeForValueSimple=C;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicsView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/BidiText ../../../../core/HandleOwner ../../../../core/has ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/coordsUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtilsSync ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/data/projectionSupport ../../../../symbols/cim/CIMSymbolHelper ../../../../symbols/support/defaults ../../engine/webgl/definitions ../../engine/webgl/GraphicTile ../../engine/webgl/TileData ../../engine/webgl/WGLDisplayObject ../../engine/webgl/mesh/MeshData ../../engine/webgl/mesh/factories/WGLMeshFactory ../../engine/webgl/mesh/templates/WGLTemplateStore ../../engine/webgl/util/Matcher ../features/schemaUtils ../features/support/AttributeStore ../features/support/ComputedAttributeStorage ../features/support/GraphicsReader ./GraphicStore ./graphicsUtils ../support/cimSymbolUtils ../../../layers/GraphicsView ../../../webgl/capabilities".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e,d,g,m,n,r,t,z,w,B,A,x,E,D,K,H,I,J,M,O,L,S,Q){function P(N,W,X){if(X.has(N))return X.get(N);W={tile:W,addedOrModified:[],removed:[]};X.set(N,W);return W}const R=v("esri-2d-graphic-debug");F=function(N){function W(T){T=N.call(this,T)||this;T._storage=new I.ComputedAttributeStorage;T._displayIds=new Map;T._controller=new AbortController;T._tiles=new Map;T._graphicStoreUpdate=!1;T._graphicsSet=new Set;T._matcher=Promise.resolve(null);T._tileUpdateSet=new Set;T._tilesToUpdate=
new Map;T._graphicIdToAbortController=new Map;T._attached=!1;T._highlightIds=new Map;T._updatingGraphicsTimer=null;T._hashToExpandedSymbol=new Map;T._hashToExpandedSymbolPromise=new Map;T._hashToCIMSymbolPromise=new Map;T._hashToCIM=new Map;T._processing=!1;T._needsProcessing=!1;T._pendingUpdate={added:new Set,updated:new Set,removed:new Set};T.lastUpdateId=-1;T.updateRequested=!1;T.graphicUpdateHandler=T.graphicUpdateHandler.bind(u._assertThisInitialized(T));return T}u._inheritsLoose(W,N);var X=
W.prototype;X._createMatcher=function(T,U,V){T&&(T=K.createMatcherSchema({indexCount:0,fields:{}},"feature",T),this._matcher=D.createMatcher(T,U,null,V))};X._createDisplayId=function(T){this._displayIds.has(T)||this._displayIds.set(T,this._storage.createDisplayId());return this._displayIds.get(T)};X.initialize=function(){this._attributeStore=new H({type:"local",initialize:U=>Promise.resolve(this.container.attributeView.initialize(U)),update:U=>this.container.attributeView.requestUpdate(U),render:()=>
this.container.requestRender()},Q());this.container.hasHighlight=()=>!!this._highlightIds.size;const T=new E.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),this.view.featuresTilingScheme.tileInfo);this._graphicStore=new M(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,U=>{this._createDisplayId(U.uid);this._setFilterState(U.uid,U.visible)},U=>{const V=this._displayIds.get(U.uid);this._displayIds.delete(U.uid);this._storage.releaseDisplayId(V)},this._hashToCIM);
this._meshFactory=new x.WGLMeshFactory(null,this.uid,T);this._templateStore=T;this.handles.add([this.watch("renderer",U=>{this._createMatcher(U,T,this.container.stage.resourceManager);for(const V of this.graphics)this._pendingUpdate.updated.add(V);this.requestUpdate()}),this.view.graphicsTileStore.on("update",U=>this._onTileUpdate(U)),this.container.on("attach",()=>{R&&this.container.enableRenderingBounds(()=>this._graphicStore.getAllBounds());0<this.graphics.items.length&&this._graphicsChangeHandler({target:this.graphics,
added:this.graphics.items,removed:[],moved:[]});this.handles.add(this.graphics.on("change",V=>this._graphicsChangeHandler(V)),"graphics");const U=this.container.stage.resourceManager;this._createMatcher(this.renderer,T,U);this._graphicStore.setResourceManager(U);this._attached=!0;this.notifyChange("updating")})]);this._onTileUpdate({added:this.view.graphicsTileStore.tiles,removed:[]})};X.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=
null,this.notifyChange("updating"));this._controller.abort();this.container.destroy();this._set("graphics",null);this._graphicStore.clear();this._attributeStore=null;this._hashToExpandedSymbol.clear();this.renderer=this.view=null;this._hashToCIM.clear();this._hashToCIMSymbolPromise.clear();this._hashToExpandedSymbolPromise.clear()};X.hitTest=function(T){if(!this.view||!this.view.position)return null;const {resolution:U,rotation:V}=this.view.state;return this._graphicStore.hitTest(T.x,T.y,2,U,V)};
X.update=function(T){k.throwIfAborted(this._controller.signal);({resolution:T}=T.state);this._graphicStore.updateLevel(T);this._graphicStoreUpdate=!0;this.updateRequested=!1;0<this._pendingUpdate.updated.size&&(this._processing?this._needsProcessing=!0:this._updateGraphics())};X.viewChange=function(){this.requestUpdate()};X.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())};X.processUpdate=function(T){this.updateRequested&&(this.updateRequested=
!1,this.update(T))};X.graphicUpdateHandler=function(T){const {graphic:U,property:V,newValue:Z}=T;switch(V){case "geometry":case "symbol":this._pendingUpdate.updated.add(U);this.requestUpdate();break;case "visible":this._setFilterState(U.uid,Z),this._attributeStore.sendUpdates()}};X.addHighlight=function(T){for(const U of T)this._highlightIds.has(U)?(T=this._highlightIds.get(U),this._highlightIds.set(U,T+1)):this._highlightIds.set(U,1);this._updateHighlight()};X.removeHighlight=function(T){for(const U of T)this._highlightIds.has(U)&&
(T=this._highlightIds.get(U)-1,0===T?this._highlightIds.delete(U):this._highlightIds.set(U,T));this._updateHighlight()};X._updateHighlight=function(){const T=Array.from(this._highlightIds.keys()),U=T.map(V=>this._displayIds.get(V));this._attributeStore.setHighlight(T,U)};X._getIntersectingTiles=function(T){T=this._graphicStore.getBounds(T);if(!T||0===l.width(T)||0===l.height(T))return[];const U=O.intersectingInternationalDateline(T,this.view.spatialReference);return p.isSome(U)?[...new Set([...this.view.graphicsTileStore.boundsIntersections(U[0]),
...this.view.graphicsTileStore.boundsIntersections(U[1])])]:this.view.graphicsTileStore.boundsIntersections(T)};X._updateTile=function(){var T=u._asyncToGenerator(function*(U){k.throwIfAborted(this._controller.signal);const V=U.tile;var Z=this._getGraphicsData(this._templateStore,V,U.addedOrModified);Z=yield this._processGraphics(V,Z);k.throwIfAborted(this._controller.signal);this._patchTile(V.key,{type:"update",addOrUpdate:Z,remove:U.removed,end:!0,clear:!1,sort:!1});return Z});return function(U){return T.apply(this,
arguments)}}();X._patchTile=function(T,U){this._tiles.has(T)&&(T=this._tiles.get(T),this.container.onTileData(T,U),this.container.requestRender())};X._graphicsChangeHandler=function(T){const U=this._pendingUpdate;for(const V of T.added)U.added.add(V);for(const V of T.moved)U.updated.add(V);for(const V of T.removed)this._pendingUpdate.added.has(V)?U.added.delete(V):U.removed.add(V);this._processing?this._needsProcessing=!0:this._updateGraphics()};X._getGraphicsToUpdate=function(){const T={added:[],
removed:[],updated:[]};if(!this.graphics)return T;const U=this._pendingUpdate;for(const V of this.graphics.items)U.added.has(V)?T.added.push(V):U.updated.has(V)&&T.updated.push(V);for(const V of U.removed)this._graphicStore.has(V)&&T.removed.push(V);U.added.clear();U.removed.clear();U.updated.clear();return T};X._updateGraphics=function(){var T=u._asyncToGenerator(function*(){this._processing=!0;const {added:U,removed:V,updated:Z}=this._getGraphicsToUpdate(),ca=this._tilesToUpdate;try{if(!this._graphicStoreUpdate){var {resolution:ea}=
this.view.state;this._graphicStore.updateLevel(ea)}ea=[];const Y=Array(U.length+V.length);for(let ba=0;ba<Z.length;ba++){var fa=Z[ba];const da=this._getIntersectingTiles(fa);for(const ha of da){var ia=ha.id;P(ia,ha,ca).removed.push(this._displayIds.get(fa.uid))}ea.push(this._updateGraphic(fa,null));Y[ba]=fa}var ja=Z.length;for(fa=0;fa<U.length;fa++){const ba=U[fa];Y[ja+fa]=ba;this._graphicsSet.add(ba);ea.push(this._addGraphic(ba))}for(const ba of V){this._abortProcessingGraphic(ba.uid);const da=this._getIntersectingTiles(ba);
for(const ha of da)ia=ha.id,P(ia,ha,ca).removed.push(this._displayIds.get(ba.uid));this._graphicsSet.delete(ba);this._graphicStore.remove(ba)}this._flipUpdatingGraphics();yield Promise.all(ea);let aa;for(ja=0;ja<Y.length;ja++){aa=Y[ja];const ba=this._getIntersectingTiles(aa);for(const da of ba)ia=da.id,P(ia,da,ca).addedOrModified.push(aa)}this._graphicStore.updateZ();ia=[];for(const [,ba]of ca)ia.push(this._updateTile(ba));yield Promise.all(ia)}catch(Y){k.isAbortError(Y)}for(const Y of V)try{const aa=
yield this._getSymbolForGraphic(Y,{});if(aa){const ba=aa.hash();this._hashToExpandedSymbol.delete(ba)}}catch(aa){k.isAbortError(aa)}ca.clear();this.notifyChange("updating");this._processing=!1;this._needsProcessing&&(this._needsProcessing=!1,this._updateGraphics())});return function(){return T.apply(this,arguments)}}();X._getArcadeInfo=function(T){const U=(T.attributes?Object.keys(T.attributes):[]).map(V=>({name:V,alias:V,type:"string"===typeof T.attributes[V]?"esriFieldTypeString":"esriFieldTypeDouble"}));
return p.isNone(T.geometry)?null:{geometryType:e.getJsonType(T.geometry),spatialReference:h.fromJSON(T.geometry.spatialReference),fields:U}};X._getSymbolForGraphic=function(T,U){k.throwIfAborted(this._controller.signal);return p.isSome(T.symbol)?Promise.resolve(T.symbol):p.isSome(this.renderer)?this.renderer.getSymbolAsync(T,{scale:this.view.scale,abortOptions:U}):Promise.resolve(this._getNullSymbol(T))};X._getCIMSymbol=function(T,U,V){var Z=this._hashToCIM.get(U);if(Z)return Promise.resolve(Z);T=
n.symbolToCIM(T);if(p.isSome(T)){if("CIMSymbolReference"===T.type)return Z=T,this._hashToCIM.set(U,Z),Promise.resolve(Z);if(Z=this._hashToCIMSymbolPromise.get(U))return Z;Z=T.fetchCIMSymbol(V).then(ca=>{this._hashToCIM.set(U,ca.data);this._hashToCIMSymbolPromise.delete(U);return ca}).catch(ca=>{this._hashToCIMSymbolPromise.delete(U);k.throwIfAbortError(ca);return null});this._hashToCIMSymbolPromise.set(U,Z);return Z}return Promise.resolve(null)};X._expandCIMSymbol=function(T,U,V,Z){var ca=this._hashToExpandedSymbol.get(V);
if(ca)return Promise.resolve(ca);if(ca=this._hashToExpandedSymbolPromise.get(V))return ca;ca=this.container.stage;U=this._getArcadeInfo(U);T=K.createSymbolSchema(T);ca=L.expandSymbol(T,U,ca.resourceManager,Z);this._hashToExpandedSymbolPromise.set(V,ca);ca.then(ea=>{this._hashToExpandedSymbol.set(V,ea);this._hashToExpandedSymbolPromise.delete(V);return ea});return ca};X._getSymbolResources=function(){var T=u._asyncToGenerator(function*(U,V){k.throwIfAborted(this._controller.signal);return this.container.stage?
this._getSymbolForGraphic(U,V).then(Z=>{const ca=Z.hash();return this._getCIMSymbol(Z,ca,V).then(ea=>p.isNone(ea)?null:this._expandCIMSymbol(ea,U,ca,V).then(fa=>{const ia=fa.layers.filter(ja=>"text"===ja.type&&"string"===typeof ja.text);if(ia&&0<ia.length){const ja=Array(ia.length);for(let aa=0;aa<ia.length;aa++){const ba=ia[aa],da=[],[ha]=C.bidiText(ba.text);for(let ka=0;ka<ha.length;ka++)da.push(ha.charCodeAt(ka));ja[aa]={symbol:ba,id:aa,glyphIds:da}}const Y=new Map;return this.container.getMaterialItems(ja).then(aa=>
{for(let ba=0;ba<ia.length;ba++){const da=ia[ba];Y.set(da.cim,{text:da.text,mosaicItem:aa[ba].mosaicItem})}return{symbol:fa,textInfo:Y,hash:ca}})}return{symbol:fa,hash:ca}}))}).catch(Z=>{k.throwIfAbortError(Z);return null}):null});return function(U,V){return T.apply(this,arguments)}}();X._projectAndNormalizeGeometry=function(){var T=u._asyncToGenerator(function*(U,V){k.throwIfAborted(this._controller.signal);if(p.isNone(U.geometry)||"mesh"===U.geometry.type)return null;var Z=U.geometry;e.isPolygon(Z)?
Z.rings=Z.rings:e.isPolyline(Z)?Z.paths=Z.paths:e.isExtent(Z)&&(U=yield this._getSymbolForGraphic(U,V),k.throwIfAborted(this._controller.signal),Z=O.isMarkerSymbol(U.type)||O.isTextSymbol(U.type)?Z.center:O.polygonFromExtent(Z));yield m.checkProjectionSupport(Z.spatialReference,this.view.spatialReference);U=d.normalizeCentralMeridianSync(Z);Z=m.project(U,Z.spatialReference,this.view.spatialReference);q.closeRingsAndFixWinding(Z);return Z});return function(U,V){return T.apply(this,arguments)}}();X._onTileUpdate=
function(T){const U=g.getInfo(this.view.spatialReference);if(T.added&&0<T.added.length)for(const V of T.added)this._addNewTile(V,U);if(T.removed&&0<T.removed.length)for(const V of T.removed)this._removeTile(V.key)};X._addGraphic=function(){var T=u._asyncToGenerator(function*(U){this._abortProcessingGraphic(U.uid);k.throwIfAborted(this._controller.signal);var V=new AbortController;this._graphicIdToAbortController.set(U.uid,V);V={signal:V.signal};try{yield this._addOrUpdateGraphic(U,V),k.throwIfAborted(this._controller.signal),
this._graphicIdToAbortController.delete(U.uid)}catch(Z){if(this._graphicIdToAbortController.delete(U.uid),!k.isAbortError(Z))throw Z;}});return function(U){return T.apply(this,arguments)}}();X._updateGraphic=function(T,U){k.throwIfAborted(this._controller.signal);const V=this._projectAndNormalizeGeometry(T,U);U=this._getSymbolResources(T,U);return Promise.all([V,U]).then(([Z,ca])=>{k.throwIfAborted(this._controller.signal);this._graphicStore.addOrModify(T,ca,Z)})};X._addOrUpdateGraphic=function(T,
U){k.throwIfAborted(this._controller.signal);const V=this._projectAndNormalizeGeometry(T,U);U=this._getSymbolResources(T,U);return Promise.all([V,U]).then(([Z,ca])=>{k.throwIfAborted(this._controller.signal);this._graphicsSet.has(T)&&this._graphicStore.addOrModify(T,ca,Z)})};X._addTile=function(T){var U=this.view.featuresTilingScheme.getTileBounds(l.create(),T);U=new z.GraphicTile(T,U[0],U[3]);this._tiles.set(T,U);this.container.addChild(U);return U};X._addNewTile=function(){var T=u._asyncToGenerator(function*(U,
V){const Z=this._addTile(U.key),ca=this._graphicStore.queryTileData(this._templateStore,U);if(0!==ca.length){if(V){V=Math.round((V.valid[1]-V.valid[0])/U.resolution);for(var ea of ca)ea.geometry&&(e.isPoint(ea.geometry)||e.isMultipoint(ea.geometry))&&this._wrapPoints(ea,V)}ea=U.key;this._tileUpdateSet.add(U.key);this.notifyChange("updating");try{const fa={type:"update",clear:!1,addOrUpdate:yield this._processGraphics(U,ca),remove:[],end:!0,sort:!1};Z.patch(fa);this._tileUpdateSet.delete(ea);this.notifyChange("updating")}catch(fa){if(this._tileUpdateSet.delete(ea),
this.notifyChange("updating"),!k.isAbortError(fa))throw fa;}}});return function(U,V){return T.apply(this,arguments)}}();X._removeTile=function(T){if(this._tiles.has(T)){var U=this._tiles.get(T);this.container.removeChild(U);U.destroy();this._tiles.delete(T)}};X._setFilterState=function(T,U){const V=this._displayIds.get(T);T=this._attributeStore.getHighlightFlag(T);this._attributeStore.setData(V,0,0,T|(U?t.FILTER_FLAG_0:0))};X._getGraphicsData=function(T,U,V){const Z=g.getInfo(this.view.spatialReference);
T=this._graphicStore.getGraphicsData(T,U,V);if(Z){U=Math.round((Z.valid[1]-Z.valid[0])/U.resolution);for(const ca of T)ca.geometry&&(e.isPoint(ca.geometry)||e.isMultipoint(ca.geometry))&&this._wrapPoints(ca,U)}return T};X._wrapPoints=function(T,U){const V=T.geometry;e.isMultipoint(V)?this._wrapMultipoint(V,U):this._wrapPoint(T,U)};X._wrapMultipoint=function(T,U){var V=T.points;const Z=[];let ca=0,ea=0;for(const [fa,ia]of V)Z.push([fa+ca,ia]),ca=0,U===O.TILE_SIZE?(V=5*O.PIXEL_BUFFER,fa+ea<V?(Z.push([U,
0]),ca=-U):fa+ea>O.TILE_SIZE-V&&(Z.push([-U,0]),ca=U)):fa+ea<-O.PIXEL_BUFFER?(Z.push([U,0]),ca=-U):fa+ea>O.TILE_SIZE+O.PIXEL_BUFFER&&(Z.push([-U,0]),ca=U),ea+=fa;T.points=Z};X._wrapPoint=function(T,U){const V=T.geometry;if(U===O.TILE_SIZE){const Z=5*O.PIXEL_BUFFER;V.x<Z?T.geometry={points:[[V.x,V.y],[U,0]]}:V.x>O.TILE_SIZE-Z&&(T.geometry={points:[[V.x,V.y],[-U,0]]})}else V.x<-O.PIXEL_BUFFER?T.geometry={points:[[V.x,V.y],[U,0]]}:V.x>O.TILE_SIZE+O.PIXEL_BUFFER&&(T.geometry={points:[[V.x,V.y],[-U,0]]})};
X._processGraphics=function(T,U,V){if(!U||!U.length||!this._meshFactory)return null;const Z=J.GraphicsReader.from(U),ca=this._meshFactory;return this._matcher.then(ea=>ca.analyzeGraphics(Z,this.container.stage.resourceManager,ea,null,null,V).then(()=>{this._attributeStore.sendUpdates();return this._processAnalyzedGraphics(T,Z)}))};X._processAnalyzedGraphics=function(T,U){const V=this._meshFactory;var Z=U.getSize();U=U.getCursor();const ca=new A.MeshData(T.key.id,{features:Z,records:Z,metrics:0},{fill:"default"},
!1,!1);for(Z=[];U.next();){const ea=U.readGraphic();ea.insertAfter=-1===ea.insertAfter?-1:this._displayIds.get(ea.insertAfter);ea.displayId=this._displayIds.get(ea.attributes[this.uid]);const fa=new B(ea.displayId);fa.insertAfter=ea.insertAfter;Z.push(fa);V.writeGraphic(ca,U,T.level)}T=ca.serialize(T.tileInfoView.tileInfo.isWrappable);return 1!==T.length?new w.TileData:w.TileData.fromVertexData(T[0].message,Z)};X._abortProcessingGraphic=function(T){this._graphicIdToAbortController.has(T)&&this._graphicIdToAbortController.get(T).abort()};
X._getNullSymbol=function(T){T=T.geometry;return e.isPolyline(T)?r.errorPolylineSymbol2D:e.isPolygon(T)||e.isExtent(T)?r.errorPolygonSymbol2D:r.errorPointSymbol2D};X._flipUpdatingGraphics=function(){this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer);this._updatingGraphicsTimer=setTimeout(()=>{this._updatingGraphicsTimer=null;this.notifyChange("updating")},160);this.notifyChange("updating")};u._createClass(W,[{key:"updating",get:function(){return!this._attached||null!==this._updatingGraphicsTimer||
0<this._tileUpdateSet.size||0<this._tilesToUpdate.size}}]);return W}(S.GraphicsView(y.HandleOwnerMixin(F)));G.__decorate([b.property({constructOnly:!0})],F.prototype,"requestUpdateCallback",void 0);G.__decorate([b.property()],F.prototype,"container",void 0);G.__decorate([b.property({constructOnly:!0})],F.prototype,"graphics",void 0);G.__decorate([b.property()],F.prototype,"updating",null);G.__decorate([b.property()],F.prototype,"view",void 0);G.__decorate([b.property()],F.prototype,"updateRequested",
void 0);return F=G.__decorate([c.subclass("esri.views.2d.layers.support.GraphicsView2D")],F)})},"esri/geometry/support/normalizeUtilsSync":function(){define("exports ./aaBoundingRect ./boundsUtils ./intersectsBase ./jsonUtils ./normalizeUtilsCommon ./spatialReferenceUtils".split(" "),function(u,G,F,C,y,v,p){function k(d,g){const m=v.getGeometryParts(d);for(const n of m)for(const r of n)r[0]+=g;return d}function b(d,g){if(!g)return d;const m=f(d,g).map(n=>n.extent);return 2>m.length?m[0]||d:2<m.length?
(d.xmin=g.valid[0],d.xmax=g.valid[1],d):{rings:m.map(n=>[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]])}}function a(d,g,m){if(Array.isArray(d)){var n=d[0];n>g?(m=v.offsetMagnitude(n,g),d[0]=n+-2*m*g):n<m&&(g=v.offsetMagnitude(n,m),d[0]=n+-2*g*m)}else n=d.x,n>g?(m=v.offsetMagnitude(n,g),d.x+=-2*m*g):n<m&&(g=v.offsetMagnitude(n,m),d.x+=-2*g*m);return d}function f(d,g){const m=[],{ymin:n,ymax:r}=d;var t=d.xmax-d.xmin,z=d.xmin,w=d.xmax;const [B,A]=g.valid;var x=c(d.xmin,
g);var E=x.x;const D=x.frameId;x=c(d.xmax,g);d=x.x;x=x.frameId;g=E===d&&0<t;if(t>2*A){t={xmin:z<w?E:d,ymin:n,xmax:A,ymax:r};z={xmin:B,ymin:n,xmax:z<w?d:E,ymax:r};w={xmin:0,ymin:n,xmax:A,ymax:r};E={xmin:B,ymin:n,xmax:0,ymax:r};d=[];g=[];h(t,w)&&d.push(D);h(t,E)&&g.push(D);h(z,w)&&d.push(x);h(z,E)&&g.push(x);for(let K=D+1;K<x;K++)d.push(K),g.push(K);m.push({extent:t,frameIds:[D]},{extent:z,frameIds:[x]},{extent:w,frameIds:d},{extent:E,frameIds:g})}else E>d||g?m.push({extent:{xmin:E,ymin:n,xmax:A,ymax:r},
frameIds:[D]},{extent:{xmin:B,ymin:n,xmax:d,ymax:r},frameIds:[x]}):m.push({extent:{xmin:E,ymin:n,xmax:d,ymax:r},frameIds:[D]});return m}function c(d,g){const [m,n]=g.valid;g=2*n;var r=0;d>n?(r=Math.ceil(Math.abs(d-n)/g),d-=r*g):d<m&&(r=Math.ceil(Math.abs(d-m)/g),d+=r*g,r=-r);return{x:d,frameId:r}}function h(d,g){const {xmin:m,ymin:n,xmax:r,ymax:t}=g;return l(d,m,n)&&l(d,m,t)&&l(d,r,t)&&l(d,r,n)}function l(d,g,m){return g>=d.xmin&&g<=d.xmax&&m>=d.ymin&&m<=d.ymax?!0:!1}let q=function(){function d(){}
d.prototype.cut=function(g,m){let n;if(g.rings)this.closed=!0,n=g.rings,this.minPts=4;else if(g.paths)this.closed=!1,n=g.paths,this.minPts=2;else return null;const r=n.length;m*=-2;for(let t=0;t<r;t++){const z=n[t];if(z&&z.length>=this.minPts){const w=[];for(const B of z)w.push([B[0]+m,B[1]]);n.push(w)}}this.closed?g.rings=n:g.paths=n;return g};return d}();const e=G.create();u.normalizeCentralMeridianSync=function(d){if(!d)return null;let g=null;var m=d.spatialReference,n=p.getInfo(m);if(!n)return"toJSON"in
d?d.toJSON():d;var r=p.isWebMercator(m)?102100:4326;const t=v.cutParams[r].maxX,z=v.cutParams[r].minX;m=v.cutParams[r].plus180Line;r=v.cutParams[r].minus180Line;let w;d="toJSON"in d?d.toJSON():d;if(y.isPoint(d))w=a(d,t,z);else if(y.isMultipoint(d))d.points=d.points.map(B=>a(B,t,z)),w=d;else if(y.isExtent(d))w=b(d,n);else if(y.isPolygon(d)||y.isPolyline(d)){F.getBoundsXY(e,d);n={xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3]};const B=2*v.offsetMagnitude(n.xmin,z)*t;d=0===B?d:k(d,B);n.xmin+=B;n.xmax+=B;C.extentIntersectsPolyline(n,
m)&&n.xmax!==t?g=d:C.extentIntersectsPolyline(n,r)&&n.xmin!==z?g=d:w=d}else w=d;return null!==g?(new q).cut(g,t):w};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(u,G,F,C,y,v,p){function k(e,
d){if(!d)return null;if("x"in d){var g={x:0,y:0};[g.x,g.y]=e(d.x,d.y,c);null!=d.z&&(g.z=d.z);null!=d.m&&(g.m=d.m);return g}if("xmin"in d)return g={xmin:0,ymin:0,xmax:0,ymax:0},[g.xmin,g.ymin]=e(d.xmin,d.ymin,c),[g.xmax,g.ymax]=e(d.xmax,d.ymax,c),d.hasZ&&(g.zmin=d.zmin,g.zmax=d.zmax,g.hasZ=!0),d.hasM&&(g.mmin=d.mmin,g.mmax=d.mmax,g.hasM=!0),g;if("rings"in d)return{rings:b(d.rings,e),hasM:d.hasM,hasZ:d.hasZ};if("paths"in d)return{paths:b(d.paths,e),hasM:d.hasM,hasZ:d.hasZ};if("points"in d)return{points:a(d.points,
e),hasM:d.hasM,hasZ:d.hasZ}}function b(e,d){const g=[];for(const m of e)g.push(a(m,d));return g}function a(e,d){const g=[];for(const m of e)e=d(m[0],m[1],[0,0]),g.push(e),2<m.length&&e.push(m[2]),3<m.length&&e.push(m[3]);return g}function f(){f=G._asyncToGenerator(function*(e,d){d&&(e=Array.isArray(e)?e.map(g=>F.isSome(g.geometry)&&g.geometry.spatialReference):[e],yield C.initializeProjection(e.map(g=>({source:g,dest:d}))))});return f.apply(this,arguments)}const c=[0,0],h=k.bind(null,p.lngLatToXY),
l=k.bind(null,p.xyToLngLat),q=new (function(){function e(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var d=e.prototype;d.push=function(){var g=G._asyncToGenerator(function*(m,n,r){if(!(m&&m.length&&n&&r)||v.equals(n,r))return m;const t={geometries:m,inSpatialReference:n,outSpatialReference:r,resolve:null};this._jobs.push(t);return new Promise(z=>{t.resolve=z;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(m,n,r){return g.apply(this,arguments)}}();
d._process=function(){this._timer=null;const g=this._jobs.shift();if(g){var {geometries:m,inSpatialReference:n,outSpatialReference:r,resolve:t}=g;p.canProject(n,r)?v.isWebMercator(r)?t(m.map(h)):t(m.map(l)):t(C.projectMany(y.jsonAdapter,m,n,r,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return e}());u.checkProjectionSupport=function(e,d){return f.apply(this,arguments)};u.project=function(e,d,g){if(!e)return e;g||(g=d,d=e.spatialReference);return v.isValid(d)&&v.isValid(g)&&
!v.equals(d,g)?p.canProject(d,g)?v.isWebMercator(g)?h(e):l(e):C.projectMany(y.jsonAdapter,[e],d,g,null)[0]:e};u.projectMany=function(e,d,g){return q.push(e,d,g)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(u){let G=function(p,k,b){this.x=p;this.y=k;this.spatialReference=b;this.m=this.z=void 0},F=function(p,k,b,a){this.rings=p;this.spatialReference=k;this.hasM=this.hasZ=void 0;b&&(this.hasZ=b);a&&(this.hasM=a)},C=
function(p,k,b,a){this.paths=p;this.spatialReference=k;this.hasM=this.hasZ=void 0;b&&(this.hasZ=b);a&&(this.hasM=a)},y=function(p,k,b,a){this.points=p;this.spatialReference=k;this.hasM=this.hasZ=void 0;b&&(this.hasZ=b);a&&(this.hasM=a)},v=function(p,k,b,a,f){this.xmin=p;this.ymin=k;this.xmax=b;this.ymax=a;this.spatialReference=f;this.mmax=this.mmin=this.zmax=this.zmin=void 0};u.jsonAdapter={convertToGEGeometry:function(p,k){return null==k?null:p.convertJSONToGeometry(k)},exportPoint:function(p,k,
b){b=new G(p.getPointX(k),p.getPointY(k),b);const a=p.hasZ(k),f=p.hasM(k);a&&(b.z=p.getPointZ(k));f&&(b.m=p.getPointM(k));return b},exportPolygon:function(p,k,b){return new F(p.exportPaths(k),b,p.hasZ(k),p.hasM(k))},exportPolyline:function(p,k,b){return new C(p.exportPaths(k),b,p.hasZ(k),p.hasM(k))},exportMultipoint:function(p,k,b){return new y(p.exportPoints(k),b,p.hasZ(k),p.hasM(k))},exportExtent:function(p,k,b){var a=p.hasZ(k);const f=p.hasM(k);b=new v(p.getXMin(k),p.getYMin(k),p.getXMax(k),p.getYMax(k),
b);a&&(a=p.getZExtent(k),b.zmin=a.vmin,b.zmax=a.vmax);f&&(p=p.getMExtent(k),b.mmin=p.vmin,b.mmax=p.vmax);return b}};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GraphicTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ./DirtyMap ./DisplayRecordStore ./WGLBuffers ./WGLTile".split(" "),function(u,G,F,C,y,v){v=function(p){function k(){var a=p.apply(this,arguments)||this;a._data=null;a._displayList=null;a._lastCommitTime=0;a._hasData=!1;a._invalidated=
!1;a._wglBuffers=null;a._dirtyMap=new F;return a}G._inheritsLoose(k,p);var b=k.prototype;b.destroy=function(){p.prototype.destroy.call(this);this.clear()};b.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};b.getDisplayList=function(){return this._displayList};b.patch=function(a){if(!0===a.clear)this.clear(),this._hasData=!1;else{var f=a.addOrUpdate,c=a.remove;!this._data&&f&&f.tileDisplayData.displayObjects.length?(f.tileDisplayData.computeDisplayList(),
this._dirtyMap=new F,this._dispRecStore=C.fromTileData(f,this._dirtyMap),this._data=f,this._dirtyMap.markAllDirty(),this._hasData=!0,a.end&&this.ready()):this._data?f&&f.tileDisplayData.displayObjects.length||c.length?this._doPatchData(a):a.end&&this.ready():a.end&&this.ready();a.end&&!this._data&&this.clear();this.requestRender();this.emit("change")}};b.commit=function(a){if(!a.time||a.time!==this._lastCommitTime)if(this._lastCommitTime=a.time,this.visible&&this._data&&(this._wglBuffers||(this._wglBuffers=
new y(a.context)),this._dirtyMap.hasDirty()||this._invalidated))this._invalidated=!1,this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._displayList=this._data.tileDisplayData.displayList.clone(),this._displayObjects=this._data.tileDisplayData.displayObjects.slice(),this._dirtyMap.markAllClean()};b.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};b._doPatchData=function(a){this._invalidated=
!0;this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=C.fromTileData(this._data,this._dirtyMap));this.requestRender()};b._patchData=function(a){let f=!0;var c=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],h=(a.remove||[]).slice();for(var l of c)null!=l.insertAfter&&h.push(l.id);for(var q of h)if(h=this._data.tileDisplayData.displayObjectRegistry.get(q)){this._data.tileDisplayData.displayList.removeFromList(h.displayRecords);
for(var e of h.displayRecords)this._dispRecStore.delete(e);this._data.tileDisplayData.displayObjectRegistry.delete(q);h=this._data.tileDisplayData.displayObjects.indexOf(h);this._data.tileDisplayData.displayObjects.splice(h,1)}for(const n of c){c=this._data.tileDisplayData.displayObjectRegistry.get(n.id);let r;if(c){q=c.displayRecords;c.set(n);c.displayRecords=q;q=c.displayRecords.length;for(e=0;e<q;++e)if(h=c.displayRecords[e],l=n.displayRecords[e],e>=n.displayRecords.length||h.geometryType!==l.geometryType||
h.symbolLevel!==l.symbolLevel||h.zOrder!==l.zOrder||h.materialKey!==l.materialKey)this._dispRecStore.delete(c.displayRecords[e]),e<n.displayRecords.length&&(c.displayRecords[e]=void 0);c.displayRecords.length=n.displayRecords.length}else if(c=n.copy(),c.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(n.id,c),q=this._data.tileDisplayData.displayObjects,null!=c.insertAfter?(r={},0<=c.insertAfter?(e=this._data.tileDisplayData.displayObjectRegistry.get(c.insertAfter))?(l=q.indexOf(e)+
1,l<q.length?q.splice(l,0,c):(q.push(c),l=q.length)):(q.push(c),l=q.length):(q.unshift(c),l=0)):(q.push(c),l=q.length),r)for(e=0<n.displayRecords.length?1:0,h=0,--l;0<=l&&h<e;--l)for(var d=q[l].displayRecords.length-1;0<=d&&h<e;--d){var g=q[l].displayRecords[d],m=this._data.tileDisplayData.displayList.getDPInfoType();r[m]||(r[m]=g,++h)}q=n.displayRecords.length;for(e=0;e<q;++e){h=n.displayRecords[e];(l=c.displayRecords[e])?(l.meshData=h.meshData,l.materialKey=h.materialKey):(l=h.copy(),l.vertexFrom=
void 0,l.indexFrom=void 0,c.displayRecords[e]=l);g=h.geometryType;d=this._data.tileDisplayData.displayList.getDPInfoType();m=a.addOrUpdate.tileBufferData.geometries[g];g=m.vertexBuffer;m=m.indexBuffer;let t=void 0;r&&(t=r[d]?this._data.tileDisplayData.displayList.splitAfter(r[d]):-1);f=this._dispRecStore.setMeshData(l,h,g,m,t)&&f;r&&null!=l.indexFrom&&null!=l.indexFrom&&(r[d]=l)}}return f};G._createClass(k,[{key:"hasData",get:function(){return!!this._hasData}},{key:"displayObjects",get:function(){var a;
return null!=(a=this._displayObjects)?a:[]}}]);return k}(v.WGLTile);u.GraphicTile=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(function(){return function(){function u(){this._dirties=[{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,
indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1}]}var G=u.prototype;G.hasDirty=function(){return this._dirties.some(F=>-1!==F.indexCount||F.allDirty)};G.markAllClean=function(){for(const F of this._dirties)F.indexFrom=-1,F.indexCount=-1,F.vertexFrom=-1,F.vertexCount=-1,F.allDirty=!1};G.markAllDirty=function(){for(const F of this._dirties)F.allDirty=!0};G.forEach=function(F){for(let C=0;C<this._dirties.length;++C){const {indexCount:y,indexFrom:v,vertexCount:p,
vertexFrom:k,allDirty:b}=this._dirties[C],a={};let f=void 0,c=!1;if(b||-1!==k&&0<p)a.geometry={count:p,from:k,allDirty:b},c=!0;if(b||-1!==v&&0<y)f={count:y,from:v,allDirty:b},c=!0;c&&F({indices:f,vertices:a},C)}};G.markDirtyIndices=function(F,C,y){F=this._dirties[F];if(!F.allDirty)if(-1!==F.indexCount){const v=Math.min(F.indexFrom,C);C=Math.max(F.indexFrom+F.indexCount,C+y)-v;F.indexFrom=v;F.indexCount=C}else F.indexFrom=C,F.indexCount=y};G.markDirtyVertices=function(F,C,y,v){F=this._dirties[F];F.allDirty||
(-1!==F.vertexCount?(C=Math.min(F.vertexFrom,y),y=Math.max(F.vertexFrom+F.vertexCount,y+v)-C,F.vertexFrom=C,F.vertexCount=y):(F.vertexFrom=y,F.vertexCount=v))};return u}()})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["../../../../core/has","./FreeList","./Utils"],function(u,G,F){const C=["FILL","LINE","MARKER","TEXT","LABEL"];return function(){function y(p,k,b,a){this._strides=p;this._displayList=k;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=b;for(const f in p){this._freeListsAndStorage[f]=
{vtxFreeList:a?new G.FreeList(a):null,idxFreeList:a?new G.FreeList(a):null,vertexBuffers:{},indexBuffer:a?new Uint32Array(a):null};for(const c in p[f])this._freeListsAndStorage[f].vertexBuffers[c]={data:a?F.allocateTypedArrayBuffer(a,p[f][c]):null,stride:p[f][c]}}}y.fromTileData=function(p,k){var b,a=p.getStrides(),f={};for(b=0;b<a.length;b++)f[C[b]]=a[b];b=f;a=[0,0,0,0,0];f=[0,0,0,0,0];var c=p.tileDisplayData.displayObjects;for(var h of c)for(var l of h.displayRecords)a[l.geometryType]=Math.max(a[l.geometryType],
l.vertexFrom+l.vertexCount),f[l.geometryType]=Math.max(f[l.geometryType],l.indexFrom+l.indexCount);k=new y(b,p.tileDisplayData.displayList,k,null);for(h=0;h<p.tileBufferData.geometries.length;++h){l=a[h];c=f[h];var q=p.tileBufferData.geometries[h];b=k._storageFor(C[h]);const e=p.tileBufferData.geometries[h].indexBuffer;b.indexBuffer=e;b.idxFreeList=new G.FreeList(e.length);b.idxFreeList.allocate(c);let d;for(const g in q.vertexBuffer)c=p.tileBufferData.geometries[h].vertexBuffer[g],b.vertexBuffers[g].data=
c.data,b.vertexBuffers[g].stride=c.stride,q=F.strideToPackingFactor(c.stride),c=c.data.length*q/c.stride,d||(d=c);b.vtxFreeList=new G.FreeList(d);b.vtxFreeList.allocate(l)}return k};var v=y.prototype;v.delete=function(p){const k=C[p.geometryType];this._freeVertices(k,p.vertexFrom,p.vertexCount);this._freeIndices(k,p.indexFrom,p.indexCount);this._displayList.removeFromList(p);p.vertexFrom=void 0;p.indexFrom=void 0};v.setMeshData=function(p,k,b,a,f){const c=C[p.geometryType];p.meshData=null;let h=void 0,
l=void 0;void 0===p.vertexFrom?(l=k.vertexCount,h=this._allocateVertices(c,l)):k.vertexCount>p.vertexCount?(this._freeVertices(c,p.vertexFrom,p.vertexCount),l=k.vertexCount,h=this._allocateVertices(c,l)):k.vertexCount===p.vertexCount?(h=p.vertexFrom,l=p.vertexCount):(this._freeVertices(c,p.vertexFrom+k.vertexCount,p.vertexCount-k.vertexCount),h=p.vertexFrom,l=k.vertexCount);let q=!0,e=void 0,d=void 0,g=void 0;void 0===p.indexFrom?(e=f,g=k.indexCount,d=this._allocateIndices(c,g)):k.indexCount>p.indexCount?
(e=this._displayList.removeFromList(p),this._freeIndices(c,p.indexFrom,p.indexCount),g=k.indexCount,d=this._allocateIndices(c,g)):k.indexCount===p.indexCount?(q=!1,d=p.indexFrom,g=p.indexCount):(e=this._displayList.removeFromList(p),this._freeIndices(c,p.indexFrom+k.indexCount,p.indexCount-k.indexCount),d=p.indexFrom,g=k.indexCount);if(-1!==h&&-1!==d){f=this._storageFor(c);F.copyMeshData(h,d,f.vertexBuffers,f.indexBuffer,k,b,a);p.vertexFrom=h;p.indexFrom=d;p.vertexCount=k.vertexCount;p.indexCount=
k.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(p.geometryType,p.indexFrom,p.indexCount);for(const m in b)this._dirtyMap.markDirtyVertices(p.geometryType,m,p.vertexFrom,p.vertexCount)}q&&this._displayList.addToList(p,e);return!0}-1!==h&&this._freeVertices(c,h,l);-1!==d&&this._freeIndices(c,d,g);p.setMeshDataFromBuffers(k,b,a);p.vertexFrom=void 0;p.vertexCount=0;p.indexFrom=void 0;p.indexCount=0;return!1};v.tryAddMeshData=function(p,k){const b=k.vertexBuffer;k=k.indexBuffer;var a=C[p.geometryType];
const f=this._allocateVertices(a,p.vertexCount);if(-1===f)return this._freeVertices(a,f,p.vertexCount),!1;const c=this._allocateIndices(a,p.indexCount);if(-1===c)return this._freeVertices(a,f,p.vertexCount),this._freeIndices(a,c,p.indexCount),!1;a=this._storageFor(a);F.copyMeshData(f,c,a.vertexBuffers,a.indexBuffer,p,b,k);p.vertexFrom=f;p.indexFrom=c;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(p.geometryType,p.indexFrom,p.indexCount);for(const h in b)this._dirtyMap.markDirtyVertices(p.geometryType,
h,f,p.vertexCount)}this._displayList.addToList(p);return!0};v._allocateVertices=function(p,k){p=this._storageFor(p);k=p.vtxFreeList.allocate(k);return-1===k||.5<p.vtxFreeList.fragmentation?-1:k};v._freeVertices=function(p,k,b){this._storageFor(p).vtxFreeList.free(k,b)};v._freeIndices=function(p,k,b){this._storageFor(p).idxFreeList.free(k,b)};v._allocateIndices=function(p,k){p=this._storageFor(p);k=p.idxFreeList.allocate(k);return-1===k||.5<p.idxFreeList.fragmentation?-1:k};v._storageFor=function(p){return this._freeListsAndStorage[p]};
v._stridesFor=function(p,k){return this._strides[p][k]};return y}()})},"esri/views/2d/engine/webgl/FreeList":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(u,G){let F=function(){function y(p){this._largestRange=null;this._parent=p;this._updateLargestRange()}var v=y.prototype;v.rangeCreated=function(p){if(!this._largestRange||p.count>this._largestRange.count)this._largestRange=p};v.rangeResized=function(p,k){if(p===this._largestRange)p.count<k&&this._updateLargestRange();
else if(!this._largestRange||p.count>this._largestRange.count)this._largestRange=p};v.findBestRange=function(p){let k=this._parent._freeHead,b=null;for(;null!==k;)k.count>=p&&(!b||k.count-p<b.count-p)&&(b=k),k=k.next;return b};v.findAdjacentRanges=function(p,k){let b=!0,a=!1,f=null,c=this._parent._freeHead;for(;b&&!a;){const h=null!==c?c.from:this._parent._size;p>=(null!==f?f.from+f.count:0)&&p+k<=h?(b=!1,a=!0):null!==c?(f=c,c=c.next):b=!1}return[f,c]};v._updateLargestRange=function(){let p=null,
k=this._parent._freeHead;for(;null!==k;){if(!p||k.count>p.count)p=k;k=k.next}this._largestRange=p};G._createClass(y,[{key:"largestRange",get:function(){return this._largestRange}}]);return y}(),C=function(){function y(p,k){this._allocated=0;this._size=p;this._freeHead=0<p?{from:0,count:p,prev:null,next:null}:null;this._bookKeeper=k||new F(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}var v=y.prototype;v.allocate=function(p){const k=this._bookKeeper.findBestRange(p);if(null===
k)return-1;const b=k.from,a=k.count;k.from+=p;k.count-=p;this._bookKeeper.rangeResized(k,b,a);this._allocated+=p;0===k.count&&(p=null!==k.prev?this._freeHead:k.next,y._removeRange(k),this._freeHead=p);return b};v.free=function(p,k){const [b,a]=this._bookKeeper.findAdjacentRanges(p,k);p={from:p,count:k,prev:b,next:a};null!==b&&(b.next=p);null!==a&&(a.prev=p);this._bookKeeper.rangeCreated(p);this._allocated-=k;if(null!==a&&p.from+p.count===a.from){k=p.from;var f=p.count;y._fuse(p,a);y._removeRange(a);
this._bookKeeper.rangeResized(p,k,f);this._bookKeeper.rangeResized(a,void 0,0)}null!==b&&b.from+b.count===p.from&&(k=b.from,f=b.count,y._fuse(b,p),y._removeRange(p),this._bookKeeper.rangeResized(b,k,f),this._bookKeeper.rangeResized(p,void 0,0));this._freeHead=null!==p.prev?this._freeHead:p};y._removeRange=function(p){null!==p.prev?null!==p.next?(p.prev.next=p.next,p.next.prev=p.prev):p.prev.next=null:null!==p.next&&(p.next.prev=null)};y._fuse=function(p,k){p.count+=k.count;p.next=k.next;k.from+=k.count;
k.count=0;null!==k.next&&(k.next.prev=p)};G._createClass(y,[{key:"fragmentation",get:function(){const p=this._size-this._allocated;return 0===p?0:1-this._bookKeeper.largestRange.count/p}}]);return y}();u.FreeList=C;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define("../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/Texture ../../../webgl/VertexArrayObject ./Utils".split(" "),
function(u,G,F,C,y,v,p,k,b,a){return function(){function f(h){this.geometryMap=a.createGeometryData(()=>({indexBuffer:u.createIndex(h,35044),vao:null}),(l,q)=>({vertexBuffer:u.createVertex(h,a.C_VBO_INFO[q])}))}var c=f.prototype;c.dispose=function(){for(let h=0;5>h;h++){const l=this.geometryMap[h];if(l){l.data.vao&&l.data.vao.dispose(!1);l.data.indexBuffer&&l.data.indexBuffer.dispose();for(const q in l.buffers)l.buffers[q]&&l.buffers[q].data.vertexBuffer.dispose()}}};c.get=function(h){const l=this.geometryMap[h];
return{draw(q,e,d,g,m){if(!l.data.vao){const n={};for(const r in l.buffers)n[r]=l.buffers[r].data.vertexBuffer;l.data.vao=new b(q,d,e,n,l.data.indexBuffer)}q.bindVAO(l.data.vao);q.drawElements(4,m,5125,Uint32Array.BYTES_PER_ELEMENT*g);q.bindVAO(null)}}};c.has=function(h){return null!=this.geometryMap[h]};c.upload=function(h,l){l.forEach((q,e)=>{this._upload(q,e,h)})};c._upload=function(h,l,q){h.indices&&(h.indices.allDirty?this._uploadIndices(q,l):null!=h.indices.from&&null!=h.indices.count&&this._uploadIndices(q,
l,h.indices.from,h.indices.count));if(h.vertices){h=h.vertices;for(const e in h){const d=h[e];d.allDirty?this._uploadVertices(q,l,e):null!=d.from&&null!=d.count&&this._uploadVertices(q,l,e,d.from,d.count)}}};c._uploadVertices=function(h,l,q,e,d){const g=this.geometryMap[l];g&&(l=h.geometries[l].vertexBuffer[q])&&(h=l.stride,l=l.data.buffer,g.buffers[q]&&0<l.byteLength&&(null!=e&&null!=d?g.buffers[q].data.vertexBuffer.setSubData(l,e*h,e*h,(e+d)*h):g.buffers[q].data.vertexBuffer.setData(l)))};c._uploadIndices=
function(h,l,q,e){const d=this.geometryMap[l];d&&(h=h.geometries[l].indexBuffer.buffer,d.data.indexBuffer&&0<h.byteLength&&(null!=q&&null!=e?d.data.indexBuffer.setSubData(h,4*q,4*q,4*(q+e)):d.data.indexBuffer.setData(h)))};return f}()})},"esri/views/2d/engine/webgl/WGLTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat2d ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2 ../../../../chunks/vec2f32 ./definitions ./TiledDisplayObject".split(" "),
function(u,G,F,C,y,v,p,k,b){let a=function(){function f(){}var c=f.prototype;c.acquire=function(h){return{refCount:1,version:-1,labelMat2d:y.create(),tileMat3:y.create(),dvs:y.create()}};c.release=function(h){};return f}();b=function(f){function c(l,q,e){return f.call(this,l,q,e,k.TILE_SIZE,k.TILE_SIZE)||this}G._inheritsLoose(c,f);var h=c.prototype;h.destroy=function(){f.prototype.destroy.call(this);this._transforms&&c.TransformCache.release(this.key.hash)};h.setTransform=function(l,q){var e=q/(l.resolution*
l.pixelRatio),d=this.transforms.tileMat3;const [g,m]=l.toScreenNoRotation([0,0],[this.x,this.y]);C.set(d,this.width/this.rangeX*e,0,0,0,this.height/this.rangeY*e,0,g,m,1);C.multiply(this.transforms.dvs,l.displayViewMat3,d);e=this.transforms.labelMat2d;q=l.getScreenTransform(e,q);d=p.create();v.transformMat2d(d,[this.x,this.y],q);F.identity(e);F.translate(e,e,d);F.multiply(e,l.viewMat2d,e)};h._createTransforms=function(){return c.TransformCache.acquire(this.key.hash)};return c}(b.TiledDisplayObject);
b.TransformCache=new a;u.WGLTile=b;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3","../DisplayObject","../../tiling/TileKey"],function(u,G,F,C,y){C=function(v){function p(b,a,f,c,h,l=c,q=h){var e=v.call(this)||this;e.triangleCountReportedInDebug=0;e.triangleCount=0;e.texture=null;e.key=new y(b);e.x=a;e.y=f;e.width=c;e.height=h;e.rangeX=l;e.rangeY=
q;return e}G._inheritsLoose(p,v);var k=p.prototype;k.destroy=function(){this.texture&&(this.texture.dispose(),this.texture=null)};k.setTransform=function(b,a){a/=b.resolution*b.pixelRatio;const f=this.transforms.tileMat3,[c,h]=b.toScreenNoRotation([0,0],[this.x,this.y]);F.set(f,this.width/this.rangeX*a,0,0,0,this.height/this.rangeY*a,0,c,h,1);F.multiply(this.transforms.dvs,b.displayViewMat3,f)};return p}(C.DisplayObject);u.TiledDisplayObject=C;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileData":function(){define("exports ../../../../core/maybe ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./WGLDisplayRecord ./cpuMapped/DisplayRecordReader ./mesh/VertexBuffer ./mesh/VertexVector ./util/Writer".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f){const c=new F,h=new F;F=function(){function l(){this.tileBufferData=this.tileDisplayData=null}var q=l.prototype;q.reshuffle=function(){c.reset();const e=y.groupRecordsByGeometryType(this.tileDisplayData.displayObjects);for(var d of e)for(var g of d)g&&c.needMore(g.geometryType,g.meshData?g.meshData.vertexCount:g.vertexCount,g.meshData?g.meshData.indexData.length:g.indexCount);d=e.length;g=new C;for(var m=0;m<d;++m){g.geometries[m].indexBuffer=new Uint32Array(Math.round(1.5*
c.indicesFor(m)));var n=[];for(var r in this.tileBufferData.geometries[m].vertexBuffer)n.push(this.tileBufferData.geometries[m].vertexBuffer[r].stride);n=l._computeVertexAlignment(n);var t=Math.round(1.5*c.verticesFor(m));n=l._align(t,n);for(var z in this.tileBufferData.geometries[m].vertexBuffer)t=this.tileBufferData.geometries[m].vertexBuffer[z].stride,g.geometries[m].vertexBuffer[z]={stride:t,data:v.allocateTypedArrayBuffer(n,t)}}h.reset();this.tileDisplayData.displayList.clear();for(r=0;r<d;++r){z=
e[r];for(const w of z){if(w.meshData)w.writeMeshDataToBuffers(h.verticesFor(r),g.geometries[r].vertexBuffer,h.indicesFor(r),g.geometries[r].indexBuffer),w.meshData=null;else{z=this.tileBufferData.geometries[r].vertexBuffer;m=this.tileBufferData.geometries[r].indexBuffer;n=g.geometries[r].vertexBuffer;t=g.geometries[r].indexBuffer;const B=h.verticesFor(r),A=h.indicesFor(r);v.copyMeshData(B,A,n,t,w,z,m);w.vertexFrom=B;w.indexFrom=A}h.needMore(r,w.vertexCount,w.indexCount)}}for(const w of this.tileDisplayData.displayObjects)this.tileDisplayData.displayList.addToList(w.displayRecords);
this.tileBufferData=g};q.getStrides=function(){const e=[];for(let d=0;d<this.tileBufferData.geometries.length;++d){const g=this.tileBufferData.geometries[d];e[d]={};for(const m in g.vertexBuffer)e[d][m]=g.vertexBuffer[m].stride}return e};q.clone=function(){const e=new l;e.tileBufferData=this.tileBufferData.clone();e.tileDisplayData=this.tileDisplayData.clone();return e};q._guessSize=function(){const {displayObjects:e}=this.tileDisplayData,d=Math.min(e.length,4);let g=0;for(let m=0;m<d;m++)g=Math.max(g,
e[m].displayRecords.length);return 2*(12*e.length+e.length*g*40)};q.serialize=function(){const e=this.tileBufferData.serialize(),d=this.tileBufferData.getBuffers(),g=this.tileDisplayData.serialize(new f(Int32Array,this._guessSize())).buffer();d.push(g);return{result:{displayData:g,bufferData:e},transferList:d}};l.fromVertexData=function(e,d){const g={},m=new Map;for(const n of d)m.set(n.id,n);v.forEachGeometryType(n=>{const r=e.data[n];if(G.isSome(r)){const z=k.DisplayRecordReader.from(r.records).getCursor();
for(;z.next();){var t=z.id;const w=z.materialKey,B=z.indexFrom,A=z.indexCount,x=z.vertexFrom,E=z.vertexCount,D=m.get(t);t=new p(t,n,w);t.indexFrom=B;t.indexCount=A;t.vertexFrom=x;t.vertexCount=E;D.displayRecords.push(t)}g[n]=b.VertexBuffers.fromVertexData(r,n)}else g[n]=(new a.VertexVectors(n,0,{fill:"default"})).intoBuffers()});return l.fromMeshData({displayObjects:d,vertexBuffersMap:g})};l.fromMeshData=function(e){const d=new l,g=new y.default,m=new C;g.displayObjects=e.displayObjects;for(const n in e.vertexBuffersMap){const r=
e.vertexBuffersMap[n];m.geometries[n].indexBuffer=r.indexBuffer;m.geometries[n].vertexBuffer=r.namedBuffers}d.tileDisplayData=g;d.tileBufferData=m;return d};l.bind=function(e,d){const g=new l;g.tileDisplayData=e;g.tileBufferData=d;return g};l.create=function(e,d){const g=new l;g.tileDisplayData=new y.default;g.tileDisplayData.displayObjects=e;const m=[0,0,0,0,0],n=[0,0,0,0,0],r=[[],[],[],[],[]];for(var t of e)for(var z of t.displayRecords)r[z.geometryType].push(z),m[z.geometryType]+=z.meshData.vertexCount,
n[z.geometryType]+=z.meshData.indexData.length;e=new C;d=[d.fill||{},d.line||{},d.icon||{},d.text||{},d.label||{}];for(t=0;5>t;t++){z=new Uint32Array(n[t]);{var w=d[t];var B=m[t];const A={};for(const x in w){const E={data:v.allocateTypedArrayBuffer(B,w[x]),stride:w[x]};A[x]=E}w=A}p.writeAllMeshDataToBuffers(r[t],w,z);e.geometries[t]={indexBuffer:z,vertexBuffer:w}}g.tileBufferData=e;return g};l._align=function(e,d){const g=e%d;return 0===g?e:e+(d-g)};l._computeVertexAlignment=function(e){let d=!1,
g=!1;for(const m of e)2===m%4?d=!0:0!==m%4&&(g=!0);return g?4:d?2:1};return l}();u.TileData=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(u){return function(){function G(){this._byGeometryType=null}var F=G.prototype;F.reset=function(){this._byGeometryType=null};F.verticesFor=function(C){return this._byGeometryType?this._byGeometryType[C].vertices:0};F.indicesFor=function(C){return this._byGeometryType?
this._byGeometryType[C].indices:0};F.needMore=function(C,y,v){if(y||v)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),C=this._byGeometryType[C],C.vertices+=y,C.indices+=v};u._createClass(G,[{key:"satisfied",get:function(){return!this._byGeometryType}}]);return G}()})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["./Utils"],function(u){return function(){function G(){this.geometries=
[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}var F=G.prototype;F.clone=function(){const C=new G;for(let y=0;y<this.geometries.length;y++){const v=this.geometries[y],p=C.geometries[y];p.indexBuffer=v.indexBuffer.slice();p.vertexBuffer={};for(const k in v.vertexBuffer){const {data:b,stride:a}=v.vertexBuffer[k];p.vertexBuffer[k]={data:b.slice(),stride:a}}}return C};
G.deserialize=function(C){const y=new G;for(let v=0;5>v;++v){y.geometries[v].indexBuffer=new Uint32Array(C.geometries[v].indexBuffer);y.geometries[v].vertexBuffer={};for(const p in C.geometries[v].vertexBuffer)y.geometries[v].vertexBuffer[p]={data:u.allocateTypedArrayBufferwithData(C.geometries[v].vertexBuffer[p].data,C.geometries[v].vertexBuffer[p].stride),stride:C.geometries[v].vertexBuffer[p].stride}}return y};F.serialize=function(){const C={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,
vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]};for(let y=0;5>y;++y)for(const v in this.geometries[y].vertexBuffer)C.geometries[y].vertexBuffer[v]={data:this.geometries[y].vertexBuffer[v].data.buffer,stride:this.geometries[y].vertexBuffer[v].stride};return C};
F.getBuffers=function(){const C=[];for(let y=0;5>y;++y){C.push(this.geometries[y].indexBuffer.buffer);for(const v in this.geometries[y].vertexBuffer)C.push(this.geometries[y].vertexBuffer[v].data.buffer)}return C};return G}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./GraphicDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(u,G,F,C,y){let v=function(){function p(){}var k=p.prototype;k.computeDisplayList=
function(){this._displayList=new F;for(const b of this.displayObjects)for(const a of b.displayRecords)this._displayList.addToList(a)};k.clone=function(){const b=new p;this.displayObjects&&(b.displayObjects=this.displayObjects.map(a=>a.clone()));return b};k.serialize=function(b){y.serializeList(b,this.displayObjects);return b};k._deserializeObjects=function(b){var a=b.readInt32();a=Array(a);const f=new Map;for(let c=0;c<a.length;++c){const h=C.deserialize(b);a[c]=h;f.set(h.id,h)}this.displayObjects=
a;this._displayList=null;this._displayObjectRegistry=f};p.deserialize=function(b){const a=new p;a._deserializeObjects(b);return a};G._createClass(p,[{key:"displayObjectRegistry",get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(const b of this.displayObjects)this._displayObjectRegistry.set(b.id,b)}return this._displayObjectRegistry}},{key:"displayList",get:function(){return this._displayList}}]);return p}();u.default=v;u.groupRecordsByGeometryType=function(p){const k=
[[],[],[],[],[]];for(const b of p)for(const a of b.displayRecords)k[a.geometryType].push(a);return k};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GraphicDisplayList":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./enums"],function(u,G){function F(b,a,f,...c){a<b.length?b.splice(a,f,...c):b.push(...c)}const C=new Map;C.set(G.WGLDrawPhase.MAP,[G.WGLGeometryType.FILL,G.WGLGeometryType.LINE,G.WGLGeometryType.MARKER,G.WGLGeometryType.TEXT]);C.set(G.WGLDrawPhase.LABEL,
[G.WGLGeometryType.LABEL]);C.set(G.WGLDrawPhase.LABEL_ALPHA,[G.WGLGeometryType.LABEL]);G=function(){function b(){this.symbolLevels=[]}var a=b.prototype;a.replay=function(f,c,h){for(const q of this.symbolLevels)for(const e of q.zLevels){var l=e.geometryDPInfo.unified;if(l)for(const d of l){l=f.painter.getGeometryBrush(d.geometryType);const g=c.getGeometry(d.geometryType),m={geometryType:d.geometryType,materialKey:d.materialKey,indexFrom:d.indexFrom,indexCount:d.indexCount,draw:(n,r,t)=>{g.draw(n,r,
t,d.indexFrom,d.indexCount)}};l.prepareState(f,c);l.drawGeometry(f,c,m,h)}}};a.clear=function(){this.symbolLevels.length=0};a.addToList=function(f,c){if(Array.isArray(f))for(const h of f)this._addToList(h,c);else this._addToList(f,c)};a.removeFromList=function(f){Array.isArray(f)||(f=[f]);let c=null;for(const h of f)c=this._removeFromList(h);return c};a.clone=function(){const f=new b;for(const c of this.symbolLevels)f.symbolLevels.push(c.clone());return f};a.splitAfter=function(f){const c=this._getDisplayList(f.symbolLevel,
f.zOrder),h=c.length,l=f.indexFrom+f.indexCount;for(let q=0;q<h;++q){const e=c[q];if(e.geometryType===f.geometryType&&l>e.indexFrom&&l<=e.indexFrom+e.indexCount)return l<e.indexFrom+e.indexCount&&(f=new y,f.geometryType=e.geometryType,f.materialKey=e.materialKey,f.indexFrom=l,f.indexCount=e.indexFrom+e.indexCount-l,c.splice(q+1,0,f),e.indexCount=l-e.indexFrom),q}};a._addToList=function(f,c){const h=this._getDisplayList(f.symbolLevel,f.zOrder);c=null!=c?c:h.length-1;var l=0<=c&&c<h.length?h[c]:null;
null!==l&&l.materialKey===f.materialKey&&l.indexFrom+l.indexCount===f.indexFrom&&l.geometryType===f.geometryType?l.indexCount+=f.indexCount:(l=new y,l.indexFrom=f.indexFrom,l.indexCount=f.indexCount,l.materialKey=f.materialKey,l.geometryType=f.geometryType,F(h,c+1,0,l))};a._removeFromList=function(f){const c=this._getDisplayList(f.symbolLevel,f.zOrder);var h=c.length;let l=void 0;for(var q=0;q<h;++q){var e=c[q];if(f.indexFrom+f.indexCount>e.indexFrom&&f.indexFrom<e.indexFrom+e.indexCount&&e.geometryType===
f.geometryType){l=q;break}}if(void 0!==l){h=c[l];if(f.indexFrom===h.indexFrom)return h.indexCount-=f.indexCount,h.indexFrom+=f.indexCount,0===h.indexCount&&F(c,l,1),l-1;if(f.indexFrom+f.indexCount===h.indexFrom+h.indexCount)return h.indexCount-=f.indexCount,0===h.indexCount?(F(c,l,1),l-1):l;{q=h.indexFrom;e=f.indexFrom-h.indexFrom;const d=f.indexCount;f=h.indexFrom+h.indexCount-(f.indexFrom+f.indexCount);h.indexCount=e;const g=new y;g.geometryType=h.geometryType;g.materialKey=h.materialKey;g.indexFrom=
q+e+d;g.indexCount=f;F(c,l+1,0,g);return l}}return null};a._getDisplayList=function(f,c){let h;var l=this.symbolLevels.length;for(let e=0;e<l;e++)if(this.symbolLevels[e].symbolLevel===f){h=this.symbolLevels[e];break}h||(h=new k,h.symbolLevel=f,this.symbolLevels.push(h));let q;f=h.zLevels.length;for(l=0;l<f;l++)if(h.zLevels[l].zLevel===c){q=h.zLevels[l];break}q||(q=new p,q.geometryDPInfo=new v,q.zLevel=c,h.zLevels.push(q));q.geometryDPInfo.unified||(q.geometryDPInfo.unified=[]);return q.geometryDPInfo.unified};
a.getDPInfoType=function(){return"unified"};u._createClass(b,[{key:"empty",get:function(){return!this.symbolLevels||0===this.symbolLevels.length}}]);return b}();let y=function(){function b(){this.materialKey=null;this.indexCount=this.indexFrom=0}b.prototype.clone=function(){const a=new b;a.geometryType=this.geometryType;a.materialKey=this.materialKey;a.indexFrom=this.indexFrom;a.indexCount=this.indexCount;return a};return b}(),v=function(){function b(){this.unified=this.label=this.text=this.marker=
this.line=this.fill=null}b.prototype.clone=function(){const a=new b;a.fill=this.fill&&this.fill.map(f=>f.clone());a.line=this.line&&this.line.map(f=>f.clone());a.marker=this.marker&&this.marker.map(f=>f.clone());a.text=this.text&&this.text.map(f=>f.clone());a.label=this.label&&this.label.map(f=>f.clone());a.unified=this.unified&&this.unified.map(f=>f.clone());return a};return b}(),p=function(){function b(){this.geometryDPInfo=new v}b.prototype.clone=function(){const a=new b;a.zLevel=this.zLevel;a.geometryDPInfo=
this.geometryDPInfo.clone();return a};return b}(),k=function(){function b(){this.zLevels=[]}b.prototype.clone=function(){const a=new b;a.symbolLevel=this.symbolLevel;for(const f of this.zLevels)a.zLevels.push(f.clone());return a};return b}();return G})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["./WGLDisplayRecord","./util/serializationUtils"],function(u,G){return function(){function F(y){this.insertAfter=null;this.id=y;this.displayRecords=[]}var C=F.prototype;C.copy=function(){const y=
new F(this.id);y.set(this);return y};C.clone=function(){const y=new F(this.id);y.displayRecords=this.displayRecords.map(v=>v.clone());y.insertAfter=this.insertAfter;return y};C.set=function(y){this.id=y.id;this.displayRecords=y.displayRecords;this.insertAfter=y.insertAfter};C.serialize=function(y){y.push(this.id);G.serializeList(y,this.displayRecords);return y};F.deserialize=function(y){const v=y.readInt32(),p=new F(v);p.displayRecords=G.deserializeList(y,u,{id:v});return p};return F}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./MeshData","./Utils"],function(u,G,F){return function(){function C(v,p,k,b=0,a=0){this.id=v;this.geometryType=p;this.materialKey=k;this.minZoom=b;this.maxZoom=a;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}var y=C.prototype;y.clone=function(){return this.copy()};y.copy=function(){const v=new C(this.id,this.geometryType,this.materialKey);v.vertexFrom=this.vertexFrom;v.vertexCount=this.vertexCount;v.indexFrom=this.indexFrom;v.indexCount=
this.indexCount;v.zOrder=this.zOrder;v.symbolLevel=this.symbolLevel;v.meshData=this.meshData;v.minZoom=this.minZoom;v.maxZoom=this.maxZoom;return v};y.setMeshDataFromBuffers=function(v,p,k){const b=new G;for(const a in p){const f=p[a].stride,c=p[a].data,h=[],l=F.strideToPackingFactor(f);for(let q=0;q<f*v.vertexCount/l;++q)h[q]=c[q+f*v.vertexFrom/l];b.vertexData.set(a,h)}b.indexData.length=0;for(p=0;p<v.indexCount;++p)b.indexData[p]=k[p+v.indexFrom]-v.vertexFrom;b.vertexCount=v.vertexCount;this.meshData=
b};y.readMeshDataFromBuffers=function(v,p){this.meshData?this.meshData.clear():this.meshData=new G;for(const k in v){const b=v[k].stride,a=v[k].data,f=[],c=F.strideToPackingFactor(b);for(let h=0;h<b*this.vertexCount/c;++h)f[h]=a[h+b*this.vertexFrom/c];this.meshData.vertexData.set(k,f)}this.meshData.indexData.length=0;for(v=0;v<this.indexCount;++v)this.meshData.indexData[v]=p[v+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};y.writeMeshDataToBuffers=function(v,p,k,b){for(const a in p){const f=
p[a].stride,c=this.meshData.vertexData.get(a),h=p[a].data,l=F.strideToPackingFactor(f);for(let q=0;q<f*this.meshData.vertexCount/l;++q)h[q+f*v/l]=c[q]}for(p=0;p<this.meshData.indexData.length;++p)b[p+k]=this.meshData.indexData[p]+v;this.vertexFrom=v;this.vertexCount=this.meshData.vertexCount;this.indexFrom=k;this.indexCount=this.meshData.indexData.length};C.writeAllMeshDataToBuffers=function(v,p,k){let b=0,a=0;for(const f of v)f.writeMeshDataToBuffers(b,p,a,k),b+=f.vertexCount,a+=f.indexCount};y._computeSortKey=
function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};y.serialize=function(v){v.push(this.geometryType);v.push(this.materialKey);v.push(this.vertexFrom);v.push(this.vertexCount);v.push(this.indexFrom);v.push(this.indexCount);v.push(this.minZoom);v.push(this.maxZoom);return v};C.deserialize=function(v,p){const k=v.readInt32(),b=v.readInt32();p=new C(p.id,k,b);p.vertexFrom=v.readInt32();p.vertexCount=v.readInt32();p.indexFrom=v.readInt32();p.indexCount=v.readInt32();
p.minZoom=v.readInt32();p.maxZoom=v.readInt32();return p};u._createClass(C,[{key:"sortKey",get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey}}]);return C}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(function(){return function(){function u(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}var G=u.prototype;G.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};G.update=function(F,C,y){for(const v in F)this.vertexData.set(v,
F[v]);for(const v in this.vertexData)null===F[v]&&this.vertexData.delete(v);this.vertexCount=C;this.indexData=y};return u}()})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["exports"],function(u){u.deserializeList=function(G,F,C){var y=G.readInt32();y=Array(y);for(let v=0;v<y.length;v++)y[v]=F.deserialize(G,C);return y};u.serializeList=function(G,F){if(null===F)G.push(0);else{G.push(F.length);for(const C of F)C.serialize(G);return G}};Object.defineProperty(u,"__esModule",
{value:!0})})},"esri/views/2d/engine/webgl/cpuMapped/DisplayRecordReader":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions"],function(u,G,F,C){let y=function(){function p(b){this._cursor=this._head=b}p.from=function(b,a=0,f=b.byteLength/v.BYTES_PER_RECORD-a){b=new v(new Int32Array(b,a*v.BYTES_PER_RECORD,f*v.ELEMENTS_PER_RECORD));return new p(b)};var k=p.prototype;k.size=function(){let b=this._cursor,a=0;for(;b;)a+=b.size(),
b=b._link;return a};k.seekIndex=function(b){for(this._cursor=this._head;this._cursor;){const a=this._cursor.size();if(b<a)return this._cursor._index=b,!0;b-=a;this._cursor=this._cursor._link}return!1};k.forEach=function(b){const a=this.getCursor();for(;a.next();)b(a)};k.link=function(b){if(this._head){for(var a=this._head;a._link;)a=a._link;a._link=b._head;a._link._indexStart=a._indexStart+a.size()}else this._head=b._head};k.getCursor=function(){return this.copy()};k.lookup=function(b){for(this._cursor=
this._head;this._cursor&&!this._cursor.lookup(b);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor};k.copy=function(){var b;const a=new p(null==(b=this._head)?void 0:b.copy());if(!a._head)return a;b=a._head;let f=a._head._link;for(;f;)b._link=f.copy(),b=f,f=b._link;return a};k.next=function(){if(!this._cursor)return!1;if(!this._cursor.next()){if(!this._cursor._link)return!1;this._cursor=this._cursor._link;return this.next()}return!0};k.peekId=function(){var b;
return null!=(b=this._cursor.peekId())?b:this._cursor._link.peekId()};k.delete=function(b){let a=this._head,f=null;for(;a;){if(a.delete(b))return a.isEmpty()&&(F.isSome(f)&&(f._link=a._link),a===this._head&&(this._head=a._link),a===this._cursor&&(this._cursor=a._link)),!0;f=a;a=a._link}return!1};G._createClass(p,[{key:"id",get:function(){return this._cursor.id},set:function(b){this._cursor.id=b}},{key:"materialKey",get:function(){return this._cursor.materialKey},set:function(b){this._cursor.materialKey=
b}},{key:"insertAfter",get:function(){return this._cursor.insertAfter}},{key:"indexFrom",get:function(){return this._cursor.indexFrom},set:function(b){this._cursor.indexFrom=b}},{key:"indexCount",get:function(){return this._cursor.indexCount},set:function(b){this._cursor.indexCount=b}},{key:"vertexFrom",get:function(){return this._cursor.vertexFrom},set:function(b){this._cursor.vertexFrom=b}},{key:"vertexCount",get:function(){return this._cursor.vertexCount},set:function(b){this._cursor.vertexCount=
b}},{key:"sortKey",get:function(){return this._cursor.sortKey},set:function(b){this._cursor.sortKey=b}},{key:"index",get:function(){return this._cursor._indexStart+this._cursor._index}}]);return p}();y.ELEMENTS_PER_RECORD=C.DISPLAY_RECORD_INT_PER_ELEMENT;y.BYTES_PER_RECORD=y.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;let v=function(){function p(b){this._link=null;this._index=-1;this._deletedCount=this._indexStart=0;this._offsets={instance:null};this._packedRecords=b}p.from=function(b,a=0,f=
b.byteLength/this.BYTES_PER_RECORD-a){return new p(new Int32Array(b,a*this.BYTES_PER_RECORD,f*this.ELEMENTS_PER_RECORD))};var k=p.prototype;k.delete=function(b){const a=this._index,f=this.lookup(b);if(f)for(this.id=2147483647,++this._deletedCount;this.next()&&this.id===b;)this.id=2147483647,++this._deletedCount;this._index=a;return f};k.isEmpty=function(){return this._deletedCount===this.size()};k.link=function(b){this._link?this._link.link(b):this._link=b};k.lookup=function(b){if(F.isNone(this._offsets.instance)){this._offsets.instance=
new Map;var a=this.copy();a._index=-1;let f=0;for(;a.next();)a.id!==f&&(this._offsets.instance.set(a.id,a._index),f=a.id)}if(!this._offsets.instance.has(b))return!1;a=this._index;this._index=this._offsets.instance.get(b);return 2147483647===this.id?(this._index=a,!1):!0};k.size=function(){return this._packedRecords.length/p.ELEMENTS_PER_RECORD};k.next=function(){for(;++this._index<this.size()&&2147483647===this.id;);return this._index<this.size()};k.peekId=function(){const b=(this._index+1)*p.ELEMENTS_PER_RECORD;
return b>=this._packedRecords.length?0:this._packedRecords[b]};k.getCursor=function(){return this.copy()};k.copy=function(){const b=new p(this._packedRecords);b._indexStart=this._indexStart;b._link=this._link;b._index=this._index;b._offsets=this._offsets;b._deletedCount=this._deletedCount;return b};G._createClass(p,[{key:"id",get:function(){return this._packedRecords[this._index*p.ELEMENTS_PER_RECORD]},set:function(b){this._packedRecords[this._index*p.ELEMENTS_PER_RECORD]=b}},{key:"materialKey",get:function(){return this._packedRecords[this._index*
p.ELEMENTS_PER_RECORD+1]},set:function(b){this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+1]=b}},{key:"insertAfter",get:function(){return this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+2]}},{key:"indexFrom",get:function(){return this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+3]},set:function(b){this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+3]=b}},{key:"indexCount",get:function(){return this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+4]},set:function(b){this._packedRecords[this._index*
p.ELEMENTS_PER_RECORD+4]=b}},{key:"vertexFrom",get:function(){return this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+5]},set:function(b){this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+5]=b}},{key:"vertexCount",get:function(){return this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+6]},set:function(b){this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+6]=b}},{key:"sortKey",get:function(){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));
return this._packedRecordsF32[this._index*p.ELEMENTS_PER_RECORD+7]},set:function(b){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));this._packedRecordsF32[this._index*p.ELEMENTS_PER_RECORD+7]=b}},{key:"index",get:function(){return this._index}}]);return p}();v.ELEMENTS_PER_RECORD=C.DISPLAY_RECORD_INT_PER_ELEMENT;v.BYTES_PER_RECORD=v.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;u.DisplayRecordReader=y;Object.defineProperty(u,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["exports","../Utils"],function(u,G){let F=function(){function y(v,p){this.data=v;this.stride=p}y.decode=function(v){const p=G.allocateTypedArrayBufferwithData(v.data,v.stride);return new y(p,v.stride)};y.fromVertexVector=function(v){const p=G.allocateTypedArrayBufferwithData(v.data.buffer(),v.stride);return new y(p,v.stride)};return y}(),C=function(){function y(v,p,k){this.geometryType=v;this.indexBuffer=new Uint32Array(p);this.namedBuffers=
k}y.decode=function(v){const p=v.geometryType,k=v.indexBuffer,b={};for(const a in v.namedBuffers)b[a]=F.decode(v.namedBuffers[a]);return new y(p,k,b)};y.fromVertexData=function(v,p){const k=v.indices,b=G.allocateTypedArrayBufferwithData(v.vertices,v.stride);v={geometry:new F(b,v.stride)};return new y(p,k,v)};y.fromVertexVectors=function(v){const p=v.geometryType,k=v.indexVector.buffer(),b={};for(const a in v.namedVectors)b[a]=F.fromVertexVector(v.namedVectors[a]);return new y(p,k,b)};return y}();
u.VertexBuffers=C;u.default=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../Utils","./VertexBuffer","../util/Writer"],function(u,G,F,C,y){let v=function(){function k(b,a){this.data=b;this.stride=a}k.prototype.transfer=function(b,a){const f=this.data.buffer();b.vertexCount=this.vertexCount;b.data=f;b.stride=this.stride;a.push(f)};G._createClass(k,[{key:"vertexCount",
get:function(){const b=this.data.length/(this.stride/4);b!==(b|0)&&console.debug("Corrupted stride");return b}}]);return k}(),p=function(){function k(a,f,c){this.geometryType=a;this.indexVector=new y(Uint32Array,6*f);this.namedVectors={};a=F.getStrides(a,c);for(const h in a){c=a[h];let l;switch(c%4){case 0:case 2:l=new y(Uint32Array,c*f);break;case 1:case 3:l=new y(Uint8Array,c*f)}this.namedVectors[h]=new v(l,c)}}var b=k.prototype;b.get=function(a){return this.namedVectors[a].data};b.getVector=function(a){return this.namedVectors[a]};
b.transfer=function(a,f){const c=this.indexVector.buffer(),h={};f.push(c);for(const l in this.namedVectors){const q=this.namedVectors[l];h[l]={};q.transfer(h[l],f)}a.geometryType=this.geometryType;a.indexBuffer=c;a.namedBuffers=h;this.destroy()};b.intoBuffers=function(){const a=C.VertexBuffers.fromVertexVectors(this);this.destroy();return a};b.destroy=function(){this.namedVectors=this.indexVector=null};return k}();u.VertexVectors=p;u.default=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],
function(u){return function(){function G(C,y){this._pos=0;y=y?this._roundToNearest(y,C.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(y);this._buffer=new C(this._array);this._ctor=C;this._i16View=new Int16Array(this._array)}var F=G.prototype;F._roundToNearest=function(C,y){C=Math.round(C);return C+(y-C%y)};F._ensureSize=function(C){if(this._pos+C>=this._buffer.length){C=this._roundToNearest(1.25*(this._array.byteLength+C*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);C=new ArrayBuffer(C);
const y=new this._ctor(C);y.set(this._buffer,0);this._array=C;this._buffer=y;this._i16View=new Int16Array(this._array)}};F.ensureSize=function(C){this._ensureSize(C)};F.writeF32=function(C){this._ensureSize(1);const y=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=C;this._pos++;return y};F.push=function(C){this._ensureSize(1);const y=this._pos;this._buffer[this._pos++]=C;return y};F.writeFixed=function(C){this._buffer[this._pos++]=C};F.setValue=function(C,y){this._buffer[C]=y};F.i1616Add=
function(C,y,v){this._i16View[2*C]+=y;this._i16View[2*C+1]+=v};F.getValue=function(C){return this._buffer[C]};F.incr=function(C){if(this._buffer.length<C)throw Error("Increment index overflows the target buffer");this._buffer[C]++};F.decr=function(C){this._buffer[C]--};F.writeRegion=function(C){this._ensureSize(C.length);const y=this._pos;this._buffer.set(C,this._pos);this._pos+=C.length;return y};F.writeManyFrom=function(C,y,v){for(this._ensureSize(v-y);y!==v;y++)this.writeFixed(C._buffer[y])};F.buffer=
function(){const C=this._array.slice(0,4*this._pos);this.destroy();return C};F.toArray=function(){const C=this._array,y=[];for(let v=0;v<C.byteLength/4;v++)y.push(C[v]);return y};F.seek=function(C){this._pos=C};F.destroy=function(){this._buffer=this._array=null};u._createClass(G,[{key:"length",get:function(){return this._pos}}]);return G}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../DisplayId ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/tileUtils".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h){function l(e){switch(e){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function q(e){switch(e){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}F=function(){function e(g,m,n,r,t){this.hasRecords=this._hasAggregate=!1;this._data={self:new Map,neighbors:[]};this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,vertStart:0,
isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=m;this.tileKey=g;this._hasAggregate=r;this._pixelBufferEnabled=t;this._strideOptions=n}var d=e.prototype;d.serialize=function(g){const m=[];m.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self));this._data.neighbors.forEach((n,r)=>{var t=1<<r;r=l(t);t=q(t);r=h.getPow2NeighborKey(new y(this.tileKey),r,t,g);r=this._serializeTileVertexData(this.tileKey,r.id,n.vertexData);r.message.bufferIds=n.displayIds;m.push(r)});
return m};d._serializeTileVertexData=function(g,m,n){var r,t,z,w,B;const A=[];n={[a.WGLGeometryType.MARKER]:null==(r=n.get(a.WGLGeometryType.MARKER))?void 0:r.serialize(A),[a.WGLGeometryType.FILL]:null==(t=n.get(a.WGLGeometryType.FILL))?void 0:t.serialize(A),[a.WGLGeometryType.LINE]:null==(z=n.get(a.WGLGeometryType.LINE))?void 0:z.serialize(A),[a.WGLGeometryType.TEXT]:null==(w=n.get(a.WGLGeometryType.TEXT))?void 0:w.serialize(A),[a.WGLGeometryType.LABEL]:null==(B=n.get(a.WGLGeometryType.LABEL))?void 0:
B.serialize(A)};return{message:{tileKeyOrigin:g,tileKey:m,data:n},transferList:A}};d.featureStart=function(g,m){this._current.insertAfter=g;this._current.sortKey=m};d.featureEnd=function(){};d.recordStart=function(g,m,n,r){this._current.writer=this._getVertexWriter(n);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=r;this._current.id=g;this._current.materialKey=m;this._current.geometryType=
n;this._current.isDotDensity=!1;this._current.writer.recordStart()};d.recordCount=function(){return this._current.writer.recordCount};d.vertexCount=function(){return this._current.writer.vertexCount};d.indexCount=function(){return this._current.writer.indexCount};d.vertexEnsureSize=function(g){this._current.writer.vertexEnsureSize(g)};d.indexEnsureSize=function(g){this._current.writer.indexEnsureSize(g)};d.vertexBounds=function(g,m,n,r){this._current.bufferingEnabled&&this._addOverlap(g,m,n,r)};d.vertexWrite=
function(g){this._current.writer.writeVertex(g)};d.vertexWriteF32=function(g){this._current.writer.writeVertexF32(g)};d.vertexEnd=function(){};d.vertexWriter=function(){return this._current.writer.vertexWriter};d.indexWrite=function(g){this._current.writer.writeIndex(g)};d.indexWriter=function(){return this._current.writer.indexWriter};d.metricWriter=function(){return this._current.writer.metricWriter};d.metricStart=function(g,m,n,r,t,z,w,B){this._current.writer=this._getVertexWriter(a.WGLGeometryType.LABEL);
const A=this._current.writer.metricWriter;A.push(b.getDisplayIdTexel(g));A.push(m);A.push(n);A.push(r);A.push(t);A.push(z);A.push(w);A.push(B);A.push(255);this._current.metricBoxLenPointer=A.push(0)};d.metricEnd=function(){const g=this._current.writer.metricWriter;0===g.getValue(this._current.metricBoxLenPointer)&&g.seek(g.length-10)};d.metricBoxWrite=function(g,m,n,r){const t=this._current.writer.metricWriter;t.incr(this._current.metricBoxLenPointer);t.push(0);t.push(0);t.push(g);t.push(m);t.push(n);
t.push(r)};d.recordEnd=function(){var g=this._current.indexStart,m=this._current.writer.indexCount;if(g===m)return!1;this.hasRecords=!0;var n=this._current.vertStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,g,m-g,n,this._current.writer.vertexCount-n,this._current.sortKey);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===a.WGLGeometryType.LABEL)return!0;g=this._current.writer;for(m=
0;8>m;m++){var r=1<<m;if(this._current.overlaps&r){this._data.neighbors[m]||(this._data.neighbors[m]={vertexData:new Map,displayIds:new Set});n=this._data.neighbors[m];var t=this._current.geometryType;if(!n.vertexData.has(t)){var z=f.getStrides(t,this._strideOptions).geometry;z=new c.VertexDataWriter(t,z,k.PATCH_PIXEL_BUFFER_ALLOC_SIZE);n.vertexData.set(t,z)}t=n.vertexData.get(this._current.geometryType);z=4096*-l(r);r=4096*-q(r);t.copyLastFrom(g,z,r);n.displayIds.add(this._current.id)}}return!0};
d._addOverlap=function(g,m,n,r){this._current.overlaps|=255^((g<0+n?148:g>=k.TILE_SIZE-n?41:189)|(m<0+r?224:m>=k.TILE_SIZE-r?7:231))};d._getVertexWriter=function(g){if(!this._data.self.has(g)){const m=this._data.self,n=f.getStrides(g,this._strideOptions).geometry;m.set(g,new c.VertexDataWriter(g,n,this.hint.records))}return this._data.self.get(g)};G._createClass(e,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);
return e}();u.MeshData=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/DisplayId":function(){define(["exports"],function(u){u.AGGREGATE_VALID_FILTERS_MASK=254;u.DISPLAY_ID_TEXEL_MASK=8388607;u.DISPLAY_ID_TYPE_AGGREGATE=1;u.DISPLAY_ID_TYPE_FEATURE=0;u.DISPLAY_ID_TYPE_MASK=8388608;u.NONAGGREGATE_VALID_FILTERS_MASK=255;u.createDisplayId=function(G,F){return((F?8388608:0)|G)>>>0};u.getDisplayIdFilterMask=G=>1===(G&8388608)>>>23?254:255;u.getDisplayIdTexel=G=>G&8388607;
u.getDisplayIdType=G=>(G&8388608)>>>23;u.isAggregateId=function(G){return 1===(G&8388608)>>>23};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(u,G,F,C,y){let v=function(){function p(b,a,f){this._start={index:0,vertex:0};f=C.getMeshSizeHint(b,a,f);a/=4;this.geometryType=b;this._records=new y(Int32Array,f.recordBytes);
this._indices=new y(Uint32Array,f.indexBytes);this._vertices=new y(Uint32Array,f.vertexBytes);this._metrics=new y(Float32Array,0);this._strideInt=a}var k=p.prototype;k.serialize=function(b){const a=this._records.buffer(),f=this._indices.buffer(),c=this._vertices.buffer(),h=this._metrics.length?this._metrics.buffer():null,l=4*this._strideInt;b.push(a,f,c);return{stride:l,records:a,indices:f,vertices:c,metrics:h}};k.vertexEnsureSize=function(b){this._vertices.ensureSize(b)};k.indexEnsureSize=function(b){this._indices.ensureSize(b)};
k.recordStart=function(){this._start.index=this._indices.length;this._start.vertex=this._vertices.length};k.recordEnd=function(b,a,f,c,h,l,q,e){this._records.push(b);this._records.push(a);this._records.push(f);this._records.push(c);this._records.push(h);this._records.push(l);this._records.push(q);this._records.writeF32(e)};k.writeIndex=function(b){this._indices.push(b)};k.writeVertex=function(b){this._vertices.push(b)};k.writeVertexF32=function(b){this._vertices.writeF32(b)};k.copyLastFrom=function(b,
a,f){var c=b._records.length-F.DISPLAY_RECORD_INT_PER_ELEMENT;const h=b._records.getValue(c),l=b._records.getValue(c+1),q=b._records.getValue(c+2),e=b._records.getValue(c+4),d=b._records.getValue(c+6);c=b._records.getValue(c+7);const g=this._vertices.length;var m=(b._start.vertex-this._vertices.length)/this._strideInt;const n=this._indices.length,r=this.vertexCount;for(var t=b._start.index;t!==b._indices.length;t++){const z=b._indices.getValue(t);this._indices.push(z-m)}for(m=b._start.vertex;m!==
b._vertices.length;m++)t=b._vertices.getValue(m),this._vertices.push(t);for(b=g;b<=this._vertices.length;b+=this._strideInt)this._vertices.i1616Add(b,a,f);this._records.push(h);this._records.push(l);this._records.push(q);this._records.push(n);this._records.push(e);this._records.push(r);this._records.push(d);this._records.push(c)};G._createClass(p,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/F.DISPLAY_RECORD_INT_PER_ELEMENT}},
{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return p}();u.VertexDataWriter=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports","../definitions","../enums"],
function(u,G,F){const C=new Map;C.set(F.WGLGeometryType.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});C.set(F.WGLGeometryType.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8});C.set(F.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});C.set(F.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});C.set(F.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});u.getMeshHeuristic=function(y){return C.get(y)};
u.getMeshSizeHint=function(y,v,p){const {indicesPerRecord:k,multiplier:b,verticesPerRecord:a}=C.get(y);return{recordBytes:p*G.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:b*k*p*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:b*a*p*v}};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports","./Tile"],function(u,G){function F(C,y,v,p){C=C.clone();const k=1<<C.level;y=C.col+y;v=C.row+v;p&&0>y?(C.col=y+k,--C.world):
y>=k?(C.col=y-k,C.world+=1):C.col=y;C.row=v;return C}u.getPow2NeighborKey=F;u.getPow2NeighborTile=function(C,y,v){y=F(C.key,y,v,C.tileInfoView.tileInfo.isWrappable);return new G.Tile(C.tileInfoView,y)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/libtess ../../DisplayId ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(u,G,F,C,y,v,p,k,b,a){F=function(){function f(h,l,q){this._loadPromise=v.loadLibtess();this._geometryType=h;this._idField=l;this._templateStore=q}var c=f.prototype;c.update=function(h,l){C.isSome(h.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(h.mesh.labels,l));this._schema=h};c._createLabelTemplates=function(h,l){const q=new Map;if("simple"===h.type){for(var e of h.classes)h=k.fromLabelClass(e,l),q.set(e.index,h);return q}for(const d in h.classes){e=h.classes[d];for(const g of e)e=
k.fromLabelClass(g,l),q.set(g.index,e)}return q};c.analyze=function(){var h=G._asyncToGenerator(function*(l,q,e,d,g,m,n){if(!y.isAborted(n)){var r;"dictionary"===e.type&&(r=yield e.analyze(this._idField,l.copy(),q,g,m,n));for(q=0;l.next();){var t=void 0;t=r?r[q++]:C.isSome(d)&&p.isAggregateId(l.getDisplayId())&&1!==l.readAttribute("cluster_count")?d.match(this._idField,l,this._geometryType,g,m):e.match(this._idField,l,this._geometryType,g,m);l.setGroupId(t);if(a.isDynamicId(t)){t=this._templateStore.getDynamicTemplateGroup(t);
for(const z of t)z&&z.analyze&&z.analyze(this._templateStore,l,g,m)}}yield this._loadPromise;return this._templateStore.finalize(n)}});return function(l,q,e,d,g,m,n){return h.apply(this,arguments)}}();c.analyzeGraphics=function(){var h=G._asyncToGenerator(function*(l,q,e,d,g,m){if(!y.isAborted(m)){l=l.getCursor();for(e&&(yield e.analyze(this._idField,l.copy(),q,d,g,m));l.next();){q=l.getGroupId();if(null==q||-1===q)q=e.match(this._idField,l,l.geometryType,d,g),l.setGroupId(q);if(a.isDynamicId(q)){const n=
this._templateStore.getDynamicTemplateGroup(q);for(const r of n)r&&r.analyze&&r.analyze(this._templateStore,l,d,g)}l.setGroupId(q)}yield this._loadPromise;return this._templateStore.finalize(m)}});return function(l,q,e,d,g,m){return h.apply(this,arguments)}}();c.writeGraphic=function(h,l,q){const e=l.getGroupId(),d=l.getDisplayId(),g=this._templateStore.getTemplateGroup(e);h.featureStart(l.insertAfter,0);if(null!=d){if(a.isDynamicId(e))for(const m of g)m&&m.bindFeature(l,null,null);if(g){for(const m of g)m&&
m.write(h,l,q);h.featureEnd()}}};c.writeCursor=function(h,l,q,e,d,g){const m=l.getGroupId(),n=l.getDisplayId(),r=this._templateStore.getTemplateGroup(m),t=this._schema.mesh.sortKey;let z=0;C.isSome(t)&&(z=null!=t.fieldIndex?l.getComputedNumericAtIndex(t.fieldIndex):null!=t.field?l.readAttribute(t.field):l.readAttribute(this._idField),z*="asc"===t.order?1:-1);h.featureStart(0,null==z||isNaN(z)?0:z);if(null!=n&&r){if(a.isDynamicId(m))for(const w of r)w.bindFeature(l,q,e);for(const w of r)w.write(h,
l,d);C.isSome(g)&&h.hasRecords&&(q=g&&this._findLabelRef(r),this._writeLabels(h,l,g,q,d));h.featureEnd()}};c._findLabelRef=function(h){for(const l of h)if(l instanceof b)return l;return null};c._writeLabels=function(h,l,q,e,d){for(const g of q)if(C.isSome(g)&&g){const {glyphs:m,rtl:n,index:r}=g;q=this._labelTemplates.get(r);q.setZoomLevel(d);q.bindReferenceTemplate(e);q.bindTextInfo(m,n);q.write(h,l,null)}};G._createClass(f,[{key:"templates",get:function(){return this._templateStore}}]);return f}();
u.WGLMeshFactory=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/geometry/libtess":function(){define(["require","exports","../chunks/_rollupPluginBabelHelpers","../assets","../core/has"],function(u,G,F,C,y){function v(){v=F._asyncToGenerator(function*(){b||(b=p());return b});return v.apply(this,arguments)}function p(){return k.apply(this,arguments)}function k(){k=F._asyncToGenerator(function*(){a=yield(y("esri-csp-restrictions")?yield(new Promise((f,c)=>u(["../chunks/libtess-asm"],f,c))).then(f=>
f.libtessAsm):yield(new Promise((f,c)=>u(["../chunks/libtess"],f,c))).then(f=>f.libtess)).load({locateFile:()=>C.getAssetUrl("esri/core/libs/libtess/libtess.wasm")})});return k.apply(this,arguments)}let b=null,a=null;G.loadLibtess=function(){return v.apply(this,arguments)};G.triangulate=function(f,c){return a.triangulate(f,c,Math.max(f.length,128E3))};Object.defineProperty(G,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./meshUtils ./segmentUtils ./WGLTextTemplate".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q){const e=F.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),d=(m,n="mapview-labeling")=>e.error(new G(n,m)),g=function(m){const n=new Map;return r=>{n.has(r)||n.set(r,m(r));return n.get(r)}}(m=>{let n=0;if(0===m)return Infinity;for(;!(m%2);)n++,m/=2;return n});return function(m){function n(t,z,w,B){var A,x,E;var D=m.call(this,t,w.font.size,w.haloSize||0,w.font.size,w.color&&k.premultiplyAlphaRGBAArray(w.color)||0,w.haloColor&&k.premultiplyAlphaRGBAArray(w.haloColor)||
0,w.horizontalAlignment,w.verticalAlignment,h.isMapAligned(z.labelPlacement)?1:0,w.font.decoration,!1,w.angle||0,w.xoffset,w.yoffset,w.lineWidth,w.lineHeight,null,null,null,null,null)||this;D._outLineLabelAngle=0;D._refPlacementPadding=0;D._refPlacementDirX=0;D._refPlacementDirY=0;D._refOffsetX=0;D._refOffsetY=0;D._zoomLevel=0;D.geometryType=a.WGLGeometryType.LABEL;D._allowOverrun=null!=(A=z.allowOverrun)?A:!1;D._repeatLabel=null!=(x=z.repeatLabel)?x:!0;D._labelPosition=null!=(E=z.labelPosition)?
E:"curved";A=!!z.minScale&&B.scaleToZoom(z.minScale)||0;A=C.clamp(A,0,25.5);B=!!z.maxScale&&B.scaleToZoom(z.maxScale)||255;B=C.clamp(B,0,25.5);const [K,H]=p.getAlignmentFromPlacement(z.labelPlacement);D._xAlignD=K;D._yAlignD=H;D._minZoom=A;D._maxZoom=B;D._refPlacementPadding=v.pt2px(w.haloSize)+b.TEXT_PLACEMENT_PADDING;D._repeatLabelDistance=z.repeatLabelDistance?v.pt2px(z.repeatLabelDistance):128;t=c.LabelMaterialKey.load(t);t.sdf=!0;D._materialKey=t.data;return D}u._inheritsLoose(n,m);n.fromLabelClass=
function(t,z){if("esriServerLinePlacementCenterAlong"===t.labelPlacement){const w=t.symbol;w.xoffset=0;w.yoffset=0;w.angle=0;w.font.decoration="none"}return new n(t.materialKey,t,t.symbol,z)};var r=n.prototype;r.setZoomLevel=function(t){this._zoomLevel=t};r.bindReferenceTemplate=function(t){let z=p.getXDirection(this._xAlignD),w=p.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(y.isNone(t))this._refSymbolAndPlacementOffset=f.i8888to32(0,0,Math.floor(127*z+127),Math.floor(127*w+
127));else{if("circle"===t.boundsType&&(z||w)){var B=Math.sqrt(z*z+w*w);z/=B;w/=B}B=Math.max(t.height,t.width);this._refSymbolAndPlacementOffset=f.i8888to32(4*this._refPlacementPadding,B,Math.floor(127*z+127),Math.floor(127*w+127));this._referenceSize=B;this._refPlacementDirX=z;this._refPlacementDirY=w;this._refOffsetX=t.xOffset;this._refOffsetY=t.yOffset}};r._write=function(t,z){if(!y.isNone(this._shapingInfo)){var w=this._shapingInfo,B=z.getDisplayId(),A="esriGeometryPolygon"===z.geometryType?z.readLegacyCentroid():
z.readLegacyGeometry();if(A)switch(this.current={out:t,inId:B,inShaping:w,zoomLevel:this._zoomLevel},z.geometryType){case "esriGeometryPolyline":this._placeLineLabels(A);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(A);break;default:d("mapview-labeling",`Geometry of type ${z.geometryType} is not supported`)}}};r._isVisible=function(t,z){const w=Math.floor(10*this.current.zoomLevel);return Math.floor(10*t)<=w&&w<=Math.floor(10*z)};r._placePointLabels=function(t){const {out:z,
inId:w,inShaping:B}=this.current;this._writeGlyphs(z,w,t,B)};r._placeLineLabels=function(t){t=l.smoothPaths(t.paths,this.current.inShaping.bounds.width);const z=this._placeSubdivGlyphs.bind(this),w=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const B of t)l.pathDivide(B,w,z,this._repeatLabel)};r._placeSubdivGlyphs=function(t,z,w,B){var A=g(z);w=Math.log2(Math.min(w,B-w)/(Math.sqrt(this._repeatLabelDistance)/2+this._shapedBox.width/2/2));A=Math.max(this._minZoom,this.current.zoomLevel+1-
(0===z?w:Math.min(A,w)));w=this.current.zoomLevel-A;B=this._shapedBox.width/2*2**w;this.current.inShaping.isMultiline?0===z&&this._placeStraight(t,A):this._allowOverrun&&0>w?this._placeStraightAlong(t,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(t,A):"curved"===this._labelPosition&&this._placeCurved(t,A,B)};r._placeStraight=function(t,z){const {out:w,inId:B,inShaping:A}=this.current;this._writeGlyphs(w,B,t,A,z)};r._placeCurved=function(t,z,w){const {out:B,inId:A}=this.current;
B.metricStart(A,z,t.x,t.y,0,0,0,0);const x=t.clone(),E=(180/Math.PI*t.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*t.angle%360*(254/360));this._placeFirst(x,z,1);this._placeBack(t,x,z,w,1);this._placeForward(t,x,z,w,1);this._outLineLabelAngle=Math.round(254/360*E);this._placeFirst(x,z,0);this._placeBack(t,x,z,w,0);this._placeForward(t,x,z,w,0);B.metricEnd()};r._placeStraightAlong=function(t,z){const {out:w,inId:B}=this.current;w.metricStart(B,z,t.x,t.y,0,0,0,0);const A=t.clone(),
x=(180/Math.PI*t.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*t.angle%360*(254/360));this._placeFirst(A,z,1,!0);this._outLineLabelAngle=Math.round(254/360*x);this._placeFirst(A,z,0,!0);w.metricEnd()};r._placeBack=function(t,z,w,B,A){const x=t.clone();for(t=t.backwardLength+0;x.prev()&&!(t>=B);)this._placeOnSegment(x,z,t,w,-1,A),t+=x.length+0};r._placeForward=function(t,z,w,B,A){const x=t.clone();for(t=t.remainingLength+0;x.next()&&!(t>=B);)this._placeOnSegment(x,z,t,w,1,A),t+=x.length+
0};r._placeFirst=function(t,z,w,B=!1){const A=this.current.inShaping;var x=A.glyphs;const E=this.current.zoomLevel,{out:D,inId:K}=this.current;for(const H of x)x=H.x>A.bounds.x?w:1-w,x=Math.max(0,E+Math.log2(Math.abs(H.x+H.width/2-A.bounds.x)/(x*t.remainingLength+(1-x)*t.backwardLength))),x=Math.max(z,B?0:x),H.maxZoom=25,H.angle=t.angle+(1-w)*Math.PI,H.minZoom=x,this._writeGlyph(D,K,t.x,t.y,H),w&&this._isVisible(H.minZoom,H.maxZoom)&&(x=H.bounds,D.metricBoxWrite(x.center[0],x.center[1],x.width,x.height))};
r._placeOnSegment=function(t,z,w,B,A,x){var E=this.current.inShaping.glyphs;const {out:D,inId:K}=this.current,H=this.current.inShaping,I=this.current.zoomLevel;var J=t.x+t.dx/t.length*-A*w,M=t.y+t.dy/t.length*-A*w;for(const L of E)if((E=L.x>H.bounds.x?x:1-x)&&1===A||!E&&-1===A){var O=Math.abs(L.x+L.width/2-H.bounds.x);E=Math.max(0,I+Math.log2(O/w)-.1);O=Math.max(B,I+Math.log2(O/(w+t.length+0)));0!==E&&(L.angle=t.angle+(1-x)*Math.PI,L.minZoom=O,L.maxZoom=E,this._writeGlyph(D,K,J,M,L),x&&this._isVisible(L.minZoom,
L.maxZoom)&&(E=L.bounds,D.metricBoxWrite(E.center[0]+(t.x-z.x),E.center[1]+(t.y-z.y),E.width,E.height)))}};r._writeGlyphs=function(t,z,w,B,A=this._minZoom){if(!(0>w.x||512<=w.x||0>w.y||512<=w.y)){var x=w.x+this._refOffsetX;w=w.y-this._refOffsetY;for(const E of B.glyphs)E.minZoom=A,E.maxZoom=this._maxZoom,this._writeGlyph(t,z,x,w,E);B=B.boundsT;t.metricStart(z,A,x,w,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);t.metricBoxWrite(B.center[0],B.center[1],B.width,
B.height);t.metricEnd()}};r._writeVertexCommon=function(t,z,w,B){const A=this._color,x=this._haloColor,E=f.i8888to32(0,0,this._size,this._haloSize);B=f.i8888to32(Math.floor(10*Math.max(B.minZoom,this._minZoom)),Math.floor(10*Math.min(B.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);t.vertexWrite(w);t.vertexWrite(z);t.vertexWrite(A);t.vertexWrite(x);t.vertexWrite(E);t.vertexWrite(this._refSymbolAndPlacementOffset);t.vertexWrite(B)};u._createClass(n,[{key:"_shapedBox",get:function(){return y.unwrap(this._shapingInfo).bounds}}]);
return n}(q)})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],function(u,G,F,C){function y(a){return a.length-1}function v(a){let f=0;for(let c=0;c<y(a);c++)f+=p(a,c);return f}function p(a,f,c=1){const [h,l]=a[f+1];return Math.sqrt(h*h+l*l)*c}function k(a,f,c,h,l){if(!(c<f)){var q=h.clone().seek(c/2);F.isNone(q)||(a(q.clone(),c,l),c=(c-f)/2,q=F.unwrap(q.seek(f/2)),
k(a,f,c,h,l+1),k(a,f,c,q,l+1))}}let b=function(){function a(c,h,l,q,e){this._segments=c;this._index=h;this._distance=l;this._xStart=q;this._yStart=e;this._done=!1}a.create=function(c){return new a(c,0,0,c[0][0],c[0][1])};var f=a.prototype;f.clone=function(){return new a(this._segments,this._index,this._distance,this.xStart,this.yStart)};f.equals=function(c){return this._index===c._index||c._index===this._index-1&&(0===this._distance||1===c._distance)||c._index===this._index+1&&(1===this._distance||
0===c._distance)};f.leq=function(c){return this._index<c._index||this._index===c._index&&this._distance<=c._distance};f.geq=function(c){return this._index>c._index||this._index===c._index&&this._distance>=c._distance};f.hasPrev=function(){return 0<=this._index-1};f.hasNext=function(){return this._index+1<y(this._segments)};f.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};f.prev=function(){if(!this.hasPrev())return this._done=
!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};f._seekBackwards=function(c,h){var l=this.backwardLength;if(c<=l)return this._distance=(l-c)/this.length,this;for(l=this.backwardLength;this.prev();){if(l+this.length>c)return this._seekBackwards(c-l);l+=this.length}this._distance=0;return h?this:null};f.seek=function(c,h=!1){if(0>c)return this._seekBackwards(Math.abs(c),h);if(c<=this.remainingLength)return this._distance=(this.backwardLength+c)/this.length,
this;let l=this.remainingLength;for(;this.next();){if(l+this.length>c)return this.seek(c-l,h);l+=this.length}this._distance=1;return h?this:null};G._createClass(a,[{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){const c=this.dy;let h=Math.acos((0*c+-1*-this.dx)/(1*this.length));0<c&&(h=2*Math.PI-h);return h}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+
this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:c,dy:h}=this;return Math.sqrt(c*
c+h*h)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);return a}();u.SegmentCursor=b;u.pathDivide=function(a,f,c,h=!0){const l=v(a);a=b.create(a);const q=l/2;if(h){h=Math.floor(Math.max((l-f)/2,0)/f);a.seek(q-h*f);for(let e=-h;e<=h;e++)512>a.x&&0<=a.x&&512>a.y&&0<=a.y&&c(a.clone(),e,q+e*f,l),
a.seek(f)}else a.seek(q),c(a.clone(),0,q+0*f,l)};u.pathLength=v;u.pathSubdivide=function(a,f,c){k(c,f,v(a),b.create(a),0)};u.segmentAt=function(a,f){return a[f+1]};u.segmentCount=y;u.segmentLength=p;u.smoothPaths=function(a,f){for(let x=0;x<a.length;x++){var c=a[x];const E=[];E.push(c[0]);for(var h=1;h<c.length;h++){let [D,K]=E[h-1];D+=c[h][0];K+=c[h][1];E.push([D,K])}a:{c=E;h=f;if(0>=h)break a;const D=c.length;if(3>D)break a;const K=[];var l=0;K.push(0);for(var q=1;q<D;q++)l+=C.dist(c[q],c[q-1]),
K.push(l);h=Math.min(h,.2*l);l=[];l.push(c[0][0]);l.push(c[0][1]);q=c[D-1][0];const H=c[D-1][1];var e=C.sub([0,0],c[0],c[1]);C.normalize(e);c[0][0]+=h*e[0];c[0][1]+=h*e[1];C.sub(e,c[D-1],c[D-2]);C.normalize(e);c[D-1][0]+=h*e[0];c[D-1][1]+=h*e[1];for(e=1;e<D;e++)K[e]+=h;K[D-1]+=h;e=.5*h;for(let I=1;I<D-1;I++){let J=0,M=0,O=0;for(var d=I-1;0<=d&&!(K[d+1]<K[I]-e);d--){var g=e+K[d+1]-K[I],m=K[d+1]-K[d],n=K[I]-K[d]<e?1:g/m;if(1E-6>Math.abs(n))break;var r=n*n,t=n*g-.5*r*m,z=n*m/h,w=c[d+1],B=c[d][0]-w[0],
A=c[d][1]-w[1];J+=z/t*(w[0]*n*g+.5*r*(g*B-m*w[0])-r*n*m*B/3);M+=z/t*(w[1]*n*g+.5*r*(g*A-m*w[1])-r*n*m*A/3);O+=z}for(d=I+1;d<D&&!(K[d-1]>K[I]+e);d++){g=e-K[d-1]+K[I];m=K[d]-K[d-1];n=K[d]-K[I]<e?1:g/m;if(1E-6>Math.abs(n))break;r=n*n;t=n*g-.5*r*m;z=n*m/h;w=c[d-1];B=c[d][0]-w[0];A=c[d][1]-w[1];J+=z/t*(w[0]*n*g+.5*r*(g*B-m*w[0])-r*n*m*B/3);M+=z/t*(w[1]*n*g+.5*r*(g*A-m*w[1])-r*n*m*A/3);O+=z}l.push(J/O);l.push(M/O)}l.push(q);l.push(H);for(let I=0,J=0;I<D;I++)c[I][0]=l[J++],c[I][1]=l[J++]}c=[];c.push(E[0]);
for(h=1;h<E.length;h++){const [D,K]=E[h-1],[H,I]=E[h];c.push([Math.round(H-D),Math.round(I-K)])}a[x]=c}return a};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],function(u){function G(F,C){return Math.sqrt(F*F+C*C)}u.DEFAULT_MAX_ZOOM=100;u.DEFAULT_MIN_ZOOM=0;u.dist=function(F,C){return G(F[0]-C[0],F[1]-C[1])};u.getLimitCosine=function(F=2){return 1/Math.max(F,1)};u.getMinMaxZoom=function(F,C){const y=!!F.minScale&&
C.scaleToZoom(F.minScale)||0;F=!!F.maxScale&&C.scaleToZoom(F.maxScale)||100;return[y,F]};u.isExtent=function(F){return void 0!==F.xmin&&void 0!==F.ymin&&void 0!==F.xmax&&void 0!==F.ymax};u.isFunction=function(F){return"function"===typeof F};u.isMultipoint=function(F){return void 0!==F.points};u.isPoint=function(F){return void 0!==F.x&&void 0!==F.y};u.isPolygon=function(F){return void 0!==F.rings};u.isPolyline=function(F){return void 0!==F.paths};u.len=G;u.normalize=function(F){const C=G(F[0],F[1]);
F[0]/=C;F[1]/=C};u.sub=function(F,C,y){F[0]=C[0]-y[0];F[1]=C[1]-y[1];return F};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/BidiText ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),function(u,G,F,C,y,v,
p,k,b,a,f){return function(c){function h(l,q,e,d,g,m,n,r,t,z,w,B,A,x,E,D,K,H,I=!1,J,M){var O=c.call(this)||this;O._xOffset=F.pt2px(A);O._yOffset=F.pt2px(x);O._decoration=z||"none";O._color=g;O._haloColor=m;O._haloSize=Math.min(Math.floor(5*F.pt2px(F.toPt(e))),127);O._size=Math.min(Math.round(F.pt2px(q)),127);q=Math.min(Math.round(F.pt2px(d||q)),127);O._referenceSize=Math.round(Math.sqrt(256*q));O._scale=O._size/v.GLYPH_SIZE;O._angle=B;O._justify=C.getJustification(n||"center");O._xAlignD=C.getXAnchorDirection(n||
"center");O._yAlignD=C.getYAnchorDirection(r||"baseline");O._baseline="baseline"===(r||"baseline");O._bitset=(1===t?1:0)|(w?1:0)<<1;l=k.MaterialKeyBase.load(l);l.sdf=!0;O._materialKey=l.data;O._lineWidth=F.pt2px(E)||512;O._lineHeight=D||1;O._textPlacement=K;O._effects=H;O._isCIM=I;O._minMaxZoom=p.i1616to32(Math.round(J*v.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(M*v.MIN_MAX_ZOOM_PRECISION_FACTOR));return O}u._inheritsLoose(h,c);h.fromText=function(l,q){const e=new h(l.materialKey,l.font.size,l.haloSize||
0,l.font.size,l.color&&y.premultiplyAlphaRGBAArray(l.color)||0,l.haloColor&&y.premultiplyAlphaRGBAArray(l.haloColor)||0,l.horizontalAlignment,l.verticalAlignment,0,l.font.decoration,!1,l.angle||0,l.xoffset,l.yoffset,l.lineWidth,l.lineHeight,null,null,!1,b.DEFAULT_MIN_ZOOM,b.DEFAULT_MAX_ZOOM),[,d]=G.bidiText(l.text);e.bindTextInfo(q,d);e._vertexBoundsScale=l.maxVVSize?l.maxVVSize/l.font.size:1;return e};h.fromCIMText=function(l,q,e){var d=l.scaleFactor||1;const g=l.size*l.sizeRatio*d,[m,n]=b.getMinMaxZoom(l.scaleInfo,
e);e=new h(l.materialKey,g,l.outlineSize*l.sizeRatio,l.referenceSize,y.premultiplyAlphaRGBA(l.color),y.premultiplyAlphaRGBA(l.outlineColor),l.horizontalAlignment,l.verticalAlignment,l.alignment,l.decoration,l.colorLocked,l.angle,l.offsetX*l.sizeRatio*d,l.offsetY*l.sizeRatio*d,512,1,l.markerPlacement,l.effects,!0,m,n);[,d]=G.bidiText(l.text);e.bindTextInfo(q,d);e._vertexBoundsScale=l.maxVVSize?l.maxVVSize/g:1;return e};return h}(a(f))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),
function(u,G,F,C,y,v,p,k,b,a){return f=>function(c){function h(...q){q=c.call(this,...q)||this;q._isCIM=!1;q._vertexBoundsScale=1;q.geometryType=p.WGLGeometryType.TEXT;q._aux=k.i8888to32(0,0,q._referenceSize,q._bitset);return q}u._inheritsLoose(h,c);var l=h.prototype;l.bindTextInfo=function(q,e){this._shapingInfo=q&&q.length?G.andThen(q,d=>a.shapeGlyphs(d,e,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,
Math.min(this._lineWidth,512)),lineHeight:v.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):null};l._write=function(q,e,d){const g=e.getDisplayId();this._writeGeometry(q,e,g,d)};l._writeGeometry=function(q,e,d,g){const m=this._shapingInfo;if(!G.isNone(m)){if(G.isSome(this._textPlacement))return e=null!=g?g:e.readLegacyGeometryForDisplay(),this._writePlacedText(q,d,e,m);e=g?C.deltaDecodeGeometry(C.convertFromGeometry(g),2):"esriGeometryPolygon"===
e.geometryType?e.readCentroid():e.readGeometryForDisplay();if(!G.isNone(e)){if(e.isPoint){const [n,r]=e.coords;return!q.hasAggregates&&q.hasPixelBufferEnabled&&(0>n||512<=n||0>r||512<=r)?void 0:this._writeGlyphs(q,d,{x:n,y:r},m)}e.forEachVertex((n,r)=>this._writeGlyphs(q,d,{x:n,y:r},m))}}};l._writePlacedText=function(q,e,d,g){var m=G.unwrap(this._textPlacement);if(d=y.CIMMarkerPlacementHelper.getPlacement(d,m,F.pt2px(1)))for(var n=d.next();null!=n;){m=n.getAngle();g.setRotation(m);const r=n.tx;n=
n.ty;0>r||512<=r||0>n||512<=n||(this._writeGlyphs(q,e,{x:r,y:n},g),g.setRotation(-m));n=d.next()}};l._writeGlyphs=function(q,e,d,g){const m=b.MaterialKeyBase.load(this._materialKey),n=k.i1616to32(Math.round(8*d.x),Math.round(8*d.y)),r=this._vertexBoundsScale,t=g.bounds,z=2*Math.max(t.width,t.height);for(const w of g.glyphs)m.textureBinding=w.textureBinding,q.recordStart(e,m.data,this.geometryType,!0),q.vertexBounds(d.x+t.x+this._xOffset,d.y+t.y-this._yOffset,z*r,z*r),this._writeVertices(q,e,n,w),
q.recordEnd()};l._writeGlyph=function(q,e,d,g,m){var n=b.MaterialKeyBase.load(this._materialKey);const r=k.i1616to32(Math.round(8*d),Math.round(8*g));n.textureBinding=m.textureBinding;q.recordStart(e,n.data,this.geometryType,!0);n=m.bounds;const t=this._vertexBoundsScale;q.vertexBounds(d+n.x*t,g+n.y*t,n.width*t,n.height*t);this._writeVertices(q,e,r,m);q.recordEnd()};l._writeVertices=function(q,e,d,g){const m=q.vertexCount();this._writeVertexCommon(q,e,d,g);q.vertexWrite(g.offsets.upperLeft);q.vertexWrite(g.texcoords.upperLeft);
q.vertexEnd();this._writeVertexCommon(q,e,d,g);q.vertexWrite(g.offsets.upperRight);q.vertexWrite(g.texcoords.upperRight);q.vertexEnd();this._writeVertexCommon(q,e,d,g);q.vertexWrite(g.offsets.lowerLeft);q.vertexWrite(g.texcoords.lowerLeft);q.vertexEnd();this._writeVertexCommon(q,e,d,g);q.vertexWrite(g.offsets.lowerRight);q.vertexWrite(g.texcoords.lowerRight);q.vertexEnd();q.indexWrite(m+0);q.indexWrite(m+1);q.indexWrite(m+2);q.indexWrite(m+1);q.indexWrite(m+3);q.indexWrite(m+2)};l._writeVertexCommon=
function(q,e,d,g){g=this._color;const m=this._haloColor,n=k.i8888to32(0,0,this._referenceSize,this._bitset),r=k.i8888to32(0,0,this._size,this._haloSize);q.vertexWrite(d);q.vertexWrite(e);q.vertexWrite(g);q.vertexWrite(m);q.vertexWrite(r);q.vertexWrite(n);q.vertexWrite(this._minMaxZoom)};return h}(f)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(u,G,F){let C=function(){function y(){}y.getPlacement=function(v,p,k){const b=
F.getPlacementOperator(p);if(!b)return null;v=G.cloneAndDecodeGeometry(v);return b.execute(v,p,k)};return y}();u.CIMMarkerPlacementHelper=C;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../core/maybe","../../../../../../symbols/cim/effects/CIMEffectHelper"],function(u,G){return function(){function F(){}var C=F.prototype;C.bindFeature=function(y,v,p){};C.write=function(y,v,p){var k;if(u.isNone(this._effects)||
0===(null==(k=this._effects)?void 0:k.length))return this._write(y,v);p=G.CIMEffectHelper.executeEffects(this._effects,v.readLegacyGeometryForDisplay());for(k=G.CIMEffectHelper.next(p);k;)this._write(y,v,k),k=G.CIMEffectHelper.next(p)};C._write=function(y,v,p){};return F}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../CIMEffects","../CIMOperators"],function(u,G,F,C,y){const v=96/72;let p=function(){function k(){}
k.executeEffects=function(b,a){a=F.cloneAndDecodeGeometry(a);a=new C.SimpleGeometryCursor(a);for(const f of b)(b=y.getEffectOperator(f))&&(a=b.execute(a,f,v,!0));return a};k.next=function(b){b=b.next();F.deltaEncodeGeometry(b);return b};k.applyEffects=function(b,a){if(!b)return a;a=new C.SimpleGeometryCursor(a);for(var f of b)(b=y.getEffectOperator(f))&&(a=b.execute(a,f,1,!1));for(f=null;b=a.next();)f?G.isPolyline(f)?G.isPolyline(b)&&f.paths.push(...b.paths):G.isPolygon(f)&&G.isPolygon(b)&&f.rings.push(...b.rings):
f=b;return f};return k}();u.CIMEffectHelper=p;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),function(u,
G,F,C,y,v,p,k,b,a,f,c){return function(h){function l(q,e,d,g,m,n,r,t,z,w,B,A,x,E,D,K,H,I,J,M,O,L,S){var Q=h.call(this)||this;Q.angle=g;Q.height=r;Q.width=n;Q.xOffset=e*J;Q.yOffset=d*J;Q._markerPlacement=M;Q._effects=O;Q._anchorX=.5-(.5+K)*D.width/D.width;Q._anchorY=.5-(.5+H)*D.height/D.height;Q._minMaxZoom=k.i1616to32(Math.round(L*p.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(S*p.MIN_MAX_ZOOM_PRECISION_FACTOR));e=(1===E?p.BITSET_MARKER_ALIGNMENT_MAP:p.BITSET_MARKER_ALIGNMENT_SCREEN)|(B?p.BITSET_GENERIC_LOCK_COLOR:
0)|(x?p.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:0)|(A?p.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);d=D&&D.sdf;q=b.MarkerMaterialKey.load(q);q.sdf=d;q.pattern=!0;q.textureBinding=D.textureBinding;Q._materialKey=q.data;Q._fillColor=m;Q._outlineColor=z;Q._sizeOutlineWidth=k.i8888to32(Math.round(Math.min(Math.sqrt(128*n),255)),Math.round(Math.min(Math.sqrt(128*r),255)),Math.round(Math.min(Math.sqrt(128*w),255)),Math.round(Math.min(Math.sqrt(128*t),255)));m=D.rect.x+p.SPRITE_PADDING;t=D.rect.y+p.SPRITE_PADDING;
z=m+D.width;D=t+D.height;Q._offsets.xUpperLeft=m;Q._offsets.yUpperLeft=t;Q._offsets.xUpperRight=z;Q._offsets.yUpperRight=t;Q._offsets.xBottomLeft=m;Q._offsets.yBottomLeft=D;Q._offsets.xBottomRight=z;Q._offsets.yBottomRight=D;Q._texUpperLeft=k.i1616to32(m,t);Q._texUpperRight=k.i1616to32(z,t);Q._texBottomLeft=k.i1616to32(m,D);Q._texBottomRight=k.i1616to32(z,D);n=n*I*J;r=r*I*J;Q._bitestAndDistRatio=k.i1616to32(e,Math.round(64*I));Q._computedWidth=n;Q._computedHeight=r;n=y.create();r=C.create();Q._applyTransformation(r,
n);return Q}u._inheritsLoose(l,h);l.fromCIMMarker=function(q,e,d){const g=q.size,m=(e&&e.width||1)/(e&&e.height||1)*q.scaleX;var n=q.scaleSymbolsProportionally&&q.frameHeight?g/q.frameHeight:1;let r=v.premultiplyAlphaRGBA(q.color);const t=v.premultiplyAlphaRGBA(q.outlineColor),z=F.pt2px(g),w=z*m,B=F.pt2px(q.offsetX||0),A=F.pt2px(q.offsetY||0);n*=F.pt2px(q.outlineWidth||0);const x=q.alignment||0,E=F.pt2px(q.referenceSize),[D,K]=a.getMinMaxZoom(q.scaleInfo,d);e.sdf||0!==r||(r=-1);d=q.rotation||0;q.rotateClockwise||
(d=-d);let H=0,I=0;const J=q.anchorPoint;J&&(q.isAbsoluteAnchorPoint?g&&(H=-J.x/(g*m),I=J.y/g):(H=J.x,I=J.y));e=new l(q.materialKey,B,A,d,r,w,z,E,t,n,q.colorLocked,q.scaleSymbolsProportionally,!1,x,e,H,I,q.sizeRatio,G.unwrapOr(q.scaleFactor,1),q.markerPlacement,q.effects,D,K);e._vertexBoundsScaleX=q.maxVVSize?q.maxVVSize/w:1;e._vertexBoundsScaleY=q.maxVVSize?q.maxVVSize/z:1;return e};l.fromPictureMarker=function(q,e){const d=Math.round(F.pt2px(q.width)),g=Math.round(F.pt2px(q.height)),m=p.PICTURE_FILL_COLOR,
n=Math.round(F.pt2px(q.xoffset||0)),r=Math.round(F.pt2px(q.yoffset||0));e=new l(q.materialKey,n,r,q.angle,m,d,g,g,0,0,!1,!1,!1,0,e,0,0,1,1,null,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM);e._vertexBoundsScaleX=q.maxVVSize?q.maxVVSize/q.width:1;e._vertexBoundsScaleY=q.maxVVSize?q.maxVVSize/q.height:1;return e};l.fromSimpleMarker=function(q,e){const d=v.premultiplyAlphaRGBAArray(q.color),g=Math.round(F.pt2px(q.size)),m=Math.round(F.pt2px(q.xoffset||0)),n=Math.round(F.pt2px(q.yoffset||0)),r=q.style;
var t=q.outline;const z=(t&&t.color&&v.premultiplyAlphaRGBAArray(t.color))|0;t=(t&&t.width&&Math.round(F.pt2px(t.width)))|0;e=new l(q.materialKey,m,n,q.angle,d,g,g,g,z,t,!1,!1,"esriSMSCross"===r||"esriSMSX"===r,0,e,0,0,1.96875,1,null,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM);e.boundsType="esriSMSCircle"===r?"circle":"square";e._vertexBoundsScaleX=q.maxVVSize?q.maxVVSize/q.size:1;e._vertexBoundsScaleY=q.maxVVSize?q.maxVVSize/q.size:1;return e};l.fromLineSymbolMarker=function(q,e){const d=v.premultiplyAlphaRGBAArray(q.color),
g=Math.round(F.pt2px(6*q.lineWidth)),m="cross"===q.style||"x"===q.style;switch(q.placement){case "begin-end":var n="Both";break;case "begin":n="JustBegin";break;case "end":n="JustEnd";break;default:n="None"}n={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:n,offsetAlongLine:0};e=new l(q.materialKey,0,0,0,d,g,g,g/6,d,m?Math.round(F.pt2px(q.lineWidth)):0,!1,!1,m,1,e,0,0,1.96875,1,n,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM);e.boundsType="circle"===q.style?"circle":
"square";return e};return l}(f(c))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../enums ../../number".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f){const c=3.14159265359/180;return h=>function(l){function q(...d){d=l.call(this,...d)||this;d.angle=0;d.xOffset=0;d.yOffset=0;d.width=0;d.height=0;d.boundsType="square";d._anchorX=0;d._anchorY=0;d._computedWidth=0;d._computedHeight=0;d._vertexBoundsScaleX=1;d._vertexBoundsScaleY=1;d._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0};d.geometryType=a.WGLGeometryType.MARKER;return d}u._inheritsLoose(q,
l);var e=q.prototype;e._write=function(d,g,m){const n=g.getDisplayId();d.recordStart(n,this._materialKey,this.geometryType,!0);this._writeGeometry(d,g,n,m);d.recordEnd()};e._writeGeometry=function(d,g,m,n){if(G.isSome(this._markerPlacement))return this._writePlacedMarkers(d,g,n);g=n?k.deltaDecodeGeometry(k.convertFromGeometry(n),2):"esriGeometryPolygon"===g.geometryType?g.readCentroid():g.readGeometryForDisplay();if(!G.isNone(g)){if(g.isPoint){const [r,t]=g.coords;return!d.hasAggregates&&d.hasPixelBufferEnabled&&
(0>r||512<=r||0>t||512<=t)?void 0:this._writeVertices(d,m,this._getPos(r,t),r,t)}g.forEachVertex((r,t)=>this._writeVertices(d,m,this._getPos(r,t),r,t))}};e._writePlacedMarkers=function(d,g,m){m=null!=m?m:g.readLegacyGeometryForDisplay();if(m=b.CIMMarkerPlacementHelper.getPlacement(m,G.unwrap(this._markerPlacement),F.pt2px(1))){g=g.getDisplayId();for(var n=p.create(),r=y.create(),t=m.next();null!=t;){const {tx:z,ty:w}=t;-128<=z&&640>=z&&-128<=w&&640>=w&&(this._applyTransformation(r,n,t.getAngle()/
c),this._writeVertices(d,g,this._getPos(z,w),z,w));t=m.next()}}};e._writeVertices=function(d,g,m,n,r){const t=d.vertexCount();d.vertexBounds(n+this.xOffset,r-this.yOffset,this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY);d.vertexWrite(m);d.vertexWrite(this._offsetUpperLeft);d.vertexWrite(this._texUpperLeft);d.vertexWrite(this._bitestAndDistRatio);d.vertexWrite(g);d.vertexWrite(this._fillColor);d.vertexWrite(this._outlineColor);d.vertexWrite(this._sizeOutlineWidth);
d.vertexWrite(this._minMaxZoom);d.vertexEnd();d.vertexWrite(m);d.vertexWrite(this._offsetUpperRight);d.vertexWrite(this._texUpperRight);d.vertexWrite(this._bitestAndDistRatio);d.vertexWrite(g);d.vertexWrite(this._fillColor);d.vertexWrite(this._outlineColor);d.vertexWrite(this._sizeOutlineWidth);d.vertexWrite(this._minMaxZoom);d.vertexEnd();d.vertexWrite(m);d.vertexWrite(this._offsetBottomLeft);d.vertexWrite(this._texBottomLeft);d.vertexWrite(this._bitestAndDistRatio);d.vertexWrite(g);d.vertexWrite(this._fillColor);
d.vertexWrite(this._outlineColor);d.vertexWrite(this._sizeOutlineWidth);d.vertexWrite(this._minMaxZoom);d.vertexEnd();d.vertexWrite(m);d.vertexWrite(this._offsetBottomRight);d.vertexWrite(this._texBottomRight);d.vertexWrite(this._bitestAndDistRatio);d.vertexWrite(g);d.vertexWrite(this._fillColor);d.vertexWrite(this._outlineColor);d.vertexWrite(this._sizeOutlineWidth);d.vertexWrite(this._minMaxZoom);d.vertexEnd();d.indexWrite(t+0);d.indexWrite(t+1);d.indexWrite(t+2);d.indexWrite(t+1);d.indexWrite(t+
3);d.indexWrite(t+2)};e._applyTransformation=function(d,g,m=0){C.identity(d);C.translate(d,d,p.fromValues(this.xOffset,-this.yOffset));0!==this.angle+m&&C.rotate(d,d,c*(this.angle+m));m=this._computedWidth;const n=this._computedHeight,r=(this._anchorX-.5)*m,t=(this._anchorY-.5)*n;v.set(g,r,t);v.transformMat2d(g,g,d);this._offsetUpperLeft=f.i1616to32(16*g[0],16*g[1]);this._offsets.xUpperLeft=g[0];this._offsets.yUpperLeft=g[1];v.set(g,r+m,t);v.transformMat2d(g,g,d);this._offsetUpperRight=f.i1616to32(16*
g[0],16*g[1]);this._offsets.xUpperRight=g[0];this._offsets.yUpperRight=g[1];v.set(g,r,t+n);v.transformMat2d(g,g,d);this._offsetBottomLeft=f.i1616to32(16*g[0],16*g[1]);this._offsets.xBottomLeft=g[0];this._offsets.yBottomLeft=g[1];v.set(g,r+m,t+n);v.transformMat2d(g,g,d);this._offsetBottomRight=f.i1616to32(16*g[0],16*g[1]);this._offsets.xBottomRight=g[0];this._offsets.yBottomRight=g[1]};e._getPos=function(d,g){return f.i1616to32(Math.round(8*d),Math.round(8*g))};return q}(h)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaultsJSON ../../enums ../../materialKey/MaterialKey ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils ../../../../layers/support/cimSymbolUtils".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e,d,g,m,n){function r(D,K){const H=D.length;D.push(null);K.then(I=>D[H]=I);return D}function t(D){return!!(D&1)}const z=C.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),w=[];C={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:0};const B={...v.errorPointSymbolJSON,hash:JSON.stringify(v.errorPointSymbolJSON),materialKey:k.createMaterialKey(p.WGLGeometryType.MARKER,C)},A={...v.errorPolylineSymbolJSON,hash:JSON.stringify(v.errorPolylineSymbolJSON),
materialKey:k.createMaterialKey(p.WGLGeometryType.LINE,C)},x={...v.errorPolygonSymbolJSON,hash:JSON.stringify(v.errorPolygonSymbolJSON),materialKey:k.createMaterialKey(p.WGLGeometryType.FILL,C)};v=function(){function D(H,I){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new d.default;this._fetchResource=H;this._tileInfo=I}var K=D.prototype;
K.createTemplateGroup=function(H,I){this._initErrorTemplates();const J=H.hash;if(this._symbolToTemplate.has(J))return this._symbolToTemplate.get(J);const M=[];I&&this._createMeshTemplates(M,I,!0);this._createMeshTemplates(M,H,!1);H=this._createGroupId("expanded-cim"===H.type&&E(H));this._idToTemplateGroup.set(H,M);this._symbolToTemplate.set(J,H);return H};K.getTemplateGroup=function(H){return this._idToTemplateGroup.has(H)?this._idToTemplateGroup.get(H):w};K.getDynamicTemplateGroup=function(H){if(!this._idToTemplateGroup.has(H))return w;
t(H)||z.error("mapview-template-store",`Id ${H} does not refer to a dynamic template`);return this._idToTemplateGroup.get(H)};K.getMosaicItem=function(H,I){const J=this._createTemplateId(),M=new Promise(O=>this._idToResolver.set(J,O));this._fetchQueue.push({symbol:H,id:J,glyphIds:I});return M};K.finalize=function(H){return this._fetchQueue.length||this._lock.isHeld()?d.withLock(this._lock,this._fetchAllQueuedResources.bind(this),H):Promise.resolve()};K._initErrorTemplates=function(){this._errorTemplates||
(this._errorTemplates={fill:this._createMeshTemplates([],x,!1),marker:this._createMeshTemplates([],B,!1),line:this._createMeshTemplates([],A,!1)})};K._fetchAllQueuedResources=function(H){if(!this._fetchQueue.length)return Promise.resolve();const I=this._fetchQueue,J=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return Promise.all(J).then(()=>this._fetchResource(I,H).then(M=>{for(const {id:O,mosaicItem:L}of M)this._idToResolver.get(O)(L),this._idToResolver.delete(O)})).catch(M=>{y.isAbortError(M)?
this._fetchQueue=this._fetchQueue.concat(I):"worker:port-closed"!==M.name&&z.error(new F("mapview-template-store","Unable to fetch requested texture resources",M))})};K._createGroupId=function(H){return this._idCounter++<<1|(H?1:0)};K._createTemplateId=function(){return this._templateIdCounter++};K._createSMS=function(){var H=G._asyncToGenerator(function*(I){const {spriteMosaicItem:J}=yield this.getMosaicItem(I);return g.ok(J,z)?q.fromSimpleMarker(I,J):this._markerError});return function(I){return H.apply(this,
arguments)}}();K._createPMS=function(){var H=G._asyncToGenerator(function*(I){const {spriteMosaicItem:J}=yield this.getMosaicItem(I);return g.ok(J,z)?q.fromPictureMarker(I,J):this._markerError});return function(I){return H.apply(this,arguments)}}();K._createSFS=function(){var H=G._asyncToGenerator(function*(I,J){const {spriteMosaicItem:M}=yield this.getMosaicItem(I);return g.ok(M,z)?h.fromSimpleFill(I,M,J):this._fillError});return function(I,J){return H.apply(this,arguments)}}();K._createPFS=function(){var H=
G._asyncToGenerator(function*(I,J){const {spriteMosaicItem:M}=yield this.getMosaicItem(I);return g.ok(M,z)?h.fromPictureFill(I,M,J):this._fillError});return function(I,J){return H.apply(this,arguments)}}();K._createSLS=function(){var H=G._asyncToGenerator(function*(I,J){({spriteMosaicItem:J}=yield this.getMosaicItem(I));return g.ok(J,z)?l.fromSimpleLine(I,J):this._lineError});return function(I,J){return H.apply(this,arguments)}}();K._createLMS=function(){var H=G._asyncToGenerator(function*(I){const {spriteMosaicItem:J}=
yield this.getMosaicItem(I);return g.ok(J,z)?q.fromLineSymbolMarker(I,J):this._markerError});return function(I){return H.apply(this,arguments)}}();K._createTS=function(){var H=G._asyncToGenerator(function*(I){const {glyphMosaicItems:J}=yield this.getMosaicItem(I);return e.fromText(I,J)});return function(I){return H.apply(this,arguments)}}();K._createCIMText=function(){var H=G._asyncToGenerator(function*(I){const {glyphMosaicItems:J}=yield this.getMosaicItem(n.cimLayerToRasterizationInfo(I),m.codepoints(I.text));
return g.ok(J,z)?e.fromCIMText(I,J,this._tileInfo):this._textError});return function(I){return H.apply(this,arguments)}}();K._createCIMFill=function(){var H=G._asyncToGenerator(function*(I){const {spriteMosaicItem:J}=yield this.getMosaicItem(n.cimLayerToRasterizationInfo(I));return g.ok(J,z)?h.fromCIMFill(I,J,this._tileInfo):this._fillError});return function(I){return H.apply(this,arguments)}}();K._createCIMLine=function(){var H=G._asyncToGenerator(function*(I){const {spriteMosaicItem:J}=yield this.getMosaicItem(n.cimLayerToRasterizationInfo(I));
return g.ok(J,z)?l.fromCIMLine(I,J,this._tileInfo):this._lineError});return function(I){return H.apply(this,arguments)}}();K._createCIMMarker=function(){var H=G._asyncToGenerator(function*(I){const {spriteMosaicItem:J}=yield this.getMosaicItem(n.cimLayerToRasterizationInfo(I));return g.ok(J,z)?q.fromCIMMarker(I,J,this._tileInfo):this._markerError});return function(I){return H.apply(this,arguments)}}();K._createCIM=function(){var H=G._asyncToGenerator(function*(I){const J=I.templateHash;if(this._cimTemplateCache.has(J))return this._cimTemplateCache.get(J);
let M;switch(I.type){case "marker":M=this._createCIMMarker(I);break;case "line":M=this._createCIMLine(I);break;case "fill":M=this._createCIMFill(I);break;case "text":M=this._createCIMText(I)}M.then(O=>this._cimTemplateCache.set(J,O));return M});return function(I){return H.apply(this,arguments)}}();K._createDynamicCIM=function(H){const I=H.templateHash;if(this._cimTemplateCache.has(I))return this._cimTemplateCache.get(I);let J;switch(H.type){case "marker":J=f.fromCIMMarker(H,this._tileInfo);break;
case "line":J=a.fromCIMLine(H,this._tileInfo);break;case "fill":J=b.fromCIMFill(H,this._tileInfo);break;case "text":J=c.fromCIMText(H,this._tileInfo)}this._cimTemplateCache.set(I,J);return J};K._createPrimitiveMeshTemplates=function(H,I,J){switch(I.type){case "esriSMS":return r(H,this._createSMS(I));case "esriPMS":return r(H,this._createPMS(I));case "esriSFS":return r(H,this._createSFS(I,J));case "line-marker":return r(H,this._createLMS(I));case "esriPFS":return r(H,this._createPFS(I,J));case "esriSLS":return r(H,
this._createSLS(I,!1));case "esriTS":return r(H,this._createTS(I));default:return z.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),H}};K._createMeshTemplates=function(H,I,J){if(-1!==I.type.indexOf("3d"))return z.error("3D symbols are not supported with MapView"),H;if("expanded-cim"===I.type){for(const M of I.layers)"function"===typeof M.materialHash?H.push(this._createDynamicCIM(M)):r(H,this._createCIM(M));return H}if("composite-symbol"===I.type){for(const M of I.layers)this._createPrimitiveMeshTemplates(H,
M,J);return H}return"cim"===I.type||"label"===I.type||"web-style"===I.type?H:this._createPrimitiveMeshTemplates(H,I,J)};G._createClass(D,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);return D}();const E=D=>{if(!D.layers)return!1;for(const K of D.layers)if("function"===
typeof K.materialHash)return!0;return!1};u.WGLTemplateStore=v;u.errorPointSchema2D=B;u.errorPolygonSchema2D=x;u.errorPolylineSchema2D=A;u.isDynamicId=t;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f){return function(c){function h(l,q,e){var d;var g=c.call(this,l)||this;g._minMaxZoom=v.i1616to32(Math.round(q*C.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(e*C.MIN_MAX_ZOOM_PRECISION_FACTOR));k.isFunction(l.color)?g._dynamicPropertyMap.set("fillColor",(B,A,x)=>(B=l.color(B,A,x))&&F.premultiplyAlphaRGBA(B)||0):(q=l.color,g.fillColor=q&&F.premultiplyAlphaRGBA(q)||0);let m=0;k.isFunction(l.height)||(m=l.height||0);const n="CIMMarkerPlacementInsidePolygon"===(null==(d=l.cim.placement)?
void 0:d.type)&&l.cim.placement.shiftOddRows?2:1;g._dynamicPropertyMap.set("_height",(B,A,x)=>k.isFunction(l.height)?l.height(B,A,x)*n:m*n);let r=0;k.isFunction(l.offsetX)||(r=G.pt2px(l.offsetX||0)+128,255<r&&(r=255));g._dynamicPropertyMap.set("_offsetX",(B,A,x)=>k.isFunction(l.offsetX)?(B=G.pt2px(l.offsetX(B,A,x))+128,255<B&&(B=255),B):r);let t=1;k.isFunction(l.scaleX)||(t=l.scaleX||1);g._dynamicPropertyMap.set("_scaleX",(B,A,x)=>k.isFunction(l.scaleX)?l.scaleX(B,A,x):t);let z=0;k.isFunction(l.offsetY)||
(z=G.pt2px(-l.offsetY||0)+128,255<z&&(z=255));g._dynamicPropertyMap.set("_offsetY",(B,A,x)=>k.isFunction(l.offsetY)?(B=G.pt2px(-l.offsetY(B,A,x))+128,255<B&&(B=255),B):z);let w=0;k.isFunction(l.angle)||(w=y.radToByte(l.angle)||0);g._dynamicPropertyMap.set("_angle",(B,A,x)=>k.isFunction(l.angle)?y.radToByte(l.angle(B,A,x)):w);g._effects=l.effects;g._cimFillLayer=l;g._fillMaterialKey=p.FillMaterialKey.load(l.materialKey);return g}u._inheritsLoose(h,c);h.fromCIMFill=function(l,q){const [e,d]=k.getMinMaxZoom(l.scaleInfo,
q);return new h(l,e,d)};h.prototype.bindFeature=function(l,q,e){const d=l.readLegacyFeature();this._dynamicPropertyMap.forEach((n,r)=>{this[r]=n(d,q,e)});l=this._fillMaterialKey;var g=this._materialCache,m=this._cimFillLayer.materialHash;m=m(d,q,e);m=g.get(m);g=null;m&&f.ok(m.spriteMosaicItem)&&(g=m.spriteMosaicItem);if(g){const {rect:n,width:r,height:t}=g;m=n.x+C.SPRITE_PADDING;const z=n.y+C.SPRITE_PADDING,w=m+r,B=z+t;let A=Math.round(G.pt2px(this._height));255<A?A=255:0>=A&&(A=B-z);let x=Math.round(G.pt2px(this._height/
t*r||0));255<x?x=255:0>=x&&(x=w-m);const E=this._scaleX;this.tl=v.i1616to32(m,z);this.br=v.i1616to32(w,B);this.aux2=v.i8888to32(x,A,this._offsetX,this._offsetY);this.aux3=v.i8888to32(E,1,this._angle,0);l.sdf=g.sdf;l.pattern=!0;l.textureBinding=g.textureBinding}else this.aux3=this.aux2=this.br=this.tl=0,l.sdf=!1,l.pattern=!1,l.textureBinding=0;this._materialKey=l.data};return h}(b(a))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../materialKey/MaterialKey ./templateUtils ./WGLLineTemplate".split(" "),
function(u,G,F,C,y,v,p,k){return b=>function(a){function f(...h){h=a.call(this,...h)||this;h.forceLibtess=!1;h._bitset=0;h._lineTemplate=null;h.geometryType=C.WGLGeometryType.FILL;return h}u._inheritsLoose(f,a);var c=f.prototype;c._maybeAddLineTemplate=function(h){this._lineTemplate=k.fromFillOutline(h)};c._write=function(h,l,q){const e="esriGeometryPoint"===l.geometryType,d=v.FillMaterialKey.load(this._materialKey);h.recordStart(l.getDisplayId(),this._materialKey,this.geometryType,e);this._writeGeometry(h,
l,d,q,e);d.outlinedFill&&G.isSome(this._lineTemplate)&&this._lineTemplate.writeGeometry(h,l,q,e);h.recordEnd()};c._writeGeometry=function(h,l,q,e,d){d=this._getGeometry(l,e,d);if(!G.isNone(d))if(e=h.indexCount(),100<d.maxLength||this.forceLibtess||!p.triangulate(h,d)){d=p.triangulateLibtess(h,d);var g=h.indexCount();e!==g&&this._writeVertices(h,l,d,[d.length/2],q)}else g=h.indexCount(),e!==g&&this._writeVertices(h,l,d.coords,d.lengths,q)};c._writeVertices=function(h,l,q,e,d){var g=l.getDisplayId();
g|=this._bitset<<24;let m=0;var n=e.reduce((r,t)=>r+t);h.vertexEnsureSize((d.dotDensity?4:10)*n);for(const r of e){n=m;for(e=r+m;n<e;n++){const t=q[2*n],z=q[2*n+1],w=y.i1616to32(1*t,1*z);h.vertexBounds(t,z,0,0);h.vertexWrite(w);h.vertexWrite(g);d.dotDensity?h.vertexWriteF32(1/Math.abs(l.readGeometryArea())):(h.vertexWrite(this.fillColor),d.simple||(h.vertexWrite(this.tl),h.vertexWrite(this.br)),h.vertexWrite(this.aux2),h.vertexWrite(this.aux3),d.simple||h.vertexWrite(this._minMaxZoom))}m+=r}};c._getGeometry=
function(h,l,q){return(h=l?F.deltaDecodeGeometry(F.convertFromGeometry(l),2):h.readGeometryForDisplay())?p.clipMarshall(h,q?256:8):null};return f}(b)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../TileClipper ../bufcut".split(" "),function(u,G,F,C,y,v,p,k){function b(h,l,q){let e=0;for(let d=
1;d<q;d++)e+=(h[2*(l+d)]-h[2*(l+d-1)])*(h[2*(l+d)+1]+h[2*(l+d-1)+1]);return e}function a(h,l,q,e,d){let g=0;for(;q<e;q+=3){const m=2*(h.getValue(q)-d),n=2*(h.getValue(q+1)-d),r=2*(h.getValue(q+2)-d);g+=Math.abs((l[m]-l[r])*(l[n+1]-l[m+1])-(l[m]-l[n])*(l[r+1]-l[m+1]))}return g}const f=new p.TileClipper(0,0,0,1,0),c=new p.TileClipper(0,0,0,1,0);f.setExtent(v.TILE_SIZE);c.setExtent(v.TILE_SIZE);u.area=b;u.clipLinesMarshall=function(h,l){c.setPixelMargin(l);const q=-l;l=v.TILE_SIZE+l;let e=[];var d=!1;
let g=0;for(;g<h.length;){const m=[],n=h[g];if(!n)return null;c.reset(2);let [r,t]=n[0];if(d)c.moveTo(r,t);else{if(r<q||r>l||t<q||t>l){d=!0;continue}m.push({x:r,y:t})}let z=!1;const w=n.length;for(let B=1;B<w;++B)if(r+=n[B][0],t+=n[B][1],d)c.lineTo(r,t);else{if(r<q||r>l||t<q||t>l){z=!0;break}m.push({x:r,y:t})}if(z)d=!0;else{if(d){if(d=c.resultWithStarts())for(const B of d)e.push(B)}else e.push({line:m,start:0});g++;d=!1}}e=e.filter(m=>1<m.line.length);return 0===e.length?null:e};u.clipMarshall=function(h,
l){if(G.isNone(h))return null;a:{var q=v.TILE_SIZE+128;var e=0;for(var d=0;d<h.lengths.length;d++){var g=h.lengths[d];for(var m=0;m<g;m++){const n=h.coords[2*(m+e)],r=h.coords[2*(m+e)+1];if(-128>n||n>q||-128>r||r>q){q=!0;break a}}e+=g}q=!1}if(!q)return h;f.setPixelMargin(l);f.reset(3);l=0;for(q=0;q<h.lengths.length;q++){e=h.lengths[q];d=h.coords[2*(0+l)];g=h.coords[2*(0+l)+1];f.moveTo(d,g);for(m=1;m<e;m++)d=h.coords[2*(m+l)],g=h.coords[2*(m+l)+1],f.lineTo(d,g);f.close();l+=e}q=f.result(!1);if(!q)return null;
h=[];l=[];for(const n of q){q=0;for(const r of n)l.push(r.x),l.push(r.y),q++;h.push(q)}return new y(h,l)};u.triangleArea=a;u.triangulate=function(h,l){const {coords:q,lengths:e,hasIndeterminateRingOrder:d}=l;l=h.indexWriter();h=h.vertexCount();if(d)return!1;const g=l.length;let m=0;for(var n=0;n<e.length;){let z=n,w=e[n];n=b(q,m,w);for(var r=[];++z<e.length;){var t=e[z];const B=b(q,m+w,t);if(!(0<B))break;n+=B;r.push(m+w);w+=t}t=l.length;k.bufcut(l,q,m,m+w,r,2,h);r=a(l,q,t,l.length,h);n=Math.abs(n);
if(1E-5<Math.abs((r-n)/Math.max(1E-7,n)))return l.seek(g),!1;n=z;m+=w}return!0};u.triangulateEarcut=function(h,l,q){const {coords:e,lengths:d,hasIndeterminateRingOrder:g}=l;if(g)return!1;let m=0;for(var n=0;n<d.length;){let t=n,z=d[n];for(n=[];++t<d.length;){var r=d[t];if(!(0<b(e,m+z,r)))break;n.push(m+z-m);z+=r}r=l.coords.slice(2*m,2*(m+z));n=F.earcut(r,n,2);for(const w of n)h.push(w+q+m);n=t;m+=z}return!0};u.triangulateLibtess=function(h,l){const q=h.indexWriter();h=h.vertexCount();const {coords:e,
lengths:d}=l,{buffer:g,vertexCount:m}=C.triangulate(e,d);q.ensureSize(m);for(l=0;l<m;l++)q.push(l+h);return g};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/chunks/earcut":function(){define(["exports"],function(u){var G={exports:{}};(function(F){(function(C){C=C();void 0!==C&&(F.exports=C)})(function(){function C(x,E,D){D=D||2;var K=E&&E.length,H=K?E[0]*D:x.length,I=y(x,0,H,D,!0),J=[];if(!I||I.next===I.prev)return J;var M;if(K){var O=I;var L=D;I=[];var S;K=0;for(S=E.length;K<S;K++){var Q=
E[K]*L;var P=K<S-1?E[K+1]*L:x.length;Q=y(x,Q,P,L,!1);Q===Q.next&&(Q.steiner=!0);I.push(l(Q))}I.sort(b);for(K=0;K<I.length;K++)L=I[K],E=O,(O=f(L,E))?(S=t(O,L),L=v(O,O.next),S=a(S),v(S,S.next),L=a(L),O=a(E===O?L:E)):O=E,O=v(O,O.next);I=O}if(x.length>80*D){var R=M=x[0];var N=K=x[1];for(L=D;L<H;L+=D)E=x[L],O=x[L+1],E<R&&(R=E),O<N&&(N=O),E>M&&(M=E),O>K&&(K=O);M=Math.max(M-R,K-N);M=0!==M?1/M:0}p(I,J,D,R,N,M);return J}function y(x,E,D,K,H){if(H===0<A(x,E,D,K))for(H=E;H<D;H+=K)var I=z(H,x[H],x[H+1],I);else for(H=
D-K;H>=E;H-=K)I=z(H,x[H],x[H+1],I);I&&d(I,I.next)&&(x=I.next,w(I),I=x);return I}function v(x,E){if(!x)return x;E||(E=x);do{var D=!1;if(x.steiner||!d(x,x.next)&&0!==e(x.prev,x,x.next))x=x.next;else{E=x.prev;w(x);x=E;if(x===x.next)break;D=!0}}while(D||x!==E);return E}function p(x,E,D,K,H,I,J){if(x){!J&&I&&c(x,K,H,I);for(var M=x,O,L;x.prev!==x.next;){O=x.prev;L=x.next;if(I)var S=k(x,K,H,I);else a:{S=x;var Q=S.prev,P=S,R=S.next;if(0<=e(Q,P,R))S=!1;else{for(var N=S.next.next;N!==S.prev;){if(q(Q.x,Q.y,
P.x,P.y,R.x,R.y,N.x,N.y)&&0<=e(N.prev,N,N.next)){S=!1;break a}N=N.next}S=!0}}if(S)E.push(O.i/D),E.push(x.i/D),E.push(L.i/D),w(x),M=x=L.next;else if(x=L,x===M){if(!J)p(v(x),E,D,K,H,I,1);else if(1===J){x=v(x);J=E;M=D;O=x;do L=O.prev,S=O.next.next,!d(L,S)&&g(L,O,O.next,S)&&r(L,S)&&r(S,L)&&(J.push(L.i/M),J.push(O.i/M),J.push(S.i/M),w(O),w(O.next),O=x=S),O=O.next;while(O!==x);x=v(O);p(x,E,D,K,H,I,2)}else if(2===J)a:{J=x;do{for(M=J.next.next;M!==J.prev;){if(O=J.i!==M.i){S=S=S=S=void 0;O=J;L=M;if(S=O.next.i!==
L.i&&O.prev.i!==L.i){b:{S=O;do{if(S.i!==O.i&&S.next.i!==O.i&&S.i!==L.i&&S.next.i!==L.i&&g(S,S.next,O,L)){S=!0;break b}S=S.next}while(S!==O);S=!1}S=!S}if(S){if(S=r(O,L)&&r(L,O)){S=O;Q=!1;P=(O.x+L.x)/2;R=(O.y+L.y)/2;do S.y>R!==S.next.y>R&&S.next.y!==S.y&&P<(S.next.x-S.x)*(R-S.y)/(S.next.y-S.y)+S.x&&(Q=!Q),S=S.next;while(S!==O);S=Q}S=S&&(e(O.prev,O,L.prev)||e(O,L.prev,L))||d(O,L)&&0<e(O.prev,O,O.next)&&0<e(L.prev,L,L.next)}O=S}if(O){x=t(J,M);J=v(J,J.next);x=v(x,x.next);p(J,E,D,K,H,I);p(x,E,D,K,H,I);
break a}M=M.next}J=J.next}while(J!==x)}break}}}}function k(x,E,D,K){var H=x.prev,I=x.next;if(0<=e(H,x,I))return!1;var J=H.x>x.x?H.x>I.x?H.x:I.x:x.x>I.x?x.x:I.x,M=H.y>x.y?H.y>I.y?H.y:I.y:x.y>I.y?x.y:I.y,O=h(H.x<x.x?H.x<I.x?H.x:I.x:x.x<I.x?x.x:I.x,H.y<x.y?H.y<I.y?H.y:I.y:x.y<I.y?x.y:I.y,E,D,K);E=h(J,M,E,D,K);D=x.prevZ;for(K=x.nextZ;D&&D.z>=O&&K&&K.z<=E;){if(D!==x.prev&&D!==x.next&&q(H.x,H.y,x.x,x.y,I.x,I.y,D.x,D.y)&&0<=e(D.prev,D,D.next))return!1;D=D.prevZ;if(K!==x.prev&&K!==x.next&&q(H.x,H.y,x.x,x.y,
I.x,I.y,K.x,K.y)&&0<=e(K.prev,K,K.next))return!1;K=K.nextZ}for(;D&&D.z>=O;){if(D!==x.prev&&D!==x.next&&q(H.x,H.y,x.x,x.y,I.x,I.y,D.x,D.y)&&0<=e(D.prev,D,D.next))return!1;D=D.prevZ}for(;K&&K.z<=E;){if(K!==x.prev&&K!==x.next&&q(H.x,H.y,x.x,x.y,I.x,I.y,K.x,K.y)&&0<=e(K.prev,K,K.next))return!1;K=K.nextZ}return!0}function b(x,E){return x.x-E.x}function a(x){if(x.next.prev===x)return x;let E=x;do{const D=E.next;if(D.prev===E||D===E||D===x)break;E=D}while(1);return E}function f(x,E){var D=E,K=x.x,H=x.y,
I=-Infinity;do{if(H<=D.y&&H>=D.next.y&&D.next.y!==D.y){var J=D.x+(H-D.y)*(D.next.x-D.x)/(D.next.y-D.y);if(J<=K&&J>I){I=J;if(J===K){if(H===D.y)return D;if(H===D.next.y)return D.next}var M=D.x<D.next.x?D:D.next}}D=D.next}while(D!==E);if(!M)return null;if(K===I)return M;E=M;J=M.x;var O=M.y,L=Infinity;D=M;do{if(K>=D.x&&D.x>=J&&K!==D.x&&q(H<O?K:I,H,J,O,H<O?I:K,H,D.x,D.y)){var S=Math.abs(H-D.y)/(K-D.x);var Q;if((Q=r(D,x))&&!(Q=S<L)&&(Q=S===L)&&!(Q=D.x>M.x)&&(Q=D.x===M.x)){Q=M;var P=D;Q=0>e(Q.prev,Q,P.prev)&&
0>e(P.next,Q,Q.next)}Q&&(M=D,L=S)}D=D.next}while(D!==E);return M}function c(x,E,D,K){var H=x;do{null===H.z&&(H.z=h(H.x,H.y,E,D,K));if(H.prev.next!==H||H.next.prev!==H)return H.prev.next=H,H.next.prev=H,c(x,E,D,K);H.prevZ=H.prev;H=H.nextZ=H.next}while(H!==x);H.prevZ.nextZ=null;H.prevZ=null;x=H;var I,J,M,O=1;do{E=x;K=x=null;for(H=0;E;){H++;D=E;for(I=J=0;I<O&&(J++,D=D.nextZ,D);I++);for(M=O;0<J||0<M&&D;)0!==J&&(0===M||!D||E.z<=D.z)?(I=E,E=E.nextZ,J--):(I=D,D=D.nextZ,M--),K?K.nextZ=I:x=I,I.prevZ=K,K=I;
E=D}K.nextZ=null;O*=2}while(1<H)}function h(x,E,D,K,H){x=32767*(x-D)*H;E=32767*(E-K)*H;x=(x|x<<8)&16711935;x=(x|x<<4)&252645135;x=(x|x<<2)&858993459;E=(E|E<<8)&16711935;E=(E|E<<4)&252645135;E=(E|E<<2)&858993459;return(x|x<<1)&1431655765|((E|E<<1)&1431655765)<<1}function l(x){var E=x,D=x;do{if(E.x<D.x||E.x===D.x&&E.y<D.y)D=E;E=E.next}while(E!==x);return D}function q(x,E,D,K,H,I,J,M){return 0<=(H-J)*(E-M)-(x-J)*(I-M)&&0<=(x-J)*(K-M)-(D-J)*(E-M)&&0<=(D-J)*(I-M)-(H-J)*(K-M)}function e(x,E,D){return(E.y-
x.y)*(D.x-E.x)-(E.x-x.x)*(D.y-E.y)}function d(x,E){return x.x===E.x&&x.y===E.y}function g(x,E,D,K){var H=n(e(x,E,D)),I=n(e(x,E,K)),J=n(e(D,K,x)),M=n(e(D,K,E));return H!==I&&J!==M||0===H&&m(x,D,E)||0===I&&m(x,K,E)||0===J&&m(D,x,K)||0===M&&m(D,E,K)?!0:!1}function m(x,E,D){return E.x<=Math.max(x.x,D.x)&&E.x>=Math.min(x.x,D.x)&&E.y<=Math.max(x.y,D.y)&&E.y>=Math.min(x.y,D.y)}function n(x){return 0<x?1:0>x?-1:0}function r(x,E){return 0>e(x.prev,x,x.next)?0<=e(x,E,x.next)&&0<=e(x,x.prev,E):0>e(x,E,x.prev)||
0>e(x,x.next,E)}function t(x,E){var D=new B(x.i,x.x,x.y),K=new B(E.i,E.x,E.y),H=x.next,I=E.prev;x.next=E;E.prev=x;D.next=H;H.prev=D;K.next=D;D.prev=K;I.next=K;K.prev=I;return K}function z(x,E,D,K){x=new B(x,E,D);K?(x.next=K.next,x.prev=K,K.next.prev=x,K.next=x):(x.prev=x,x.next=x);return x}function w(x){x.next.prev=x.prev;x.prev.next=x.next;x.prevZ&&(x.prevZ.nextZ=x.nextZ);x.nextZ&&(x.nextZ.prevZ=x.prevZ)}function B(x,E,D){this.i=x;this.x=E;this.y=D;this.nextZ=this.prevZ=this.z=this.next=this.prev=
null;this.steiner=!1}function A(x,E,D,K){for(var H=0,I=D-K;E<D;E+=K)H+=(x[I]-x[E])*(x[E+1]+x[I+1]),I=E;return H}C.deviation=function(x,E,D,K){var H=E&&E.length,I=Math.abs(A(x,0,H?E[0]*D:x.length,D));if(H){H=0;for(var J=E.length;H<J;H++)I-=Math.abs(A(x,E[H]*D,H<J-1?E[H+1]*D:x.length,D))}for(H=E=0;H<K.length;H+=3){J=K[H]*D;var M=K[H+1]*D,O=K[H+2]*D;E+=Math.abs((x[J]-x[O])*(x[M+1]-x[J+1])-(x[J]-x[M])*(x[O+1]-x[J+1]))}return 0===I&&0===E?0:Math.abs((E-I)/I)};C.flatten=function(x){for(var E=x[0][0].length,
D={vertices:[],holes:[],dimensions:E},K=0,H=0;H<x.length;H++){for(var I=0;I<x[H].length;I++)for(var J=0;J<E;J++)D.vertices.push(x[H][I][J]);0<H&&(K+=x[H-1].length,D.holes.push(K))}return D};return C})})(G);u.earcut=G.exports})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./definitions","./Geometry","./GeometryUtils"],function(u,G,F,C,y){let v=function(a,f,c){this.ratio=a;this.x=f;this.y=c},p=function(){function a(c,h,l,q=8,
e=8){this.lines=[];this.starts=[];this.validateTessellation=!0;this.pixelRatio=q;this.pixelMargin=e;this.tileSize=F.TILE_SIZE*q;this.dz=c;this.yPos=h;this.xPos=l}var f=a.prototype;f.setPixelMargin=function(c){c!==this.pixelMargin&&(this.pixelMargin=c,this.setExtent(this._extent))};f.setExtent=function(c){this._extent=c;this.finalRatio=this.tileSize/c*(1<<this.dz);let h=this.pixelRatio*this.pixelMargin;h/=this.finalRatio;c>>=this.dz;h>c&&(h=c);this.margin=h;this.xmin=c*this.xPos-h;this.ymin=c*this.yPos-
h;this.xmax=this.xmin+c+2*h;this.ymax=this.ymin+c+2*h};f.reset=function(c){this.type=c;this.lines=[];this.starts=[];this.line=null;this.start=0};f.moveTo=function(c,h){this._pushLine();this._prevIsIn=this._isIn(c,h);this._moveTo(c,h,this._prevIsIn);this._prevPt=new C.Point(c,h);this._firstPt=new C.Point(c,h);this._dist=0};f.lineTo=function(c,h){const l=this._isIn(c,h),q=new C.Point(c,h),e=C.Point.distance(this._prevPt,q);if(l)if(this._prevIsIn)this._lineTo(c,h,!0);else{var d=this._prevPt;var g=q;
c=this._intersect(g,d);this.start=this._dist+e*(1-this._r);this._lineTo(c.x,c.y,!0);this._lineTo(g.x,g.y,!0)}else if(this._prevIsIn)g=this._prevPt,d=q,c=this._intersect(g,d),this._lineTo(c.x,c.y,!0),this._lineTo(d.x,d.y,!1);else{const n=this._prevPt;if(!(n.x<=this.xmin&&q.x<=this.xmin||n.x>=this.xmax&&q.x>=this.xmax||n.y<=this.ymin&&q.y<=this.ymin||n.y>=this.ymax&&q.y>=this.ymax)){c=[];if(n.x<this.xmin&&q.x>this.xmin||n.x>this.xmin&&q.x<this.xmin){h=(this.xmin-n.x)/(q.x-n.x);var m=n.y+h*(q.y-n.y);
m<=this.ymin?g=!1:m>=this.ymax?g=!0:c.push(new v(h,this.xmin,m))}if(n.x<this.xmax&&q.x>this.xmax||n.x>this.xmax&&q.x<this.xmax)h=(this.xmax-n.x)/(q.x-n.x),m=n.y+h*(q.y-n.y),m<=this.ymin?g=!1:m>=this.ymax?g=!0:c.push(new v(h,this.xmax,m));if(n.y<this.ymin&&q.y>this.ymin||n.y>this.ymin&&q.y<this.ymin)h=(this.ymin-n.y)/(q.y-n.y),m=n.x+h*(q.x-n.x),m<=this.xmin?d=!1:m>=this.xmax?d=!0:c.push(new v(h,m,this.ymin));if(n.y<this.ymax&&q.y>this.ymax||n.y>this.ymax&&q.y<this.ymax)h=(this.ymax-n.y)/(q.y-n.y),
m=n.x+h*(q.x-n.x),m<=this.xmin?d=!1:m>=this.xmax?d=!0:c.push(new v(h,m,this.ymax));if(0===c.length)d?g?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):g?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<c.length&&c[0].ratio>c[1].ratio)this.start=this._dist+e*c[1].ratio,this._lineTo(c[1].x,c[1].y,!0),this._lineTo(c[0].x,c[0].y,!0);else for(this.start=this._dist+e*c[0].ratio,d=0;d<c.length;d++)this._lineTo(c[d].x,c[d].y,!0)}this._lineTo(q.x,
q.y,!1)}this._dist+=e;this._prevIsIn=l;this._prevPt=q};f.close=function(){if(2<this.line.length){var c=this._firstPt,h=this._prevPt;c.x===h.x&&c.y===h.y||this.lineTo(c.x,c.y);c=this.line;for(h=c.length;4<=h;)if(c[0].x===c[1].x&&c[0].x===c[h-2].x||c[0].y===c[1].y&&c[0].y===c[h-2].y)c.pop(),c[0].x=c[h-2].x,c[0].y=c[h-2].y,--h;else break}};f.result=function(c=!0){this._pushLine();if(0===this.lines.length)return null;3===this.type&&c&&b.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};
f.resultWithStarts=function(){if(2!==this.type)throw Error("Only valid for lines");this._pushLine();const c=this.lines,h=c.length;if(0===h)return null;const l=[];for(let q=0;q<h;q++)l.push({line:c[q],start:this.starts[q]||0});return l};f._isIn=function(c,h){return c>=this.xmin&&c<=this.xmax&&h>=this.ymin&&h<=this.ymax};f._intersect=function(c,h){let l,q,e;if(h.x>=this.xmin&&h.x<=this.xmax)q=h.y<=this.ymin?this.ymin:this.ymax,e=(q-c.y)/(h.y-c.y),l=c.x+e*(h.x-c.x);else if(h.y>=this.ymin&&h.y<=this.ymax)l=
h.x<=this.xmin?this.xmin:this.xmax,e=(l-c.x)/(h.x-c.x),q=c.y+e*(h.y-c.y);else{q=h.y<=this.ymin?this.ymin:this.ymax;l=h.x<=this.xmin?this.xmin:this.xmax;const d=(l-c.x)/(h.x-c.x),g=(q-c.y)/(h.y-c.y);d<g?(e=d,q=c.y+d*(h.y-c.y)):(e=g,l=c.x+g*(h.x-c.x))}this._r=e;return new C.Point(l,q)};f._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):
3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};f._moveTo=function(c,h,l){3!==this.type?l&&(c=Math.round((c-(this.xmin+this.margin))*this.finalRatio),h=Math.round((h-(this.ymin+this.margin))*this.finalRatio),this.line.push(new C.Point(c,h))):(l||(c<this.xmin&&(c=this.xmin),c>this.xmax&&(c=this.xmax),h<this.ymin&&(h=this.ymin),h>this.ymax&&(h=this.ymax)),c=Math.round((c-(this.xmin+this.margin))*this.finalRatio),h=Math.round((h-
(this.ymin+this.margin))*this.finalRatio),this.line.push(new C.Point(c,h)),this._is_v=this._is_h=!1)};f._lineTo=function(c,h,l){if(3!==this.type)if(l){c=Math.round((c-(this.xmin+this.margin))*this.finalRatio);h=Math.round((h-(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(l=this.line[this.line.length-1],l.equals(c,h)))return;this.line.push(new C.Point(c,h))}else this.line&&0<this.line.length&&this._pushLine();else if(l||(c<this.xmin&&(c=this.xmin),c>this.xmax&&(c=this.xmax),h<this.ymin&&
(h=this.ymin),h>this.ymax&&(h=this.ymax)),c=Math.round((c-(this.xmin+this.margin))*this.finalRatio),h=Math.round((h-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){l=this.line[this.line.length-1];const q=l.x===c,e=l.y===h;q&&e||(this._is_h&&q?(l.x=c,l.y=h,l=this.line[this.line.length-2],l.x===c&&l.y===h?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(l=this.line[this.line.length-2],this._is_h=l.x===c,this._is_v=l.y===h)):(this._is_h=l.x===c,this._is_v=l.y===
h)):this._is_v&&e?(l.x=c,l.y=h,l=this.line[this.line.length-2],l.x===c&&l.y===h?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(l=this.line[this.line.length-2],this._is_h=l.x===c,this._is_v=l.y===h)):(this._is_h=l.x===c,this._is_v=l.y===h)):(this.line.push(new C.Point(c,h)),this._is_h=q,this._is_v=e))}else this.line.push(new C.Point(c,h))};return a}(),k=function(){function a(){}var f=a.prototype;f.setExtent=function(c){this._ratio=4096===c?1:4096/c};f.reset=function(c){this.lines=[];
this.line=null};f.moveTo=function(c,h){this.line&&this.lines.push(this.line);this.line=[];const l=this._ratio;this.line.push(new C.Point(c*l,h*l))};f.lineTo=function(c,h){const l=this._ratio;this.line.push(new C.Point(c*l,h*l))};f.close=function(){const c=this.line;c&&!c[0].isEqual(c[c.length-1])&&c.push(c[0])};f.result=function(){this.line&&this.lines.push(this.line);return 0===this.lines.length?null:this.lines};G._createClass(a,[{key:"validateTessellation",get:function(){return 1>this._ratio}}]);
return a}(),b=function(){function a(){}a.simplify=function(f,c,h){if(h){var l=-c,q=f+c,e=-c,d=f+c;f=[];c=[];var g=h.length;for(let m=0;m<g;++m){const n=h[m];if(!n||2>n.length)continue;let r=n[0],t;const z=n.length;for(let w=1;w<z;++w)t=n[w],r.x===t.x&&(r.x<=l&&(r.y>t.y?(f.push(m),f.push(w),f.push(0),f.push(-1)):(c.push(m),c.push(w),c.push(0),c.push(-1))),r.x>=q&&(r.y<t.y?(f.push(m),f.push(w),f.push(1),f.push(-1)):(c.push(m),c.push(w),c.push(1),c.push(-1)))),r.y===t.y&&(r.y<=e&&(r.x<t.x?(f.push(m),
f.push(w),f.push(2),f.push(-1)):(c.push(m),c.push(w),c.push(2),c.push(-1))),r.y>=d&&(r.x>t.x?(f.push(m),f.push(w),f.push(3),f.push(-1)):(c.push(m),c.push(w),c.push(3),c.push(-1)))),r=t}0!==f.length&&0!==c.length&&(a.fillParent(h,c,f),a.fillParent(h,f,c),l=[],a.calcDeltas(l,c,f),a.calcDeltas(l,f,c),a.addDeltas(l,h))}};a.fillParent=function(f,c,h){const l=h.length,q=c.length;for(let n=0;n<q;n+=4){var e=c[n],d=c[n+1];const r=c[n+2],t=f[e][d-1];e=f[e][d];d=8092;let z=-1;for(let w=0;w<l;w+=4){if(h[w+2]!==
r)continue;var g=h[w];const B=h[w+1];var m=f[g][B-1];g=f[g][B];switch(r){case 0:case 1:y.between(t.y,m.y,g.y)&&y.between(e.y,m.y,g.y)&&(m=Math.abs(g.y-m.y),m<d&&(d=m,z=w));break;case 2:case 3:y.between(t.x,m.x,g.x)&&y.between(e.x,m.x,g.x)&&(m=Math.abs(g.x-m.x),m<d&&(d=m,z=w))}}c[n+3]=z}};a.calcDeltas=function(f,c,h){const l=c.length;for(let q=0;q<l;q+=4){const e=a.calcDelta(q,c,h,[]);f.push(c[q]);f.push(c[q+1]);f.push(c[q+2]);f.push(e)}};a.calcDelta=function(f,c,h,l){f=c[f+3];if(-1===f)return 0;const q=
l.length;if(1<q&&l[q-2]===f)return 0;l.push(f);return a.calcDelta(f,h,c,l)+1};a.addDeltas=function(f,c){const h=f.length;let l=0;for(var q=0;q<h;q+=4){var e=f[q+3];e>l&&(l=e)}for(q=0;q<h;q+=4){e=c[f[q]];const d=f[q+1],g=l-f[q+3];switch(f[q+2]){case 0:e[d-1].x-=g;e[d].x-=g;1===d&&(e[e.length-1].x-=g);d===e.length-1&&(e[0].x-=g);break;case 1:e[d-1].x+=g;e[d].x+=g;1===d&&(e[e.length-1].x+=g);d===e.length-1&&(e[0].x+=g);break;case 2:e[d-1].y-=g;e[d].y-=g;1===d&&(e[e.length-1].y-=g);d===e.length-1&&(e[0].y-=
g);break;case 3:e[d-1].y+=g,e[d].y+=g,1===d&&(e[e.length-1].y+=g),d===e.length-1&&(e[0].y+=g)}}};return a}();u.SimpleBuilder=k;u.TileClipper=p;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/Geometry":function(){define(["exports"],function(u){let G=function(){function F(y,v){this.x=y;this.y=v}var C=F.prototype;C.clone=function(){return new F(this.x,this.y)};C.equals=function(y,v){return y===this.x&&v===this.y};C.isEqual=function(y){return y.x===this.x&&y.y===this.y};
C.setCoords=function(y,v){this.x=y;this.y=v};C.normalize=function(){var y=this.x;const v=this.y;y=Math.sqrt(y*y+v*v);this.x/=y;this.y/=y};C.rightPerpendicular=function(){const y=this.x;this.x=this.y;this.y=-y};C.move=function(y,v){this.x+=y;this.y+=v};C.assign=function(y){this.x=y.x;this.y=y.y};C.assignAdd=function(y,v){this.x=y.x+v.x;this.y=y.y+v.y};C.assignSub=function(y,v){this.x=y.x-v.x;this.y=y.y-v.y};C.rotate=function(y,v){const p=this.x,k=this.y;this.x=p*y-k*v;this.y=p*v+k*y};C.scale=function(y){this.x*=
y;this.y*=y};C.length=function(){const y=this.x,v=this.y;return Math.sqrt(y*y+v*v)};F.distance=function(y,v){const p=v.x-y.x;y=v.y-y.y;return Math.sqrt(p*p+y*y)};F.add=function(y,v){return new F(y.x+v.x,y.y+v.y)};F.sub=function(y,v){return new F(y.x-v.x,y.y-v.y)};return F}();u.Point=G;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],function(u){function G(t,z,w,B,A,x,E){let D;w=0;for(let K=B,H=A-x;K<A;K+=x)w+=(t[H+z*x]-t[K+
z*x])*(t[K+1+z*x]+t[H+1+z*x]),H=K;if(E===0<w)for(;B<A;B+=x)D=v(B+z*x,t[B+z*x],t[B+1+z*x],D);else for(A-=x;A>=B;A-=x)D=v(A+z*x,t[A+z*x],t[A+1+z*x],D);D&&e(D,D.next)&&(p(D),D=D.next);return D}function F(t,z=t){if(!t)return t;let w;do if(w=!1,t.steiner||!e(t,t.next)&&0!==f(t.prev,t,t.next))t=t.next;else{p(t);t=z=t.prev;if(t===t.next)break;w=!0}while(w||t!==z);return z}function C(t,z,w,B,A,x,E,D){if(t){!D&&x&&(t=a(t,B,A,x));for(var K=t;t.prev!==t.next;){var H=t.prev,I=t.next;if(x)var J=y(t,B,A,x);else a:{J=
t;var M=J.prev,O=J;const L=J.next;if(0<=f(M,O,L)){J=!1;break a}let S=J.next.next;const Q=S;let P=0;for(;S!==J.prev&&(0===P||S!==Q);){P++;if(h(M.x,M.y,O.x,O.y,L.x,L.y,S.x,S.y)&&0<=f(S.prev,S,S.next)){J=!1;break a}S=S.next}J=!0}if(J)z.push(H.index/w+E),z.push(t.index/w+E),z.push(I.index/w+E),p(t),K=t=I.next;else if(t=I,t===K){if(!D)C(F(t),z,w,B,A,x,E,1);else if(1===D){D=z;K=w;H=E;I=t;do J=I.prev,M=I.next.next,!e(J,M)&&c(J,I,I.next,M)&&l(J,M)&&l(M,J)&&(D.push(J.index/K+H),D.push(I.index/K+H),D.push(M.index/
K+H),p(I),p(I.next),I=t=M),I=I.next;while(I!==t);t=I;C(t,z,w,B,A,x,E,2)}else if(2===D)a:{D=t;do{for(K=D.next.next;K!==D.prev;){if(H=D.index!==K.index){J=J=J=void 0;H=D;I=K;if(J=H.next.index!==I.index&&H.prev.index!==I.index){b:{J=H;do{if(J.index!==H.index&&J.next.index!==H.index&&J.index!==I.index&&J.next.index!==I.index&&c(J,J.next,H,I)){J=!0;break b}J=J.next}while(J!==H);J=!1}J=!J}if(J=J&&l(H,I)&&l(I,H)){J=H;M=!1;O=(H.x+I.x)/2;I=(H.y+I.y)/2;do J.y>I!==J.next.y>I&&J.next.y!==J.y&&O<(J.next.x-J.x)*
(I-J.y)/(J.next.y-J.y)+J.x&&(M=!M),J=J.next;while(J!==H);J=M}H=J}if(H){t=g(D,K);D=F(D,D.next);t=F(t,t.next);C(D,z,w,B,A,x,E,0);C(t,z,w,B,A,x,E,0);break a}K=K.next}D=D.next}while(D!==t)}break}}}}function y(t,z,w,B){const A=t.prev,x=t.next;if(0<=f(A,t,x))return!1;const E=A.x>t.x?A.x>x.x?A.x:x.x:t.x>x.x?t.x:x.x,D=A.y>t.y?A.y>x.y?A.y:x.y:t.y>x.y?t.y:x.y,K=q(A.x<t.x?A.x<x.x?A.x:x.x:t.x<x.x?t.x:x.x,A.y<t.y?A.y<x.y?A.y:x.y:t.y<x.y?t.y:x.y,z,w,B);z=q(E,D,z,w,B);w=t.prevZ;for(B=t.nextZ;w&&w.z>=K&&B&&B.z<=
z;){if(w!==t.prev&&w!==t.next&&h(A.x,A.y,t.x,t.y,x.x,x.y,w.x,w.y)&&0<=f(w.prev,w,w.next))return!1;w=w.prevZ;if(B!==t.prev&&B!==t.next&&h(A.x,A.y,t.x,t.y,x.x,x.y,B.x,B.y)&&0<=f(B.prev,B,B.next))return!1;B=B.nextZ}for(;w&&w.z>=K;){if(w!==t.prev&&w!==t.next&&h(A.x,A.y,t.x,t.y,x.x,x.y,w.x,w.y)&&0<=f(w.prev,w,w.next))return!1;w=w.prevZ}for(;B&&B.z<=z;){if(B!==t.prev&&B!==t.next&&h(A.x,A.y,t.x,t.y,x.x,x.y,B.x,B.y)&&0<=f(B.prev,B,B.next))return!1;B=B.nextZ}return!0}function v(t,z,w,B){t=m.create(t,z,w);
B?(t.next=B.next,t.prev=B,B.next.prev=t,B.next=t):(t.prev=t,t.next=t);return t}function p(t){t.next.prev=t.prev;t.prev.next=t.next;t.prevZ&&(t.prevZ.nextZ=t.nextZ);t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function k(t){let z=t,w=t;do{if(z.x<w.x||z.x===w.x&&z.y<w.y)w=z;z=z.next}while(z!==t);return w}function b(t,z){let w=z;const B=t.x,A=t.y;let x=-Infinity,E;do{if(A<=w.y&&A>=w.next.y&&w.next.y!==w.y){var D=w.x+(A-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(D<=B&&D>x){x=D;if(D===B){if(A===w.y)return w;if(A===w.next.y)return w.next}E=
w.x<w.next.x?w:w.next}}w=w.next}while(w!==z);if(!E)return null;if(B===x)return E.prev;z=E;D=E.x;const K=E.y;let H=Infinity,I;for(w=E.next;w!==z;)B>=w.x&&w.x>=D&&B!==w.x&&h(A<K?B:x,A,D,K,A<K?x:B,A,w.x,w.y)&&(I=Math.abs(A-w.y)/(B-w.x),(I<H||I===H&&w.x>E.x)&&l(w,t)&&(E=w,H=I)),w=w.next;return E}function a(t,z,w,B){for(var A;A!==t;A=A.next){A=A||t;null===A.z&&(A.z=q(A.x,A.y,z,w,B));if(A.prev.next!==A||A.next.prev!==A)return A.prev.next=A,A.next.prev=A,a(t,z,w,B);A.prevZ=A.prev;A.nextZ=A.next}t.prevZ.nextZ=
null;t.prevZ=null;a:for(w=1;;){B=t;z=t=null;let x=0;for(;B;){x++;A=B;let E=0;for(;E<w&&A;E++)A=A.nextZ;let D=w;for(;0<E||0<D&&A;){let K;0===E?(K=A,A=A.nextZ,D--):0!==D&&A?B.z<=A.z?(K=B,B=B.nextZ,E--):(K=A,A=A.nextZ,D--):(K=B,B=B.nextZ,E--);z?z.nextZ=K:t=K;K.prevZ=z;z=K}B=A}z.nextZ=null;w*=2;if(2>x)break a}return t}function f(t,z,w){return(z.y-t.y)*(w.x-z.x)-(z.x-t.x)*(w.y-z.y)}function c(t,z,w,B){return e(t,z)&&e(w,B)||e(t,B)&&e(w,z)?!0:0<f(t,z,w)!==0<f(t,z,B)&&0<f(w,B,t)!==0<f(w,B,z)}function h(t,
z,w,B,A,x,E,D){return 0<=(A-E)*(z-D)-(t-E)*(x-D)&&0<=(t-E)*(B-D)-(w-E)*(z-D)&&0<=(w-E)*(x-D)-(A-E)*(B-D)}function l(t,z){return 0>f(t.prev,t,t.next)?0<=f(t,z,t.next)&&0<=f(t,t.prev,z):0>f(t,z,t.prev)||0>f(t,t.next,z)}function q(t,z,w,B,A){t=32767*(t-w)*A;z=32767*(z-B)*A;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;z=(z|z<<8)&16711935;z=(z|z<<4)&252645135;z=(z|z<<2)&858993459;return(t|t<<1)&1431655765|((z|z<<1)&1431655765)<<1}function e(t,z){return t.x===z.x&&t.y===z.y}function d(t,
z){return t.x-z.x}function g(t,z){const w=m.create(t.index,t.x,t.y),B=m.create(z.index,z.x,z.y),A=t.next,x=z.prev;t.next=z;z.prev=t;w.next=A;A.prev=w;B.next=w;w.prev=B;x.next=B;B.prev=x;return B}let m=function(){function t(){this.y=this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}t.create=function(z,w,B){const A=r<n.length?n[r++]:new t;A.index=z;A.x=w;A.y=B;A.prev=null;A.next=null;A.z=null;A.prevZ=null;A.nextZ=null;A.steiner=!1;return A};return t}();const n=
[];let r=0;for(let t=0;8096>t;t++)n.push(new m);u.bufcut=function(t,z,w,B,A,x,E){r=0;var D=(B-w)*x,K=A&&A.length;const H=K?(A[0]-w)*x:D;var I=G(z,w,B,0,H,x,!0);if(I&&I.next!==I.prev){var J;if(K){K=[];for(let S=0,Q=A.length;S<Q;S++){const P=G(z,w,B,A[S]*x,S<Q-1?A[S+1]*x:B*x,x,!1);P===P.next&&(P.steiner=!0);K.push(k(P))}K.sort(d);for(var M of K){B=M;A=I;if(A=b(B,A))B=g(A,B),F(B,B.next);I=F(I,I.next)}}if(D>80*x){var O=D=z[w*x];var L=J=z[1+w*x];for(M=x;M<H;M+=x)B=z[M+w*x],A=z[M+1+w*x],O=Math.min(O,B),
L=Math.min(L,A),D=Math.max(D,B),J=Math.max(J,A);J=Math.max(D-O,J-L);J=0!==J?1/J:0}C(I,t,x,O,L,J,E,0)}};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),function(u,
G,F,C,y,v,p,k,b,a,f){const c=G.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");return function(h){function l(q,e,d,g,m,n,r,t,z,w,B,A,x,E,D,K,H,I,J){var M=h.call(this)||this;q=k.LineMaterialKey.load(q);e&&(q.sdf=e.sdf,q.pattern=!0,q.textureBinding=e.textureBinding);M._capType=g;M._joinType=m;M._miterLimitCosine=b.getLimitCosine(n);M.tessellationProperties._fillColor=r;M.tessellationProperties._tl=t;M.tessellationProperties._br=z;M._hasPattern=w;M._isDashed=B;M._zOrder=K;M._effects=H;M._minMaxZoom=
v.i1616to32(Math.round(I*y.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(J*y.MIN_MAX_ZOOM_PRECISION_FACTOR));M._materialKey=q.data;M.tessellationProperties._bitset=(x?y.BITSET_GENERIC_LOCK_COLOR:0)|(E?y.BITSET_TYPE_FILL_OUTLINE:0)|(A?y.BITSET_LINE_SCALE_DASH:0);M.tessellationProperties._halfWidth=.5*d;M.tessellationProperties._halfReferenceWidth=.5*D;M.tessellationProperties.offset=0;M._initializeTessellator(!1);return M}u._inheritsLoose(l,h);l.fromCIMLine=function(q,e,d){var g=q.color,m=q.scaleFactor||
1;const n=!!q.dashTemplate;let r=q.cap;n&&1===r&&(r=2);const t=q.join;m*=F.pt2px(q.width);const z=F.pt2px(q.referenceWidth),w=F.pt2px(q.miterLimit);g=g&&C.premultiplyAlphaRGBA(g)||0;const [B,A]=b.getMinMaxZoom(q.scaleInfo,d);if(!e)return new l(q.materialKey,e,m,r,t,w,g,0,0,!1,n,q.scaleDash,q.colorLocked,!1,z,q.zOrder,q.effects,B,A);const {rect:x,width:E,height:D}=e;var K=x.x+y.SPRITE_PADDING;const H=x.y+y.SPRITE_PADDING;d=K+E;const I=H+D;K=v.i1616to32(K,H);d=v.i1616to32(d,I);return new l(q.materialKey,
e,m,r,t,w,g,K,d,!0,n,q.scaleDash,q.colorLocked,!1,z,q.zOrder,q.effects,B,A)};l.fromFillOutline=function(q){var e;return q.isOutlinedFill&&q.outline&&"esriSLSSolid"===(null==(e=q.outline)?void 0:e.style)?l.fromSimpleLine({hash:"",materialKey:q.materialKey,...q.outline},null,!0):null};l.fromSimpleLine=function(q,e,d=!1){var {color:g}=q;const m="esriSLSSolid"!==q.style&&"esriSLSNull"!==q.style,n=p.getCapType(q.cap||"round"),r=p.getJoinType(q.join||"round");g=g&&"esriSLSNull"!==q.style&&C.premultiplyAlphaRGBAArray(g)||
0;"esriSLSNull"===q.style&&(g=0);const t=F.pt2px(q.width),z=q.miterLimit;if(!e)return new l(q.materialKey,e,t,n,r,z,g,0,0,!1,m,!0,!1,d,t,0,null,b.DEFAULT_MIN_ZOOM,b.DEFAULT_MAX_ZOOM);const {rect:w,width:B,height:A}=e;var x=w.x+y.SPRITE_PADDING;const E=w.y+y.SPRITE_PADDING;var D=x+B;const K=E+A;x=v.i1616to32(x,E);D=v.i1616to32(D,K);return new l(q.materialKey,e,t,n,r,z,g,x,D,!0,m,!0,!1,d,t,0,null,b.DEFAULT_MIN_ZOOM,b.DEFAULT_MAX_ZOOM)};l.fromPictureLineSymbol=function(q,e,d,g){c.error("PictureLineSymbol support does not exist!");
return null};return l}(a(f))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),function(u,G,F,C,y,v,p,k){const b=(c,h,l)=>(q,e,d,g,m,n,r,t,z,w,B)=>{d=y.i1616to32(B,Math.ceil(16*c._halfWidth));r=y.i8888to32(Math.round(16*r),Math.round(16*t),Math.round(16*z),Math.round(16*
w));m=y.i8888to32(16*m,16*n,0,c._bitset);n=c.out;n.vertexBounds(q,e,h,l);n.vertexWrite(y.i1616to32(8*q,8*e));n.vertexWrite(c.id);n.vertexWrite(c._fillColor);n.vertexWrite(r);n.vertexWrite(d);n.vertexWrite(c._tl);n.vertexWrite(c._br);n.vertexWrite(m);n.vertexWrite(y.i1616to32(Math.ceil(16*c._halfReferenceWidth),0));n.vertexWrite(c.minMaxZoom);n.vertexEnd();return c.offset+c.vertexCount++},a=(c,h,l)=>(q,e,d,g,m,n,r,t,z,w,B)=>{d=y.i8888to32(0,0,16*c._halfWidth,16*c._halfReferenceWidth);r=y.i8888to32(16*
r+128,16*t+128,16*z+128,16*w+128);t=c.out;z=c._bitset<<24|c.id;t.vertexBounds(q,e,h,l);t.vertexWrite(y.i1616to32(8*q,8*e));t.vertexWrite(z);t.vertexWrite(c._fillColor);c.key.simple||(t.vertexWrite(0),t.vertexWrite(0));t.vertexWrite(d);t.vertexWrite(r);c.key.simple||t.vertexWrite(c.minMaxZoom);t.vertexEnd();return c.offset+c.vertexCount++},f=c=>(h,l,q)=>{const e=c.out;e.indexWrite(h);e.indexWrite(l);e.indexWrite(q);c.indexCount+=3};return c=>function(h){function l(...e){e=h.call(this,...e)||this;e.tessellationProperties=
{};e._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};e.geometryType=C.WGLGeometryType.LINE;return e}u._inheritsLoose(l,h);var q=l.prototype;q.writeGeometry=function(e,d,g,m){this._writeGeometry(e,d,g,m)};q._initializeTessellator=function(e){var d=p.LineMaterialKey.load(this._materialKey);const g=p.FillMaterialKey.load(this._materialKey);var m=this._tessellationOptions;d=d.vvSizeFieldStops||d.vvSizeMinMaxValue||d.vvSizeScaleStops||d.vvSizeUnitValue;e=this.tessellationProperties._halfWidth<
F.THIN_LINE_HALF_WIDTH_THRESHOLD&&!e&&!d;this.tessellationProperties.minMaxZoom=this._minMaxZoom;m.wrapDistance=65535;m.textured=this._isDashed||this._hasPattern;m.offset=this.tessellationProperties.offset;m.halfWidth=this.tessellationProperties._halfWidth;m=e?0:1;this._lineTessellator=new v.LineTessellation((g.outlinedFill?a:b)(this.tessellationProperties,m,m),f(this.tessellationProperties),e)};q._write=function(e,d,g){const m="esriGeometryPoint"===d.geometryType;e.recordStart(d.getDisplayId(),this._materialKey,
this.geometryType,m);this._writeGeometry(e,d,g,m);e.recordEnd()};q._writeGeometry=function(e,d,g,m){g=null!=g?g:d.readLegacyGeometryForDisplay();m=this._getLines(g,m);G.isNone(m)||this._writeVertices(e,d,m)};q._getLines=function(e,d){if(G.isNone(e))return null;e=e.paths||e.rings;return G.isNone(e)?null:k.clipLinesMarshall(e,d?256:16)};q._writeVertices=function(e,d,g){const m=d.getDisplayId(),n=e.vertexCount(),r=this.tessellationProperties;d=this._tessellationOptions;r.out=e;r.id=m;r.indexCount=0;
r.vertexCount=0;r.offset=n;d.capType=this._capType;d.joinType=this._joinType;e=p.FillMaterialKey.load(this._materialKey);this.tessellationProperties.key=e.outlinedFill?e:p.LineMaterialKey.load(this._materialKey);for(const {line:t,start:z}of g)d.initialDistance=z%65535,this._lineTessellator.tessellate(t,d)};return l}(c)})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["exports","./definitions"],function(u,G){function F(f,c){return f.x===c.x&&f.y===c.y}function C(f,c){f.x=c.y;f.y=-c.x;return f}
function y(f,c){f.x=-c.y;f.y=c.x;return f}function v(f,c){f.x=c.x;f.y=c.y;return f}function p(f,c){f.x=-c.x;f.y=-c.y;return f}function k(f){return Math.sqrt(f.x*f.x+f.y*f.y)}function b(f,c,h,l){f.x=c.x*h+c.y*l;f.y=c.x*l-c.y*h;return f}let a=function(){function f(h,l,q){this.writeVertex=h;this.writeTriangle=l;this.canUseThinTessellation=q;this.prevNormal={x:void 0,y:void 0};this.nextNormal={x:void 0,y:void 0};this.textureNormalLeft={x:0,y:1};this.textureNormalRight={x:0,y:-1};this.textureNormal={x:void 0,
y:void 0};this.joinNormal={x:void 0,y:void 0};this.inner={x:void 0,y:void 0};this.outer={x:void 0,y:void 0};this.roundStart={x:void 0,y:void 0};this.roundEnd={x:void 0,y:void 0};this.startBreak={x:void 0,y:void 0};this.endBreak={x:void 0,y:void 0};this.innerPrev={x:void 0,y:void 0};this.innerNext={x:void 0,y:void 0};this.bevelStart={x:void 0,y:void 0};this.bevelEnd={x:void 0,y:void 0};this.bevelMiddle={x:void 0,y:void 0}}var c=f.prototype;c.tessellate=function(h,l){if(h){var q=h.length;if(!(1>=q)){var e=
0;for(let d=1;d<q;d++)F(h[d],h[e])||++e===d||(h[e]=h[d]);h.length=e+1}}this.canUseThinTessellation&&l.halfWidth<G.THIN_LINE_HALF_WIDTH_THRESHOLD&&!l.offset?this.tessellateThin_(h,l):this.tessellate_(h,l)};c.tessellateThin_=function(h,l){if(!(2>h.length)){var q=l.wrapDistance||65535;l=l.initialDistance||0;var e=!1,d=h[0].x,g=h[0].y,m=h.length;for(let z=1;z<m;++z){e&&(e=!1,l=0);let w=h[z].x,B=h[z].y;var n=w-d;let A=B-g;var r=Math.sqrt(n*n+A*A);n/=r;A/=r;if(l+r>q){e=!0;var t=(q-l)/r;r=q-l;w=(1-t)*d+
t*w;B=(1-t)*g+t*B;--z}t=this.writeVertex(d,g,0,0,n,A,A,-n,0,-1,l);d=this.writeVertex(d,g,0,0,n,A,-A,n,0,1,l);l+=r;r=this.writeVertex(w,B,0,0,n,A,A,-n,0,-1,l);n=this.writeVertex(w,B,0,0,n,A,-A,n,0,1,l);this.writeTriangle(t,d,r);this.writeTriangle(d,r,n);d=w;g=B}}};c.tessellate_=function(h,l){var q=h[h.length-1];const e=F(h[0],q);if(!(h.length<(e?3:2))){var d=l.pixelCoordRatio,g=null!=l.capType?l.capType:0,m=null!=l.joinType?l.joinType:2,n=null!=l.miterLimit?Math.min(l.miterLimit,4):2,r=null!=l.roundLimit?
Math.min(l.roundLimit,1.05):1.05,t=null!=l.halfWidth?l.halfWidth:2,z=!!l.textured,w=null,B=null,A=this.prevNormal,x=this.nextNormal,E=-1,D=-1,K=this.joinNormal,H=this.textureNormalLeft,I=this.textureNormalRight,J=this.textureNormal,M=-1,O=-1,L=l.wrapDistance||65535,S=l.initialDistance||0,Q=this.writeVertex,P=this.writeTriangle;l=function(ba,da,ha,ka,la,ma){ba=Q(R,N,T,U,ha,ka,ba,da,la,ma,S);0<=M&&0<=O&&0<=ba&&P(M,O,ba);M=O;return O=ba};e&&(w=h[h.length-2],x.x=q.x-w.x,x.y=q.y-w.y,D=k(x),x.x/=D,x.y/=
D);q=!1;for(let ba=0;ba<h.length;++ba){q&&(q=!1,S=0);w&&(A.x=-x.x,A.y=-x.y,E=D,S+E>L&&(q=!0));q?(B=(L-S)/E,E=L-S,w={x:(1-B)*w.x+B*h[ba].x,y:(1-B)*w.y+B*h[ba].y},--ba):w=h[ba];var R=w.x;var N=w.y;var W=0>=ba&&!q,X=ba===h.length-1;W||(S+=E);(B=X?e?h[1]:null:h[ba+1])?(x.x=B.x-R,x.y=B.y-N,D=k(x),x.x/=D,x.y/=D):(x.x=void 0,x.y=void 0);if(!e){if(W){y(K,x);var T=K.x;var U=K.y;2===g&&(l(-x.y-x.x,x.x-x.y,x.x,x.y,0,-1),l(x.y-x.x,-x.x-x.y,x.x,x.y,0,1));1===g&&(l(-x.y-x.x,x.x-x.y,x.x,x.y,-1,-1),l(x.y-x.x,-x.x-
x.y,x.x,x.y,-1,1));if(1===g||0===g)l(-x.y,x.x,x.x,x.y,0,-1),l(x.y,-x.x,x.x,x.y,0,1);continue}if(X){C(K,A);T=K.x;U=K.y;if(1===g||0===g)l(A.y,-A.x,-A.x,-A.y,0,-1),l(-A.y,A.x,-A.x,-A.y,0,1);2===g&&(l(A.y-A.x,-A.x-A.y,-A.x,-A.y,0,-1),l(-A.y-A.x,A.x-A.y,-A.x,-A.y,0,1));1===g&&(l(A.y-A.x,-A.x-A.y,-A.x,-A.y,1,-1),l(-A.y-A.x,A.x-A.y,-A.x,-A.y,1,1));continue}}var V=void 0;W=-(A.x*x.y-A.y*x.x);.01>Math.abs(W)?0<A.x*x.x+A.y*x.y?(K.x=A.x,K.y=A.y,W=1,V=Number.MAX_VALUE,B=!0):(y(K,x),V=W=1,B=!1):(K.x=(A.x+x.x)/
W,K.y=(A.y+x.y)/W,V=k(K),B=(V-1)*t*d,B=4<V||B>E&&B>D);T=K.x;U=K.y;var Z=m;switch(m){case 0:1.05>V&&(Z=2);break;case 1:V<r&&(Z=2);break;case 2:V>n&&(Z=0)}switch(Z){case 2:l(K.x,K.y,-A.x,-A.y,0,-1);l(-K.x,-K.y,-A.x,-A.y,0,1);if(X)break;z&&(B=q?0:S,M=this.writeVertex(R,N,T,U,x.x,x.y,K.x,K.y,0,-1,B),O=this.writeVertex(R,N,T,U,x.x,x.y,-K.x,-K.y,0,1,B));break;case 0:W=0>W;var ca=void 0;W?(Z=M,M=O,O=Z,ca=H,Z=I):(ca=I,Z=H);var ea=void 0,fa=void 0;B?(ea=W?y(this.innerPrev,A):C(this.innerPrev,A),fa=W?C(this.innerNext,
x):y(this.innerNext,x)):ea=fa=W?p(this.inner,K):v(this.inner,K);V=W?C(this.bevelStart,A):y(this.bevelStart,A);l(ea.x,ea.y,-A.x,-A.y,ca.x,ca.y);ea=l(V.x,V.y,-A.x,-A.y,Z.x,Z.y);if(X)break;X=W?y(this.bevelEnd,x):C(this.bevelEnd,x);B?(B=this.writeVertex(R,N,T,U,-A.x,-A.y,0,0,0,0,S),M=this.writeVertex(R,N,T,U,x.x,x.y,fa.x,fa.y,ca.x,ca.y,S),O=this.writeVertex(R,N,T,U,x.x,x.y,X.x,X.y,Z.x,Z.y,S),this.writeTriangle(ea,B,O)):(z?(B=this.bevelMiddle,B.x=(V.x+X.x)/2,B.y=(V.y+X.y)/2,b(J,B,-A.x,-A.y),l(B.x,B.y,
-A.x,-A.y,J.x,J.y),b(J,B,x.x,x.y),M=this.writeVertex(R,N,T,U,x.x,x.y,B.x,B.y,J.x,J.y,S),O=this.writeVertex(R,N,T,U,x.x,x.y,fa.x,fa.y,ca.x,ca.y,S)):(B=M,M=O,O=B),l(X.x,X.y,x.x,x.y,Z.x,Z.y));W&&(B=M,M=O,O=B);break;case 1:{W=0>W;var ia=void 0;W?(Z=M,M=O,O=Z,Z=H,ia=I):(Z=I,ia=H);var ja=W?p(this.inner,K):v(this.inner,K);B?(fa=W?y(this.innerPrev,A):C(this.innerPrev,A),ca=W?C(this.innerNext,x):y(this.innerNext,x)):ca=fa=ja;ea=W?C(this.roundStart,A):y(this.roundStart,A);var Y=W?y(this.roundEnd,x):C(this.roundEnd,
x);fa=l(fa.x,fa.y,-A.x,-A.y,Z.x,Z.y);ea=l(ea.x,ea.y,-A.x,-A.y,ia.x,ia.y);if(X)break;X=this.writeVertex(R,N,T,U,-A.x,-A.y,0,0,0,0,S);B||this.writeTriangle(M,O,X);ja=p(this.outer,ja);ia=this.writeVertex(R,N,T,U,x.x,x.y,Y.x,Y.y,ia.x,ia.y,S);let da,ha;if(Y=2<V){var aa=void 0;V!==Number.MAX_VALUE?(ja.x/=V,ja.y/=V,aa=A.x*ja.x+A.y*ja.y,aa=(V*(aa*aa-1)+1)/aa):aa=-1;da=W?C(this.startBreak,A):y(this.startBreak,A);da.x+=A.x*aa;da.y+=A.y*aa;ha=W?y(this.endBreak,x):C(this.endBreak,x);ha.x+=x.x*aa;ha.y+=x.y*aa}b(J,
ja,-A.x,-A.y);V=this.writeVertex(R,N,T,U,-A.x,-A.y,ja.x,ja.y,J.x,J.y,S);b(J,ja,x.x,x.y);ja=z?this.writeVertex(R,N,T,U,x.x,x.y,ja.x,ja.y,J.x,J.y,S):V;aa=X;const ka=z?this.writeVertex(R,N,T,U,x.x,x.y,0,0,0,0,S):X;let la=-1,ma=-1;Y&&(b(J,da,-A.x,-A.y),la=this.writeVertex(R,N,T,U,-A.x,-A.y,da.x,da.y,J.x,J.y,S),b(J,ha,x.x,x.y),ma=this.writeVertex(R,N,T,U,x.x,x.y,ha.x,ha.y,J.x,J.y,S));z?Y?(this.writeTriangle(aa,ea,la),this.writeTriangle(aa,la,V),this.writeTriangle(ka,ja,ma),this.writeTriangle(ka,ma,ia)):
(this.writeTriangle(aa,ea,V),this.writeTriangle(ka,ja,ia)):Y?(this.writeTriangle(X,ea,la),this.writeTriangle(X,la,ma),this.writeTriangle(X,ma,ia)):(this.writeTriangle(X,ea,V),this.writeTriangle(X,ja,ia));B?M=this.writeVertex(R,N,T,U,x.x,x.y,ca.x,ca.y,Z.x,Z.y,S):(M=z?this.writeVertex(R,N,T,U,x.x,x.y,ca.x,ca.y,Z.x,Z.y,S):fa,this.writeTriangle(M,ka,ia));O=ia;W&&(B=M,M=O,O=B)}}}}};return f}();u.LineTessellation=a;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer","../../../../../../symbols/cim/utils","./WGLMeshTemplate"],function(u,G,F,C,y){const v=G.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(p){function k(b){var a=p.call(this)||this;a._ongoingMaterialRequestMap=new Map;a._materialCache=new Map;a._dynamicPropertyMap=new Map;a._cimLayer=b;return a}u._inheritsLoose(k,p);k.prototype.analyze=function(b,a,f,c,h){if(h&&0===h.length)return null;const l=
h&&0<h.length;a=a.readLegacyFeature();const q=this._materialCache;var e=this._cimLayer.materialHash;if(!e)return v.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const d="function"===typeof e?e(a,f,c):e;if(q.has(d))return b=q.get(d),Promise.resolve(b);if(e=this._ongoingMaterialRequestMap.get(d))return e;e=this._cimLayer;var g=F.analyzeCIMResource(e.cim,this._cimLayer.materialOverrides);g.mosaicHash=d;const {type:m,url:n}=e;g={cim:g,type:m,mosaicHash:d,
url:n,size:null,dashTemplate:null,text:null,fontName:null};switch(m){case "marker":g.size=C.evaluateValueOrFunction(e.size,a,f,c);break;case "line":g.dashTemplate=e.dashTemplate;break;case "text":g.text=C.evaluateValueOrFunction(e.text,a,f,c),g.fontName=C.evaluateValueOrFunction(e.fontName,a,f,c)}b=b.getMosaicItem(g,h).then(r=>{l||(this._ongoingMaterialRequestMap.delete(d),q.set(d,r));return r}).catch(r=>{this._ongoingMaterialRequestMap.delete(d);v.error(".analyze()",r.message);return null});l||this._ongoingMaterialRequestMap.set(d,
b);return b};return k}(y)})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./SDFHelper ./utils ./effects/CIMEffectHelper ../../views/2d/arcade/callExpressionWithFeature".split(" "),function(u,G,F,C,y,v,p,k,b,a,f,c,h){function l(N){switch(N){case "Butt":return 0;case "Square":return 2;default:return 1}}function q(N){switch(N){case "Bevel":return 0;
case "Miter":return 2;default:return 1}}function e(N){switch(N){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function d(N){switch(N){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function g(N){let W="",X="";N&&(N=N.toLowerCase(),-1!==N.indexOf("italic")?W="italic":-1!==N.indexOf("oblique")&&(W="oblique"),-1!==N.indexOf("bold")?X="bold":-1!==N.indexOf("light")&&(X="lighter"));
return{style:W,weight:X}}function m(N,W,X,T){let U;N[W]?U=N[W]:(U={},N[W]=U);U[X]=T}function n(N){return(N=N.markerPlacement)&&N.angleToLine?1:0}function r(){r=G._asyncToGenerator(function*(N,W,X,T,U){T=null!=T?T:[];if(!N)return T;let V;const Z={};if("CIMSymbolReference"===N.type){if(V=N.symbol,N=N.primitiveOverrides){var ca=[];for(const fa of N){var ea=fa.valueExpressionInfo;ea&&W?(ea=k.createRendererExpression(ea.expression,W.spatialReference,W.fields).then(ia=>{ia&&m(Z,fa.primitiveName,fa.propertyName,
ia)}),ca.push(ea)):null!=fa.value&&m(Z,fa.primitiveName,fa.propertyName,fa.value)}0<ca.length&&(yield Promise.all(ca))}}else return R.error("Expect cim type to be 'CIMSymbolReference'"),T;ca=[];P(V,X,ca);0<ca.length&&(yield Promise.all(ca));switch(V.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":t(V,N,Z,W,T,X,U)}return T});return r.apply(this,arguments)}function t(N,W,X,T,U,V,Z){if(N){var ca=N.symbolLayers;if(ca){var ea=N.effects,fa,ia=b.CIMSymbolHelper.getSize(N);"CIMPointSymbol"===
N.type&&"Map"===N.angleAlignment&&(fa=1);for(var ja=ca.length;ja--;){var Y=ca[ja];if(!Y||!1===Y.enable)continue;let pa;ea&&ea.length&&(pa=[...ea]);var aa=Y.effects;aa&&aa.length&&(ea?pa.push(...aa):pa=[...aa]);var ba=[];b.OverrideHelper.findApplicableOverrides(Y,W,ba);switch(Y.type){case "CIMSolidFill":z(Y,pa,X,ba,T,U);break;case "CIMPictureFill":w(Y,pa,X,ba,T,V,U);break;case "CIMHatchFill":B(Y,pa,X,ba,T,U);break;case "CIMGradientFill":{aa=pa;var da=X,ha=T,ka=U;const [ra,ua]=Q(ba,Y.primitiveName);
var la=p.numericHash(JSON.stringify(Y)+ua).toString();ka.push({type:"fill",templateHash:la,materialHash:ra?S(la,da,ba,ha):la,cim:Y,materialOverrides:null,colorLocked:Y.colorLocked,effects:aa,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}break;case "CIMSolidStroke":A(Y,pa,X,ba,T,U,"CIMPolygonSymbol"===N.type,ia);break;case "CIMPictureStroke":x(Y,pa,X,ba,T,U,"CIMPolygonSymbol"===N.type,ia);break;case "CIMGradientStroke":{aa=pa;da=X;ha=T;ka=U;la="CIMPolygonSymbol"===N.type;
var ma=ia,na=Y.primitiveName,oa=void 0!==Y.width?Y.width:4,sa=l(Y.capStyle),ta=q(Y.joinStyle),qa=Y.miterLimit;const [ra,ua]=Q(ba,na),va=p.numericHash(JSON.stringify(Y)+ua).toString();ka.push({type:"line",templateHash:va,materialHash:ra?S(va,da,ba,ha):va,cim:Y,materialOverrides:null,isOutline:la,colorLocked:Y.colorLocked,effects:aa,color:{r:128,g:128,b:128,a:1},width:L(na,da,"Width",ha,oa),cap:L(na,da,"CapStyle",ha,sa),join:L(na,da,"JoinStyle",ha,ta),miterLimit:L(na,da,"MiterLimit",ha,qa),referenceWidth:ma,
zOrder:M(Y.name),dashTemplate:null,scaleDash:!1})}break;case "CIMCharacterMarker":E(Y,pa,X,ba,T,U);break;case "CIMPictureMarker":if(E(Y,pa,X,ba,T,U))break;"CIMLineSymbol"===N.type&&(fa=n(Y));D(Y,pa,X,ba,T,V,U,fa,ia);break;case "CIMVectorMarker":if(E(Y,pa,X,ba,T,U))break;"CIMLineSymbol"===N.type&&(fa=n(Y));aa=pa;da=X;ha=T;ka=U;la=V;ma=fa;na=ia;oa=Z;if(ta=Y.markerGraphics){sa=0;Y.scaleSymbolsProportionally&&(qa=Y.frame)&&(sa=qa.ymax-qa.ymin);for(const ra of ta)if(ra&&(ta=ra.symbol))switch(ta.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":H(Y,
aa,ra,ba,da,ha,ka,la,ma,na,sa,oa);break;case "CIMTextSymbol":K(Y,aa,ra,da,ba,ha,ka,ma,na,sa)}}break;default:R.error("Cannot analyze CIM layer",Y.type)}}}}}function z(N,W,X,T,U,V){const Z=N.primitiveName,ca=f.fromCIMColor(N.color),[ea,fa]=Q(T,Z),ia=p.numericHash(JSON.stringify(N)+fa).toString();V.push({type:"fill",templateHash:ia,materialHash:ea?()=>ia:ia,cim:N,materialOverrides:null,colorLocked:N.colorLocked,color:L(Z,X,"Color",U,ca,O),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:W})}function w(N,
W,X,T,U,V,Z){const ca=N.primitiveName,ea=N.tintColor?f.fromCIMColor(N.tintColor):{r:255,g:255,b:255,a:1},[fa,ia]=Q(T,ca);T=p.numericHash(JSON.stringify(N)+ia).toString();const ja=p.numericHash(`${N.url}${JSON.stringify(N.colorSubstitutions)}`).toString();let Y=f.getValue(N.scaleX);if("width"in N){const aa=N.width;let ba=1;V=V.getResource(N.url);y.isSome(V)&&(ba=V.width/V.height);Y/=N.height/aa*ba}Z.push({type:"fill",templateHash:T,materialHash:fa?()=>ja:ja,cim:N,materialOverrides:null,colorLocked:N.colorLocked,
effects:W,color:L(ca,X,"TintColor",U,ea,O),height:L(ca,X,"Height",U,N.height),scaleX:L(ca,X,"ScaleX",U,Y),angle:L(ca,X,"Rotation",U,f.getValue(N.rotation)),offsetX:L(ca,X,"OffsetX",U,f.getValue(N.offsetX)),offsetY:L(ca,X,"OffsetY",U,f.getValue(N.offsetY)),url:N.url})}function B(N,W,X,T,U,V){const Z=["Rotation","OffsetX","OffsetY"],ca=T.filter(Y=>Y.primitiveName!==N.primitiveName&&-1===Z.indexOf(Y.propertyName)),ea=N.primitiveName,[fa,ia]=Q(T,ea);T=p.numericHash(JSON.stringify(N)+ia).toString();const ja=
p.numericHash(`${N.separation}${JSON.stringify(N.lineSymbol)}`).toString();V.push({type:"fill",templateHash:T,materialHash:fa?S(ja,X,ca,U):ja,cim:N,materialOverrides:ca,colorLocked:N.colorLocked,effects:W,color:{r:255,g:255,b:255,a:1},height:L(ea,X,"Separation",U,N.separation),scaleX:1,angle:L(ea,X,"Rotation",U,f.getValue(N.rotation)),offsetX:L(ea,X,"OffsetX",U,f.getValue(N.offsetX)),offsetY:L(ea,X,"OffsetY",U,f.getValue(N.offsetY))})}function A(N,W,X,T,U,V,Z,ca){const ea=N.primitiveName,fa=f.fromCIMColor(N.color),
ia=void 0!==N.width?N.width:4,ja=l(N.capStyle),Y=q(N.joinStyle),aa=N.miterLimit,[ba,da]=Q(T,ea),ha=p.numericHash(JSON.stringify(N)+da).toString();let ka;if(W&&0<W.length&&(T=W[W.length-1],"CIMGeometricEffectDashes"===T.type&&"NoConstraint"===T.lineDashEnding)){W=[...N.effects];var la=W.pop();ka=la.dashTemplate;la=la.scaleDash}V.push({type:"line",templateHash:ha,materialHash:ba?()=>ha:ha,cim:N,materialOverrides:null,isOutline:Z,colorLocked:N.colorLocked,effects:W,color:L(ea,X,"Color",U,fa,O),width:L(ea,
X,"Width",U,ia),cap:L(ea,X,"CapStyle",U,ja),join:L(ea,X,"JoinStyle",U,Y),miterLimit:L(ea,X,"MiterLimit",U,aa),referenceWidth:ca,zOrder:M(N.name),dashTemplate:ka,scaleDash:la})}function x(N,W,X,T,U,V,Z,ca){const ea=p.numericHash(`${N.url}${JSON.stringify(N.colorSubstitutions)}`).toString(),fa=N.primitiveName,ia=f.fromCIMColor(N.tintColor),ja=void 0!==N.width?N.width:4,Y=l(N.capStyle),aa=q(N.joinStyle),ba=N.miterLimit,[da,ha]=Q(T,fa);T=p.numericHash(JSON.stringify(N)+ha).toString();V.push({type:"line",
templateHash:T,materialHash:da?()=>ea:ea,cim:N,materialOverrides:null,isOutline:Z,colorLocked:N.colorLocked,effects:W,color:L(fa,X,"TintColor",U,ia,O),width:L(fa,X,"Width",U,ja),cap:L(fa,X,"CapStyle",U,Y),join:L(fa,X,"JoinStyle",U,aa),miterLimit:L(fa,X,"MiterLimit",U,ba),referenceWidth:ca,zOrder:M(N.name),dashTemplate:null,scaleDash:!1,url:N.url})}function E(N,W,X,T,U,V){const Z=N.markerPlacement;if(!Z||"CIMMarkerPlacementInsidePolygon"!==Z.type)return!1;const ca=["Rotation","OffsetX","OffsetY"],
ea=T.filter(da=>da.primitiveName!==N.primitiveName&&-1===ca.indexOf(da.propertyName)),fa="url"in N?N.url:null,[ia,ja]=Q(T,Z.primitiveName);T=p.numericHash(JSON.stringify(N)+ja).toString();let Y=Z.stepY,aa=null,ba=1;Z.shiftOddRows&&(Y*=2,aa=function(da){return da?2*da:0},ba=.5);V.push({type:"fill",templateHash:T,materialHash:ia?S(T,X,ea,U):T,cim:N,materialOverrides:ea,colorLocked:N.colorLocked,effects:W,color:{r:255,g:255,b:255,a:1},height:L(Z.primitiveName,X,"StepY",U,Y,aa),scaleX:ba,angle:L(Z.primitiveName,
X,"GridAngle",U,Z.gridAngle),offsetX:L(Z.primitiveName,X,"OffsetX",U,f.getValue(Z.offsetX)),offsetY:L(Z.primitiveName,X,"OffsetY",U,f.getValue(Z.offsetY)),url:fa});return!0}function D(N,W,X,T,U,V,Z,ca,ea){var fa;const ia=N.primitiveName,ja=f.getValue(N.size);let Y=f.getValue(N.scaleX);const aa=f.getValue(N.rotation),ba=f.getValue(N.offsetX),da=f.getValue(N.offsetY),ha=N.tintColor?f.fromCIMColor(N.tintColor):{r:255,g:255,b:255,a:1},ka=p.numericHash(`${N.url}${JSON.stringify(N.colorSubstitutions)}`).toString(),
[la,ma]=Q(T,ia);T=p.numericHash(JSON.stringify(N)+ma).toString();const na=null!=(fa=N.anchorPoint)?fa:{x:0,y:0};if("width"in N){fa=N.width;let oa=1;V=V.getResource(N.url);y.isSome(V)&&(oa=V.width/V.height);Y/=ja/fa*oa}Z.push({type:"marker",templateHash:T,materialHash:la?()=>ka:ka,cim:N,materialOverrides:null,colorLocked:N.colorLocked,effects:W,scaleSymbolsProportionally:!1,alignment:ca,size:L(ia,X,"Size",U,ja),scaleX:L(ia,X,"ScaleX",U,Y),rotation:L(ia,X,"Rotation",U,aa),offsetX:L(ia,X,"OffsetX",U,
ba),offsetY:L(ia,X,"OffsetY",U,da),color:L(ia,X,"TintColor",U,ha,O),anchorPoint:{x:na.x,y:-na.y},isAbsoluteAnchorPoint:"Relative"!==N.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:N.rotateClockwise,referenceSize:ea,sizeRatio:1,markerPlacement:N.markerPlacement,url:N.url})}function K(N,W,X,T,U,V,Z,ca,ea,fa){b.OverrideHelper.findApplicableOverrides(X,U,[]);var ia=X.geometry;if("x"in ia&&"y"in ia){var ja=X.symbol;var Y=ja.underline?"underline":ja.strikethrough?
"line-through":"none";var aa=g(ja.fontStyleName),ba=f.toKebabCase(ja.fontFamilyName);ja.font={family:ba,decoration:Y,...aa};var da=N.frame,ha=ia.x-.5*(da.xmin+da.xmax),ka=ia.y-.5*(da.ymin+da.ymax),la=N.size/fa;fa=N.primitiveName;ia=f.getValue(ja.height)*la;da=f.getValue(ja.angle);ha=(f.getValue(ja.offsetX)+ha)*la;ka=(f.getValue(ja.offsetY)+ka)*la;var ma=f.fromCIMColor(b.CIMSymbolHelper.getFillColor(ja)),na=f.fromCIMColor(b.CIMSymbolHelper.getStrokeColor(ja)),oa=b.CIMSymbolHelper.getStrokeWidth(ja);
oa||(na=f.fromCIMColor(b.CIMSymbolHelper.getFillColor(ja.haloSymbol)),oa=ja.haloSize*la);var [sa,ta]=Q(U,fa);U=JSON.stringify(N.effects)+Number(N.colorLocked)+JSON.stringify(N.anchorPoint)+N.anchorPointUnits+JSON.stringify(N.markerPlacement);U=p.numericHash(JSON.stringify(X)+U+ta).toString();var qa=L(X.primitiveName,T,"TextString",V,X.textString,f._adjustTextCase,ja.textCase);({fontStyleName:X}=ja);var pa=ba+(X?"-"+X.toLowerCase():"-regular");Z.push({type:"text",templateHash:U,materialHash:sa||"function"===
typeof qa||qa.match(/\[(.*?)\]/)?(ra,ua,va)=>pa+"-"+f.evaluateValueOrFunction(qa,ra,ua,va):pa+"-"+p.numericHash(qa),cim:ja,materialOverrides:null,colorLocked:N.colorLocked,effects:W,alignment:ca,anchorPoint:{x:N.anchorPoint?N.anchorPoint.x:0,y:N.anchorPoint?N.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==N.anchorPointUnits,fontName:pa,decoration:Y,weight:L(fa,T,"Weight",V,aa.weight),style:L(fa,T,"Size",V,aa.style),size:L(fa,T,"Size",V,ia),angle:L(fa,T,"Rotation",V,da),offsetX:L(fa,T,"OffsetX",
V,ha),offsetY:L(fa,T,"OffsetY",V,ka),horizontalAlignment:e(ja.horizontalAlignment),verticalAlignment:d(ja.verticalAlignment),text:qa,color:ma,outlineColor:na,outlineSize:oa,referenceSize:ea,sizeRatio:1,markerPlacement:N.markerPlacement})}}function H(N,W,X,T,U,V,Z,ca,ea,fa,ia,ja){var Y=X.symbol;const aa=Y.symbolLayers;if(aa)if(ja)J(N,W,X,U,T,V,Z,ca,ea,fa,ia);else if(ja=aa.length,aa&&2===aa.length&&aa[0].enable&&aa[1].enable&&"CIMSolidStroke"===aa[0].type&&"CIMSolidFill"===aa[1].type&&!aa[0].effects&&
!aa[1].effects)I(N,X,aa,T,U,V,Z,ea,fa,ia);else if(Y=c.CIMEffectHelper.applyEffects(Y.effects,X.geometry))for(;ja--;){var ba=aa[ja];if(ba&&!1!==ba.enable)switch(ba.type){case "CIMSolidFill":case "CIMSolidStroke":{var da,ha=c.CIMEffectHelper.applyEffects(ba.effects,Y),ka=a.getExtent(ha);if(!ka)continue;const [na,oa,sa]=a.getSDFMetrics(ka,N.frame,N.size,N.anchorPoint,"Relative"!==N.anchorPointUnits);var la="CIMSolidFill"===ba.type;ha={type:"sdf",geom:ha,asFill:la};var ma=N.primitiveName;ka=null!=(da=
f.getValue(N.size))?da:10;const ta=f.getValue(N.rotation),qa=f.getValue(N.offsetX),pa=f.getValue(N.offsetY),ra=ba.path,ua=ba.primitiveName,va=la?f.fromCIMColor(b.CIMSymbolHelper.getFillColor(ba)):f.fromCIMColor(b.CIMSymbolHelper.getStrokeColor(ba)),wa=la?{r:0,g:0,b:0,a:0}:f.fromCIMColor(b.CIMSymbolHelper.getStrokeColor(ba)),ya=b.CIMSymbolHelper.getStrokeWidth(ba);if(!la&&!ya)break;la=!1;let za="";for(const xa of T)if(xa.primitiveName===ua||xa.primitiveName===ma)void 0!==xa.value?za+=`-${xa.primitiveName}-${xa.propertyName}-${JSON.stringify(xa.value)}`:
xa.valueExpressionInfo&&(la=!0);ma=JSON.stringify({...N,markerGraphics:null});const Aa=p.numericHash(JSON.stringify(ha)+ra).toString();ba={type:"marker",templateHash:p.numericHash(JSON.stringify(X)+JSON.stringify(ba)+ma+za).toString(),materialHash:la?()=>Aa:Aa,cim:ha,materialOverrides:null,colorLocked:N.colorLocked,effects:W,scaleSymbolsProportionally:N.scaleSymbolsProportionally,alignment:ea,anchorPoint:{x:oa,y:sa},isAbsoluteAnchorPoint:!1,size:L(N.primitiveName,U,"Size",V,ka),rotation:L(N.primitiveName,
U,"Rotation",V,ta),offsetX:L(N.primitiveName,U,"OffsetX",V,qa),offsetY:L(N.primitiveName,U,"OffsetY",V,pa),scaleX:1,frameHeight:ia,rotateClockwise:N.rotateClockwise,referenceSize:fa,sizeRatio:na,color:L(ua,U,"Color",V,va,O),outlineColor:L(ua,U,"Color",V,wa,O),outlineWidth:L(ua,U,"Width",V,ya),markerPlacement:N.markerPlacement,path:ra};Z.push(ba);break}default:J(N,W,X,U,T,V,Z,ca,ea,fa,ia)}}}function I(N,W,X,T,U,V,Z,ca,ea,fa){var ia=W.geometry;const ja=X[0];X=X[1];var Y=a.getExtent(ia);if(Y){var [aa,
ba,da]=a.getSDFMetrics(Y,N.frame,N.size,N.anchorPoint,"Relative"!==N.anchorPointUnits);ia={type:"sdf",geom:ia,asFill:!0};var ha=N.primitiveName;Y=f.getValue(N.size);var ka=f.getValue(N.rotation),la=f.getValue(N.offsetX),ma=f.getValue(N.offsetY),na=X.path,oa=X.primitiveName,sa=ja.primitiveName,ta=f.fromCIMColor(b.CIMSymbolHelper.getFillColor(X)),qa=f.fromCIMColor(b.CIMSymbolHelper.getStrokeColor(ja)),pa=b.CIMSymbolHelper.getStrokeWidth(ja),ra=!1,ua="";for(const wa of T)if(wa.primitiveName===oa||wa.primitiveName===
sa||wa.primitiveName===ha)void 0!==wa.value?ua+=`-${wa.primitiveName}-${wa.propertyName}-${JSON.stringify(wa.value)}`:wa.valueExpressionInfo&&(ra=!0);T=JSON.stringify({...N,markerGraphics:null});var va=p.numericHash(JSON.stringify(ia)+na).toString();N={type:"marker",templateHash:p.numericHash(JSON.stringify(W)+JSON.stringify(X)+JSON.stringify(ja)+T+ua).toString(),materialHash:ra?()=>va:va,cim:ia,materialOverrides:null,colorLocked:N.colorLocked,effects:N.effects,scaleSymbolsProportionally:N.scaleSymbolsProportionally,
alignment:ca,anchorPoint:{x:ba,y:da},isAbsoluteAnchorPoint:!1,size:L(N.primitiveName,U,"Size",V,Y),rotation:L(N.primitiveName,U,"Rotation",V,ka),offsetX:L(N.primitiveName,U,"OffsetX",V,la),offsetY:L(N.primitiveName,U,"OffsetY",V,ma),scaleX:1,frameHeight:fa,rotateClockwise:N.rotateClockwise,referenceSize:ea,sizeRatio:aa,color:L(oa,U,"Color",V,ta,O),outlineColor:L(sa,U,"Color",V,qa,O),outlineWidth:L(sa,U,"Width",V,pa),markerPlacement:N.markerPlacement,path:na};Z.push(N)}}function J(N,W,X,T,U,V,Z,ca,
ea,fa,ia){X={type:N.type,enable:!0,name:N.name,colorLocked:N.colorLocked,primitiveName:N.primitiveName,anchorPoint:N.anchorPoint,anchorPointUnits:N.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:N.rotateClockwise,rotation:0,size:N.size,billboardMode3D:N.billboardMode3D,depth3D:N.depth3D,frame:N.frame,markerGraphics:[X],scaleSymbolsProportionally:N.scaleSymbolsProportionally,respectFrame:N.respectFrame,clippingPath:N.clippingPath};let ja=[];const Y=["Rotation","OffsetX","OffsetY"];ja=U.filter(ma=>
ma.primitiveName!==N.primitiveName||-1===Y.indexOf(ma.propertyName));var aa="";for(var ba of U)void 0!==ba.value&&(aa+=`-${ba.primitiveName}-${ba.propertyName}-${JSON.stringify(ba.value)}`);const [da,ha,ka]=b.CIMSymbolHelper.getTextureAnchor(X,ca);U=N.primitiveName;ca=f.getValue(N.rotation);ba=f.getValue(N.offsetX);const la=f.getValue(N.offsetY);aa=p.numericHash(JSON.stringify(X)+aa).toString();W={type:"marker",templateHash:aa,materialHash:0===ja.length?aa:S(aa,T,ja,V),cim:X,materialOverrides:ja,
colorLocked:N.colorLocked,effects:W,scaleSymbolsProportionally:N.scaleSymbolsProportionally,alignment:ea,anchorPoint:{x:da,y:ha},isAbsoluteAnchorPoint:!1,size:N.size,rotation:L(U,T,"Rotation",V,ca),offsetX:L(U,T,"OffsetX",V,ba),offsetY:L(U,T,"OffsetY",V,la),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:ia,rotateClockwise:N.rotateClockwise,referenceSize:fa,sizeRatio:ka/v.pt2px(N.size),markerPlacement:N.markerPlacement};Z.push(W)}function M(N){return N&&
0===N.indexOf("Level_")?parseInt(N.substr(6),10):0}function O(N){if(!N||0===N.length)return null;N=(new F(N)).toRgba();return{r:N[0],g:N[1],b:N[2],a:N[3]}}function L(N,W,X,T,U,V,Z){if(N=W[N]){const ca=N[X];if("string"===typeof ca||"number"===typeof ca||ca instanceof Array)return V?V.call(null,ca,Z):ca;if(null!=ca&&ca instanceof k.ArcadeExpression)return(ea,fa,ia)=>{ea=h(ca,ea,{$view:ia},T.geometryType,fa);null!==ea&&V&&(ea=V.call(null,ea,Z));return null!==ea?ea:U}}return U}function S(N,W,X,T){for(const U of X)if(U.valueExpressionInfo){const V=
W[U.primitiveName]&&W[U.primitiveName][U.propertyName];V instanceof k.ArcadeExpression&&(U.fn=(Z,ca,ea)=>h(V,Z,{$view:ea},T.geometryType,ca))}return(U,V,Z)=>{for(const ca of X)ca.fn&&(ca.value=ca.fn(U,V,Z));return p.numericHash(N+b.OverrideHelper.buildOverrideKey(X)).toString()}}function Q(N,W){let X=!1,T="";for(const U of N)U.primitiveName===W&&(void 0!==U.value?T+=`-${U.primitiveName}-${U.propertyName}-${JSON.stringify(U.value)}`:U.valueExpressionInfo&&(X=!0));return[X,T]}function P(N,W,X){if(N&&
W)switch(N.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(N=N.symbolLayers)for(const T of N)switch(T.type){case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMCharacterMarker":case "CIMPictureMarker":"url"in T&&T.url&&X.push(W.fetchResource(T.url,null));break;case "CIMVectorMarker":if(N=T.markerGraphics)for(const U of N)U&&(N=U.symbol)&&P(N,W,X)}}}const R=C.getLogger("esri.symbols.cim.cimAnalyzer");
u.analyzeCIMResource=function(N,W){if(!W||0===W.length)return N;N=JSON.parse(JSON.stringify(N));b.OverrideHelper.applyOverrides(N,W);return N};u.analyzeCIMSymbol=function(N,W,X,T,U){return r.apply(this,arguments)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../geometry/support/quantizationUtils"],function(u,G,F){function C(v){const p={};switch(v){case "esriGeometryPoint":return(k,
b,a,f)=>F.unquantizePoint(b,p,k,a,f);case "esriGeometryPolygon":return(k,b,a,f)=>F.unquantizePolygon(b,p,k,a,f);case "esriGeometryPolyline":return(k,b,a,f)=>F.unquantizePolyline(b,p,k,a,f);case "esriGeometryMultipoint":return(k,b,a,f)=>F.unquantizeMultipoint(b,p,k,a,f);default:return G.getLogger("esri.views.2d.support.arcadeOnDemand").error(new u("mapview-arcade",`Unable to handle geometryType: ${v}`)),k=>k}}const y=new Map;return function(v,p,k,b,a){if(v.referencesGeometry()&&a){{const {transform:f,
hasZ:c,hasM:h}=a;y.has(b)||y.set(b,C(b));b=y.get(b)(p.geometry,f,c,h);p={...p,geometry:b}}}p=v.repurposeFeature(p);try{return v.evaluate({...k,$feature:p})}catch(f){return G.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",f),null}}})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe","./jsonUtils"],function(u,G,F){function C({scale:x,translate:E},D){return Math.round((D-E[0])/x[0])}function y({scale:x,translate:E},
D){return Math.round((E[1]-D)/x[1])}function v(x,E,D){const K=[];let H,I,J,M;for(let O=0;O<D.length;O++){const L=D[O];if(0<O){if(J=C(x,L[0]),M=y(x,L[1]),J!==H||M!==I)K.push(E(L,J-H,M-I)),H=J,I=M}else H=C(x,L[0]),I=y(x,L[1]),K.push(E(L,H,I))}return 0<K.length?K:null}function p(x,E,D,K){return v(x,D?K?A:B:K?B:w,E)}function k(x,E,D,K){const H=[];D=D?K?A:B:K?B:w;for(K=0;K<E.length;K++){const I=v(x,D,E[K]);I&&3<=I.length&&H.push(I)}return H.length?H:null}function b(x,E,D,K){const H=[];D=D?K?A:B:K?B:w;
for(K=0;K<E.length;K++){const I=v(x,D,E[K]);I&&2<=I.length&&H.push(I)}return H.length?H:null}function a({scale:x,translate:E},D){return D*x[0]+E[0]}function f({scale:x,translate:E},D){return E[1]-D*x[1]}function c(x,E,D){const K=Array(D.length);if(!D.length)return K;const [H,I]=x.scale;let J=a(x,D[0][0]);x=f(x,D[0][1]);K[0]=E(D[0],J,x);for(let M=1;M<D.length;M++){const O=D[M];J+=O[0]*H;x-=O[1]*I;K[M]=E(O,J,x)}return K}function h(x,E,D){const K=Array(D.length);for(let H=0;H<D.length;H++)K[H]=c(x,E,
D[H]);return K}function l(x,E,D,K){return c(x,D?K?A:B:K?B:w,E)}function q(x,E,D,K){return h(x,D?K?A:B:K?B:w,E)}function e(x,E,D,K){return h(x,D?K?A:B:K?B:w,E)}function d(x,E,D){let [K,H]=D[0],I=Math.min(K,E[0]),J=Math.min(H,E[1]),M=Math.max(K,E[2]);E=Math.max(H,E[3]);for(let O=1;O<D.length;O++){const [L,S]=D[O];K+=L;H+=S;0>L&&(I=Math.min(I,K));0<L&&(M=Math.max(M,K));0>S?J=Math.min(J,H):0<S&&(E=Math.max(E,H))}x[0]=I;x[1]=J;x[2]=M;x[3]=E;return x}function g(x,E){if(!E.length)return null;x[0]=x[1]=Number.POSITIVE_INFINITY;
x[2]=x[3]=Number.NEGATIVE_INFINITY;for(let D=0;D<E.length;D++)d(x,x,E[D]);return x}function m(x,E,D,K,H){E.xmin=C(x,D.xmin);E.ymin=y(x,D.ymin);E.xmax=C(x,D.xmax);E.ymax=y(x,D.ymax);E!==D&&(K&&(E.zmin=D.zmin,E.zmax=D.zmax),H&&(E.mmin=D.mmin,E.mmax=D.mmax));return E}function n(x,E,D,K,H){E.points=p(x,D.points,K,H);return E}function r(x,E,D,K,H){E.x=C(x,D.x);E.y=y(x,D.y);E!==D&&(K&&(E.z=D.z),H&&(E.m=D.m));return E}function t(x,E,D,K,H){x=k(x,D.rings,K,H);if(!x)return null;E.rings=x;return E}function z(x,
E,D,K,H){x=b(x,D.paths,K,H);if(!x)return null;E.paths=x;return E}const w=(x,E,D)=>[E,D],B=(x,E,D)=>[E,D,x[2]],A=(x,E,D)=>[E,D,x[2],x[3]];u.equals=function(x,E){if(x===E||null==x&&null==E)return!0;if(null==x||null==E)return!1;let D,K,H,I;x&&"upperLeft"===x.originPosition?(D=x.translate[0],K=x.translate[1],x=x.scale[0]):(D=G.isSome(x.extent)?x.extent.xmin:0,K=G.isSome(x.extent)?x.extent.ymax:0,x=x.tolerance);E&&"upperLeft"===E.originPosition?(H=E.translate[0],I=E.translate[1],E=E.scale[0]):(H=G.isSome(E.extent)?
E.extent.xmin:0,I=G.isSome(E.extent)?E.extent.ymax:0,E=E.tolerance);return D===H&&K===I&&x===E};u.getQuantizedBoundsCoordsArray=d;u.getQuantizedBoundsCoordsArrayArray=g;u.getQuantizedBoundsPaths=function(x){return g([0,0,0,0],x)};u.getQuantizedBoundsPoints=function(x){const E=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return d(E,E,x)};u.getQuantizedBoundsRings=function(x){return g([0,0,0,0],x)};u.quantizeBounds=function(x,E,D){E[0]=C(x,D[0]);
E[3]=y(x,D[1]);E[2]=C(x,D[2]);E[1]=y(x,D[3]);return E};u.quantizeExtent=m;u.quantizeGeometry=function(x,E){return x&&E?F.isPoint(E)?r(x,{},E,!1,!1):F.isPolyline(E)?z(x,{},E,!1,!1):F.isPolygon(E)?t(x,{},E,!1,!1):F.isMultipoint(E)?n(x,{},E,!1,!1):F.isExtent(E)?m(x,{},E,!1,!1):null:null};u.quantizeMultipoint=n;u.quantizePaths=b;u.quantizePoint=r;u.quantizePoints=p;u.quantizePolygon=t;u.quantizePolyline=z;u.quantizeRings=k;u.quantizeX=C;u.quantizeY=y;u.toQuantizationTransform=function(x){return x?{originPosition:"upper-left"===
x.originPosition?"upperLeft":"lower-left"===x.originPosition?"lowerLeft":x.originPosition,scale:x.tolerance?[x.tolerance,x.tolerance]:[1,1],translate:G.isSome(x.extent)?[x.extent.xmin,x.extent.ymax]:[0,0]}:null};u.unquantizeBounds=function(x,E,D){return D?(E[0]=a(x,D[0]),E[1]=f(x,D[3]),E[2]=a(x,D[2]),E[3]=f(x,D[1]),E):[a(x,E[0]),f(x,E[3]),a(x,E[2]),f(x,E[1])]};u.unquantizeCoordsArray=c;u.unquantizeCoordsArrayArray=h;u.unquantizeExtent=function(x,E,D,K,H){E.xmin=a(x,D.xmin);E.ymin=f(x,D.ymin);E.xmax=
a(x,D.xmax);E.ymax=f(x,D.ymax);E!==D&&(K&&(E.zmin=D.zmin,E.zmax=D.zmax),H&&(E.mmin=D.mmin,E.mmax=D.mmax));return E};u.unquantizeMultipoint=function(x,E,D,K,H){G.isSome(D)&&(E.points=l(x,D.points,K,H));return E};u.unquantizePaths=q;u.unquantizePoint=function(x,E,D,K,H){if(G.isNone(D))return E;E.x=a(x,D.x);E.y=f(x,D.y);E!==D&&(K&&(E.z=D.z),H&&(E.m=D.m));return E};u.unquantizePoints=l;u.unquantizePolygon=function(x,E,D,K,H){G.isSome(D)&&(E.rings=e(x,D.rings,K,H));return E};u.unquantizePolyline=function(x,
E,D,K,H){G.isSome(D)&&(E.paths=q(x,D.paths,K,H));return E};u.unquantizeRings=e;u.unquantizeX=a;u.unquantizeY=f;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(u,
G,F,C,y,v,p,k,b,a){return function(f){function c(h,l,q){var e=f.call(this,h)||this;e._minMaxZoom=y.i1616to32(Math.round(l*C.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(q*C.MIN_MAX_ZOOM_PRECISION_FACTOR));e._cimLineLayer=h;let d=0;p.isFunction(h.width)||(d=.5*G.pt2px(h.width));e._dynamicPropertyMap.set("_halfWidth",(g,m,n)=>p.isFunction(h.width)?.5*G.pt2px(h.width(g,m,n)):d);p.isFunction(h.cap)?e._dynamicPropertyMap.set("_capType",h.cap):e._capType=h.cap;p.isFunction(h.join)?e._dynamicPropertyMap.set("_joinType",
h.join):e._joinType=h.join;p.isFunction(h.color)?e._dynamicPropertyMap.set("_fillColor",(g,m,n)=>(g=h.color(g,m,n))&&F.premultiplyAlphaRGBA(g)||0):(l=h.color,e._fillColor=l&&F.premultiplyAlphaRGBA(l)||0);p.isFunction(h.miterLimit)?e._dynamicPropertyMap.set("_miterLimitCosine",(g,m,n)=>p.getLimitCosine(h.miterLimit(g,m,n))):e._miterLimitCosine=p.getLimitCosine(h.miterLimit);e._scaleFactor=h.scaleFactor||1;e._isDashed=null!=h.dashTemplate;e._effects=h.effects;e.tessellationProperties._bitset=(h.colorLocked?
1:0)|(h.scaleDash?1:0)<<1;e._materialKey=h.materialKey;e._initializeTessellator(!0);return e}u._inheritsLoose(c,f);c.fromCIMLine=function(h,l){const [q,e]=p.getMinMaxZoom(h.scaleInfo,l);return new c(h,q,e)};c.prototype.bindFeature=function(h,l,q){const e=h.readLegacyFeature();this._dynamicPropertyMap.forEach((g,m)=>{this[m]=g(e,l,q)});this._halfWidth*=this._scaleFactor;h=this._materialCache;var d=this._cimLineLayer.materialHash;d=d(e,l,q);d=h.get(d);h=null;d&&a.ok(d.spriteMosaicItem)&&(h=d.spriteMosaicItem);
if(h){this._hasPattern=!0;const {rect:g,width:m,height:n}=h;d=g.x+C.SPRITE_PADDING;const r=g.y+C.SPRITE_PADDING,t=d+m,z=r+n;this.tessellationProperties._tl=y.i1616to32(d,r);this.tessellationProperties._br=y.i1616to32(t,z)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=0;this.tessellationProperties._halfReferenceWidth=
this.tessellationProperties._halfWidth;d=v.LineMaterialKey.load(this._materialKey);h&&(d.sdf=h.sdf,d.pattern=!0,d.textureBinding=h.textureBinding);this._materialKey=d.data};return c}(k(b))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q){const e=p.create(),d=v.create(),g=F.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");return function(m){function n(r,t,z){var w=m.call(this,r)||this;w._cimMarkerLayer=r;w._minMaxZoom=a.i1616to32(Math.round(t*b.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(z*b.MIN_MAX_ZOOM_PRECISION_FACTOR));c.isFunction(r.color)?w._dynamicPropertyMap.set("_fillColor",(B,A,x)=>k.premultiplyAlphaRGBA(r.color(B,A,x))):w._fillColor=k.premultiplyAlphaRGBA(r.color);c.isFunction(r.outlineColor)?
w._dynamicPropertyMap.set("_outlineColor",(B,A,x)=>k.premultiplyAlphaRGBA(r.outlineColor(B,A,x))):w._outlineColor=k.premultiplyAlphaRGBA(r.outlineColor);c.isFunction(r.size)?w._dynamicPropertyMap.set("_size",(B,A,x)=>y.pt2px(r.size(B,A,x))):w._size=y.pt2px(r.size)||0;c.isFunction(r.scaleX)?w._dynamicPropertyMap.set("_scaleX",r.scaleX):w._scaleX=r.scaleX||1;c.isFunction(r.offsetX)?w._dynamicPropertyMap.set("xOffset",(B,A,x)=>y.pt2px(r.offsetX(B,A,x))):w.xOffset=y.pt2px(r.offsetX)||0;c.isFunction(r.offsetY)?
w._dynamicPropertyMap.set("yOffset",(B,A,x)=>y.pt2px(r.offsetY(B,A,x))):w.yOffset=y.pt2px(r.offsetY)||0;c.isFunction(r.outlineWidth)?w._dynamicPropertyMap.set("_outlineWidth",(B,A,x)=>y.pt2px(r.outlineWidth(B,A,x))):w._outlineWidth=y.pt2px(r.outlineWidth)||0;c.isFunction(r.rotation)?w._dynamicPropertyMap.set("_angle",r.rotation):w._angle=r.rotation||0;w._scaleFactor=C.unwrapOr(r.scaleFactor,1);w._markerPlacement=r.markerPlacement;w._effects=r.effects;w._bitSet=(1===r.alignment?1:0)|(r.colorLocked?
1:0)<<1|(r.scaleSymbolsProportionally?1:0)<<3;w._materialKey=r.materialKey;return w}u._inheritsLoose(n,m);n.fromCIMMarker=function(r,t){const [z,w]=c.getMinMaxZoom(r.scaleInfo,t);return new n(r,z,w)};n.prototype.bindFeature=function(r,t,z){const w=r.readLegacyFeature();this._dynamicPropertyMap.forEach((S,Q)=>{this[Q]=S(w,t,z)});r=this._cimMarkerLayer.materialHash;r="function"===typeof r?r(w,t,z):r;if((r=this._materialCache.get(r))&&q.ok(r.spriteMosaicItem)&&r.spriteMosaicItem){r=r.spriteMosaicItem;
var B=this._cimMarkerLayer.sizeRatio,A=r.width/r.height*this._scaleX,x=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,E=this._size,D=E*A,K=this.xOffset,H=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var I=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/y.pt2px(this._cimMarkerLayer.frameHeight):1,J=this._outlineWidth*I,M=y.pt2px(this._cimMarkerLayer.referenceSize),O=I=0,L=this._cimMarkerLayer.anchorPoint;L&&
(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(I=-L.x/(this._size*A),O=L.y/this._size):(I=L.x,O=L.y));this._sizeOutlineWidth=a.i8888to32(Math.round(Math.min(Math.sqrt(128*D),255)),Math.round(Math.min(Math.sqrt(128*E),255)),Math.round(Math.min(Math.sqrt(128*J),255)),Math.round(Math.min(Math.sqrt(128*M),255)));this.angle=x;this._bitestAndDistRatio=a.i1616to32(this._bitSet,Math.round(64*B));A=r.rect.x+b.SPRITE_PADDING;x=r.rect.y+b.SPRITE_PADDING;J=A+r.width;M=x+r.height;this._texUpperLeft=
a.i1616to32(A,x);this._texUpperRight=a.i1616to32(J,x);this._texBottomLeft=a.i1616to32(A,M);this._texBottomRight=a.i1616to32(J,M);A=f.MarkerMaterialKey.load(this._materialKey);A.sdf=r.sdf;A.pattern=!0;A.textureBinding=r.textureBinding;this._materialKey=A.data;this._anchorX=.5-(.5+I)*r.width/r.width;this._anchorY=.5-(.5+O)*r.height/r.height;D=D*B*this._scaleFactor;E=E*B*this._scaleFactor;D*=r.rect.width/r.width;E*=r.rect.height/r.height;this._computedWidth=D;this._computedHeight=E;this._applyTransformation(d,
e);this.xOffset=K;this.yOffset=H}else g.error(new G("mapview-cim","Encountered an error when binding feature"))};return n}(h(l))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f){return function(c){function h(q,e,d){var g=c.call(this,q)||this;g._horizontalAlignment="center";g._verticalAlignment="middle";g._textToGlyphs=new Map;g._minMaxZoom=v.i1616to32(Math.round(e*y.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(d*y.MIN_MAX_ZOOM_PRECISION_FACTOR));e=q.scaleFactor||1;g._cimTextLayer=q;k.isFunction(q.color)?g._dynamicPropertyMap.set("_color",(t,z,w)=>C.premultiplyAlphaRGBA(q.color(t,z,w))):g._color=C.premultiplyAlphaRGBA(q.color);k.isFunction(q.color)?
g._dynamicPropertyMap.set("_haloColor",(t,z,w)=>C.premultiplyAlphaRGBA(q.outlineColor(t,z,w))):g._haloColor=C.premultiplyAlphaRGBA(q.outlineColor);let m;k.isFunction(q.size)||(m=Math.min(Math.round(G.pt2px(q.size*q.sizeRatio)),127));g._dynamicPropertyMap.set("_size",(t,z,w)=>k.isFunction(q.size)?Math.min(Math.round(G.pt2px(q.size(t,z,w)*q.sizeRatio)),127):m);k.isFunction(q.outlineSize)?g._dynamicPropertyMap.set("_haloSize",(t,z,w)=>Math.min(Math.floor(5*G.pt2px(q.outlineSize(t,z,w)*q.sizeRatio)),
127)):g._haloSize=Math.min(Math.floor(5*G.pt2px(q.outlineSize*q.sizeRatio)),127);let n;k.isFunction(q.offsetX)||(n=Math.round(G.pt2px(q.offsetX*q.sizeRatio)));g._dynamicPropertyMap.set("_xOffset",(t,z,w)=>k.isFunction(q.offsetX)?Math.round(G.pt2px(q.offsetX(t,z,w)*q.sizeRatio)):n);let r;k.isFunction(q.offsetY)||(r=Math.round(G.pt2px(q.offsetY*q.sizeRatio)));g._dynamicPropertyMap.set("_yOffset",(t,z,w)=>k.isFunction(q.offsetY)?Math.round(G.pt2px(q.offsetY(t,z,w)*q.sizeRatio)):r);k.isFunction(q.angle)?
g._dynamicPropertyMap.set("_angle",q.angle):g._angle=q.angle;k.isFunction(q.horizontalAlignment)?g._dynamicPropertyMap.set("_horizontalAlignment",q.horizontalAlignment):g._horizontalAlignment=q.horizontalAlignment;k.isFunction(q.verticalAlignment)?g._dynamicPropertyMap.set("_verticalAlignment",q.verticalAlignment):g._verticalAlignment=q.verticalAlignment;g._scaleFactor=e;k.isFunction(q.text)?g._dynamicPropertyMap.set("_text",q.text):g._text=q.text;e=Math.min(Math.round(G.pt2px(q.referenceSize*q.sizeRatio)),
127);g._referenceSize=Math.round(Math.sqrt(256*e));g._materialKey=q.materialKey;e=p.TextMaterialKey.load(g._materialKey);e.sdf=!0;g._bitset=(1===q.alignment?1:0)|(q.colorLocked?1:0)<<1;g._materialKey=e.data;g._decoration="none";g._lineHeight=1;g._lineWidth=512;g._textPlacement=q.markerPlacement;g._effects=q.effects;g._isCIM=!0;return g}u._inheritsLoose(h,c);h.fromCIMText=function(q,e){const [d,g]=k.getMinMaxZoom(q.scaleInfo,e);return new h(q,d,g)};var l=h.prototype;l.analyze=function(){var q=u._asyncToGenerator(function*(e,
d,g,m){var n=d.readLegacyFeature();var r=this._cimTextLayer;n="string"===typeof r.text?r.text:"function"===typeof r.text?r.text(n,g,m):"";(e=yield c.prototype.analyze.call(this,e,d,g,m,f.codepoints(n)))&&e.glyphMosaicItems&&this._textToGlyphs.set(n,e.glyphMosaicItems);return e});return function(e,d,g,m){return q.apply(this,arguments)}}();l.bindFeature=function(q,e,d){const g=q.readLegacyFeature();this._dynamicPropertyMap.forEach((m,n)=>{this[n]=m(g,e,d)});this._text&&0!==this._text.length?(this._size*=
this._scaleFactor,this._scale=this._size/y.GLYPH_SIZE,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=F.getXAnchorDirection(this._horizontalAlignment||"center"),this._yAlignD=F.getYAnchorDirection(this._verticalAlignment||"baseline"),q=this._textToGlyphs.get(this._text),this.bindTextInfo(q,!1)):this._shapingInfo=null};return h}(b(a))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(u){u.codepoints=function(G){const F=Array(G.length);
for(let C=0;C<G.length;C++)F[C]=G.charCodeAt(C);return F};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),function(u,G,F,C,y,v,p,k,b,a){return function(f){function c(h,l,q,e,d,g,m,
n,r,t,z,w,B,A,x,E){var D=f.call(this)||this;D._effects=A;h=p.FillMaterialKey.load(h);l&&(h.sdf=l.sdf,h.pattern=!0,h.textureBinding=l.textureBinding);D.fillColor=q;D.tl=e;D.br=d;D.aux2=v.i8888to32(g,m,n,r);D.aux3=v.i8888to32(t,z,w,0);D._bitset=B;D._minMaxZoom=v.i1616to32(Math.round(x*C.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(E*C.MIN_MAX_ZOOM_PRECISION_FACTOR));D._materialKey=h.data;return D}u._inheritsLoose(c,f);c.fromCIMFill=function(h,l,q){var e=h.color;e=e&&F.premultiplyAlphaRGBA(e)||0;const d=
h.materialKey,[g,m]=k.getMinMaxZoom(h.scaleInfo,q);if(!l)return new c(d,null,e,0,0,0,0,0,0,0,0,0,h.colorLocked?1:0,h.effects,g,m);const {rect:n,width:r,height:t}=l;var z=h.scaleX||1,w=n.x+C.SPRITE_PADDING;const B=n.y+C.SPRITE_PADDING;var A=w+r;const x=B+t;var E=h.height;q=Math.round(E);255<q?q=255:0>=q&&(q=x-B);z=Math.round(z*E);255<z?z=255:0>=z&&(z=A-w);E=G.pt2px(h.offsetX||0)+128;255<E&&(E=255);let D=G.pt2px(-h.offsetY||0)+128;255<D&&(D=255);w=v.i1616to32(w,B);A=v.i1616to32(A,x);return new c(d,
l,e,w,A,z,q,E,D,128,128,y.degToByte(h.angle),h.colorLocked?1:0,h.effects,g,m)};c.fromSimpleFill=function(h,l,q=!1){var {color:e}=h;e=e&&"esriSFSNull"!==h.style&&F.premultiplyAlphaRGBAArray(e)||0;q=q?C.BITSET_GENERIC_LOCK_COLOR:0;const d=h.materialKey;if(l){const {rect:n,width:r,height:t}=l;var g=n.x+C.SPRITE_PADDING;const z=n.y+C.SPRITE_PADDING;var m=g+r;const w=z+t;g=v.i1616to32(g,z);m=v.i1616to32(m,w);l=new c(d,l,e,g,m,r,t,0,0,128,128,0,q,null,k.DEFAULT_MIN_ZOOM,k.DEFAULT_MAX_ZOOM)}else l=new c(d,
null,e,0,0,0,0,0,0,0,0,0,q,null,k.DEFAULT_MIN_ZOOM,k.DEFAULT_MAX_ZOOM);l._maybeAddLineTemplate(h);return l};c.fromPictureFill=function(h,l,q=!1){const e=C.PICTURE_FILL_COLOR,{rect:d,width:g,height:m}=l;var n=d.x+C.SPRITE_PADDING,r=d.y+C.SPRITE_PADDING,t=n+g,z=r+m;n=v.i1616to32(n,r);t=v.i1616to32(t,z);z=Math.round(G.pt2px(h.width));255<z&&(z=255);r=Math.round(G.pt2px(h.height));255<r&&(r=255);let w=G.pt2px(h.xoffset)+128;255<w&&(w=255);let B=G.pt2px(-h.yoffset)+128;255<B&&(B=255);l=new c(h.materialKey,
l,e,n,t,z,r,w,B,128*h.xscale,128*h.yscale,0,q?C.BITSET_GENERIC_LOCK_COLOR:0,null,k.DEFAULT_MIN_ZOOM,k.DEFAULT_MAX_ZOOM);l._maybeAddLineTemplate(h);return l};return c}(b(a))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(u,G,F){function C(){C=G._asyncToGenerator(function*(v,p,k){try{yield v.acquire(),yield p(k),v.release()}catch(b){throw v.release(),b;}});return C.apply(this,arguments)}
let y=function(){function v(){this._resolver=null}var p=v.prototype;p.isHeld=function(){return!!this._resolver};p.acquire=function(){var k=G._asyncToGenerator(function*(){if(!this._resolver)return this._resolver=F.createResolver(),Promise.resolve();yield this._resolver.promise;yield this.acquire()});return function(){return k.apply(this,arguments)}}();p.release=function(){const k=this._resolver;this._resolver=null;k.resolve()};return v}();u.default=y;u.withLock=function(v,p,k){return C.apply(this,
arguments)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/support/cimSymbolUtils":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../symbols/cim/cimAnalyzer","../../../../symbols/cim/ExpandedCIM","./webStyleUtils"],function(u,G,F,C,y){const v=function(){var b=G._asyncToGenerator(function*(a,f,c,h){return Promise.all(a.map(l=>k(l,f,c,h)))});return function(a,f,c,h){return b.apply(this,arguments)}}(),p=function(){var b=G._asyncToGenerator(function*(a,
f,c){return new C.ExpandedCIM(yield F.analyzeCIMSymbol(a.data,f,c),a.data,a.rendererKey,a.maxVVSize)});return function(a,f,c){return b.apply(this,arguments)}}(),k=function(){var b=G._asyncToGenerator(function*(a,f,c,h){return a?"cim"===a.type?p(a,f,c):"web-style"===a.type?(a={type:"cim",data:yield y.fetchCIMSymbolReference(a,null,h),rendererKey:a.rendererKey,maxVVSize:a.maxVVSize},p(a,f,c)):a:null});return function(a,f,c,h){return b.apply(this,arguments)}}();u.cimLayerToRasterizationInfo=function(b){if(!b)return null;
const {type:a,cim:f,url:c,materialHash:h}=b,l={cim:f,type:a,mosaicHash:h,url:c,size:null,dashTemplate:null,path:null,text:null,fontName:null};switch(a){case "marker":l.size=b.size;l.path=b.path;break;case "line":l.dashTemplate=b.dashTemplate;break;case "text":l.text=b.text,l.fontName=b.fontName}return l};u.expandSymbol=k;u.expandSymbols=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums",
"../../views/2d/engine/webgl/materialKey/MaterialKey"],function(u,G,F,C){const y={marker:F.WGLGeometryType.MARKER,fill:F.WGLGeometryType.FILL,line:F.WGLGeometryType.LINE,text:F.WGLGeometryType.TEXT};F=function(){function v(p,k,b,a){const f={minScale:null==k?void 0:k.minScale,maxScale:null==k?void 0:k.maxScale};var c=f.minScale||f.maxScale?f.minScale+"-"+f.maxScale:"";this.layers=p;this.data=k;this.hash=this._createHash()+c;this.rendererKey=b;k={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},
vvFlags:b};for(const h of p)h.materialKey=C.createMaterialKey(y[h.type],k),h.maxVVSize=a,h.scaleInfo=f,h.templateHash+=c}v.prototype._createHash=function(){let p="";for(const k of this.layers)p+=k.templateHash;return p};G._createClass(v,[{key:"type",get:function(){return"expanded-cim"}}]);return v}();u.ExpandedCIM=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/support/webStyleUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/devEnvironmentUtils ../../../../core/Error ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../portal/Portal ../../../../chunks/persistableUrlUtils ../../../../symbols/support/styleUtils".split(" "),
function(u,G,F,C,y,v,p,k,b){function a(){a=G._asyncToGenerator(function*(q,e,d){if(!q.name)return Promise.reject(new C("style-symbol-reference-name-missing","Missing name in style symbol reference"));if(q.styleName&&"Esri2DPointSymbolsStyle"===q.styleName)return f(q,d);try{const g=yield b.fetchStyle(q,e,d);return h(g,q.name,e,d)}catch(g){return y.throwIfAborted(g),null}});return a.apply(this,arguments)}function f(q,e){return c.apply(this,arguments)}function c(){c=G._asyncToGenerator(function*(q,e){q=
b.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,q.name);try{const d=yield b.requestJSON(q,e);return b.makeCIMSymbolRef(d.data)}catch(d){return y.throwIfAborted(d),null}});return c.apply(this,arguments)}function h(q,e,d,g){return l.apply(this,arguments)}function l(){l=G._asyncToGenerator(function*(q,e,d,g){var m=q.data;q={portal:d&&d.portal||p.getDefault(),url:v.urlToObject(q.baseUrl),origin:"portal-item"};m=m.items.find(n=>n.name===e);if(!m)throw new C("symbolstyleutils:symbol-name-not-found",`The symbol name '${e}' could not be found`,
{symbolName:e});m=k.fromJSON(b.symbolUrlFromStyleItem(m,"cimRef"),q);F.isDevEnvironment()&&(m=F.adjustStaticAGOUrl(m));try{const n=yield b.requestJSON(m,g);return b.makeCIMSymbolRef(n.data)}catch(n){return y.throwIfAborted(n),null}});return l.apply(this,arguments)}u.fetchCIMSymbolReference=function(q,e,d){return a.apply(this,arguments)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(u){const G=/^devext.arcgis.com$/,F=/^qaext.arcgis.com$/,
C=/^[\w-]*\.mapsdevext.arcgis.com$/,y=/^[\w-]*\.mapsqa.arcgis.com$/,v=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,G,F,/^jsapps.esri.com$/,C,y];u.adjustStaticAGOUrl=function(p,k){return p?(k=k||globalThis.location.hostname)?null!=k.match(G)||null!=k.match(C)?p.replace("static.arcgis.com","staticdev.arcgis.com"):null!=k.match(F)||null!=k.match(y)?p.replace("static.arcgis.com","staticqa.arcgis.com"):p:p:p};u.isDevEnvironment=function(p){p=p||globalThis.location.hostname;return v.some(k=>{var b;return null!=
(null==(b=p)?void 0:b.match(k))})};u.isTelemetryDevEnvironment=function(p){p=p||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(v).some(k=>{var b;return null!=(null==(b=p)?void 0:b.match(k))})};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../support/arcadeOnDemand ../../../../../symbols/cim/utils ../../../arcade/callExpressionWithFeature ../../../layers/support/cimSymbolUtils".split(" "),
function(u,G,F,C,y,v,p,k,b,a){function f(w,B,A,x){return c.apply(this,arguments)}function c(){c=F._asyncToGenerator(function*(w,B,A,x){switch(w.type){case "simple":return g.fromBasicRenderer(w,B,A,x);case "map":return r.fromUVRenderer(w,B,A,x);case "interval":return n.fromCBRenderer(w,B,A,x);case "dictionary":return z.fromDictionaryRenderer(w,B,A,x);case "subtype":return m.fromSubtypes(w,B,A,x)}});return c.apply(this,arguments)}function h(w,B){return l.apply(this,arguments)}function l(){l=F._asyncToGenerator(function*(w,
B){const A=w||1;if("number"===typeof A)return(E,D,K)=>A;const x=yield p.createRendererExpression(A,B.spatialReference,B.fields);return(E,D,K)=>b(x,E,{$view:K},B.geometryType,D)||1});return l.apply(this,arguments)}function q(){return e.apply(this,arguments)}function e(){e=F._asyncToGenerator(function*(){t||(t=new Promise((w,B)=>u(["../../../layers/features/schemaUtils"],w,B)));return t});return e.apply(this,arguments)}const d=y.getLogger("esri/views/2d/engine/webgl/util/Matcher");let g=function(){function w(){this.type=
"feature";this._defaultResult=null}w.fromBasicRenderer=function(){var A=F._asyncToGenerator(function*(x,E,D,K){const H=new w;x.symbol&&(x=yield a.expandSymbol(x.symbol,D,K),E=E.createTemplateGroup(x,null),H.setDefault(E));return H});return function(x,E,D,K){return A.apply(this,arguments)}}();var B=w.prototype;B.size=function(){return 1};B.getDefault=function(){return this._defaultResult};B.setDefault=function(A){this._defaultResult=A};B.match=function(A,x,E,D,K){return this.getDefault()};B.analyze=
function(){var A=F._asyncToGenerator(function*(x,E,D,K,H,I){return null});return function(x,E,D,K,H,I){return A.apply(this,arguments)}}();return w}(),m=function(w){function B(A,x){var E=w.call(this)||this;E._subMatchers=A;E._subtypeField=x;return E}F._inheritsLoose(B,w);B.fromSubtypes=function(){var A=F._asyncToGenerator(function*(x,E,D,K){const H=new Map,I=[];for(const J in x.renderers){const M=parseInt(J,10),O=f(x.renderers[J],E,D,K).then(L=>H.set(M,L));I.push(O)}yield Promise.all(I);return new B(H,
x.subtypeField)});return function(x,E,D,K){return A.apply(this,arguments)}}();B.prototype.match=function(A,x,E,D,K){var H=x.readAttribute(this._subtypeField);return(H=this._subMatchers.get(H))?H.match(A,x,E,D,K):null};return B}(g),n=function(w){function B(x,E,D,K){var H=w.call(this)||this;H.type="interval";H._intervals=[];H._isMaxInclusive=E;H._fieldIndex=K;H._field=x;H._normalizationInfo=D;return H}F._inheritsLoose(B,w);B.fromCBRenderer=function(){var x=F._asyncToGenerator(function*(E,D,K,H){const {isMaxInclusive:I,
normalizationField:J,normalizationTotal:M,normalizationType:O}=E,L=new B(E.field,I,{normalizationField:J,normalizationTotal:M,normalizationType:O},E.fieldIndex),S=yield a.expandSymbol(E.backgroundFillSymbol,K,H);yield Promise.all(E.intervals.map(function(){var Q=F._asyncToGenerator(function*(P){var R=yield a.expandSymbol(P.symbol,K,H);R=yield D.createTemplateGroup(R,S);L.add({min:P.min,max:P.max},R)});return function(P){return Q.apply(this,arguments)}}()));if(E=yield a.expandSymbol(E.defaultSymbol,
K,H))E=yield D.createTemplateGroup(E,S),L.setDefault(E);return L});return function(E,D,K,H){return x.apply(this,arguments)}}();var A=B.prototype;A.add=function(x,E){this._intervals.push({interval:x,result:E});this._intervals.sort((D,K)=>D.interval.min-K.interval.min)};A.size=function(){return w.prototype.size.call(this)+this._intervals.length};A.match=function(x,E,D,K,H){if(null==this._fieldIndex&&!this._field)return this.getDefault();x=null!=this._fieldIndex?E.getComputedNumericAtIndex(this._fieldIndex):
this._getValueFromField(E);if(!x&&(null===x||void 0===x||isNaN(x)))return this.getDefault();for(E=0;E<this._intervals.length;E++){const {interval:I,result:J}=this._intervals[E];D=this._isMaxInclusive?x<=I.max:x<I.max;if(x>=I.min&&D)return J}return this.getDefault()};A._needsNormalization=function(){const x=this._normalizationInfo;return x&&(x.normalizationField||x.normalizationTotal||x.normalizationType)};A._getValueFromField=function(x){const E=x.readAttribute(this._field);if(!this._needsNormalization()||
null==E)return E;const {normalizationField:D,normalizationTotal:K,normalizationType:H}=this._normalizationInfo;x=!!D&&x.readAttribute(D);if(H)switch(H){case "esriNormalizeByField":return(x||void 0)&&E/x;case "esriNormalizeByLog":return Math.log(E)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return E/K*100;default:d.error(`Found unknown normalization type: ${H}`)}else d.error("Normalization is required, but no type was set!")};return B}(g),r=function(w){function B(x,E,D){var K=w.call(this)||this;
K.type="map";K._nullResult=null;K._resultsMap=new Map;K._fieldsIndex=D;K._fields=x;K._seperator=E||"";return K}F._inheritsLoose(B,w);B.fromUVRenderer=function(){var x=F._asyncToGenerator(function*(E,D,K,H){const I=E.fieldDelimiter,J=[E.field];E.field2&&J.push(E.field2);E.field3&&J.push(E.field3);const M=yield a.expandSymbol(E.backgroundFillSymbol,K,H),O=new B(J,I,E.fieldIndex);yield Promise.all(E.map.map(function(){var L=F._asyncToGenerator(function*(S){var Q=yield a.expandSymbol(S.symbol,K,H);Q=
yield D.createTemplateGroup(Q,M);"\x3cNull\x3e"===S.value?O.setNullResult(Q):O.add(S.value,Q)});return function(S){return L.apply(this,arguments)}}()));if(E=yield a.expandSymbol(E.defaultSymbol,K,H))E=yield D.createTemplateGroup(E,M),O.setDefault(E);return O});return function(E,D,K,H){return x.apply(this,arguments)}}();var A=B.prototype;A.setNullResult=function(x){this._nullResult=x};A.add=function(x,E){this._resultsMap.set(x.toString(),E)};A.size=function(){return w.prototype.size.call(this)+this._resultsMap.size};
A.match=function(x,E,D,K,H){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();x=null!=this._fieldsIndex?E.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(E);if(null!==this._nullResult&&(null==x||""===x||"\x3cNull\x3e"===x))return this._nullResult;if(!x&&null==x)return this.getDefault();x=x.toString();return this._resultsMap.has(x)?this._resultsMap.get(x):this.getDefault()};A._getValueFromFields=function(x){const E=[];for(const D of this._fields){const K=x.readAttribute(D);
null==K||""===K?E.push("\x3cNull\x3e"):E.push(K)}return E.join(this._seperator)};return B}(g),t,z=function(w){function B(x,E,D,K,H){var I=w.call(this)||this;I.type="dictionary";I._groupIdCache=new v(100);I._renderer=x;I._fieldMap=x.fieldMap;I._symbolFields=x.getSymbolFields();I._templates=E;I._info=D;I._scaleFn=K;I._schemaUtilsModule=H;return I}F._inheritsLoose(B,w);B.fromDictionaryRenderer=function(){var x=F._asyncToGenerator(function*(E,D,K,H){const [{default:I},J]=yield Promise.all([new Promise((M,
O)=>u(["../../../../../renderers/DictionaryRenderer"],L=>M(Object.freeze({__proto__:null,default:L})),O)),q()]);E=I.fromJSON(E.renderer);yield E.fetchResources({spatialReference:K.spatialReference,fields:K.fields});H=yield h(E.scaleExpression,K);return new B(E,D,K,H,J)});return function(E,D,K,H){return x.apply(this,arguments)}}();var A=B.prototype;A._analyzeFeature=function(){var x=F._asyncToGenerator(function*(E,D,K,H,I){E=E.readLegacyFeature();const J=this._scaleFn(E,K,H);K=this._attributeHash(E)+
"-"+J;const M=this._groupIdCache.get(K);if(M)return M;H=yield this._renderer.getSymbolAsync(E,{...H,spatialReference:this._info.spatialReference,abortOptions:I,fields:this._info.fields});H=this._schemaUtilsModule.createSymbolSchema(H,this._renderer);D=a.expandSymbol(H,this._info,D,I).then(O=>{if("expanded-cim"!==O.type)return d.error(new C("mapview-bad-type",`Found unexpected type ${O.type} in dictionary response`)),null;O.hash+="-"+J;for(const L of O.layers)L.scaleFactor=J,L.templateHash+="-"+J,
"text"===L.type&&"string"===typeof L.text&&-1<L.text.indexOf("[")&&(L.text=k.createLabelOverrideFunction(this._fieldMap,L.text,L.cim.textCase));return this._templates.createTemplateGroup(O,null)});this._groupIdCache.put(K,D,1);return D});return function(E,D,K,H,I){return x.apply(this,arguments)}}();A.analyze=function(){var x=F._asyncToGenerator(function*(E,D,K,H,I,J){E=D.getCursor();for(D=[];E.next();)D.push(this._analyzeFeature(E,K,H,I,J));return Promise.all(D)});return function(E,D,K,H,I,J){return x.apply(this,
arguments)}}();A.match=function(x,E,D,K,H){return null};A._attributeHash=function(x){let E="";for(const D of this._symbolFields){const K=this._fieldMap[D];K&&(E+=x.attributes[K]+"-")}return E};return B}(g);G.DictionaryMatcher=z;G.FeatureMatcher=g;G.IntervalMatcher=n;G.MapMatcher=r;G.SubtypeMatcher=m;G.createMatcher=f;Object.defineProperty(G,"__esModule",{value:!0})})},"esri/views/2d/layers/features/schemaUtils":function(){define("exports ../../../../renderers/ClassBreaksRenderer ../../../../renderers/DictionaryRenderer ../../../../renderers/DotDensityRenderer ../../../../renderers/HeatmapRenderer ../../../../renderers/Renderer ../../../../renderers/SimpleRenderer ../../../../renderers/UniqueValueRenderer ../../../../renderers/support/jsonUtils ../../../../core/Error ../../../../core/has ../../../../core/lang ../../../../core/Logger ../../../../core/maybe ../../../../core/screenUtils ../../../../symbols/support/jsonUtils ../../engine/webgl/enums ../../engine/webgl/Utils ../../engine/webgl/materialKey/MaterialKey ../../engine/webgl/util/vvFlagUtils ./support/pixelBuffering ./support/rendererUtils ../support/clusterUtils ../support/util".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e,d,g,m,n,r,t,z,w){function B(Y){switch(Y.type){case "line-marker":var aa;return{type:"line-marker",color:null==(aa=Y.color)?void 0:aa.toJSON(),placement:Y.placement,style:Y.style};default:return e.fromJSON(Y.toJSON()).toJSON()}}function A(Y){let aa=0,ba=0,da=!1,ha=!0,ka=!0;if(l.isSome(Y)&&(ba=r.getPtMaxVVSize(Y),"visualVariables"in Y&&(aa=n.getVVFlags(Y.visualVariables||[]),da="dot-density"===Y.type),!da)){var la=Y.getSymbols();"backgroundFillSymbol"in Y&&Y.backgroundFillSymbol&&
la.push(Y.backgroundFillSymbol);for(const ma of la)if("cim"===ma.type&&(ha=!1),"simple-fill"===ma.type||"picture-fill"===ma.type)if((Y=ma.outline)&&"none"!==Y.style&&"solid"!==Y.style&&(ka=!1),Y=Y&&"none"!==Y.style&&"solid"!==Y.style,la="simple-fill"===ma.type&&"none"!==ma.style&&"solid"!==ma.style,"picture-fill"===ma.type||la||Y)ha=!1}da&&(ka=!1);return{vvFlags:aa,maxVVSize:ba,supportsOutlineFills:ka,stride:{fill:da?"dot-density":ha?"simple":"default"}}}function x(Y,aa,ba){return E(Y,A(aa),ba)}function E(Y,
aa,ba){if(!Y)return null;switch(Y.type){case "simple-fill":case "picture-fill":return D(Y,aa,ba);case "simple-marker":case "picture-marker":var da=m.createMaterialKey(d.WGLGeometryType.MARKER,aa);ba=ba?m.hydrateMaterialKey(da):da;da=B(Y);return Y={materialKey:ba,hash:Y.hash(),...da,angle:Y.angle,maxVVSize:aa.maxVVSize};case "simple-line":return K(Y,aa,ba);case "text":return da=m.createMaterialKey(d.WGLGeometryType.TEXT,aa),ba=ba?m.hydrateMaterialKey(da):da,da=B(Y),Y={materialKey:ba,hash:Y.hash(),
...da,angle:Y.angle,maxVVSize:aa.maxVVSize};case "label":return da=Y.toJSON(),aa=m.createMaterialKey(d.WGLGeometryType.LABEL,{...aa,placement:da.labelPlacement}),Y={materialKey:ba?m.hydrateMaterialKey(aa):aa,hash:Y.hash(),...da,labelPlacement:da.labelPlacement};case "cim":return{type:"cim",rendererKey:aa.vvFlags,data:Y.data,maxVVSize:aa.maxVVSize};case "CIMSymbolReference":return{type:"cim",rendererKey:aa.vvFlags,data:Y,maxVVSize:aa.maxVVSize};case "web-style":return{...B(Y),type:"web-style",hash:Y.hash(),
rendererKey:aa.vvFlags,maxVVSize:aa.maxVVSize};default:throw Error(`symbol not supported ${Y.type}`);}}function D(Y,aa,ba){var da=m.createMaterialKey(d.WGLGeometryType.FILL,{...aa,isOutlinedFill:aa.supportsOutlineFills});da=ba?m.hydrateMaterialKey(da):da;var ha=Y.clone();Y=ha.outline;aa.supportsOutlineFills||(ha.outline=null);ha={materialKey:da,hash:ha.hash(),isOutlinedFill:!!aa.supportsOutlineFills,...B(ha)};if(aa.supportsOutlineFills)return ha;da=[];da.push(ha);Y&&(aa=m.createMaterialKey(d.WGLGeometryType.LINE,
{...aa,isOutline:!0}),ba={materialKey:ba?m.hydrateMaterialKey(aa):aa,hash:Y.hash(),...B(Y)},da.push(ba));return{type:"composite-symbol",layers:da,hash:da.reduce((ka,la)=>la.hash+ka,"")}}function K(Y,aa,ba){var da=m.createMaterialKey(d.WGLGeometryType.LINE,aa);const ha=ba?m.hydrateMaterialKey(da):da;Y=Y.clone();da=Y.marker;Y.marker=null;const ka=[];ka.push({materialKey:ha,hash:Y.hash(),...B(Y)});if(da){var la;aa=m.createMaterialKey(d.WGLGeometryType.MARKER,aa);ba=ba?m.hydrateMaterialKey(aa):aa;da.color=
null!=(la=da.color)?la:Y.color;ka.push({materialKey:ba,hash:da.hash(),lineWidth:Y.width,...B(da)})}return{type:"composite-symbol",layers:ka,hash:ka.reduce((ma,na)=>na.hash+ma,"")}}function H(Y,aa){const ba=Y.labelPlacement;var da=ja[aa];if(!Y.symbol)return ia.warn("No ILabelClass symbol specified."),!0;if(!da)return ia.error(new a("mapview-labeling:unsupported-geometry-type",`Unable to create labels for Feature Layer, ${aa} is not supported`)),!0;da.some(ha=>ha===ba)||(da=da[0],ba&&ia.warn(`Found invalid label placement type ${ba} for ${aa}. Defaulting to ${da}`),
Y.labelPlacement=da);return!1}function I(Y,aa){Y=c.clone(Y);return Y.some(ba=>H(ba,aa))?[]:Y}function J(Y,aa=!1){try{var ba,da;const ha=P(Y,aa),ka={};ha.map(la=>{a:{switch(la.target){case "feature":L(ka,O(Y),la);la=void 0;break a;case "aggregate":if(!("featureReduction"in Y)){la=void 0;break a}var ma=Y.featureReduction;if("selection"===ma.type)throw new a("ValidationError","Mapview does not support `selection` reduction type",ma);L(ka,O(Y),la);ka.aggregate||(ka.aggregate={name:"aggregate",input:"feature",
filters:null,attributes:{},params:{clusterRadius:q.pt2px(ma.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(q.pt2px(ma.clusterMaxSize)/64),fields:la.aggregateFields}});M(ka.aggregate,la.attributes.fields);la=void 0;break a}la=void 0}return la});return{source:{definitionExpression:Y.definitionExpression,fields:Y.fields.map(la=>la.toJSON()),gdbVersion:Y.gdbVersion,historicMoment:null==(ba=Y.historicMoment)?void 0:ba.getTime(),outFields:Y.availableFields,pixelBuffer:Y.pixelBuffer,spatialReference:Y.spatialReference.toJSON(),
timeExtent:null==(da=Y.timeExtent)?void 0:da.toJSON(),customParameters:Y.customParameters},attributes:{fields:{},indexCount:0},processors:ha,targets:ka}}catch(ha){if("ValidationError"===ha.fieldName)return ia.error(ha),null;throw ha;}}function M(Y,aa){for(const ba in aa){const da=aa[ba];if(da.target!==Y.name)continue;const ha=Y.attributes[ba];ha?(ha.context.mesh=ha.context.mesh||da.context.mesh,ha.context.storage=ha.context.storage||da.context.storage):Y.attributes[ba]=da}return Y}function O(Y){var aa,
ba,da,ha,ka;return[null!=(aa=null==(ba=l.unwrap(Y.filter))?void 0:ba.toJSON())?aa:null,null!=(da=null==(ha=l.unwrap(null==(ka=l.unwrap(Y.featureEffect))?void 0:ka.filter))?void 0:ha.toJSON())?da:null]}function L(Y,aa,ba){Y.feature||(Y.feature={name:"feature",input:"source",filters:aa,attributes:{}});M(Y.feature,ba.attributes.fields);return Y}function S(Y,aa){return aa.field?Q(Y,{...aa,type:"field",field:aa.field}):aa.valueExpression?Q(Y,{...aa,type:"expression",valueExpression:aa.valueExpression}):
{field:null,fieldIndex:null}}function Q(Y,aa){switch(aa.type){case "expression":var ba=aa.valueExpression;if(!Y.fields[ba]){var da=Y.indexCount++;Y.fields[ba]={...aa,name:ba,fieldIndex:da}}return{fieldIndex:Y.fields[ba].fieldIndex};case "label-expression":return ba=JSON.stringify(aa.label),Y.fields[ba]||(da=Y.indexCount++,Y.fields[ba]={...aa,name:ba,fieldIndex:da}),{fieldIndex:Y.fields[ba].fieldIndex};case "field":ba=aa.field;if("aggregate"===aa.target&&Y.fields[ba])return{field:ba};Y.fields[ba]=
{...aa,name:ba};return{field:ba};case "statistic":return Y.fields[aa.name]={...aa},{field:aa.name}}}function P(Y,aa=!1){const ba=[];let da=0;ba.push(N(Y,da++,aa));return ba}function R(Y,aa,ba,da,ha,ka=!1){aa=Q(aa,{type:"label-expression",target:da,context:{mesh:!0},resultType:"string",label:{labelExpression:ba.labelExpression,labelExpressionInfo:ba.labelExpressionInfo?{expression:ba.labelExpressionInfo.expression}:null,symbol:!!ba.symbol,where:ba.where}});({fieldIndex:aa}=aa);return{...x(ba,Y,ka),
fieldIndex:aa,target:da,index:ha}}function N(Y,aa,ba=!1){const da={indexCount:0,fields:{}};var ha="featureReduction"in Y&&Y.featureReduction;aa=ha?"aggregate":"feature";if("sublayers"in Y){var ka={type:"subtype",subtypeField:Y.subtypeField,renderers:{},stride:{fill:"default"}},la={type:"subtype",mapping:{},target:"feature"},ma={type:"subtype",classes:{}},na={type:"symbol",target:"feature",aggregateFields:[],attributes:da,storage:la,mesh:{matcher:ka,aggregateMatcher:null,labels:ma,sortKey:null}};ha=
new Set;let ta=0;for(const {renderer:qa,subtypeCode:pa,labelingInfo:ra,labelsVisible:ua}of Y.sublayers){Y=Z(da,aa,qa,ba);var oa=T(da,aa,qa),sa=ua&&ra;if("visualVariables"in qa&&qa.visualVariables&&qa.visualVariables.length)throw new a("ValidationError","Visual variables are currently not supported for subtype layers");if("dictionary"===Y.type)throw new a("ValidationError","Dictionary renderer is not supported in subtype layers");if("subtype"===Y.type)throw new a("ValidationError","Nested subtype renderers is not supported");
if(l.isSome(oa)&&"subtype"===oa.type)throw new a("ValidationError","Nested subtype storage is not supported");if(l.isSome(oa)&&"dot-density"===oa.type)throw new a("ValidationError","Dot density attributes are not supported in subtype layers");if(ha.has(pa))throw new a("ValidationError","Subtype codes for sublayers must be unique");ha.add(pa);ka.renderers[pa]=Y;la.mapping[pa]=oa;sa&&(ma.classes[pa]=sa.map(va=>R(qa,da,va,"feature",ta++,ba)))}return na}switch(Y.renderer.type){case "heatmap":{const {blurRadius:ta,
fieldOffset:qa,field:pa}=Y.renderer;return{type:"heatmap",aggregateFields:[],attributes:da,target:aa,storage:null,mesh:{blurRadius:ta,fieldOffset:qa,field:S(da,{target:aa,field:pa,resultType:"numeric"}).field}}}default:{ka=[];const ta="aggregate"===aa?z.createClusterRenderer(ka,Y.renderer,ha,null):Y.renderer;X(da,ka);la=Z(da,aa,ta,ba);na=null;ma=T(da,aa,ta);oa=w.toJSONGeometryType(Y.geometryType);sa=Y.labelsVisible&&Y.labelingInfo||[];let qa=[];if(ha){if("selection"===ha.type)throw new a("ValidationError",
"Mapview does not support `selection` reduction type",ha);ha.symbol&&(na=new p({symbol:ha.symbol,visualVariables:"visualVariables"in ta?ta.visualVariables:null}),na=Z(da,aa,na,ba));qa=ha&&ha.labelsVisible&&ha.labelingInfo||[]}sa=I(sa,oa);qa=I(qa,oa);let pa=0;ha=[...sa.map(ra=>R(ta,da,ra,"feature",pa++,ba)),...qa.map(ra=>R(ta,da,ra,"aggregate",pa++,ba))];Y=W(da,Y.orderBy);return{type:"symbol",target:aa,attributes:da,aggregateFields:ka,storage:ma,mesh:{matcher:la,labels:{type:"simple",classes:ha},aggregateMatcher:na,
sortKey:Y}}}}}function W(Y,aa){if(l.isNone(aa)||!aa.length)return null;1<aa.length&&ia.warn(`Layer rendering currently only supports ordering by 1 orderByInfo, but found ${aa.length}. All but the first will be discarded`);aa=aa[0];const ba="ascending"===aa.order?"asc":"desc";if(aa.field)return{field:aa.field,order:ba};if(aa.valueExpression)return{fieldIndex:Q(Y,{type:"expression",target:"feature",valueExpression:aa.valueExpression,resultType:"numeric"}).fieldIndex,order:ba};ia.error(new a("ValidationError",
"Expected to find a field or valueExpression for OrderByInfo",aa));return null}function X(Y,aa){const ba={mesh:!0,storage:!0};for(const da of aa){const {name:ha,outStatistic:ka}=da,{statisticType:la,onStatisticField:ma}=ka;let na=aa=null,oa=null;"onStatisticValueExpression"in ka?na=Q(Y,{type:"expression",target:"feature",valueExpression:ka.onStatisticValueExpression,resultType:"numeric"}).fieldIndex:"onStatisticNormalizationField"in ka?(aa=Q(Y,{type:"field",target:"feature",field:ma,resultType:"numeric"}).field,
oa=ka.onStatisticNormalizationField):aa=Q(Y,{type:"field",target:"feature",field:ma,resultType:"numeric"}).field;Q(Y,{type:"statistic",target:"aggregate",name:ha,context:ba,inField:aa,inNormalizationField:oa,inFieldIndex:na,statisticType:la})}}function T(Y,aa,ba){switch(ba.type){case "dot-density":return U(Y,aa,ba.attributes);case "simple":case "class-breaks":case "unique-value":case "dictionary":return V(Y,aa,ba.visualVariables);case "heatmap":return null}}function U(Y,aa,ba){return ba&&ba.length?
{type:"dot-density",mapping:ba.map((da,ha)=>{const {field:ka,fieldIndex:la}=S(Y,{valueExpression:da.valueExpression,field:da.field,resultType:"numeric",target:aa});return{binding:ha,field:ka,fieldIndex:la}}),target:aa}:{type:"dot-density",mapping:[],target:aa}}function V(Y,aa,ba){if(!ba||!ba.length)return{type:"visual-variable",mapping:[],target:aa};const da={storage:!0};return{type:"visual-variable",mapping:t.simplifyVisualVariables(ba).map(ha=>{var ka;const la=g.getVVType(ha.type),{field:ma,fieldIndex:na}=
S(Y,{target:aa,valueExpression:ha.valueExpression,field:ha.field,context:da,resultType:"numeric"});switch(ha.type){case "size":return"$view.scale"===ha.valueExpression?null:{type:"size",binding:la,field:ma,fieldIndex:na,normalizationField:S(Y,{target:aa,field:ha.normalizationField,context:da,resultType:"numeric"}).field,valueRepresentation:null!=(ka=ha.valueRepresentation)?ka:null};case "color":return{type:"color",binding:la,field:ma,fieldIndex:na,normalizationField:S(Y,{target:aa,field:ha.normalizationField,
context:da,resultType:"numeric"}).field};case "opacity":return{type:"opacity",binding:la,field:ma,fieldIndex:na,normalizationField:S(Y,{target:aa,field:ha.normalizationField,context:da,resultType:"numeric"}).field};case "rotation":return{type:"rotation",binding:la,field:ma,fieldIndex:na}}}).filter(ha=>ha),target:aa}}function Z(Y,aa,ba,da=!1){Y=l.unwrapOr(Y,{indexCount:0,fields:{}});switch(ba.type){case "simple":case "dot-density":return ca(Y,ba,da);case "class-breaks":return ea(Y,aa,ba,da);case "unique-value":return fa(Y,
aa,ba,da);case "dictionary":return{type:"dictionary",renderer:ba.toJSON(),stride:{fill:"default"}}}}function ca(Y,aa,ba=!1){Y=aa.getSymbols();Y=Y.length?Y[0]:null;const {stride:da}=A(aa);return{type:"simple",symbol:x(Y,aa,ba),stride:da}}function ea(Y,aa,ba,da=!1){const ha=ba.backgroundFillSymbol,{field:ka,fieldIndex:la}=S(Y,{target:aa,field:ba.field,valueExpression:ba.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}});aa=ba.normalizationType;aa="log"===aa?"esriNormalizeByLog":
"percent-of-total"===aa?"esriNormalizeByPercentOfTotal":"field"===aa?"esriNormalizeByField":null;const ma=A(ba),na=ba.classBreakInfos.map(oa=>({symbol:E(oa.symbol,ma,da),min:oa.minValue,max:oa.maxValue})).sort((oa,sa)=>oa.min-sa.min);return{type:"interval",attributes:Y.fields,field:ka,fieldIndex:la,backgroundFillSymbol:E(ha,ma,da),defaultSymbol:E(ba.defaultSymbol,ma,da),intervals:na,normalizationField:ba.normalizationField,normalizationTotal:ba.normalizationTotal,normalizationType:aa,isMaxInclusive:ba.isMaxInclusive,
stride:ma.stride}}function fa(Y,aa,ba,da=!1){const ha=[],ka=ba.backgroundFillSymbol;aa={target:aa,context:{mesh:!0},resultType:"string"};if(ba.field&&"string"!==typeof ba.field)throw new a("ValidationError","Expected renderer.field to be a string",ba);const {field:la,fieldIndex:ma}=S(Y,{...aa,field:ba.field,valueExpression:ba.valueExpression}),na=A(ba);for(const oa of ba.uniqueValueInfos)ha.push({value:""+oa.value,symbol:E(oa.symbol,na,da)});return{type:"map",attributes:Y.fields,field:la,fieldIndex:ma,
field2:S(Y,{...aa,field:ba.field2}).field,field3:S(Y,{...aa,field:ba.field3}).field,fieldDelimiter:ba.fieldDelimiter,backgroundFillSymbol:E(ka,na),defaultSymbol:E(ba.defaultSymbol,na),map:ha,stride:na.stride}}const ia=h.getLogger("esri.views.2d.layers.features.schemaUtils"),ja={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],
esriGeometryMultipoint:null};u.addAggregateFields=X;u.createMatcherSchema=Z;u.createSchema=function(Y){f("esri-2d-update-debug")&&console.debug("Created new schema",J(Y,!0));return J(Y)};u.createSymbolSchema=x;u.createSymbolSchemaOptions=A;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["exports","../enums","../visualVariablesUtils"],function(u,G,F){u.getVVFlags=function(C){if(!C)return G.WGLVVFlag.NONE;let y=0;for(const v of C)"size"===
v.type?(C=F.getTypeOfSizeVisualVariable(v),y|=C,"outline"===v.target&&(y|=C<<4)):"color"===v.type?y|=G.WGLVVFlag.COLOR:"opacity"===v.type?y|=G.WGLVVFlag.OPACITY:"rotation"===v.type&&(y|=G.WGLVVFlag.ROTATION);return y};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports","../../../../core/Error","../../../../core/Logger","./enums","./Utils"],function(u,G,F,C,y){const v=F.getLogger("esri.views.2d.engine.webgl");u.getTypeOfSizeVisualVariable=
function(p){if(y.isNumber(p.minDataValue)&&y.isNumber(p.maxDataValue)&&null!=p.minSize&&null!=p.maxSize)return C.WGLVVFlag.SIZE_MINMAX_VALUE;if((p.expression&&"view.scale"===p.expression||p.valueExpression&&"$view.scale"===p.valueExpression)&&Array.isArray(p.stops))return C.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=p.field||p.expression&&"view.scale"!==p.expression||p.valueExpression&&"$view.scale"!==p.valueExpression)&&(Array.isArray(p.stops)||"levels"in p&&p.levels))return C.WGLVVFlag.SIZE_FIELD_STOPS;
if((null!=p.field||p.expression&&"view.scale"!==p.expression||p.valueExpression&&"$view.scale"!==p.valueExpression)&&null!=p.valueUnit)return C.WGLVVFlag.SIZE_UNIT_VALUE;v.error(new G("mapview-bad-type","Found invalid size VisualVariable",p));return C.WGLVVFlag.NONE};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/pixelBuffering":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/screenUtils ../../../../../symbols/cim/CIMSymbolHelper ../../../../../symbols/cim/Rect ../../../engine/webgl/definitions ../../graphics/graphicsUtils ../../support/cimSymbolUtils".split(" "),
function(u,G,F,C,y,v,p,k){function b(r){if(!("visualVariables"in r&&r.hasVisualVariables("size")))return 0;r=r.getVisualVariablesForType("size");if(!r[0])return 0;r=r[0];if("outline"===r.target)return 0;if("stops"===r.transformationType)return r.stops.map(t=>t.size).reduce(d,0);if("clamped-linear"===r.transformationType){let t=-Infinity,z=-Infinity;t="number"===typeof r.maxSize?r.maxSize:r.maxSize.stops.map(w=>w.size).reduce(d,0);z="number"===typeof r.minSize?r.minSize:r.minSize.stops.map(w=>w.size).reduce(d,
0);return Math.max(t,z)}if("real-world-size"===r.transformationType)return 30}function a(){a=G._asyncToGenerator(function*(r,t,z,w,B,A){if(!r||A&&"cluster"===A.type)return 0;if("heatmap"===r.type)return Math.round(3*r.blurRadius);if("dot-density"===r.type)return 0;if("dictionary"===r.type)return"esriGeometryPoint"===t||"esriGeometryMultipoint"===t?100:200;A=r.getSymbols();r=b(r);const x=[];for(const E of A)x.push(l(E,r,z,t,w,B));t=yield Promise.all(x);return F.pt2px(t.reduce(d,0))});return a.apply(this,
arguments)}function f(r,t){return null==r?t:r}function c(r,t,z,w,B,A){return h.apply(this,arguments)}function h(){h=G._asyncToGenerator(function*(r,t,z,w,B,A){if("simple-marker"===r.type)return t=Math.max(f(r.size,12),t),e(r)+.707*t;if("picture-marker"===r.type)return z=Math.max(f(r.height,12),t),t=f(r.width,12)*(z/f(r.height,12))/2,z/=2,e(r)+Math.sqrt(t*t+z*z);if("text"===r.type){if(z=r.text&&r.text.length){t=[];for(w=0;w<z;w++)t.push({...n,code:r.text.charCodeAt(w)});t={glyphMosaicItems:t}}else t=
{glyphMosaicItems:[n]};p.getTextSymbolSize(m,r.toJSON(),t);return Math.max(Math.abs(m[0]),Math.abs(m[1]))+Math.max(m[2],m[3])}return"simple-line"===r.type?(z=Math.max(f(r.width,.75),t)/2,r.marker?Math.max(6*r.width,2*t):z):"simple-fill"===r.type||"picture-fill"===r.type?Math.max(null==r.outline?0:f(r.outline.width,0),t)/2:"cim"===r.type?(yield k.expandSymbol({type:"cim",rendererKey:0,data:r.data,maxVVSize:t},{geometryType:w,fields:B,spatialReference:A},z),(r=C.CIMSymbolHelper.getEnvelope(r.data,z))?
Math.sqrt(r.width*r.width+r.height*r.height):0):"web-style"===r.type?c(yield r.fetchCIMSymbol(),t,z,w,B,A):0});return h.apply(this,arguments)}function l(r,t,z,w,B,A){return q.apply(this,arguments)}function q(){q=G._asyncToGenerator(function*(r,t,z,w,B,A){return r.type in g?Math.min(yield c(r,t,z,w,B,A),75):0});return q.apply(this,arguments)}function e(r){const t=f(r.xoffset,0);r=f(r.yoffset,0);return Math.sqrt(t*t+r*r)}function d(r,t){return Math.max(r,t)}const g={"simple-marker":1,"picture-marker":1,
text:0,"simple-line":0,"simple-fill":0,"picture-fill":0,cim:1,"web-style":1},m=[0,0,0,0],n={sdf:!0,code:99,metrics:v.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,rect:new y(0,0,24,24),page:0,textureBinding:2};u.computePxBuffer=function(r,t,z,w,B,A){return a.apply(this,arguments)};u.getPtMaxVVSize=b;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("exports ../../../../core/BidiText ../../../../core/maybe ../../../../core/screenUtils ../../../../geometry/Polygon ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/normalizeUtilsCommon ../../engine/webgl/alignmentUtils ../../engine/webgl/definitions ../../engine/webgl/mesh/templates/shapingUtils".split(" "),
function(u,G,F,C,y,v,p,k,b,a){u.PIXEL_BUFFER=50;u.TILE_SIZE=512;u.getTextSymbolSize=function(f,c,h){var l,q,e;if(!h||0===h.glyphMosaicItems.length)return f;const d=G.bidiText(c.text)[1];c=a.shapeGlyphs(h.glyphMosaicItems,d,{scale:C.pt2px(c.font.size)/b.GLYPH_SIZE,angle:null!=(l=c.angle)?l:0,xOffset:null!=(q=c.xoffset)?q:0,yOffset:null!=(e=c.yoffset)?e:0,hAlign:k.getXAnchorDirection(c.horizontalAlignment||"center"),vAlign:k.getYAnchorDirection(c.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,
Math.min(c.lineWidth||512,512)),lineHeight:b.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(c.lineHeight||1,4)),decoration:c.font.decoration||"none",isCIM:!1}).bounds;f[0]=C.pt2px(c.x-c.halfWidth);f[1]=C.pt2px(c.y-c.halfHeight);f[2]=C.pt2px(c.width);f[3]=C.pt2px(c.height);return f};u.graphicGeometryToNumber=function(f){switch(F.unwrap(f.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};u.intersectingInternationalDateline=function(f,c){if(!c.isWrappable)return null;
const [h,l]=p.getSpatialReferenceMinMaxX(c);return f[2]>l?[v.create([f[0],f[1],l,f[3]]),v.create([h,f[1],h+f[2]-l,f[3]])]:f[0]<h?[v.create([h,f[1],f[2],f[3]]),v.create([l-(h-f[0]),f[1],l,f[3]])]:null};u.isMarkerSymbol=function(f){return"simple-marker"===f||"picture-marker"===f||"esriSMS"===f||"esriPMS"===f};u.isTextSymbol=function(f){return"text"===f||"esriTS"===f};u.polygonFromExtent=function(f){if(!f)return null;const {xmin:c,ymin:h,xmax:l,ymax:q,spatialReference:e}=f;return new y({rings:[[[c,h],
[c,q],[l,q],[l,h],[c,h]]],spatialReference:e})};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/rendererUtils":function(){define(["exports","../../../../../core/Logger","../../../../../core/screenUtils"],function(u,G,F){function C(p){return("size"===p.type||"color"===p.type||"opacity"===p.type)&&null!=p.stops}function y(p){var k=p.type;var b=p.stops;if(8>=b.length)k=b;else if(v.warn(`Found ${b.length} Visual Variable stops, but MapView only supports ${8}. Displayed stops will be simplified.`),
16<b.length){{const [g,...m]=b;var a=m.pop(),f=m[0].value,c=m[m.length-1].value,h=(c-f)/6;const n=[];for(;f<c;f+=h){for(var l=0;f>=m[l].value;)l++;var q=m[l],e=b[l-1],d=f-e.value;q=q.value===e.value?1:d/(q.value-e.value);"color"===k?(e=m[l],l=b[l-1],d=e.color.clone(),d.r=(1-q)*l.color.r+q*d.r,d.g=(1-q)*l.color.g+q*d.g,d.b=(1-q)*l.color.b+q*d.b,d.a=(1-q)*l.color.a+q*d.a,n.push({value:f,color:d,label:e.label})):"size"===k?(e=m[l],d=b[l-1],l=F.toPt(e.size),d=F.toPt(d.size),n.push({value:f,size:(1-q)*
d+q*l,label:e.label})):(e=m[l],n.push({value:f,opacity:(1-q)*b[l-1].opacity+q*e.opacity,label:e.label}))}k=[g,...n,a]}}else{{const [g,...m]=b;for(k=m.pop();6<m.length;){a=b=0;for(c=1;c<m.length;c++)h=Math.abs(m[c].value-m[c-1].value),h>a&&(a=h,b=c);m.splice(b,1)}k=[g,...m,k]}}p.stops=k;return p}const v=G.getLogger("esri.renderers.visualVariables.support.utils");u.simplifyVVRenderer=p=>{if(!("visualVariables"in p&&p.visualVariables&&p.visualVariables.length))return p;p=p.clone();const k=p.visualVariables.map(b=>
C(b)?y(b):b);p.visualVariables=k;return p};u.simplifyVisualVariables=function(p){return p.map(k=>C(k)?y(k.clone()):k)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/support/clusterUtils":function(){define("exports ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/MD5 ../../../../renderers/visualVariables/SizeVariable ../../../../renderers/visualVariables/support/SizeStop ../../engine/LevelDependentSizeVariable".split(" "),
function(u,G,F,C,y,v,p,k,b){function a(n,r,t){switch(n){case "avg":case "avg_angle":return`cluster_avg_${r}`;case "mode":return`cluster_type_${r}`;case "norm":return n=r.toLowerCase()+",norm:field,"+t.toLowerCase(),"cluster_avg_"+v.createMD5Hash(n)}}function f(n,r){const {name:t,outStatistic:z}=r,{onStatisticField:w,onStatisticValueExpression:B,statisticType:A}=z;B?(r=v.createMD5Hash(B.toLowerCase()),n.push({name:t,outStatistic:{onStatisticField:r,onStatisticValueExpression:B,statisticType:A}})):
w?n.push({name:t,outStatistic:{onStatisticField:w,statisticType:A}}):l.error(new G("mapview-unsupported-field","Unable to handle field",{field:r}))}function c(n,r,t){const z=v.createMD5Hash(r),w="mode"===t?`cluster_type_${z}`:`cluster_avg_${z}`;n.some(B=>B.name===w)||n.push({name:w,outStatistic:{onStatisticField:z,onStatisticValueExpression:r,statisticType:t}});return w}function h(n,r,t,z){if("cluster_count"===r||n.some(B=>B.name===r))return r;const w=a(t,r,z);n.some(B=>B.name===w)||("norm"===t?n.push({name:w,
outStatistic:{onStatisticField:r,onStatisticNormalizationField:z,statisticType:t}}):n.push({name:w,outStatistic:{onStatisticField:r,statisticType:t}}));return w}const l=C.getLogger("esri.views.2d.layers.support.clusterUtils");F.add("esri-cluster-arcade-enabled",!0);const q=F("esri-cluster-arcade-enabled"),e=n=>{for(const r of n)if("size"===r.type)return r;return null},d=n=>{for(const r of n)if("cluster_count"===r.field)return!0;return!1},g=(n,r)=>{const t=[new k({value:0,size:0}),new k({value:1})];
if(y.isNone(r))return new p({field:"cluster_count",stops:[...t,new k({value:2,size:0})]});const z=Object.keys(r).reduce((w,B)=>({...w,[B]:[...t,new k({value:Math.max(2,r[B].minValue),size:n.clusterMinSize}),new k({value:Math.max(3,r[B].maxValue),size:n.clusterMaxSize})]}),{});return new b.LevelDependentSizeVariable({field:"cluster_count",levels:z})},m=n=>{const r=t=>l.error(new G("Unsupported-renderer",t,{renderer:n}));if("unique-value"===n.type){if(n.field2||n.field3)return r("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),
!1}else if("class-breaks"===n.type){if(n.normalizationField){const t=n.normalizationType;if("field"!==t)return r(`FeatureReductionCluster does not support a normalizationType of ${t}`),!1}}else if("simple"!==n.type)return r(`FeatureReductionCluster does not support renderers of type ${n.type}`),!1;if(!q){if("valueExpression"in n&&n.valueExpression)return r("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in
n&&n.visualVariables||[]).some(t=>!!("valueExpression"in t&&t.valueExpression)))return r("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};u.createClusterCountSizeVariable=g;u.createClusterRenderer=(n,r,t,z)=>{r=r.clone();if(!m(r))return r;if(t.fields)for(var w of t.fields)f(n,w);if("visualVariables"in r){w=(r.visualVariables||[]).filter(A=>"$view.scale"!==A.valueExpression);const B=e(w);w.forEach(A=>
{"rotation"===A.type?A.field?A.field=h(n,A.field,"avg_angle"):A.valueExpression&&(A.field=c(n,A.valueExpression,"avg_angle"),A.valueExpression=null):A.normalizationField?(A.field=h(n,A.field,"norm",A.normalizationField),A.normalizationField=null):A.field?A.field=h(n,A.field,"avg"):(A.field=c(n,A.valueExpression,"avg"),A.valueExpression=null)});y.isNone(B)&&!d(w)&&(w.push(g(t,z)),r.dynamicClusterSize=!0);r.visualVariables=w}switch(r.type){case "unique-value":r.field?r.field=h(n,r.field,"mode"):r.valueExpression&&
(r.field=c(n,r.valueExpression,"mode"),r.valueExpression=null);break;case "class-breaks":r.normalizationField?(r.field=h(n,r.field,"norm",r.normalizationField),r.normalizationField=null):r.field?r.field=h(n,r.field,"avg"):(r.field=c(n,r.valueExpression,"avg"),r.valueExpression=null)}return r};u.findSizeVV=e;u.hasClusterCountVV=d;u.isClusterCompatibleRenderer=m;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/core/MD5":function(){define(["exports"],function(u){function G(k,b){const a=(k&65535)+
(b&65535);return(k>>16)+(b>>16)+(a>>16)<<16|a&65535}function F(k,b,a,f,c,h){k=G(G(b,k),G(f,h));return G(k<<c|k>>>32-c,a)}function C(k,b,a,f,c,h,l){return F(b&a|~b&f,k,b,c,h,l)}function y(k,b,a,f,c,h,l){return F(b&f|a&~f,k,b,c,h,l)}function v(k,b,a,f,c,h,l){return F(a^(b|~f),k,b,c,h,l)}const p={Base64:0,Hex:1,String:2,Raw:3};u.createMD5Hash=function(k,b=p.Hex){b=b||p.Base64;var a=[];for(let c=0,h=8*k.length;c<h;c+=8)a[c>>5]|=(k.charCodeAt(c/8)&255)<<c%32;{k=8*k.length;a[k>>5]|=128<<k%32;a[(k+64>>>
9<<4)+14]=k;k=1732584193;var f=-271733879;let c=-1732584194,h=271733878;for(let l=0;l<a.length;l+=16){const q=k,e=f,d=c,g=h;k=C(k,f,c,h,a[l+0],7,-680876936);h=C(h,k,f,c,a[l+1],12,-389564586);c=C(c,h,k,f,a[l+2],17,606105819);f=C(f,c,h,k,a[l+3],22,-1044525330);k=C(k,f,c,h,a[l+4],7,-176418897);h=C(h,k,f,c,a[l+5],12,1200080426);c=C(c,h,k,f,a[l+6],17,-1473231341);f=C(f,c,h,k,a[l+7],22,-45705983);k=C(k,f,c,h,a[l+8],7,1770035416);h=C(h,k,f,c,a[l+9],12,-1958414417);c=C(c,h,k,f,a[l+10],17,-42063);f=C(f,c,
h,k,a[l+11],22,-1990404162);k=C(k,f,c,h,a[l+12],7,1804603682);h=C(h,k,f,c,a[l+13],12,-40341101);c=C(c,h,k,f,a[l+14],17,-1502002290);f=C(f,c,h,k,a[l+15],22,1236535329);k=y(k,f,c,h,a[l+1],5,-165796510);h=y(h,k,f,c,a[l+6],9,-1069501632);c=y(c,h,k,f,a[l+11],14,643717713);f=y(f,c,h,k,a[l+0],20,-373897302);k=y(k,f,c,h,a[l+5],5,-701558691);h=y(h,k,f,c,a[l+10],9,38016083);c=y(c,h,k,f,a[l+15],14,-660478335);f=y(f,c,h,k,a[l+4],20,-405537848);k=y(k,f,c,h,a[l+9],5,568446438);h=y(h,k,f,c,a[l+14],9,-1019803690);
c=y(c,h,k,f,a[l+3],14,-187363961);f=y(f,c,h,k,a[l+8],20,1163531501);k=y(k,f,c,h,a[l+13],5,-1444681467);h=y(h,k,f,c,a[l+2],9,-51403784);c=y(c,h,k,f,a[l+7],14,1735328473);f=y(f,c,h,k,a[l+12],20,-1926607734);k=F(f^c^h,k,f,a[l+5],4,-378558);h=F(k^f^c,h,k,a[l+8],11,-2022574463);c=F(h^k^f,c,h,a[l+11],16,1839030562);f=F(c^h^k,f,c,a[l+14],23,-35309556);k=F(f^c^h,k,f,a[l+1],4,-1530992060);h=F(k^f^c,h,k,a[l+4],11,1272893353);c=F(h^k^f,c,h,a[l+7],16,-155497632);f=F(c^h^k,f,c,a[l+10],23,-1094730640);k=F(f^c^
h,k,f,a[l+13],4,681279174);h=F(k^f^c,h,k,a[l+0],11,-358537222);c=F(h^k^f,c,h,a[l+3],16,-722521979);f=F(c^h^k,f,c,a[l+6],23,76029189);k=F(f^c^h,k,f,a[l+9],4,-640364487);h=F(k^f^c,h,k,a[l+12],11,-421815835);c=F(h^k^f,c,h,a[l+15],16,530742520);f=F(c^h^k,f,c,a[l+2],23,-995338651);k=v(k,f,c,h,a[l+0],6,-198630844);h=v(h,k,f,c,a[l+7],10,1126891415);c=v(c,h,k,f,a[l+14],15,-1416354905);f=v(f,c,h,k,a[l+5],21,-57434055);k=v(k,f,c,h,a[l+12],6,1700485571);h=v(h,k,f,c,a[l+3],10,-1894986606);c=v(c,h,k,f,a[l+10],
15,-1051523);f=v(f,c,h,k,a[l+1],21,-2054922799);k=v(k,f,c,h,a[l+8],6,1873313359);h=v(h,k,f,c,a[l+15],10,-30611744);c=v(c,h,k,f,a[l+6],15,-1560198380);f=v(f,c,h,k,a[l+13],21,1309151649);k=v(k,f,c,h,a[l+4],6,-145523070);h=v(h,k,f,c,a[l+11],10,-1120210379);c=v(c,h,k,f,a[l+2],15,718787259);f=v(f,c,h,k,a[l+9],21,-343485551);k=G(k,q);f=G(f,e);c=G(c,d);h=G(h,g)}a=[k,f,c,h]}switch(b){case p.Raw:return a;case p.Hex:b=[];for(let c=0,h=4*a.length;c<h;c++)b.push("0123456789abcdef".charAt(a[c>>2]>>c%4*8+4&15)+
"0123456789abcdef".charAt(a[c>>2]>>c%4*8&15));return b=b.join("");case p.String:b=[];for(let c=0,h=32*a.length;c<h;c+=8)b.push(String.fromCharCode(a[c>>5]>>>c%32&255));return b=b.join("");case p.Base64:b=[];for(let c=0,h=4*a.length;c<h;c+=3)for(k=(a[c>>2]>>c%4*8&255)<<16|(a[c+1>>2]>>(c+1)%4*8&255)<<8|a[c+2>>2]>>(c+2)%4*8&255,f=0;4>f;f++)8*c+6*f>32*a.length?b.push("\x3d"):b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(k>>6*(3-f)&63));return b=b.join("")}};u.outputTypes=
p;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(u,G,F,C,y,v,p,k,b,a){var f;u.LevelDependentSizeVariable=f=function(c){function h(){return c.apply(this,arguments)||this}G._inheritsLoose(h,c);var l=h.prototype;l.writeLevels=function(q,e,d){for(const g in q){e.stops=this.levels[g];break}};l.clone=function(){return new f({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:a.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:a.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(q=>q.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:C.clone(this.levels)})};return h}(b);F.__decorate([y.property()],u.LevelDependentSizeVariable.prototype,"levels",void 0);
F.__decorate([k.writer("levels")],u.LevelDependentSizeVariable.prototype,"writeLevels",null);u.LevelDependentSizeVariable=f=F.__decorate([p.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],u.LevelDependentSizeVariable);Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/support/util":function(){define(["exports","../../../../core/jsonMap"],function(u,G){const F=new G.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",
esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});u.analyzeRings=function(C,y,v){const p=[],k=[];let b=0,a=0;for(const f of C){C=a;let c=f[0][0],h=f[0][1];p[a++]=c;p[a++]=h;let l=0;for(let q=1;q<f.length;++q){const e=c,d=h;c=f[q][0];h=f[q][1];l+=h*e-c*d;p[a++]=c;p[a++]=h}y(l/2);0<l?(0<C-b&&(v(b,C,p,k),b=C),k.length=0):0>l?0<C-b?k.push(.5*(C-b)):a=C:a=C}0<a-b&&v(b,a,p,k)};u.canUseMajorityInterpolationOnDataSource=function(C){const {bandCount:y,attributeTable:v,colormap:p,
pixelType:k}=C.rasterInfo;return 1===y&&(null!=v||null!=p||"u8"===k||"s8"===k)};u.toJSONGeometryType=function(C){return F.toJSON(C)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q){function e(t,z){return w=>z(t(w))}const d=y.getLogger("esri.views.layers.2d.features.support.AttributeStore"),g=l.createDebugLogger(l.DEBUG_ATTR_UPDATES,d);var m=C("esri-shared-array-buffer"),n=C("esri-atomics");let r=function(){function t(w,B,A,x){this.size=0;this.texelSize=4;const {pixelType:E,layout:D,textureOnly:K}=x;this.textureOnly=K||!1;this.pixelType=E;this._ctype=B;this.layout=D;this._resetRange();this._shared=w;this.size=A;K||(this.data=this._initData(E,
A,w,B))}var z=t.prototype;z.unsetComponentAllTexels=function(w,B){const A=p.unwrap(this.data);for(let x=0;x<this.size*this.size;x++)A[x*this.texelSize+w]&=~B;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};z.setComponentAllTexels=function(w,B){const A=p.unwrap(this.data);for(let x=0;x<this.size*this.size;x++)A[x*this.texelSize+w]|=255&B;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};z.setComponent=function(w,B,A){const x=p.unwrap(this.data);for(const E of A)x[E*this.texelSize+w]|=B,
this.dirtyStart=Math.min(this.dirtyStart,E),this.dirtyEnd=Math.max(this.dirtyEnd,E)};z.setComponentTexel=function(w,B,A){p.unwrap(this.data)[A*this.texelSize+w]|=B;this.dirtyStart=Math.min(this.dirtyStart,A);this.dirtyEnd=Math.max(this.dirtyEnd,A)};z.unsetComponentTexel=function(w,B,A){p.unwrap(this.data)[A*this.texelSize+w]&=~B;this.dirtyStart=Math.min(this.dirtyStart,A);this.dirtyEnd=Math.max(this.dirtyEnd,A)};z.getData=function(w,B){w=c.getDisplayIdTexel(w);return p.unwrap(this.data)[w*this.texelSize+
B]};z.setData=function(w,B,A){w=c.getDisplayIdTexel(w);0===(this.layout&1<<B)?d.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[w*this.texelSize+B]=A,this.dirtyStart=Math.min(this.dirtyStart,w),this.dirtyEnd=Math.max(this.dirtyEnd,w))};z.lock=function(){5121===this.pixelType&&this._shared&&n&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};z.unlock=function(){5121===this.pixelType&&this._shared&&n&&"local"!==this._ctype&&Atomics.store(this.data,
0,0)};z.expand=function(w){this.size=w;if(!this.textureOnly){w=this._initData(this.pixelType,w,this._shared,this._ctype);const B=p.unwrap(this.data);w.set(B);this.data=w}};z.toMessage=function(){const w=this.dirtyStart,B=this.dirtyEnd;var A=this.texelSize;if(w>B)return null;this._resetRange();const x=!this._shared&&"local"!==this._ctype,E=this.pixelType,D=this.layout,K=p.unwrap(this.data);A=x&&K.slice(w*A,(B+1)*A)||null;return{start:w,end:B,data:A,pixelType:E,layout:D}};z._initData=function(w,B,A,
x){A=A&&"local"!==x?SharedArrayBuffer:ArrayBuffer;w=h.getPixelArrayCtor(w);B=new w(new A(B*B*4*w.BYTES_PER_ELEMENT));for(w=0;w<B.length;w+=4)B[w+1]=255;return B};z._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};G._createClass(t,[{key:"buffer",get:function(){return p.andThen(this.data,w=>w.buffer)}}]);return t}();return function(){function t(w,B){this._client=w;this.config=B;this._attributeComputeMap=new Map;this._blocks=[];this._filters=Array(f.MAX_FILTERS);this._targetType=0;
this._abortController=new AbortController;this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;w=B.supportsTextureFloat?5126:5121;g(`Creating AttributeStore ${m?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:w,layout:15},{pixelType:w,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var z=t.prototype;z.destroy=function(){this._abortController.abort()};z.update=function(w,B){this.config=
B;B=B.schema.processors[0].storage;const A=b.diff(this._schema,B);if(w.targets.feature||w.targets.aggregate)w.storage.data=!0;if(A&&(C("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",A),w.storage.data=!0,this._schema=B,this._attributeComputeMap.clear(),!p.isNone(B))){switch(B.target){case "feature":this._targetType=c.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=c.DISPLAY_ID_TYPE_AGGREGATE}if("subtype"===B.type)for(const x in B.mapping){if(w=B.mapping[x],
p.isSome(w))for(const E of w.mapping)this._bindAttribute(E)}else for(const x of B.mapping)this._bindAttribute(x)}};z.onTileData=function(w,B){if(!p.isNone(B.addOrUpdate))for(w=B.addOrUpdate.getCursor();w.next();)B=w.getDisplayId(),this.setAttributeData(B,w)};z.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();this._abortController=new AbortController};z.setHighlight=function(){var w=G._asyncToGenerator(function*(B,A){const x=this._getBlock(0);A=A.map(E=>
c.getDisplayIdTexel(E));x.lock();x.unsetComponentAllTexels(0,1);x.setComponent(0,1,A);x.unlock();this._idsToHighlight.clear();for(const E of B)this._idsToHighlight.add(E);yield this.sendUpdates()});return function(B,A){return w.apply(this,arguments)}}();z.updateFilters=function(){var w=G._asyncToGenerator(function*(B,A){const {config:x,service:E,spatialReference:D}=A;({filters:A}=x);A=A.map((K,H)=>this._updateFilter(K,H,E,D));(yield Promise.all(A)).some(K=>K)&&(B.storage.filters=!0,C("esri-2d-update-debug")&&
console.debug("Applying Update - AttributeStore:","Filters changed"))});return function(B,A){return w.apply(this,arguments)}}();z.setData=function(w,B,A,x){const E=c.getDisplayIdTexel(w);this._ensureSizeForTexel(E);this._getBlock(B).setData(w,A,x)};z.getData=function(w,B,A){return this._getBlock(B).getData(w,A)};z.getHighlightFlag=function(w){return this._idsToHighlight.has(w)?f.HIGHLIGHT_FLAG:0};z.unsetAttributeData=function(w){w=c.getDisplayIdTexel(w);this._getBlock(0).setData(w,0,0)};z.setAttributeData=
function(w,B){const A=c.getDisplayIdTexel(w);this._ensureSizeForTexel(A);this._getBlock(0).setData(A,0,this.getFilterFlags(B));if(this._targetType===c.getDisplayIdType(w)){w=this._attributeComputeMap;var x=this.config.supportsTextureFloat?1:2;w.size&&w.forEach((E,D)=>{const K=D*x%4;D=this._getBlock(Math.floor(D*x/4)+f.ATTRIBUTE_DATA_VV);E=E(B);if(this.config.supportsTextureFloat)D.setData(A,K,E);else if(E===f.NAN_MAGIC_NUMBER)D.setData(A,K,255),D.setData(A,K+1,255);else{E=v.clamp(Math.round(E),-32767,
32766)+32768;const H=(E&65280)>>8;D.setData(A,K,E&255);D.setData(A,K+1,H)}})}};z.sendUpdates=function(){if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=k.createResolver(),this._nextUpdate.promise;const w={blocks:this._blocks.map(B=>p.isSome(B)?B.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var B=()=>{this._currUpdate=null;if(this._nextUpdate){const A=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>A.resolve())}};
B=this._client.update(w,this._signal).then(B).catch(B);this._client.render(this._signal);return B}).catch(B=>{if(k.isAbortError(B))return this._createResourcesPromise=null,this._createResources();d.error(new F("mapview-attribute-store","Encountered an error during client update",B));return Promise.resolve()})};z._ensureSizeForTexel=function(w){for(;w>=this._size*this._size&&!this._expand(););};z._bindAttribute=function(w){function B(){return w.normalizationField?E=>{const D=E.readAttribute(w.normalizationField);
return D?E.readAttribute(w.field)/D:null}:E=>E.readAttribute(w.field)}function A(){w.normalizationField&&d.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");return E=>E.getComputedNumericAtIndex(w.fieldIndex)}let x;if(null!=w.fieldIndex)x=A();else if(w.field)x=B();else return;w.valueRepresentation&&(x=e(x,E=>q.getVisualVariableSizeValueRepresentationRatio(E,w.valueRepresentation)));this._attributeComputeMap.set(w.binding,e(x,E=>null===
E||isNaN(E)||Infinity===E?f.NAN_MAGIC_NUMBER:E))};z._createResources=function(){if(p.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(f.ATTRIBUTE_DATA_ANIMATION);g("Initializing AttributeStore");var w={shared:m&&"local"!==this._client.type,size:this._size,blocks:p.mapMany(this._blocks,B=>({textureOnly:B.textureOnly,buffer:B.buffer,pixelType:B.pixelType}))};this._createResourcesPromise=w=this._client.initialize(w,this._signal).catch(B=>{k.isAbortError(B)?this._createResourcesPromise=
null:d.error(new F("mapview-attribute-store","Encountered an error during client initialization",B))});w.then(()=>p.isNone(this._createResourcesPromise)?this._createResources():void 0);return w};z._getBlock=function(w){var B=this._blocks[w];if(p.isSome(B))return B;g(`Initializing AttributeBlock at index ${w}`);B=new r(m,this._client.type,this._size,this._blockDescriptors[w]);this._blocks[w]=B;this._createResourcesPromise=null;return B};z._expand=function(){if(this._size<this.config.maxTextureSize){const w=
this._size<<=1;g("Expanding block size to",w,this._blocks);p.forEachSome(this._blocks,B=>B.expand(w));this._createResourcesPromise=null;this._size=w;return 0}d.error(new F("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};z._updateFilter=function(){var w=G._asyncToGenerator(function*(B,A,x,E){const D=this._filters[A],K=p.isSome(D)&&D.hash;if(!D&&!B||K===JSON.stringify(B))return!1;if(p.isNone(B)){if(!D)return!1;B=1<<A+1;x=this._getBlock(0);this._filters[A]=null;x.setComponentAllTexels(0,
B);this.sendUpdates();return!0}yield(yield this._getFilter(A,x)).update(B,E);return!0});return function(B,A,x,E){return w.apply(this,arguments)}}();z._getFilter=function(){var w=G._asyncToGenerator(function*(B,A){var x=this._filters[B];if(p.isSome(x))return x;({default:x}=yield new Promise((E,D)=>u(["./FeatureFilter"],K=>E(Object.freeze({__proto__:null,default:K})),D)));A=new x({geometryType:A.geometryType,hasM:!1,hasZ:!1,timeInfo:A.timeInfo,fieldsIndex:new a(A.fields)});return this._filters[B]=A});
return function(B,A){return w.apply(this,arguments)}}();z.isVisible=function(w){return!!(this._getBlock(0).getData(w,0)&2)};z.getFilterFlags=function(w){let B=0;var A=c.getDisplayIdFilterMask(w.getDisplayId());for(let E=0;E<this._filters.length;E++){var x=this._filters[E];x=!(A&1<<E)||p.isNone(x)||x.check(w);B|=(x?1:0)<<E}A=0;this._idsToHighlight.size&&(w=w.getObjectId(),A=this.getHighlightFlag(w));return B<<1|A};G._createClass(t,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",
get:function(){return this._abortController.signal}}]);return t}()})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(u){u.DEBUG_ATTR_UPDATES=!1;u.createDebugLogger=(G,F)=>G&&((...C)=>F.warn("DEBUG:",...C))||(()=>null);Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),
function(u,G,F,C,y,v,p){function k(q){return{value:q.value,size:F.toPt(q.size)}}function b(q){return q.map(e=>k(e))}function a(q){return"string"===typeof q||"number"===typeof q?F.toPt(q):{type:"size",expression:q.expression,stops:b(q.stops)}}function f(q){const e={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof q.field)if(q.stops){if(8<q.stops.length)return null;q=q.stops;for(var d=0;8>d;++d){const g=q[Math.min(d,q.length-1)];e.values[d]=g.value;e.opacities[d]=g.opacity}}else return null;
else if(q.stops&&0<=q.stops.length)for(q=q.stops&&0<=q.stops.length&&q.stops[0].opacity,d=0;8>d;d++)e.values[d]=Infinity,e.opacities[d]=q;else return null;return e}function c(q,e,d){q[4*e]=d.r/255;q[4*e+1]=d.g/255;q[4*e+2]=d.b/255;q[4*e+3]=d.a}function h(q){if(G.isNone(q)||q.normalizationField)return null;const e={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof q.field)if(q.stops){if(8<q.stops.length)return null;e.field=
q.field;q=q.stops;for(var d=0;8>d;++d){const g=q[Math.min(d,q.length-1)];e.values[d]=g.value;c(e.colors,d,g.color)}}else return null;else if(q.stops&&0<=q.stops.length)for(q=q.stops&&0<=q.stops.length&&q.stops[0].color,d=0;8>d;d++)e.values[d]=Infinity,c(e.colors,d,q);else return null;for(q=0;32>q;q+=4)C.premultiplyAlpha(e.colors,q,!0);return e}const l=q=>{const e=[],d=[];q=b(q);const g=q.length;for(let m=0;6>m;m++){const n=q[Math.min(m,g-1)];e.push(n.value);d.push(null==n.size?y.NAN_MAGIC_NUMBER:
F.pt2px(n.size))}return{values:new Float32Array(e),sizes:new Float32Array(d)}};u.convertColorVariable=h;u.convertVisualVariables=function(q){const e=q&&0<q.length?{}:null,d=e?{}:null;if(!e)return{vvFields:e,vvRanges:d};for(const g of q)if(g.field&&(e[g.type]=g.field),"size"===g.type)switch(d.size||(d.size={}),q=g,p.getTypeOfSizeVisualVariable(q)){case v.WGLVVFlag.SIZE_MINMAX_VALUE:d.size.minMaxValue={minDataValue:q.minDataValue,maxDataValue:q.maxDataValue,minSize:a(q.minSize),maxSize:a(q.maxSize)};
break;case v.WGLVVFlag.SIZE_SCALE_STOPS:d.size.scaleStops={stops:b(q.stops)};break;case v.WGLVVFlag.SIZE_FIELD_STOPS:if(q.levels){const m={};for(const n in q.levels)m[n]=l(q.levels[n]);d.size.fieldStops={type:"level-dependent",levels:m}}else d.size.fieldStops={type:"static",...l(q.stops)};break;case v.WGLVVFlag.SIZE_UNIT_VALUE:d.size.unitValue={unit:q.valueUnit,valueRepresentation:q.valueRepresentation}}else"color"===g.type?d.color=h(g):"opacity"===g.type?d.opacity=f(g):"rotation"===g.type&&(d.rotation=
{type:g.rotationType});return{vvFields:e,vvRanges:d}};u.getVisualVariableSizeValueRepresentationRatio=function(q,e){if(!q||!e)return q;switch(e){case "radius":case "distance":return 2*q;case "area":return Math.sqrt(q)}return q};u.getVisualVariablesFields=function(q){const e=q&&0<q.length?{}:null;e&&q.forEach(d=>{const g=d.type;d.field&&(e[g]=d.field)});return e};u.normalizeSizeElement=a;u.normalizeSizeStops=b;u.stopToSizeStop=k;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports",
"../../../engine/webgl/DisplayId","./DisplayIdGenerator","./StaticBitSet"],function(u,G,F,C){function y(p,k,b){if(!(p.length>k))for(;p.length<=k;)p.push(b)}let v=function(){function p(){this._numerics=[];this._strings=[];this._idGenerator=new F.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var k=p.prototype;k.createBitset=function(){const b=this._bitsets.length;this._bitsets.push(C.StaticBitSet.create(this._allocatedSize,G.DISPLAY_ID_TEXEL_MASK));
return b+1};k.getBitset=function(b){return this._bitsets[b-1]};k._expand=function(){this._allocatedSize<<=1;for(const b of this._bitsets)b.resize(this._allocatedSize)};k._ensureNumeric=function(b,a){this._numerics[b]||(this._numerics[b]=[]);y(this._numerics[b],a,0)};k._ensureInstanceId=function(b){y(this._instanceIds,b,0)};k._ensureString=function(b,a){this._strings[b]||(this._strings[b]=[]);y(this._strings[b],a,null)};k.createDisplayId=function(b=!1){const a=this._idGenerator.createId();a>this._allocatedSize&&
this._expand();return G.createDisplayId(a,b)};k.releaseDisplayId=function(b){for(const a of this._bitsets)a.unset(b);return this._idGenerator.releaseId(b&G.DISPLAY_ID_TEXEL_MASK)};k.getComputedNumeric=function(b,a){return this.getComputedNumericAtIndex(b&G.DISPLAY_ID_TEXEL_MASK,0)};k.setComputedNumeric=function(b,a,f){return this.setComputedNumericAtIndex(b&G.DISPLAY_ID_TEXEL_MASK,f,0)};k.getComputedString=function(b,a){return this.getComputedStringAtIndex(b&G.DISPLAY_ID_TEXEL_MASK,0)};k.setComputedString=
function(b,a,f){return this.setComputedStringAtIndex(b&G.DISPLAY_ID_TEXEL_MASK,0,f)};k.getComputedNumericAtIndex=function(b,a){b&=G.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(a,b);return this._numerics[a][b]};k.setComputedNumericAtIndex=function(b,a,f){b&=G.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(a,b);this._numerics[a][b]=f};k.getInstanceId=function(b){b&=G.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(b);return this._instanceIds[b]};k.setInstanceId=function(b,a){b&=G.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(b);
this._instanceIds[b]=a};k.getComputedStringAtIndex=function(b,a){b&=G.DISPLAY_ID_TEXEL_MASK;this._ensureString(a,b);return this._strings[a][b]};k.setComputedStringAtIndex=function(b,a,f){b&=G.DISPLAY_ID_TEXEL_MASK;this._ensureString(a,b);this._strings[a][b]=f};k.getXMin=function(b){return this._bounds[4*(b&G.DISPLAY_ID_TEXEL_MASK)]};k.getYMin=function(b){return this._bounds[4*(b&G.DISPLAY_ID_TEXEL_MASK)+1]};k.getXMax=function(b){return this._bounds[4*(b&G.DISPLAY_ID_TEXEL_MASK)+2]};k.getYMax=function(b){return this._bounds[4*
(b&G.DISPLAY_ID_TEXEL_MASK)+3]};k.setBounds=function(b,a){a=a.readHydratedGeometry();if(!a||!a.coords.length)return!1;let f=Infinity,c=Infinity,h=-Infinity,l=-Infinity;a.forEachVertex((q,e)=>{f=Math.min(f,q);c=Math.min(c,e);h=Math.max(h,q);l=Math.max(l,e)});b&=G.DISPLAY_ID_TEXEL_MASK;y(this._bounds,4*b+4,0);this._bounds[4*b]=f;this._bounds[4*b+1]=c;this._bounds[4*b+2]=h;this._bounds[4*b+3]=l;return!0};return p}();u.ComputedAttributeStorage=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/DisplayIdGenerator":function(){define(["exports",
"../../../engine/webgl/DisplayId"],function(u,G){let F=function(){function C(){this._freeIds=[];this._idCounter=1}var y=C.prototype;y.createId=function(v=!1){return G.createDisplayId(this._getFreeId(),v)};y.releaseId=function(v){this._freeIds.push(v)};y._getFreeId=function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};return C}();u.DisplayIdGenerator=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/GraphicsReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ./FeatureSetReader ./FeatureSetReaderJSON".split(" "),
function(u,G,F,C,y,v){v=function(p){function k(a,f){return p.call(this,a,f,null)||this}G._inheritsLoose(k,p);k.from=function(a){const f=y.FeatureSetReader.createInstance(),c=[];a=a.filter(h=>!!h.geometry);for(const h of a)a=F.getJsonType(h.geometry),C.convertFromGraphics(c,[h],a,!1,!1,"uid");return new k(f,c)};var b=k.prototype;b.readGraphic=function(){return this._current};b.getCursor=function(){return this.copy()};b.copy=function(){const a=new k(this.instance,this._features);this.copyInto(a);return a};
G._createClass(k,[{key:"geometryType",get:function(){const a=this._current;return a?a.geometryType:null}},{key:"insertAfter",get:function(){return this._current.insertAfter}}]);return k}(v.FeatureSetReaderJSON);u.GraphicsReader=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),
function(u,G,F,C,y,v,p,k,b,a){var f,c,h;let l=0;F=null!=(f=C("featurelayer-simplify-thresholds"))?f:[.5,.5,.5,.5];const q=F[0],e=F[1],d=F[2],g=F[3];f=null!=(c=C("featurelayer-simplify-payload-size-factors"))?c:[1,2,4];const m=f[0],n=f[1],r=f[2],t=null!=(h=C("featurelayer-simplify-mobile-factor"))?h:2,z=C("esri-mobile");C=function(){function w(A){this.type="FeatureSetReader";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=null;this._joined=[];this._objectIdToIndex=
null;this._level=0;this.instance=A}w.createInstance=function(){l++;return l=65535<l?0:l};var B=w.prototype;B.getAreaSimplificationThreshold=function(A,x){let E=1;const D=z?t:1;4E6<x?E=r*D:1E6<x?E=n*D:5E5<x?E=m*D:1E5<x&&(E=D);x=0;4E3<A?x=g*E:2E3<A?x=d*E:100<A?x=e:15<A&&(x=q);A=8;4>this._level?A=1:5>this._level?A=2:6>this._level&&(A=4);return x*A};B.setArcadeSpatialReference=function(A){this._arcadeSpatialReference=A};B.attachStorage=function(A){this._storage=A};B.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");
};B.getStorage=function(){return this._storage};B.getComputedNumeric=function(A){return this.getComputedNumericAtIndex(0)};B.setComputedNumeric=function(A,x){return this.setComputedNumericAtIndex(x,0)};B.getComputedString=function(A){return this.getComputedStringAtIndex(0)};B.setComputedString=function(A,x){return this.setComputedStringAtIndex(0,x)};B.getComputedNumericAtIndex=function(A){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),A)};B.setComputedNumericAtIndex=function(A,
x){this._storage.setComputedNumericAtIndex(this.getDisplayId(),A,x)};B.getComputedStringAtIndex=function(A){return this._storage.getComputedStringAtIndex(this.getDisplayId(),A)};B.setComputedStringAtIndex=function(A,x){return this._storage.setComputedStringAtIndex(this.getDisplayId(),A,x)};B.transform=function(A,x,E,D){const K=this.copy();K._tx+=A;K._ty+=x;K._sx*=E;K._sy*=D;return K};B.readAttribute=function(A,x=!1){var E=this._readAttribute(A,x);if(void 0!==E)return E;for(const D of this._joined)if(D.setIndex(this.getIndex()),
E=D._readAttribute(A,x),void 0!==E)return E};B.readAttributes=function(){const A=this._readAttributes();for(const x of this._joined){x.setIndex(this.getIndex());const E=x._readAttributes();for(const D of Object.keys(E))A[D]=E[D]}return A};B.joinAttributes=function(A){this._joined.push(A)};B.readArcadeFeature=function(){return this};B.geometry=function(){var A=this.readHydratedGeometry();A=p.convertToGeometry(A,this.geometryType,this.hasZ,this.hasM);if(A=a.fromJSON(A))A.spatialReference=this._arcadeSpatialReference;
return A};B.field=function(A){return this.readAttribute(A,!0)};B.hasField=function(A){return!0};B.setField=function(A,x){};B.keys=function(){return[]};B.castToText=function(){return""};B.removeIds=function(A){if(y.isNone(this._objectIdToIndex)){var x=new Map;const E=this.getCursor();for(;E.next();)x.set(E.getObjectId(),E.getIndex());this._objectIdToIndex=x}x=this._objectIdToIndex;for(const E of A)x.has(E)&&this.removeAtIndex(x.get(E))};B.removeAtIndex=function(A){y.isNone(this._deleted)&&(this._deleted=
b.StaticBitSet.create(this.getSize()));this._deleted.set(A)};B.readGeometryForDisplay=function(){return this.readUnquantizedGeometry(!0)};B.readLegacyGeometryForDisplay=function(){return this.readLegacyGeometry(!0)};B.features=function*(){const A=this.getCursor();for(;A.next();)yield A.readOptimizedFeature()};B._getExists=function(){return y.isNone(this._deleted)||!this._deleted.has(this.getIndex())};B._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;const A=this.readUnquantizedGeometry();
if(!A||A.hasIndeterminateRingOrder)return null;const x=y.unwrapOr(this.getQuantizationTransform(),null);return v.getCentroidOptimizedGeometry(new k,A,this.hasM,this.hasZ,x)};B.copyInto=function(A){A.seen=this.seen;A._storage=this._storage;A._arcadeSpatialReference=this._arcadeSpatialReference;A._joined=this._joined;A._tx=this._tx;A._ty=this._ty;A._sx=this._sx;A._sy=this._sy;A._deleted=this._deleted;A._objectIdToIndex=this._objectIdToIndex};G._createClass(w,[{key:"isEmpty",get:function(){return y.isSome(this._deleted)&&
this._deleted.countSet()===this.getSize()}},{key:"level",set:function(A){this._level=A}}]);return w}();u.FeatureSetReader=C;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/layers/graphics/centroid":function(){define(["exports","../../core/maybe"],function(u,G){function F(y,v,p,k,b,a,f=1){a=b?a?4:3:a?3:2;let c=p,h=p+a,l=0,q=0,e=p=0,d=0;for(let g=0,m=k-1;g<m;g++,c+=a,h+=a){k=v[c];const n=v[c+1],r=v[c+2],t=v[h],z=v[h+1],w=v[h+2];let B=k*z-t*n;e+=B;l+=(k+t)*B;q+=(n+z)*B;b&&(B=k*w-t*r,p+=(r+
w)*B,d+=B);k<y[0]&&(y[0]=k);k>y[1]&&(y[1]=k);n<y[2]&&(y[2]=n);n>y[3]&&(y[3]=n);b&&(r<y[4]&&(y[4]=r),r>y[5]&&(y[5]=r))}0<e*f&&(e*=-1);0<d*f&&(d*=-1);if(!e)return null;y=[l,q,.5*e];b&&(y[3]=p,y[4]=.5*d);return y}function C(y,v,p,k,b){b=k?b?4:3:b?3:2;let a=v,f=v+b,c=0,h=0,l=0,q=0;for(let m=0,n=p-1;m<n;m++,a+=b,f+=b){var e=y[a];const r=y[a+1],t=y[a+2],z=y[f],w=y[f+1],B=y[f+2];if(k){{var d=z-e;var g=w-r;const A=B-t;d=Math.sqrt(d*d+g*g+A*A)}}else d=z-e,g=w-r,d=Math.sqrt(d*d+g*g);d&&(c+=d,k?(e=[e+.5*(z-
e),r+.5*(w-r),t+.5*(B-t)],h+=d*e[0],l+=d*e[1],q+=d*e[2]):(e=[e+.5*(z-e),r+.5*(w-r)],h+=d*e[0],l+=d*e[1]))}return 0<c?k?[h/c,l/c,q/c]:[h/c,l/c]:0<p?k?[y[v],y[v+1],y[v+2]]:[y[v],y[v+1]]:null}u.getCentroidOptimizedGeometry=function(y,v,p,k,b){if(G.isNone(v)||!v.lengths.length)return null;const a="upperLeft"===(null==b?void 0:b.originPosition)?-1:1;y.lengths.length&&(y.lengths.length=0);y.coords.length&&(y.coords.length=0);b=y.coords;const f=[],c=p?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:h,coords:l}=v,q=p?k?4:3:k?3:2;let e=0;for(var d of h){const g=F(c,l,e,d,p,k,a);g&&f.push(g);e+=d*q}f.sort((g,m)=>{let n=a*g[2]-a*m[2];0===n&&p&&(n=g[4]-m[4]);return n});f.length&&(d=6*f[0][2],b[0]=f[0][0]/d,b[1]=f[0][1]/d,p&&(d=6*f[0][4],b[2]=0!==d?f[0][3]/d:0),b[0]<c[0]||b[0]>c[1]||b[1]<c[2]||b[1]>c[3]||p&&(b[2]<
c[4]||b[2]>c[5]))&&(b.length=0);if(!b.length)if(v=v.lengths[0]?C(l,0,h[0],p,k):null)b[0]=v[0],b[1]=v[1],p&&2<v.length&&(b[2]=v[2]);else return null;return y};u.lineCentroid=C;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ./FeatureSetReader".split(" "),
function(u,G,F,C,y,v){function p({coords:b,lengths:a}){let f=0;for(const c of a){for(a=1;a<c;a++)b[2*(f+a)]+=b[2*(f+a)-2],b[2*(f+a)+1]+=b[2*(f+a)-1];f+=c}}let k=function(b){function a(c,h,l){c=b.call(this,c)||this;c._featureIndex=-1;c._dateFields=new Set;c._geometryType=l;c._features=h;return c}G._inheritsLoose(a,b);a.fromFeatures=function(c,h,l){l=C.convertFromFeatures([],c,h,!1,!1,l);for(let q=0;q<l.length;q++)l[q].displayId=c[q].displayId;return a.fromOptimizedFeatures(l,h)};a.fromFeatureSet=function(c,
h){c=C.convertFromFeatureSet(c,h);return a.fromOptimizedFeatureSet(c)};a.fromOptimizedFeatureSet=function(c){const {features:h,geometryType:l}=c,q=a.fromOptimizedFeatures(h,l);q._exceededTransferLimit=c.exceededTransferLimit;q._transform=c.transform;for(const e of c.fields)"esriFieldTypeDate"===e.type&&q._dateFields.add(e.name);return q};a.fromOptimizedFeatures=function(c,h,l){const q=v.FeatureSetReader.createInstance();c=new a(q,c,h);c._transform=l;return c};var f=a.prototype;f.removeIds=function(c){const h=
new Set(c);this._features=this._features.filter(l=>!h.has(l.objectId))};f.append=function(c){for(const h of c)this._features.push(h)};f.getSize=function(){return this._features.length};f.getCursor=function(){return this.copy()};f.getQuantizationTransform=function(){return this._transform};f.getAttributeHash=function(){let c="";for(const h in this._current.attributes)c+=this._current.attributes[h];return c};f.getIndex=function(){return this._featureIndex};f.setIndex=function(c){this._featureIndex=
c};f.getObjectId=function(){return this._current.objectId};f.getDisplayId=function(){return this._current.displayId};f.setDisplayId=function(c){this._current.displayId=c};f.getGroupId=function(){return this._current.groupId};f.setGroupId=function(c){this._current.groupId=c};f.copy=function(){const c=new a(this.instance,this._features,this.geometryType);this.copyInto(c);return c};f.next=function(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};
f.readLegacyFeature=function(){return C.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};f.readOptimizedFeature=function(){return this._current};f.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};f.readLegacyGeometry=function(){const c=this.readGeometry();return C.convertToGeometry(c,this.geometryType,this.hasZ,this.hasM)};f.readLegacyCentroid=function(){const c=this.readCentroid();return F.isNone(c)?null:{x:c.coords[0]*this._sx+
this._tx,y:c.coords[1]*this._sy+this._ty}};f.readGeometryArea=function(){return y.hasGeometry(this._current)?C.getQuantizedArea(this._current.geometry,2):0};f.readUnquantizedGeometry=function(){var c=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!c)return c;c=c.clone();p(c);return c};f.readHydratedGeometry=function(){var c=this._current.geometry;if(F.isNone(c))return null;c=c.clone();F.isSome(this._transform)&&C.unquantizeOptimizedGeometry(c,c,this.hasZ,this.hasM,this._transform);
return c};f.getXHydrated=function(){if(!y.hasGeometry(this._current))return 0;const c=this._current.geometry.coords[0],h=this.getQuantizationTransform();return F.isNone(h)?c:c*h.scale[0]+h.translate[0]};f.getYHydrated=function(){if(!y.hasGeometry(this._current))return 0;const c=this._current.geometry.coords[1],h=this.getQuantizationTransform();return F.isNone(h)?c:h.translate[1]-c*h.scale[1]};f.getX=function(){return y.hasGeometry(this._current)?this._current.geometry.coords[0]*this._sx+this._tx:
0};f.getY=function(){return y.hasGeometry(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0};f.readGeometry=function(){if(!y.hasGeometry(this._current))return null;const c=this._current.geometry.clone();if(c.isPoint)return c.coords[0]=c.coords[0]*this._sx+this._tx,c.coords[1]=c.coords[1]*this._sy+this._ty,c;let h=0;for(const l of c.lengths)c.coords[2*h]=c.coords[2*h]*this._sx+this._tx,c.coords[2*h+1]=c.coords[2*h+1]*this._sy+this._ty,h+=l;return c};f.readCentroid=function(){if(!y.hasGeometry(this._current))return null;
if(!this._current.centroid){var c=this._computeCentroid();if(!c)return null;c.coords[0]=(c.coords[0]-this._tx)/this._sx;c.coords[1]=(c.coords[1]-this._ty)/this._sy;this._current.centroid=c}c=this._current.centroid.clone();c.coords[0]=c.coords[0]*this._sx+this._tx;c.coords[1]=c.coords[1]*this._sx+this._ty;return c};f._readAttribute=function(c,h){var l=this._current.attributes[c];if(void 0!==l)return null!=l&&h&&this._dateFields.has(c)?new Date(l):l;l=this.readAttributes();c=c.toLocaleLowerCase().trim();
for(const q in l)if(q.toLocaleLowerCase().trim()===c)return c=this._current.attributes[q],null!=c&&h&&this._dateFields.has(q)?new Date(c):c};f.copyInto=function(c){b.prototype.copyInto.call(this,c);c._featureIndex=this._featureIndex;c._transform=this._transform;c._dateFields=this._dateFields};f._readAttributes=function(){return this._current.attributes};G._createClass(a,[{key:"_current",get:function(){return this._features[this._featureIndex]}},{key:"geometryType",get:function(){return this._geometryType}},
{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return a}(v.FeatureSetReader);u.FeatureSetReaderJSON=k;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicStore":function(){define("../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/rbush ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/boundsUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/normalizeUtilsCommon ../../../../symbols/cim/CIMSymbolDrawHelper ../../../../symbols/cim/CIMSymbolHelper ./GraphicStoreItem ./graphicsUtils".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f){function c(d,g,m,n,r){l.minX=g;l.minY=m;l.maxX=n;l.maxY=r;return d.search(l)}function h(d){return{minX:d.bounds[0],minY:d.bounds[1],maxX:d.bounds[2],maxY:d.bounds[3]}}const l={minX:0,minY:0,maxX:0,maxY:0},q=C.create(),e=(d,g)=>{const m=f.graphicGeometryToNumber(d.graphic),n=f.graphicGeometryToNumber(g.graphic);return m===n?g.zorder-d.zorder:m-n};return function(){function d(m,n,r,t,z,w,B){this._graphics=t;this._onAdd=z;this._onRemove=w;this._hashToCIM=B;this._index=
F.rbush(9,h);this._itemByGraphic=new Map;this._inflatedSizeHelper=new b.CIMSimbolInflatedSizeHelper;this._tileInfoView=m;this._uidFieldName=r;if(m=m.getClosestInfoForScale(n))this._resolution=this._tileInfoView.getTileResolution(m.level)}var g=d.prototype;g.setResourceManager=function(m){this._cimResourceManager=m;this._hittestDrawHelper=new k.HittestDrawHelper(m)};g.hitTest=function(m,n,r,t,z){m=v.normalizeMapX(m,this._tileInfoView.spatialReference);var w=.5*t*window.devicePixelRatio*r;q[0]=m-w;
q[1]=n-w;q[2]=m+w;q[3]=n+w;r=.5*t*(r+f.PIXEL_BUFFER);n=c(this._index,m-r,n-r,m+r,n+r);if(!n||0===n.length)return[];m=[];r=C.create();w=C.create();for(var B of n){const {geometry:A,symbolResource:x}=B;this._getSymbolBounds(r,x,A,w,z);w[3]=w[2]=w[1]=w[0]=0;C.intersects(r,q)&&B.graphic.visible&&m.push(B)}if(0===m.length)return[];B=this._hittestDrawHelper;n=[];for(const A of m){const {geometry:x,symbolResource:E}=A,{hash:D,textInfo:K}=E;(m=this._hashToCIM.get(D))&&B.hitTest(q,m.symbol,x,K,z,t)&&n.push(A)}n.sort(e);
return n.map(A=>A.graphic)};g.getGraphicsData=function(m,n,r){const t=this._searchForItems(n);if(0===t.length||0===r.length)return[];t.sort((D,K)=>D.zorder-K.zorder);t[0].insertAfter=-1;for(var z=1;z<t.length;z++)t[z].insertAfter=t[z-1].graphic.uid;t.sort((D,K)=>D.graphic.uid-K.graphic.uid);r.sort((D,K)=>D.uid-K.uid);let w=z=0,B;const A=n.resolution,x=[],E={originPosition:"upperLeft",scale:[A,A],translate:[n.bounds[0],n.bounds[3]]};for(const D of r){for(w=-2;z<t.length;)if(B=t[z],z++,D.uid===B.graphic.uid){w=
B.insertAfter;break}if(!B.geometry||-2===w)continue;r=B.getGeometryQuantized(E,n.bounds,this._tileInfoView.spatialReference,A);const K={...B.graphic.attributes};K[this._uidFieldName]=D.uid;null==B.groupId&&(B.groupId=m.createTemplateGroup(B.symbol,null));x.push({centroid:a.getCentroidQuantized(B,E),geometry:r,attributes:K,symbol:B.symbol,groupId:B.groupId,insertAfter:w,zorder:B.zorder})}x.sort((D,K)=>D.zorder-K.zorder);return x};g.queryTileData=function(m,n){if(0===this._graphics.length)return[];
const {bounds:r,resolution:t}=n,z=this._searchForItems(n),w=[];if(0===z.length)return w;this._createTileGraphics(w,m,z,{originPosition:"upperLeft",scale:[t,t],translate:[r[0],r[3]]},n);return w};g.has=function(m){return this._itemByGraphic.has(m)};g.getBounds=function(m){return(m=this._itemByGraphic.get(m))?m.bounds:null};g.getAllBounds=function(){return Array.from(this._itemByGraphic.values()).filter(m=>m.graphic.visible).map(m=>m.bounds)};g.addOrModify=function(m,n,r){if(m&&!u.isNone(n)){this.has(m)&&
this.remove(m);this._onAdd(m);var t=[0,0,0,0],z=this._getSymbolBounds(null,n,r,t,0);n=a.acquire(m,n,r,u.isSome(z)?z:null,t);this._itemByGraphic.set(m,n);r&&this._index.insert(n);return n.bounds}};g.remove=function(m){if(this._itemByGraphic.has(m)){this._onRemove(m);var n=this._itemByGraphic.get(m);n.bounds&&this._index.remove(n);this._itemByGraphic.delete(m)}};g.updateZ=function(){const m=this._graphics.items;for(let r=0;r<m.length;r++){var n=m[r];if(n=this._itemByGraphic.get(n))n.zorder=r}};g.update=
function(m,n,r){const t=this._itemByGraphic.get(m);t.groupId=null;const z=C.clone(t.bounds);this._index.remove(t);const w=this._getSymbolBounds(t.bounds,n,r,t.size,0);u.isSome(w)&&t.set(m,n,r,w,t.size);r&&this._index.insert(t);return{oldBounds:z,newBounds:t.bounds}};g.updateLevel=function(m){if(this._resolution!==m){this._resolution=m;this._index.clear();var n=this._itemByGraphic;m=[];for(const [,r]of n)n=this._getSymbolBounds(r.bounds,r.symbolResource,r.geometry,r.size,0),r.geometry&&u.isSome(n)&&
(r.bounds=n,m.push(r));this._index.load(m)}};g.clear=function(){this._itemByGraphic.clear();this._index.clear()};g._createTileGraphics=function(m,n,r,t,z){const w=this._uidFieldName,B=this._tileInfoView.spatialReference,{bounds:A,resolution:x}=z;r.sort((H,I)=>H.zorder-I.zorder);let E,D,K;for(let H=0;H<r.length;H++){D=r[H];z=D.graphic;E=D.getGeometryQuantized(t,A,B,x);K=0===H?-1:r[H-1].graphic.uid;const I={...D.graphic.attributes};I[w]=z.uid;null==D.groupId&&(D.groupId=n.createTemplateGroup(D.symbol,
null));m.push({centroid:a.getCentroidQuantized(D,t),geometry:E,attributes:I,symbol:D.symbol,groupId:D.groupId,insertAfter:K,zorder:D.zorder})}};g._searchForItems=function(m){var n=this._tileInfoView.spatialReference,r=m.bounds;if(n.isWrappable){const [t,z]=p.getSpatialReferenceMinMaxX(n);n=1E-5>Math.abs(r[2]-z);const w=1E-5>Math.abs(r[0]-t);if(!(n&&w||!n&&!w))return m=m.resolution,m=n?C.create([t,r[1],t+m*f.PIXEL_BUFFER,r[3]]):C.create([z-m*f.PIXEL_BUFFER,r[1],z,r[3]]),r=c(this._index,r[0],r[1],r[2],
r[3]),m=c(this._index,m[0],m[1],m[2],m[3]),[...new Set([...r,...m])]}return c(this._index,r[0],r[1],r[2],r[3])};g._getSymbolBounds=function(m,n,r,t,z){if(!n||!n.symbol||!r)return null;m||(m=C.create());y.getBoundsXY(m,r);if(!t||0===t[0]&&0===t[1]&&0===t[2]&&0===t[3]){const {hash:w,textInfo:B}=n;n=this._hashToCIM.get(w);if(!n)return null;t||(t=[0,0,0,0]);z=this._inflatedSizeHelper.getSymbolInflateSize(t,n.symbol,this._cimResourceManager,z,B);t[0]=G.pt2px(z[0]);t[1]=G.pt2px(z[1]);t[2]=G.pt2px(z[2]);
t[3]=G.pt2px(z[3])}z=this._resolution;t=b.CIMSimbolInflatedSizeHelper.SafeSize(t);m[0]-=t*z;m[1]-=t*z;m[2]+=t*z;m[3]+=t*z;return m};return d}()})},"esri/views/2d/layers/graphics/GraphicStoreItem":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtilsCommon ../../../../geometry/support/quantizationUtils ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./graphicsUtils".split(" "),
function(u,G,F,C,y,v,p,k,b,a){function f(l){l.coords.length=0;l.lengths.length=0}const c=new b,h=new b;b=function(){function l(){this.bounds=F.create();this.graphic=null}l.acquire=function(e=null,d,g,m,n){let r;0===l._pool.length?r=new l:(r=l._pool.pop(),this._set.delete(r));r.acquire(e,d,g,m,n);return r};l.release=function(e){e&&!this._set.has(e)&&(e.release(),this._pool.push(e),this._set.add(e))};l.getCentroidQuantized=function(e,d){if(y.isPolygon(e.geometry)){const g=e.symbol;if(G.isNone(g))return null;
if(a.isMarkerSymbol(g.type)||a.isTextSymbol(g.type))return e=C.polygonCentroid(e.geometry),p.quantizePoint(d,{},{x:e[0],y:e[1]},!1,!1)}return null};var q=l.prototype;q.acquire=function(e=null,d,g,m,n){e&&this.set(e,d,g,m,n)};q.release=function(){this.geometry=this.symbolResource=this.graphic=null};q.set=function(e,d,g,m,n){this.graphic=e;this.geometry=g;this.symbolResource=d;this.bounds=m;n&&(this.size=n)};q.getGeometryQuantized=function(e,d,g,m){const n=this.geometry;if(y.isPolygon(n)){if(g=n.rings,
1===g.length&&2===g[0].length)return p.quantizeGeometry(e,{paths:[[g[0][0],g[0][1]]]})}else{if(y.isPolyline(n))return f(c),f(h),k.convertFromPolyline(c,n),k.generalizeOptimizedGeometry(h,c,n.hasZ,n.hasM,"esriGeometryPolyline",e.scale[0]),k.quantizeOptimizedGeometry(c,h,n.hasZ,n.hasM,"esriGeometryPolyline",e),k.convertToPolyline(c,n.hasZ,n.hasM);if(y.isMultipoint(n)){const r=.5*m*Math.max(Math.abs(this.size[0])+this.size[2]-this.size[0],Math.abs(this.size[1])+this.size[3]-this.size[1]),[t,z]=v.getSpatialReferenceMinMaxX(g),
w=z-t;g=n.points.filter(B=>{if(B[0]+r>z||B[0]-r<t){const A=[...B];A[0]=B[0]+r>z?A[0]-w:A[0]+w;return F.containsPointWithMargin(d,B,r)||F.containsPointWithMargin(d,A,r)}return F.containsPointWithMargin(d,B,r)});return 0===g.length?{points:g}:p.quantizeGeometry(e,{points:g})}}return p.quantizeGeometry(e,this.geometry)};u._createClass(l,[{key:"symbol",get:function(){return this.symbolResource.symbol}}]);return l}();b._pool=[];b._set=new Set;return b})},"esri/views/layers/GraphicsView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(u,G,F,C,y,v,p,k,b){u.GraphicsView=a=>{a=function(f){function c(){var h=f.apply(this,arguments)||this;h.graphics=null;h.renderer=null;return h}G._inheritsLoose(c,f);return c}(C.IdentifiableMixin(a));F.__decorate([y.property()],a.prototype,"graphics",void 0);F.__decorate([y.property()],a.prototype,"renderer",void 0);F.__decorate([y.property()],a.prototype,"updating",void 0);F.__decorate([y.property()],a.prototype,"view",void 0);return a=F.__decorate([b.subclass("esri.views.layers.GraphicsView")],
a)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/webgl/enums","./BaseGraphicContainer"],function(u,G,F){return function(C){function y(){return C.apply(this,arguments)||this}u._inheritsLoose(y,C);var v=y.prototype;v.renderChildren=function(p){this.attributeView.bindTextures(p.context,!1);this.children.some(k=>k.hasData)&&(C.prototype.renderChildren.call(this,p),p.drawPhase===
G.WGLDrawPhase.MAP&&this._renderChildren(p),this.hasHighlight()&&p.drawPhase===G.WGLDrawPhase.HIGHLIGHT&&this._renderHighlight(p),this._boundsRenderer&&this._boundsRenderer.doRender(p))};v._renderHighlight=function(p){var {painter:k}=p;k=k.effects.highlight;k.bind(p);this._renderChildren(p,k.defines);k.draw(p);k.unbind()};return y}(F)})},"esri/views/2d/layers/graphics/BaseGraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/FeatureContainer","./GraphicBoundsRenderer"],
function(u,G,F){return function(C){function y(p){p=C.call(this,p)||this;p.hasHighlight=()=>!0;return p}u._inheritsLoose(y,C);var v=y.prototype;v.destroy=function(){C.prototype.destroy.call(this);this._boundsRenderer&&(this._boundsRenderer.destroy(),this._boundsRenderer=null)};v.enableRenderingBounds=function(p){this._boundsRenderer=new F(p);this.requestRender()};v.onTileData=function(p,k){p.patch(k);this.contains(p)||this.addChild(p);this.requestRender()};v.onTileError=function(p){p.clear();this.contains(p)||
this.addChild(p)};v._renderChildren=function(p,k){for(const b of this.children)b.isReady&&b.hasData&&(b.commit(p),p.context.setStencilFunction(514,b.stencilRef,255),b._displayList.replay(p,b,k))};u._createClass(y,[{key:"hasLabels",get:function(){return!1}}]);return y}(G.FeatureContainer)})},"esri/views/2d/engine/FeatureContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/promiseUtils ../../../core/Queue ./webgl/AttributeStoreView ./webgl/TileContainer ./webgl/WGLRendererInfo".split(" "),
function(u,G,F,C,y,v,p){v=function(k){function b(f){var c=k.call(this,f)||this;c._rendererInfo=new p.WGLRendererInfo;c._materialItemsRequestQueue=new C;c.attributeView=new y.AttributeStoreView(()=>c.onAttributeStoreUpdate());return c}G._inheritsLoose(b,k);var a=b.prototype;a.destroy=function(){this.removeAllChildren();this.children.forEach(f=>f.destroy());this.attributeView.destroy();this._materialItemsRequestQueue.clear()};a.setRendererInfo=function(f,c,h){this._rendererInfo.setInfo(f,c,h);this.requestRender()};
a.getMaterialItems=function(){var f=G._asyncToGenerator(function*(c,h){if(!c||0===c.length)return null;const l=F.createResolver();this._materialItemsRequestQueue.push({items:c,abortOptions:h,resolver:l});this.requestRender();return l.promise});return function(c,h){return f.apply(this,arguments)}}();a.doRender=function(f){f.context.capabilities.enable("textureFloat");f.context.capabilities.enable("vao");if(0<this._materialItemsRequestQueue.length){let c=this._materialItemsRequestQueue.pop();for(;c;)this._processMaterialItemRequest(f,
c),c=this._materialItemsRequestQueue.pop()}k.prototype.doRender.call(this,f)};a.renderChildren=function(f){for(const c of this.children)c.commit(f);this._rendererInfo.update(f.state);k.prototype.renderChildren.call(this,f)};a.createRenderParams=function(f){f=k.prototype.createRenderParams.call(this,f);f.rendererInfo=this._rendererInfo;f.attributeView=this.attributeView;return f};a.onAttributeStoreUpdate=function(){};a._processMaterialItemRequest=function(f,{items:c,abortOptions:h,resolver:l}){const {painter:q,
pixelRatio:e}=f;f=c.map(d=>q.textureManager.rasterizeItem(d.symbol,e,d.glyphIds,h));Promise.all(f).then(d=>{this.stage?(d=d.map((g,m)=>({id:c[m].id,mosaicItem:g})),l.resolve(d)):l.reject()},l.reject)};return b}(v.default);u.FeatureContainer=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/Texture ../../../webgl/VertexArrayObject ./definitions ./DisplayId ./Utils ./util/debug".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e,d,g){const m=y.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),n=g.createDebugLogger(g.DEBUG_ATTR_UPDATES,m);let r=function(){function t(w,B,A){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;const {buffer:x,pixelType:E,textureOnly:D}=w;w=d.getPixelArrayCtor(E);this.shared=A;this.pixelType=E;this.size=B;this.textureOnly=D;D||(this.data=new w(v.unwrap(x)));this._resetRange()}var z=t.prototype;z.destroy=function(){v.andThen(this._texture,
w=>w.dispose());for(const w in this._fbos)v.andThen(this._fbos[w],B=>{"0"===w&&B.detachColorTexture();B.dispose()}),this._fbos[w]=null;this._texture=null};z.setData=function(w,B,A){w=e.getDisplayIdTexel(w);const x=v.unwrap(this.data);B=w*this.texelSize+B;!x||B>=x.length||(x[B]=A,this.dirtyStart=Math.min(this.dirtyStart,w),this.dirtyEnd=Math.max(this.dirtyEnd,w))};z.getData=function(w,B){if(v.isNone(this.data))return null;w=e.getDisplayIdTexel(w)*this.texelSize+B;return!this.data||w>=this.data.length?
null:this.data[w]};z.getTexture=function(w){return v.unwrapOr(this._texture,()=>this._initTexture(w))};z.getFBO=function(w,B=0){if(v.isNone(this._fbos[B])){const A=0===B?this.getTexture(w):this._textureDesc;this._fbos[B]=new b(w,{colorTarget:0,depthStencilTarget:0},A)}return this._fbos[B]};z.updateTexture=function(w,B){if(!this.locked){try{const A=this.dirtyStart,x=this.dirtyEnd;if(!this.hasDirty)return;this._resetRange();const E=v.unwrap(this.data).buffer,D=this.getTexture(w),K=(A-A%this.size)/this.size,
H=(x-x%this.size)/this.size,I=K*this.size*4,J=4*(this.size+H*this.size)-I,M=d.getPixelArrayCtor(this.pixelType),O=new M(E,I*M.BYTES_PER_ELEMENT,J),L=this.size;w=H-K+1;if(w>this.size){m.error(new F("mapview-webgl","Out-of-bounds index when updating AttributeData"));return}D.updateData(0,0,K,L,w,O)}catch(A){}B()}};z.update=function(w){const {data:B,start:A,end:x}=w;if(v.isSome(B)){const E=this.data,D=A*this.texelSize;for(let K=0;K<B.length;K++)w.layout&1<<K%this.texelSize&&(E[D+K]=B[K])}this.dirtyStart=
Math.min(this.dirtyStart,A);this.dirtyEnd=Math.max(this.dirtyEnd,x)};z.resize=function(w,B){const A=this.size;this.size=B;this.textureOnly?A!==this.size&&(this._lastTexture=this._texture,this._texture=null):(B=d.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new B(v.unwrap(w.buffer)))};z._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};z._initTexture=function(w){const B=new h(w,this._textureDesc,v.unwrapOr(this.data,void 0));if(v.isSome(this._lastTexture)&&this._fbos[0]){const E=
this._lastTexture.descriptor.width,D=this._lastTexture.descriptor.height,K=this._lastTexture.descriptor.dataType,H=this._lastTexture.descriptor.pixelFormat,I=this.getFBO(w);var A=d.getPixelBytes(K),x=d.getPixelArrayCtor(K);A=new ArrayBuffer(E*D*A*this.texelSize);x=new x(A);A=w.getBoundFramebufferObject();const {x:J,y:M,width:O,height:L}=w.getViewport();w.bindFramebuffer(I);I.readPixels(0,0,E,D,H,K,x);B.updateData(0,0,0,2*E,D/2,x);w.setViewport(J,M,O,L);w.bindFramebuffer(A)}this.destroy();return this._texture=
B};G._createClass(t,[{key:"_textureDesc",get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}}},{key:"locked",get:function(){return 5121===this.pixelType&&this.shared&&!this.textureOnly&&C("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1}},{key:"hasDirty",get:function(){return this.dirtyEnd>=this.dirtyStart}}]);return t}();y=function(){function t(w){this._onUpdate=w;this._locked=this._forceNextUpload=
this._initialized=!1}var z=t.prototype;z.initialize=function(w){const {blocks:B,shared:A,size:x}=w;this.shared=A;this.size=x;n("Initializing AttributeStoreView",w);if(v.isNone(this._data))this._data=v.mapMany(B,E=>new r(E,x,A));else for(w=0;w<this._data.length;w++){const E=this._data[w],D=B[w];v.isSome(D)&&(v.isNone(E)?this._data[w]=new r(D,x,A):E.resize(D,x))}this._initialized=!0};z.destroy=function(){v.andThen(this._data,w=>v.mapMany(w,B=>B.destroy()));v.andThen(this._defaultTexture,w=>w.dispose())};
z.isEmpty=function(){return v.isNone(this._data)};z.isUpdating=function(){const w=v.isSome(this._pendingAttributeUpdate);C("esri-2d-log-updating")&&console.log(`Updating AttributeStoreView ${w}\n  -> hasPendingUpdate ${w}`);return w};z.getBlock=function(w){return v.isNone(this._data)?null:this._data[w]};z.setLabelMinZoom=function(w,B){this.setData(w,0,1,B)};z.getLabelMinZoom=function(w){return this.getData(w,0,1,255)};z.getFilterFlags=function(w){return this.getData(w,0,0,0)};z.getVVSize=function(w){return this.getData(w,
q.ATTRIBUTE_DATA_VV,0,0)};z.getData=function(w,B,A,x){if(!this._data)return 0;B=v.unwrap(this._data)[B];if(v.isNone(B))return 0;w=B.getData(w,A);return v.isSome(w)?w:x};z.setData=function(w,B,A,x){B=v.unwrap(this._data)[B];v.unwrap(B).setData(w,A,x)};z.lockTextureUpload=function(){this._locked=!0};z.unlockTextureUpload=function(){this._locked=!1};z.forceTextureUpload=function(){this._forceNextUpload=!0};z.requestUpdate=function(){var w=G._asyncToGenerator(function*(B){if(this._pendingAttributeUpdate)m.error(new F("mapview-webgl",
"Tried to update attribute data with a pending update"));else{var A=p.createResolver();n("AttributeStoreView Update Requested",B);this._pendingAttributeUpdate={data:B,resolver:A};return A.promise}});return function(B){return w.apply(this,arguments)}}();z.update=function(){if(this._initialized&&v.isSome(this._pendingAttributeUpdate)){const {data:w,resolver:B}=this._pendingAttributeUpdate,A=v.unwrap(this._data);for(let x=0;x<w.blocks.length;x++){const E=w.blocks[x];v.andThen(A[x],D=>v.andThen(E,K=>
{n(`Updating block ${x}`,K);D.update(K)}))}this._pendingAttributeUpdate=null;B();this._onUpdate()}};z.bindTextures=function(w,B=!0){this.update();const A=this._getDefaultTexture(w);if(this._initialized){var x=v.unwrap(this._data);if(!this._locked||this._forceNextUpload)v.forEachSome(x,E=>E.updateTexture(w,()=>this._onUpdate())),this._forceNextUpload=!1;w.bindTexture(v.mapOr(x[0],A,E=>E.getTexture(w)),q.TEXTURE_BINDING_ATTRIBUTE_DATA_0);B&&(w.bindTexture(v.mapOr(x[1],A,E=>E.getTexture(w)),q.TEXTURE_BINDING_ATTRIBUTE_DATA_1),
w.bindTexture(v.mapOr(x[2],A,E=>E.getTexture(w)),q.TEXTURE_BINDING_ATTRIBUTE_DATA_2),w.bindTexture(v.mapOr(x[3],A,E=>E.getTexture(w)),q.TEXTURE_BINDING_ATTRIBUTE_DATA_3))}else w.bindTexture(A,q.TEXTURE_BINDING_ATTRIBUTE_DATA_0),B&&(w.bindTexture(A,q.TEXTURE_BINDING_ATTRIBUTE_DATA_1),w.bindTexture(A,q.TEXTURE_BINDING_ATTRIBUTE_DATA_2),w.bindTexture(A,q.TEXTURE_BINDING_ATTRIBUTE_DATA_3))};z._getDefaultTexture=function(w){v.isNone(this._defaultTexture)&&(this._defaultTexture=new h(w,{wrapMode:33071,
pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return t}();u.AttributeStoreView=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileContainer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(u,G,F,C,y,v,p){const k=(b,a)=>0!==b.key.level-a.key.level?b.key.level-
a.key.level:0!==b.key.row-a.key.row?b.key.row-a.key.row:b.key.col-a.key.col;y=function(b){function a(c){var h=b.call(this)||this;h._tileInfoView=c;return h}G._inheritsLoose(a,b);var f=a.prototype;f.renderChildren=function(c){this.sortChildren(k);this.setStencilReference();b.prototype.renderChildren.call(this,c)};f.createRenderParams=function(c){const {state:h}=c;c=b.prototype.createRenderParams.call(this,c);c.requiredLevel=this._tileInfoView.getClosestInfoForScale(h.scale).level;c.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(h.scale);
return c};f.prepareRenderPasses=function(c){const h=b.prototype.prepareRenderPasses.call(this,c);h.push(c.registerRenderPass({name:"stencil",brushes:[p],drawPhase:C.WGLDrawPhase.DEBUG|C.WGLDrawPhase.MAP|C.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()}));F("esri-tiles-debug")&&h.push(c.registerRenderPass({name:"tileInfo",brushes:[v],drawPhase:C.WGLDrawPhase.DEBUG,target:()=>this.children}));return h};f.getStencilTarget=function(){return this.children};f.updateTransforms=function(c){for(const h of this.children){const l=
this._tileInfoView.getTileResolution(h.key);h.setTransform(c,l)}};f.setStencilReference=function(){let c=1;for(const h of this.children)h.stencilRef=c++};G._createClass(a,[{key:"requiresDedicatedFBO",get:function(){return!1}}]);return a}(y);u.default=y;u.sortByLevel=k;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../chunks/mat3f32 ../brushes ../Container ./ClippingInfo ./enums".split(" "),
function(u,G,F,C,y,v,p,k){return function(b){function a(){var c=b.apply(this,arguments)||this;c.name=c.constructor.name;return c}u._inheritsLoose(a,b);var f=a.prototype;f._createTransforms=function(){return{dvs:C.create()}};f.doRender=function(c){const h=this.createRenderParams(c),{painter:l,globalOpacity:q,profiler:e,drawPhase:d}=h,g=d===k.WGLDrawPhase.LABEL||d===k.WGLDrawPhase.HIGHLIGHT?1:q*this.computedOpacity;e.recordContainerStart(this.name);l.beforeRenderLayer(h,this._clippingInfos?255:0,g);
this.updateTransforms(c.state);this.renderChildren(h);l.compositeLayer(h,g);e.recordContainerEnd()};f.renderChildren=function(c){F.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(c.painter));for(const h of this.children)h.beforeRender(c);for(const h of this._renderPasses)try{h.render(c)}catch(l){}for(const h of this.children)h.afterRender(c)};f.createRenderParams=function(c){c.requireFBO=this.requiresDedicatedFBO;return c};f.prepareRenderPasses=function(c){return[c.registerRenderPass({name:"clip",
brushes:[y.brushes.clip],target:()=>this._clippingInfos,drawPhase:k.WGLDrawPhase.MAP|k.WGLDrawPhase.LABEL|k.WGLDrawPhase.LABEL_ALPHA|k.WGLDrawPhase.DEBUG|k.WGLDrawPhase.HIGHLIGHT})]};f.updateTransforms=function(c){for(const h of this.children)h.setTransform(c)};f.onAttach=function(){b.prototype.onAttach.call(this);this._updateClippingInfo()};f.onDetach=function(){b.prototype.onDetach.call(this);this._updateClippingInfo()};f._updateClippingInfo=function(){F.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(h=>
h.destroy()),this._clippingInfos=null);if(this.stage){var c=this._clips;F.isSome(c)&&c.length&&(this._clippingInfos=c.items.map(h=>p.fromClipArea(this.stage,h)));this.requestRender()}};u._createClass(a,[{key:"clips",set:function(c){this._clips=c;this.children.forEach(h=>h.clips=c);this._updateClippingInfo()}}]);return a}(v.Container)})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../chunks/mat3f32 ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),
function(u,G,F,C,y,v,p,k){const b=F.getLogger("esri.views.2d.engine.webgl.ClippingInfo");return function(a){function f(h,l){var q=a.call(this)||this;q._clip=l;q._cache={};q.stage=h;q._handle=l.watch("version",()=>q._invalidate());q.ready();return q}u._inheritsLoose(f,a);f.fromClipArea=function(h,l){return new f(h,l)};var c=f.prototype;c._destroyGL=function(){C.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);C.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=
null)};c.destroy=function(){this._destroyGL();this._handle.remove()};c.getVAO=function(h,l,q,e){const [d,g]=l.size;if("geometry"===this._clip.type||this._lastWidth!==d||this._lastHeight!==g)this._lastWidth=d,this._lastHeight=g,this._destroyGL();if(C.isNone(this._cache.vao)){l=this._createMesh(l,this._clip);const m=l.getIndexBuffer(h),n=l.getVertexBuffers(h);this._cache.mesh=l;this._cache.vao=new k(h,q,e,n,m)}return this._cache.vao};c._createTransforms=function(){return{dvs:y.create()}};c._invalidate=
function(){this._destroyGL();this.requestRender()};c._createScreenRect=function(h,l){const [q,e]=h.size;h="string"===typeof l.left?parseFloat(l.left)/100*q:l.left;const d="string"===typeof l.right?parseFloat(l.right)/100*q:l.right,g="string"===typeof l.top?parseFloat(l.top)/100*e:l.top;l="string"===typeof l.bottom?parseFloat(l.bottom)/100*e:l.bottom;return{x:h,y:g,width:Math.max(q-d-h,0),height:Math.max(e-l-g,0)}};c._createMesh=function(h,l){switch(l.type){case "rect":return p.fromRect(this._createScreenRect(h,
l));case "path":return p.fromPath(l);case "geometry":return p.fromGeometry(h,l);default:return b.error(new G("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),p.fromRect({x:0,y:0,width:1,height:1})}};return f}(v.DisplayObject)})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../chunks/earcut ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f){const c=F.getLogger("esri.views.2d.engine.webgl.Mesh2D"),h=({coords:l,lengths:q},e)=>{const d=[];for(let n=0,r=0;n<q.length;r+=q[n],n+=1){const t=r;for(var g=[];n<q.length-1;n+=1,r+=q[n]){{var m=r+q[n];let z=0;for(let w=1;w<q[n+1];w++)z+=(l[2*(m+w)]-l[2*(m+w-1)])*(l[2*(m+w)+1]+l[2*(m+w-1)+1]);m=e?0<z:0>z}if(!m)break;g.push(r+q[n]-t)}m=l.slice(2*t,2*(r+q[n]));g=y.earcut(m,g,2);for(const z of g)d.push(z+t)}return d};return function(){function l(e,d,g,m=!1){this._cache=
{};this.vertices=e;this.indices=d;this.primitiveType=g;this.isMapSpace=m}l.fromRect=function({x:e,y:d,width:g,height:m}){return l.fromScreenExtent({xmin:e,ymin:d,xmax:e+g,ymax:d+m})};l.fromPath=function(e){var d=k.convertFromNestedArray(new b,e.path,!1,!1);e=d.coords;d=new Uint32Array(h(d,!0));const g=new Uint32Array(e.length/2);for(let m=0;m<g.length;m++)g[m]=a.i1616to32(Math.floor(e[2*m]),Math.floor(e[2*m+1]));return new l({geometry:g},d,4)};l.fromGeometry=function(e,d){const g=d.geometry.type;
switch(g){case "polygon":return l.fromPolygon(e,d.geometry);case "extent":return l.fromMapExtent(e,d.geometry);default:return c.error(new G("mapview-bad-type",`Unable to create a mesh from type ${g}`,d)),l.fromRect({x:0,y:0,width:1,height:1})}};l.fromPolygon=function(e,d){var g=k.convertFromPolygon(new b,d,!1,!1);d=g.coords;g=new Uint32Array(h(g,!1));const m=new Uint32Array(d.length/2),n=p.create(),r=p.create();for(let t=0;t<m.length;t++)v.set(n,d[2*t],d[2*t+1]),e.toScreen(r,n),m[t]=a.i1616to32(Math.floor(r[0]),
Math.floor(r[1]));return new l({geometry:m},g,4,!0)};l.fromScreenExtent=function({xmin:e,xmax:d,ymin:g,ymax:m}){e={geometry:new Uint32Array([a.i1616to32(e,g),a.i1616to32(d,g),a.i1616to32(e,m),a.i1616to32(e,m),a.i1616to32(d,g),a.i1616to32(d,m)])};d=new Uint32Array([0,1,2,3,4,5]);return new l(e,d,4)};l.fromMapExtent=function(e,d){const [g,m]=e.toScreen([0,0],[d.xmin,d.ymin]),[n,r]=e.toScreen([0,0],[d.xmax,d.ymax]);e={geometry:new Uint32Array([a.i1616to32(g,m),a.i1616to32(n,m),a.i1616to32(g,r),a.i1616to32(g,
r),a.i1616to32(n,m),a.i1616to32(n,r)])};d=new Uint32Array([0,1,2,3,4,5]);return new l(e,d,4)};var q=l.prototype;q.destroy=function(){C.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const e in this._cache.vertexBuffers)C.isSome(this._cache.vertexBuffers[e])&&this._cache.vertexBuffers[e].dispose()};q.getIndexBuffer=function(e,d=35044){this._cache.indexBuffer||(this._cache.indexBuffer=f.createIndex(e,d,this.indices));return this._cache.indexBuffer};q.getVertexBuffers=function(e,
d=35044){this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((g,m)=>({...g,[m]:f.createVertex(e,d,this.vertices[m])}),{}));return this._cache.vertexBuffers};u._createClass(l,[{key:"elementType",get:function(){a:switch(this.indices.BYTES_PER_ELEMENT){case 1:var e=5121;break a;case 2:e=5123;break a;case 4:e=5125;break a;default:throw new G("Cannot get DataType of array");}return e}}]);return l}()})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../Color ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../renderers/support/lengthUtils ./definitions ./Utils ../../../webgl/capabilities".split(" "),
function(u,G,F,C,y,v,p,k,b,a){function f(l,q){const e=q.length;if(l<q[0].value||1===e)return q[0].size;for(let d=1;d<e;d++)if(l<q[d].value)return q[d-1].size+(l-q[d-1].value)/(q[d].value-q[d-1].value)*(q[d].size-q[d-1].size);return q[e-1].size}function c(l,q,e=0){if(C.isNone(q))l[e+0]=0,l[e+1]=0,l[e+2]=0,l[e+3]=0;else{var {r:d,g,b:m,a:n}=q;l[e+0]=d*n/255;l[e+1]=g*n/255;l[e+2]=m*n/255;l[e+3]=n}}let h=function(){function l(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=
new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1}}var q=l.prototype;q.getSizeVVFieldStops=function(e){const d=this._vvSizeFieldStops;switch(d.type){case "static":return d;
case "level-dependent":return C.unwrapOr(d.levels[e],()=>{var g=Infinity,m=0;for(var n in d.levels){const r=parseFloat(n),t=Math.abs(e-r);t<g&&(g=t,m=r)}if(Infinity===g)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};g=2**((e-m)/2);m=C.unwrap(d.levels[m]);n=new Float32Array(m.values);n[2]*=g;n[3]*=g;return{sizes:C.unwrap(m.sizes),values:n}})}};q.update=function(e){C.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,e)};q.setInfo=function(e,
d,g){this._updateEffects(g);this._vvInfo=d;switch(e.type){case "dot-density":this._updateDotDensityInfo(e)}};q.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,oesTextureFloat:a().supportsTextureFloat}};q.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1};q._updateEffects=function(e){C.isSome(e)?this.outsideLabelsVisible=e.excludedLabelsVisible:this.outsideLabelsVisible=!1};q._updateVisualVariables=
function(e,d){const g=this._vvMaterialParameters;g.vvOpacityEnabled=!1;g.vvSizeEnabled=!1;g.vvColorEnabled=!1;g.vvRotationEnabled=!1;if(e){var m=e.size;if(m){g.vvSizeEnabled=!0;if(m.minMaxValue){const r=m.minMaxValue;let t;if(b.isDefined(r.minSize)&&b.isDefined(r.maxSize))if(b.isNumber(r.minSize)&&b.isNumber(r.maxSize)){t=y.pt2px(r.minSize);var n=y.pt2px(r.maxSize)}else n=d.scale,t=y.pt2px(f(n,r.minSize.stops)),n=y.pt2px(f(n,r.maxSize.stops));this.vvSizeMinMaxValue.set([r.minDataValue,r.maxDataValue,
t,n])}m.scaleStops&&(this.vvSizeScaleStopsValue=y.pt2px(f(d.scale,m.scaleStops.stops)));m.unitValue&&(this.vvSizeUnitValueToPixelsRatio=v.getMetersPerUnitForSR(d.spatialReference)/p.meterIn[m.unitValue.unit]/d.resolution);m.fieldStops&&(this._vvSizeFieldStops=m.fieldStops)}if(d=e.color)g.vvColorEnabled=!0,this.vvColorValues.set(d.values),this.vvColors.set(d.colors);if(d=e.opacity)g.vvOpacityEnabled=!0,this.vvOpacityValues.set(d.values),this.vvOpacities.set(d.opacities);if(e=e.rotation)g.vvRotationEnabled=
!0,g.vvRotationType=e.type}};q._updateDotDensityInfo=function(e){var d=e.attributes;this.ddDotValue=e.dotValue;this.ddDotScale=e.referenceScale;this.ddDotSize=e.dotSize;this.ddDotBlending=e.dotBlendingEnabled;this.ddSeed=e.seed;for(let g=0;g<k.DOT_DENSITY_MAX_FIELDS;g++){const m=g>=d.length?new F([0,0,0,0]):d[g].color;c(this.ddColors,m,4*g)}for(d=0;8>d;d++)this.ddActiveDots[d]=d<e.attributes.length?1:0;c(this.ddBackgroundColor,e.backgroundColor)};G._createClass(l,[{key:"vvMaterialParameters",get:function(){return this._vvMaterialParameters}}]);
return l}();u.WGLRendererInfo=h;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicBoundsRenderer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f32 ../../../../chunks/vec3f32 ../../../../geometry/support/normalizeUtils ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/enums ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../engine/DisplayObject ../../engine/webgl/Utils".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l){const q=Math.PI/180,e=()=>l.createProgramDescriptor("bounds",{geometry:[{location:0,name:"a_position",count:2,type:5126}]});return function(d){function g(n){var r=d.call(this)||this;r._dvsMat3=F.create();r._localOrigin={x:0,y:0};r._getBounds=n;return r}u._inheritsLoose(g,d);var m=g.prototype;m.destroy=function(){this._vao&&(this._vao.dispose(!0),this._indexBuffer=this._vertexBuffer=this._vao=null);this._program&&(this._program.dispose(),this._program=null)};m.doRender=
function(n){const {context:r}=n,t=this._getBounds();1>t.length||(this._createShaderProgram(r),this._updateMatricesAndLocalOrigin(n),this._updateBufferData(r,t),r.setBlendingEnabled(!0),r.setDepthTestEnabled(!1),r.setStencilWriteMask(0),r.setStencilTestEnabled(!1),r.setBlendFunction(1,771),r.setColorMask(!0,!0,!0,!0),n=this._program,r.bindVAO(this._vao),r.useProgram(n),n.setUniformMatrix3fv("u_dvsMat3",this._dvsMat3),r.gl.lineWidth(1),r.drawElements(1,8*t.length,5125,0),r.bindVAO())};m._createTransforms=
function(){return{dvs:F.create()}};m._createShaderProgram=function(n){this._program||(this._program=new b.Program(n,"precision highp float;\n        uniform mat3 u_dvsMat3;\n\n        attribute vec2 a_position;\n\n        void main() {\n          mediump vec3 pos \x3d u_dvsMat3 * vec3(a_position, 1.0);\n          gl_Position \x3d vec4(pos.xy, 0.0, 1.0);\n        }","precision mediump float;\n      void main() {\n        gl_FragColor \x3d vec4(0.75, 0.0, 0.0, 0.75);\n      }",e().attributes))};m._updateMatricesAndLocalOrigin=
function(n){var {state:r}=n;const {displayMat3:t,size:z,resolution:w,pixelRatio:B,rotation:A,viewpoint:x}=r;n=q*A;const {x:E,y:D}=x.targetGeometry;r=v.normalizeMapX(E,r.spatialReference);this._localOrigin.x=r;this._localOrigin.y=D;r=B*z[0];const K=B*z[1],H=w*r,I=w*K,J=G.identity(this._dvsMat3);G.multiply(J,J,t);G.translate(J,J,C.fromValues(r/2,K/2));G.scale(J,J,y.fromValues(z[0]/H,-K/I,1));G.rotate(J,J,-n)};m._updateBufferData=function(n,r){const {x:t,y:z}=this._localOrigin,w=new Float32Array(8*r.length),
B=new Uint32Array(8*r.length);let A=0,x=0;for(const E of r)E&&(w[2*A]=E[0]-t,w[2*A+1]=E[1]-z,w[2*A+2]=E[0]-t,w[2*A+3]=E[3]-z,w[2*A+4]=E[2]-t,w[2*A+5]=E[3]-z,w[2*A+6]=E[2]-t,w[2*A+7]=E[1]-z,B[x+0]=A+0,B[x+1]=A+3,B[x+2]=A+3,B[x+3]=A+2,B[x+4]=A+2,B[x+5]=A+1,B[x+6]=A+1,B[x+7]=A+0,A+=4,x+=8);this._vertexBuffer?this._vertexBuffer.setData(w.buffer):this._vertexBuffer=p.createVertex(n,35048,w.buffer);this._indexBuffer?this._indexBuffer.setData(B):this._indexBuffer=p.createIndex(n,35048,B);this._vao||(r=e(),
this._vao=new c(n,r.attributes,r.bufferLayouts,{geometry:this._vertexBuffer},this._indexBuffer))};return g}(h.DisplayObject)})},"esri/chunks/vec3f32":function(){define(["exports"],function(u){function G(){return new Float32Array(3)}function F(d){const g=new Float32Array(3);g[0]=d[0];g[1]=d[1];g[2]=d[2];return g}function C(d,g,m){const n=new Float32Array(3);n[0]=d;n[1]=g;n[2]=m;return n}function y(d,g){return new Float32Array(d,g,3)}function v(){return G()}function p(){return C(1,1,1)}function k(){return C(1,
0,0)}function b(){return C(0,1,0)}function a(){return C(0,0,1)}const f=G(),c=p(),h=k(),l=b(),q=a(),e=Object.freeze({__proto__:null,create:G,clone:F,fromValues:C,createView:y,zeros:v,ones:p,unitX:k,unitY:b,unitZ:a,ZEROS:f,ONES:c,UNIT_X:h,UNIT_Y:l,UNIT_Z:q});u.ONES=c;u.UNIT_X=h;u.UNIT_Y=l;u.UNIT_Z=q;u.ZEROS=f;u.clone=F;u.create=G;u.createView=y;u.fromValues=C;u.ones=p;u.unitX=k;u.unitY=b;u.unitZ=a;u.vec3f32=e;u.zeros=v})},"esri/views/2d/navigation/MapViewNavigation":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Viewpoint ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../geometry/Point ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q){const e=new F({targetGeometry:new a}),d=[0,0];F=function(g){function m(r){r=g.call(this,r)||this;r._endTimer=null;r.animationManager=null;return r}u._inheritsLoose(m,g);var n=m.prototype;n.initialize=function(){this.pan=new h({navigation:this});this.rotate=new q({navigation:this});this.pinch=new l({navigation:this});this.zoomBox=new c({view:this.view,navigation:this})};n.destroy=function(){this.zoomBox.destroy();this.animationManager=this.zoomBox=null};n.begin=
function(){this._set("interacting",!0)};n.end=function(){this._lastEventTimestamp=performance.now();this._startTimer(250)};n.zoom=function(){var r=u._asyncToGenerator(function*(t,z=this._getDefaultAnchor()){this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>t?this.zoomIn(z):this.zoomOut(z);this.setViewpoint(z,t,0,[0,0])});return function(t){return r.apply(this,arguments)}}();n.zoomIn=function(){var r=u._asyncToGenerator(function*(t){var z=this.view;
z=z.constraints.snapToNextScale(z.scale);return this._zoomToScale(z,t)});return function(t){return r.apply(this,arguments)}}();n.zoomOut=function(){var r=u._asyncToGenerator(function*(t){var z=this.view;z=z.constraints.snapToPreviousScale(z.scale);return this._zoomToScale(z,t)});return function(t){return r.apply(this,arguments)}}();n.setViewpoint=function(r,t,z,w){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,r,t,z,w);this.end()};n.setViewpointImmediate=
function(r,t=0,z=[0,0],w=this._getDefaultAnchor()){this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,w,r,t,z)};n.continousRotateClockwise=function(){const r=this.get("view.viewpoint");this.animationManager.animateContinous(r,t=>{f.rotateBy(t,t,-1)})};n.continousRotateCounterclockwise=function(){const r=this.get("view.viewpoint");this.animationManager.animateContinous(r,t=>{f.rotateBy(t,t,1)})};n.resetRotation=function(){this.view.rotation=0};n.continousPanLeft=function(){this._continuousPan([-10,
0])};n.continousPanRight=function(){this._continuousPan([10,0])};n.continousPanUp=function(){this._continuousPan([0,10])};n.continousPanDown=function(){this._continuousPan([0,-10])};n.stop=function(){this.pan.stopMomentumNavigation();this.animationManager.stop();this.end();null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))};n._continuousPan=function(r){const t=this.get("view.viewpoint");this.animationManager.animateContinous(t,z=>{f.translateBy(z,
z,r);this.view.constraints.constrainByGeometry(z)})};n._startTimer=function(r){return null!==this._endTimer?this._endTimer:this._endTimer=setTimeout(()=>{this._endTimer=null;const t=performance.now()-this._lastEventTimestamp;250>t?this._endTimer=this._startTimer(t):this._set("interacting",!1)},r)};n._getDefaultAnchor=function(){const {size:r,padding:{left:t,right:z,top:w,bottom:B}}=this.view;d[0]=.5*(r[0]-z+t);d[1]=.5*(r[1]-B+w);return d};n._zoomToScale=function(){var r=u._asyncToGenerator(function*(t,
z=this._getDefaultAnchor()){const {view:w}=this,{constraints:B,scale:A,viewpoint:x,size:E,padding:D}=w,K=B.canZoomInTo(t),H=B.canZoomOutTo(t);if(!(t<A&&!K||t>A&&!H))return f.padAndScaleAndRotateBy(e,x,t/A,0,z,E,D),B.constrainByGeometry(e),w.goTo(e,{animate:!0})});return function(t){return r.apply(this,arguments)}}();n._scaleRotateTranslateViewpoint=function(r,t,z,w,B){var {view:A}=this;const {size:x,padding:E,constraints:D,scale:K,viewpoint:H}=A;var I=K*z;A=D.canZoomInTo(I);I=D.canZoomOutTo(I);if(1>
z&&!A||1<z&&!I)z=1;f.translateBy(H,H,B);f.padAndScaleAndRotateBy(r,H,z,w,t,x,E);return D.constrainByGeometry(r)};return m}(C);G.__decorate([y.property()],F.prototype,"animationManager",void 0);G.__decorate([y.property({type:Boolean,readOnly:!0})],F.prototype,"interacting",void 0);G.__decorate([y.property()],F.prototype,"pan",void 0);G.__decorate([y.property()],F.prototype,"pinch",void 0);G.__decorate([y.property()],F.prototype,"rotate",void 0);G.__decorate([y.property()],F.prototype,"view",void 0);
G.__decorate([y.property()],F.prototype,"zoomBox",void 0);return F=G.__decorate([b.subclass("esri.views.2d.navigation.MapViewNavigation")],F)})},"esri/views/2d/navigation/ZoomBox":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../input/InputManager".split(" "),
function(u,G,F,C,y,v,p,k,b,a){F=function(f){function c(l){l=f.call(this,l)||this;l._container=null;l._overlay=null;l._backgroundShape=null;l._boxShape=null;l._box={x:0,y:0,width:0,height:0};l._redraw=l._redraw.bind(u._assertThisInitialized(l));return l}u._inheritsLoose(c,f);var h=c.prototype;h.destroy=function(){this.view=null};h._start=function(){this._createContainer();this._createOverlay();this.navigation.begin()};h._update=function(l,q,e,d){this._box.x=l;this._box.y=q;this._box.width=e;this._box.height=
d;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};h._end=function(l,q,e,d,g){const m=this.view;l=m.toMap(C.createScreenPoint(l+.5*e,q+.5*d));e=Math.max(e/m.width,d/m.height);-1===g&&(e=1/e);this._destroyOverlay();this.navigation.end();m.goTo({center:l,scale:m.scale*e})};h._updateBox=function(l,q,e,d){const g=this._boxShape;g.setAttributeNS(null,"x",""+l);g.setAttributeNS(null,"y",""+q);g.setAttributeNS(null,"width",""+e);g.setAttributeNS(null,"height",""+d);g.setAttributeNS(null,"class",
"esri-zoom-box__outline")};h._updateBackground=function(l,q,e,d){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(l,q,e,d,this.view.width,this.view.height))};h._createContainer=function(){const l=document.createElement("div");l.className="esri-zoom-box__container";this.view.root.appendChild(l);this._container=l};h._createOverlay=function(){var l=this.view.width,q=this.view.height;const e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttributeNS(null,"d","M 0 0 L "+
l+" 0 L "+l+" "+q+" L 0 "+q+" Z");e.setAttributeNS(null,"class","esri-zoom-box__overlay-background");l=document.createElementNS("http://www.w3.org/2000/svg","rect");q=document.createElementNS("http://www.w3.org/2000/svg","svg");q.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");q.setAttributeNS(null,"class","esri-zoom-box__overlay");q.appendChild(e);q.appendChild(l);this._container.appendChild(q);this._backgroundShape=e;this._boxShape=l;this._overlay=q};
h._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};h._toSVGPath=function(l,q,e,d,g,m){e=l+e;d=q+d;return"M 0 0 L "+g+" 0 L "+g+" "+m+" L 0 "+m+" ZM "+l+" "+q+" L "+l+" "+d+" L "+e+" "+d+" L "+e+" "+q+" Z"};h._handleDrag=function(l,q){var e=l.x,d=l.y,g=l.origin.x;const m=l.origin.y;let n;e>g?(n=g,g=e-g):(n=e,g-=e);d>m?(e=m,d-=m):(e=d,d=m-d);switch(l.action){case "start":this._start();
break;case "update":this._update(n,e,g,d);break;case "end":this._end(n,e,g,d,q)}l.stopPropagation()};h._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var {x:l,y:q,width:e,height:d}=this._box;this._updateBox(l,q,e,d);this._updateBackground(l,q,e,d);this._rafId=requestAnimationFrame(this._redraw)}};u._createClass(c,[{key:"view",set:function(l){this._handles&&this._handles.forEach(q=>{q.remove()});this._handles=null;this._destroyOverlay();this._set("view",l);l&&(l.on("drag",["Shift"],
q=>this._handleDrag(q,1),a.ViewEventPriorities.INTERNAL),l.on("drag",["Shift","Ctrl"],q=>this._handleDrag(q,-1),a.ViewEventPriorities.INTERNAL))}}]);return c}(F);G.__decorate([y.property()],F.prototype,"navigation",void 0);G.__decorate([y.property()],F.prototype,"view",null);return F=G.__decorate([b.subclass("esri.views.2d.navigation.ZoomBox")],F)})},"esri/views/2d/navigation/actions/Pan":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../viewpointUtils ../../../navigation/PanPlanarMomentumEstimator ../../../../geometry/Point".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e){F=function(d){function g(n){var r=d.call(this,n)||this;r.animationTime=0;r.momentumEstimator=new q.PanPlanarMomentumEstimator(500,6,.92);r.momentum=null;r.tmpMomentum=h.create();r.momentumFinished=!1;r.viewpoint=new C({targetGeometry:new e,scale:0,rotation:0});r.watch("momentumFinished",t=>{t&&r.navigation.stop()});return r}u._inheritsLoose(g,d);var m=g.prototype;m.begin=function(n,r){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(r);
this.previousDrag=r};m.update=function(n,r){this.addToEstimator(r);let t=r.center.x,z=r.center.y;const w=this.previousDrag;t=w?w.center.x-t:-t;z=w?z-w.center.y:z;n.viewpoint=l.translateBy(this.viewpoint,n.viewpoint,[t||0,z||0]);this.previousDrag=r};m.end=function(n,r){this.addToEstimator(r);this.momentum=n.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null;this.animationTime=0;if(this.momentum)this.onAnimationUpdate(n);this.previousDrag=null;this.navigation.end()};m.addToEstimator=
function(n){var r=n.center.x;const t=n.center.y,z=v.createScreenPointArray(-r,t);r=h.fromValues(-r,t,0);this.momentumEstimator.add(z,r,.001*n.timestamp)};m.onAnimationUpdate=function(n){this.navigation.animationManager.animateContinous(n.viewpoint,(r,t)=>{this.momentumFinished=!this.momentum||this.momentum.isFinished(this.animationTime);t*=.001;if(!this.momentumFinished){const z=this.momentum.valueDelta(this.animationTime,t);c.scale(this.tmpMomentum,this.momentum.direction,z);l.translateBy(r,r,this.tmpMomentum);
n.constraints.constrainByGeometry(r)}this.animationTime+=t})};m.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};return g}(y);G.__decorate([p.property()],F.prototype,"momentumFinished",void 0);G.__decorate([p.property()],F.prototype,"viewpoint",void 0);G.__decorate([p.property()],F.prototype,"navigation",void 0);return F=G.__decorate([f.subclass("esri.views.2d.navigation.actions.Pan")],F)})},"esri/views/navigation/PanPlanarMomentumEstimator":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/vec3 ../../chunks/vec3f64 ./FilteredFiniteDifference ./Momentum".split(" "),
function(u,G,F,C,y,v){let p=function(k){function b(a,f,c,h,l){a=k.call(this,a,f,c)||this;a.sceneVelocity=h;a.direction=l;return a}G._inheritsLoose(b,k);b.prototype.value=function(a){return k.prototype.valueFromInitialVelocity.call(this,this.sceneVelocity,a)};return b}(v.Momentum);v=function(){function k(a=300,f=12,c=.84){this.minimumInitialVelocity=a;this.stopVelocity=f;this.friction=c;this.enabled=!0;this.time=new y.FilteredFiniteDifference(.6);this.screen=[new y.FilteredFiniteDifference(.4),new y.FilteredFiniteDifference(.4)];
this.scene=[new y.FilteredFiniteDifference(.6),new y.FilteredFiniteDifference(.6),new y.FilteredFiniteDifference(.6)];this.tmpDirection=C.create()}var b=k.prototype;b.add=function(a,f,c){!this.enabled||this.time.hasLastValue&&.015>this.time.computeDelta(c)||(this.screen[0].update(a[0]),this.screen[1].update(a[1]),this.scene[0].update(f[0]),this.scene[1].update(f[1]),this.scene[2].update(f[2]),this.time.update(c))};b.reset=function(){this.screen[0].reset();this.screen[1].reset();this.scene[0].reset();
this.scene[1].reset();this.scene[2].reset();this.time.reset()};b.evaluateMomentum=function(){if(!this.enabled||!this.screen[0].hasFilteredDelta)return null;var a=this.screen[0].filteredDelta;const f=this.screen[1].filteredDelta;a=Math.sqrt(a*a+f*f)/this.time.filteredDelta;return Math.abs(a)<this.minimumInitialVelocity?null:this.createMomentum(a,this.stopVelocity,this.friction)};b.createMomentum=function(a,f,c){F.set(this.tmpDirection,this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta);
const h=F.length(this.tmpDirection);0<h&&F.scale(this.tmpDirection,this.tmpDirection,1/h);return new p(a,f,c,h/this.time.filteredDelta,this.tmpDirection)};return k}();u.PanPlanarMomentum=p;u.PanPlanarMomentumEstimator=v;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/navigation/FilteredFiniteDifference":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(u,G){let F=function(){function C(v){this.gain=v}var y=C.prototype;y.update=function(v){if(this.hasLastValue){const p=
this.computeDelta(v);this.updateDelta(p)}this.lastValue=v};y.reset=function(){this.filteredDelta=this.lastValue=void 0};y.computeDelta=function(v){return v-this.lastValue};y.updateDelta=function(v){this.filteredDelta=this.hasFilteredDelta?(1-this.gain)*this.filteredDelta+this.gain*v:v};G._createClass(C,[{key:"hasLastValue",get:function(){return void 0!==this.lastValue}},{key:"hasFilteredDelta",get:function(){return void 0!==this.filteredDelta}}]);return C}();u.FilteredFiniteDifference=F;Object.defineProperty(u,
"__esModule",{value:!0})})},"esri/views/navigation/Momentum":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(u,G){let F=function(){function C(v,p,k){this._initialVelocity=v;this._stopVelocity=p;this._friction=k;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}var y=C.prototype;y.isFinished=function(v){return v>this.duration};y.value=function(v){return this.valueFromInitialVelocity(this._initialVelocity,
v)};y.valueDelta=function(v,p){const k=this.value(v);return this.value(v+p)-k};y.valueFromInitialVelocity=function(v,p){p=Math.min(p,this.duration);const k=1-this.friction;return v*(k**p-1)/Math.log(k)};G._createClass(C,[{key:"duration",get:function(){return this._duration}},{key:"friction",get:function(){return this._friction}}]);return C}();u.Momentum=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/navigation/actions/Pinch":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../navigation/RotationMomentumEstimator ../../../navigation/ZoomMomentumEstimator ../../../../geometry/Point".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e){F=function(d){function g(n){var r=d.call(this,n)||this;r._animationTime=0;r._momentumFinished=!1;r._rotationMomentumEstimator=new l.RotationMomentumEstimator(.6,.15,.95);r._rotationDirection=1;r._zoomDirection=1;r._zoomMomentumEstimator=new q.ZoomMomentumEstimator;r._zoomOnly=null;r.zoomMomentum=null;r.rotateMomentum=null;r.viewpoint=new C({targetGeometry:new e,scale:0,rotation:0});r.watch("_momentumFinished",t=>{t&&r.navigation.stop()});return r}u._inheritsLoose(g,
d);var m=g.prototype;m.begin=function(n,r){this.navigation.begin();this._rotationMomentumEstimator.reset();this._zoomMomentumEstimator.reset();this._zoomOnly=null;this._previousAngle=this._startAngle=r.angle;this._previousRadius=this._startRadius=r.radius;this._previousCenter=r.center;this._updateTimestamp=null;n.constraints.rotationEnabled&&this.addToRotateEstimator(0,r.timestamp);this.addToZoomEstimator(r,1)};m.update=function(n,r){null===this._updateTimestamp&&(this._updateTimestamp=r.timestamp);
const t=r.angle,z=r.radius,w=r.center,B=Math.abs(180*(t-this._startAngle)/Math.PI),A=Math.abs(z-this._startRadius),x=this._startRadius/z;if(this._previousRadius){const E=z/this._previousRadius;let D=180*(t-this._previousAngle)/Math.PI;this._rotationDirection=0<=D?1:-1;this._zoomDirection=1<=E?1:-1;n.constraints.rotationEnabled?(null===this._zoomOnly&&200<r.timestamp-this._updateTimestamp&&(this._zoomOnly=0<A-B),null===this._zoomOnly||this._zoomOnly?D=0:this.addToRotateEstimator(t-this._startAngle,
r.timestamp)):D=0;this.addToZoomEstimator(r,x);this.navigation.setViewpoint([w.x,w.y],1/E,D,[this._previousCenter.x-w.x,w.y-this._previousCenter.y])}this._previousAngle=t;this._previousRadius=z;this._previousCenter=w};m.end=function(n){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum();this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum();this._animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(n);this.navigation.end()};m.addToRotateEstimator=
function(n,r){this._rotationMomentumEstimator.add(n,.001*r)};m.addToZoomEstimator=function(n,r){this._zoomMomentumEstimator.add(r,.001*n.timestamp)};m.canZoomIn=function(n){const r=n.scale;n=n.constraints.effectiveMaxScale;return 0===n||r>n};m.canZoomOut=function(n){const r=n.scale;n=n.constraints.effectiveMinScale;return 0===n||r<n};m.onAnimationUpdate=function(n){this.navigation.animationManager.animateContinous(n.viewpoint,(r,t)=>{var z=!this.canZoomIn(n)&&1<this._zoomDirection||!this.canZoomOut(n)&&
1>this._zoomDirection,w=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime);z=z||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime);t*=.001;this._momentumFinished=w&&z;if(!this._momentumFinished){w=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,t))*this._rotationDirection*180/Math.PI:0;z=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,t)):1;const A=c.create();var B=c.create();if(this._previousCenter){f.set(A,
this._previousCenter.x,this._previousCenter.y);h.getPaddingScreenTranslation(B,n.size,n.padding);f.add(A,A,B);const {constraints:x,scale:E}=n;B=E*z;1>z&&!x.canZoomInTo(B)?(z=E/x.effectiveMaxScale,this.rotateMomentum=this.zoomMomentum=null):1<z&&!x.canZoomOutTo(B)&&(z=E/x.effectiveMinScale,this.rotateMomentum=this.zoomMomentum=null);h.scaleAndRotateBy(r,n.viewpoint,z,w,A,n.size);n.constraints.constrainByGeometry(r)}}this._animationTime+=t})};m.stopMomentumNavigation=function(){if(this.rotateMomentum||
this.zoomMomentum)this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};return g}(y);G.__decorate([v.property()],F.prototype,"_momentumFinished",void 0);G.__decorate([v.property()],F.prototype,"viewpoint",void 0);G.__decorate([v.property()],F.prototype,"navigation",void 0);return F=G.__decorate([a.subclass("esri.views.2d.navigation.actions.Pinch")],F)})},"esri/views/navigation/RotationMomentumEstimator":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./MomentumEstimator"],function(u,G,F){F=function(C){function y(v=3,p=.01,k=.95,b=12){return C.call(this,v,p,k,b)||this}G._inheritsLoose(y,C);y.prototype.add=function(v,p){if(this.value.hasLastValue){const k=this.value.lastValue;for(v-=k;v>Math.PI;)v-=2*Math.PI;for(;v<-Math.PI;)v+=2*Math.PI;v=k+v}C.prototype.add.call(this,v,p)};return y}(F.MomentumEstimator);u.RotationMomentumEstimator=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/navigation/MomentumEstimator":function(){define(["exports",
"../../core/mathUtils","./FilteredFiniteDifference","./Momentum"],function(u,G,F,C){let y=function(){function v(k=2.5,b=.01,a=.95,f=12){this.minimumInitialVelocity=k;this.stopVelocity=b;this.friction=a;this.maxVelocity=f;this.enabled=!0;this.value=new F.FilteredFiniteDifference(.8);this.time=new F.FilteredFiniteDifference(.3)}var p=v.prototype;p.add=function(k,b){if(this.enabled){if(this.time.hasLastValue){if(.01>this.time.computeDelta(b))return;if(this.value.hasFilteredDelta){const a=this.value.computeDelta(k);
0>this.value.filteredDelta*a&&this.value.reset()}}this.time.update(b);this.value.update(k)}};p.reset=function(){this.value.reset();this.time.reset()};p.evaluateMomentum=function(){if(!this.enabled||!this.value.hasFilteredDelta)return null;let k=this.value.filteredDelta/this.time.filteredDelta;k=G.clamp(k,-this.maxVelocity,this.maxVelocity);return Math.abs(k)<this.minimumInitialVelocity?null:this.createMomentum(k,this.stopVelocity,this.friction)};p.createMomentum=function(k,b,a){return new C.Momentum(k,
b,a)};return v}();u.MomentumEstimator=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/navigation/ZoomMomentumEstimator":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./Momentum","./MomentumEstimator"],function(u,G,F,C){let y=function(v){function p(b,a,f){return v.call(this,b,a,f)||this}G._inheritsLoose(p,v);var k=p.prototype;k.value=function(b){b=v.prototype.value.call(this,b);return Math.exp(b)};k.valueDelta=function(b,a){const f=v.prototype.value.call(this,
b);b=v.prototype.value.call(this,b+a);return Math.exp(b-f)};return p}(F.Momentum);F=function(v){function p(b=2.5,a=.01,f=.95,c=12){return v.call(this,b,a,f,c)||this}G._inheritsLoose(p,v);var k=p.prototype;k.add=function(b,a){v.prototype.add.call(this,Math.log(b),a)};k.createMomentum=function(b,a,f){return new y(b,a,f)};return p}(C.MomentumEstimator);u.ZoomMomentum=y;u.ZoomMomentumEstimator=F;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/navigation/actions/Rotate":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../../geometry/Point".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l){const q=c.create(),e=c.create();F=function(d){function g(n){n=d.call(this,n)||this;n._previousCenter=c.create();n.viewpoint=new C({targetGeometry:new l,scale:0,rotation:0});return n}u._inheritsLoose(g,d);var m=g.prototype;m.begin=function(n,r){this.navigation.begin();f.set(this._previousCenter,r.center.x,r.center.y)};m.update=function(n,r){const {state:{size:t,padding:z}}=n;f.set(q,r.center.x,r.center.y);h.getAnchor(e,t,z);n.viewpoint=h.rotateBy(this.viewpoint,
n.state.paddedViewState.viewpoint,h.angleBetween(e,this._previousCenter,q));f.copy(this._previousCenter,q)};m.end=function(){this.navigation.end()};return g}(y);G.__decorate([v.property()],F.prototype,"viewpoint",void 0);G.__decorate([v.property()],F.prototype,"navigation",void 0);return F=G.__decorate([a.subclass("esri.views.2d.actions.Rotate")],F)})},"esri/views/2d/magnifier/MagnifierView2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/Handles ../../../core/mathUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/urlUtils ../../../core/watchUtils ../../../chunks/mat3f32 ../../webgl/BufferObject ../../webgl/FramebufferObject ../../../core/has ../../webgl/checkWebGLError ../../webgl/enums ../../../chunks/builtins ../../webgl/Texture ../../webgl/VertexArrayObject ../engine/DisplayObject ../engine/webgl/enums ../engine/webgl/shaders/MagnifierPrograms ../../magnifier/resources".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c,h,l,q,e,d,g,m,n,r){return function(t){function z(){var B=t.call(this)||this;B._handles=new F;B._resourcePixelRatio=1;B.visible=!1;return B}u._inheritsLoose(z,t);var w=z.prototype;w.destroy=function(){this._handles.destroy();this._handles=null;this._disposeRenderResources();this._resourcesTask&&(this._resourcesTask.abort(),this._resourcesTask=null)};w._createTransforms=function(){return{dvs:b.create()}};w.doRender=function(B){const A=B.context;if(!this._resourcesTask)this._reloadResources();
else if(B.drawPhase===m.WGLDrawPhase.MAP&&this._canRender()){this._updateResources(B);var x=this._magnifier;if(!y.isNone(x.position)){var E=B.pixelRatio,D=x.size*E,K=Math.ceil(1/x.factor*D);this._readbackTexture.resize(K,K);var {size:H}=B.state;B=E*H[0];H=E*H[1];var I=.5*K,J=.5*K,M=C.clamp(E*x.position.x,I,B-I-1),O=C.clamp(H-E*x.position.y,J,H-J-1);A.setBlendingEnabled(!0);I=M-I;J=O-J;var L=this._readbackTexture;A.bindTexture(L,0);A.gl.copyTexImage2D(L.descriptor.target,0,L.descriptor.pixelFormat,
I,J,K,K,0);var S=(K=null==(S=this.background)?void 0:S.color)?[K.a*K.r/255,K.a*K.g/255,K.a*K.b/255,K.a]:[1,1,1,1];K=-1+(M+x.offset.x*E)/B*2;E=-1+(O-x.offset.y*E)/H*2;B=D/B*2;D=D/H*2;H=this._program;A.bindVAO(this._vertexArrayObject);A.bindTexture(this._overlayTexture,6);A.bindTexture(this._maskTexture,7);A.useProgram(H);H.setUniform4fv("u_background",S);H.setUniform1i("u_readbackTexture",0);H.setUniform1i("u_overlayTexture",6);H.setUniform1i("u_maskTexture",7);H.setUniform4f("u_drawPos",K,E,B,D);
H.setUniform1i("u_maskEnabled",x.maskEnabled?1:0);H.setUniform1i("u_overlayEnabled",x.overlayEnabled?1:0);A.setStencilTestEnabled(!1);A.setColorMask(!0,!0,!0,!0);A.drawArrays(5,0,4);A.bindVAO()}}};w._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier};w._reloadResources=function(){var B=this;this._resourcesTask&&this._resourcesTask.abort();const A=y.isSome(this._magnifier)?this._magnifier.maskUrl:null,x=y.isSome(this._magnifier)?this._magnifier.overlayUrl:null;this._resourcesTask=
v.createTask(function(){var E=u._asyncToGenerator(function*(D){const K=y.isNone(A)||y.isNone(x)?r.loadMagnifierResources(D):null,H=y.isSome(A)?G(A,{responseType:"image",signal:D}).then(M=>M.data):K.then(M=>M.mask);D=y.isSome(x)?G(x,{responseType:"image",signal:D}).then(M=>M.data):K.then(M=>M.overlay);const [I,J]=yield Promise.all([H,D]);B.mask=I;B.overlay=J;B._disposeRenderResources();B.requestRender()});return function(D){return E.apply(this,arguments)}}())};w._disposeRenderResources=function(){this._readbackTexture=
y.disposeMaybe(this._readbackTexture);this._overlayTexture=y.disposeMaybe(this._overlayTexture);this._maskTexture=y.disposeMaybe(this._maskTexture);this._vertexArrayObject=y.disposeMaybe(this._vertexArrayObject);this._program=y.disposeMaybe(this._program)};w._updateResources=function(B){B.pixelRatio!==this._resourcePixelRatio&&this._disposeRenderResources();if(!this._readbackTexture){var A=B.context;this._resourcePixelRatio=B.pixelRatio;var x=Math.ceil(this._magnifier.size*B.pixelRatio);this._program=
n.createMagnifierProgram(A);var E=new Uint16Array([0,1,0,0,1,1,1,0]);this._vertexArrayObject=new d(A,n.magnifierProgramTemplate.attributes,{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:a.createVertex(A,35044,E)});this.overlay.width=x;this.overlay.height=x;this._overlayTexture=new e(A,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0,preMultiplyAlpha:p.isSVG(this.overlay.src)&&B.context.driverTest.svgAlwaysPremultipliesAlpha?
!1:!0},this.overlay);this.mask.width=x;this.mask.height=x;this._maskTexture=new e(A,{target:3553,pixelFormat:6406,internalFormat:6406,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.mask);B=1/this._magnifier.factor;this._readbackTexture=new e(A,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:Math.ceil(B*x),height:Math.ceil(B*x)})}};u._createClass(z,[{key:"background",get:function(){return this._background},set:function(B){this._background=
B;this.requestRender()}},{key:"magnifier",get:function(){return this._magnifier},set:function(B){this._magnifier=B;this._handles.removeAll();this._handles.add([k.init(B,"version",()=>{this.visible=B.visible&&y.isSome(B.position)&&0<B.size;this.requestRender()}),B.watch(["mask","overlay"],()=>this._reloadResources()),B.watch("size",()=>{this._disposeRenderResources();this.requestRender()})])}}]);return z}(g.DisplayObject)})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define("exports ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../webgl/checkWebGLError ../../../../webgl/enums ../../../../../chunks/builtins ../../../../webgl/programUtils ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ./sources/resolver".split(" "),
function(u,G,F,C,y,v,p,k,b,a,f,c){const h={shaders:{vertexShader:c.resolveIncludes("magnifier/magnifier.vert"),fragmentShader:c.resolveIncludes("magnifier/magnifier.frag")},attributes:new Map([["a_pos",0]])};u.createMagnifierProgram=function(l){return b.createProgram(l,h)};u.magnifierProgramTemplate=h;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/magnifier/resources":function(){define(["require","exports","../../chunks/_rollupPluginBabelHelpers","../../core/promiseUtils","../../support/requestImageUtils"],
function(u,G,F,C,y){function v(){v=F._asyncToGenerator(function*(p){var k=new Promise((a,f)=>u(["./mask-svg"],c=>a(Object.freeze({__proto__:null,default:c})),f)),b=new Promise((a,f)=>u(["./overlay-svg"],c=>a(Object.freeze({__proto__:null,default:c})),f));k=y.requestImage((yield k).default,{signal:p});b=y.requestImage((yield b).default,{signal:p});b={mask:yield k,overlay:yield b};C.throwIfAborted(p);return b});return v.apply(this,arguments)}G.loadMagnifierResources=function(p){return v.apply(this,
arguments)};Object.defineProperty(G,"__esModule",{value:!0})})},"esri/support/requestImageUtils":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","../request"],function(u,G,F){function C(){C=G._asyncToGenerator(function*(y,v){({data:y}=yield F(y,{responseType:"image",...v}));return y});return C.apply(this,arguments)}u.requestImage=function(y,v){return C.apply(this,arguments)};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["exports",
"../../../chunks/mat4"],function(u,G){u.mat4=G.mat4;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["exports","../../../chunks/mat4f32"],function(u,G){u.mat4f32=G.mat4f32;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["exports","../../../chunks/vec3f32"],function(u,G){u.vec3f32=G.vec3f32;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["exports",
"../../../chunks/vec4f32"],function(u,G){u.vec4f32=G.vec4f32;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/Bitmap":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/mat3 ../../../chunks/mat3f32 ../../../chunks/vec2f32 ./DisplayObject ./ImageryBitmapSource ../../webgl/Texture".split(" "),function(u,G,F,C,y,v,p,k,b){function a(h){return h&&"render"in h}function f(h){const l=document.createElement("canvas");l.width=h.width;
l.height=h.height;h.render(l.getContext("2d"));return l}function c(h,l,q){const e={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};l&&q&&(e.width=l,e.height=q);return new b(h,e)}p=function(h){function l(e=null,d,g=!0){var m=h.call(this)||this;m.requestRenderOnSourceChangedEnabled=g;m._textureInvalidated=!0;m.stencilRef=0;m.coordScale=[1,1];m._height=void 0;m.pixelRatio=1;m.resolution=0;m.rotation=0;m._source=null;m._width=void 0;m.x=0;m.y=0;m.blendFunction=d;m.source=
e;m.requestRender=m.requestRender.bind(G._assertThisInitialized(m));return m}G._inheritsLoose(l,h);var q=l.prototype;q.destroy=function(){this._texture&&(this._texture.dispose(),this._texture=null)};q.beforeRender=function(e){h.prototype.beforeRender.call(this,e);this.updateTexture(e.context)};q.invalidateTexture=function(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())};q._createTransforms=function(){return{dvs:y.create()}};
q.setTransform=function(e){const d=C.identity(this.transforms.dvs),[g,m]=e.toScreenNoRotation([0,0],[this.x,this.y]);var n=this.resolution/this.pixelRatio/e.resolution;const r=n*this.width;n*=this.height;const t=Math.PI*this.rotation/180;C.translate(d,d,v.fromValues(g,m));C.translate(d,d,v.fromValues(r/2,n/2));C.rotate(d,d,-t);C.translate(d,d,v.fromValues(-r/2,-n/2));C.scaleByVec2(d,d,v.fromValues(r,n));C.multiply(this.transforms.dvs,e.displayViewMat3,d)};q.setSamplingProfile=function(e){this._texture&&
(e.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(e.samplingMode))};q.bind=function(e,d){this._texture&&e.bindTexture(this._texture,d)};q.updateTexture=function(e){if(this.stage)this._textureInvalidated&&(this._textureInvalidated=!1,this._texture||(this._texture=this.source?c(e,this.sourceWidth,this.sourceHeight):c(e)),(e=this.source)?(this._texture.resize(this.sourceWidth,this.sourceHeight),a(e)?e instanceof k?(e=e.getRenderedRasterPixels(),
this._texture.setData(F.isSome(e)?e.renderedRasterPixels:null)):this._texture.setData(f(e)):!e||"render"in e||this._texture.setData(e),this.ready()):this._texture.setData(null));else{var d;null==(d=this._texture)?void 0:d.dispose();this._texture=null}};q.onAttach=function(){this.invalidateTexture()};q.onDetach=function(){this.invalidateTexture()};G._createClass(l,[{key:"isSourceScaled",get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}},{key:"height",get:function(){return void 0!==
this._height?this._height:this.sourceHeight},set:function(e){this._height=e}},{key:"source",get:function(){return this._source},set:function(e){this._source=e;this.invalidateTexture()}},{key:"sourceHeight",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}},{key:"sourceWidth",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}},{key:"width",get:function(){return void 0!==this._width?
this._width:this.sourceWidth},set:function(e){this._width=e}}]);return l}(p.DisplayObject);u.Bitmap=p;u.isImageSource=a;u.rasterize=f;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe"],function(u,G){return function(){function F(y,v,p){this.pixelBlock=y;this.extent=v;this.originalPixelBlock=p}var C=F.prototype;C.render=function(y){var v=this.pixelBlock;if(!G.isNone(v)){var p=
this.filter({pixelBlock:v});G.isNone(p.pixelBlock)||(v=p.pixelBlock.getAsRGBA(),p=y.createImageData(p.pixelBlock.width,p.pixelBlock.height),p.data.set(v),y.putImageData(p,0,0))}};C.getRenderedRasterPixels=function(){const y=this.filter({pixelBlock:this.pixelBlock});return G.isNone(y.pixelBlock)?null:{width:y.pixelBlock.width,height:y.pixelBlock.height,renderedRasterPixels:new Uint8Array(y.pixelBlock.getAsRGBA().buffer)}};u._createClass(F,[{key:"width",get:function(){return G.isSome(this.pixelBlock)?
this.pixelBlock.width:0}},{key:"height",get:function(){return G.isSome(this.pixelBlock)?this.pixelBlock.height:0}}]);return F}()})},"esri/views/2d/engine/BitmapContainer":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","./brushes","./webgl/enums","./webgl/WGLContainer"],function(u,G,F,C,y){y=function(v){function p(){return v.apply(this,arguments)||this}G._inheritsLoose(p,v);p.prototype.prepareRenderPasses=function(k){const b=k.registerRenderPass({name:"bitmap",brushes:[F.brushes.bitmap],
target:()=>this.children,drawPhase:C.WGLDrawPhase.MAP});return[...v.prototype.prepareRenderPasses.call(this,k),b]};G._createClass(p,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(k=>"additive"===k.blendFunction)}}]);return p}(y);u.BitmapContainer=y;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/BitmapTile":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../chunks/mat3f32","./Bitmap","./webgl/TiledDisplayObject"],function(u,
G,F,C,y){y=function(v){function p(b,a,f,c,h,l=null){var q=v.call(this,b,a,f,c,h)||this;q.bitmap=new C.Bitmap(l,"standard",!1);q.bitmap.coordScale=[c,h];q.bitmap.once("isReady",()=>q.ready());return q}G._inheritsLoose(p,v);var k=p.prototype;k.destroy=function(){v.prototype.destroy.call(this);this.bitmap.destroy()};k.beforeRender=function(b){v.prototype.beforeRender.call(this,b);this.bitmap.beforeRender(b)};k.afterRender=function(b){v.prototype.afterRender.call(this,b);this.bitmap.afterRender(b)};k._createTransforms=
function(){return{dvs:F.create(),tileMat3:F.create()}};k.setTransform=function(b,a){v.prototype.setTransform.call(this,b,a);this.bitmap.transforms.dvs=this.transforms.dvs};k.onAttach=function(){this.bitmap.stage=this.stage};k.onDetach=function(){this.bitmap&&(this.bitmap.stage=null)};G._createClass(p,[{key:"stencilRef",get:function(){return this.bitmap.stencilRef},set:function(b){this.bitmap.stencilRef=b}}]);return p}(y.TiledDisplayObject);u.BitmapTile=y;Object.defineProperty(u,"__esModule",{value:!0})})},
"esri/views/2d/engine/BitmapTileContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/aaBoundingRect ./BitmapTile ./brushes ./webgl/enums ./webgl/TileContainer".split(" "),function(u,G,F,C,y,v,p){p=function(k){function b(){return k.apply(this,arguments)||this}G._inheritsLoose(b,k);var a=b.prototype;a.createTile=function(f){const c=this._tileInfoView.getTileBounds(F.create(),f),[h,l]=this._tileInfoView.tileInfo.size;return new C.BitmapTile(f,c[0],
c[3],h,l)};a.destroyTile=function(){};a.prepareRenderPasses=function(f){const c=f.registerRenderPass({name:"bitmap (tile)",brushes:[y.brushes.bitmap],target:()=>this.children.map(h=>h.bitmap),drawPhase:v.WGLDrawPhase.MAP});return[...k.prototype.prepareRenderPasses.call(this,f),c]};a.doRender=function(f){this.visible&&f.drawPhase===v.WGLDrawPhase.MAP&&k.prototype.doRender.call(this,f)};G._createClass(b,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(f=>"additive"===f.bitmap.blendFunction)}}]);
return b}(p.default);u.BitmapTileContainer=p;Object.defineProperty(u,"__esModule",{value:!0})})},"*noref":1}});define("exports ./engine/Stage ./LabelManager ./layers/graphics/GraphicsView2D ./layers/graphics/GraphicContainer ./navigation/MapViewNavigation ./magnifier/MagnifierView2D".split(" "),function(u,G,F,C,y,v,p){u.Stage=G.Stage;u.LabelManager=F;u.GraphicsView2D=C;u.GraphicContainer=y;u.MapViewNavigation=v;u.MagnifierView2D=p;Object.defineProperty(u,"__esModule",{value:!0})});