// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
define(["./ImmutableArray","../chunks/languageUtils","../core/promiseUtils","../geometry/Geometry"],function(q,e,m,n){function l(d,g=!1){if(null===d||void 0===d)return null;if(e.isNumber(d))return e.toNumber(d);if(e.isBoolean(d))return e.toBoolean(d);if(e.isString(d))return e.toString(d);if(e.isDate(d))return e.toDate(d);if(e.isArray(d)){var a=[];for(var c of d)a.push(l(c,g));return a}c=new p;c.immutable=!1;for(a of Object.keys(d)){const b=d[a];void 0!==b&&c.setField(a,l(b,g))}c.immutable=g;return c}
let p=function(){function d(a){this.declaredClass="esri.arcade.Dictionary";this.attributes=null;this.plain=!1;this.immutable=!0;this.attributes=a instanceof d?a.attributes:void 0===a?{}:null===a?{}:a}var g=d.prototype;g.field=function(a){const c=a.toLowerCase(),b=this.attributes[a];if(void 0!==b)return b;for(const f in this.attributes)if(f.toLowerCase()===c)return this.attributes[f];throw Error("Field not Found : "+a);};g.setField=function(a,c){if(this.immutable)throw Error("Dictionary is Immutable");
const b=a.toLowerCase();if(void 0===this.attributes[a])for(const f in this.attributes)if(f.toLowerCase()===b){this.attributes[f]=c;return}this.attributes[a]=c};g.hasField=function(a){const c=a.toLowerCase();if(void 0!==this.attributes[a])return!0;for(const b in this.attributes)if(b.toLowerCase()===c)return!0;return!1};g.keys=function(){let a=[];for(const c in this.attributes)a.push(c);return a=a.sort()};g.castToText=function(){let a="";for(const c in this.attributes){""!==a&&(a+=",");const b=this.attributes[c];
null==b?a+=JSON.stringify(c)+":null":e.isBoolean(b)||e.isNumber(b)||e.isString(b)?a+=JSON.stringify(c)+":"+JSON.stringify(b):b instanceof n?a+=JSON.stringify(c)+":"+e.toStringExplicit(b):b instanceof q?a+=JSON.stringify(c)+":"+e.toStringExplicit(b):b instanceof Array?a+=JSON.stringify(c)+":"+e.toStringExplicit(b):b instanceof Date?a+=JSON.stringify(c)+":"+JSON.stringify(b):null!==b&&"object"===typeof b&&void 0!==b.castToText&&(a+=JSON.stringify(c)+":"+b.castToText())}return"{"+a+"}"};d.convertObjectToArcadeDictionary=
function(a,c=!0){const b=new d;b.immutable=!1;for(const f in a){const h=a[f];void 0!==h&&b.setField(f.toString(),l(h))}b.immutable=c;return b};d.convertJsonToArcade=function(a,c=!1){return l(a,c)};g.castAsJson=function(a=null){const c={};for(let b in this.attributes){const f=this.attributes[b];void 0!==f&&(null!=a&&a.keyTranslate&&(b=a.keyTranslate(b)),c[b]=e.castAsJson(f,a))}return c};g.castDictionaryValueAsJsonAsync=function(a,c,b,f=null,h){return e.castAsJsonAsync(b,f,h).then(k=>a[c]=k)};g.castAsJsonAsync=
function(a=null,c=null){const b={},f=[];for(let h in this.attributes){const k=this.attributes[h];null!=c&&c.keyTranslate&&(h=c.keyTranslate(h));void 0!==k&&(e.isSimpleType(k)||k instanceof n||k instanceof Date?b[h]=e.castAsJson(k,c):f.push(this.castDictionaryValueAsJsonAsync(b,h,k,a,c)))}return 0<f.length?m.all(f).then(()=>b):m.resolve(b)};return d}();return p});